<!DOCTYPE html>
<!-- Created by pdf2htmlEX (https://github.com/coolwanglu/pdf2htmlex) -->
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta charset="utf-8"/>
<meta name="generator" content="pdf2htmlEX"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>
<link rel="stylesheet" href="base.min.css"/>
<link rel="stylesheet" href="fancy.min.css"/>
<link rel="stylesheet" href="main.css"/>
<script src="compatibility.min.js"></script>
<script src="pdf2htmlEX.min.js"></script>
<script>
try{
pdf2htmlEX.defaultViewer = new pdf2htmlEX.Viewer({});
}catch(e){}
</script>
<title></title>
</head>
<body>
<div id="sidebar">
<div id="outline">
<ul><li><a class="l" href="#pf7" data-dest-detail='[7,"XYZ",70.87,568.85,null]'>第一部分 模型选择与评估</a><ul><li><a class="l" href="#pf9" data-dest-detail='[9,"XYZ",70.87,799.37,null]'>概述</a><ul><li><a class="l" href="#pf9" data-dest-detail='[9,"XYZ",70.87,662.85,null]'>基本概念</a></li><li><a class="l" href="#pfa" data-dest-detail='[10,"XYZ",70.87,332.06,null]'>假设空间</a><ul><li><a class="l" href="#pfa" data-dest-detail='[10,"XYZ",70.87,40.4,null]'>线性模型</a></li><li><a class="l" href="#pfb" data-dest-detail='[11,"XYZ",70.87,703.86,null]'>非线性模型</a></li></ul></li><li><a class="l" href="#pfb" data-dest-detail='[11,"XYZ",70.87,471.49,null]'>学习准则</a><ul><li><a class="l" href="#pfb" data-dest-detail='[11,"XYZ",70.87,151.63,null]'>风险最小化准则</a></li><li><a class="l" href="#pfc" data-dest-detail='[12,"XYZ",70.87,670.51,null]'>结构风险最小化准则</a></li></ul></li></ul></li><li><a class="l" href="#pfd" data-dest-detail='[13,"XYZ",70.87,799.37,null]'>评估假设空间</a><ul><li><a class="l" href="#pfd" data-dest-detail='[13,"XYZ",70.87,662.93,null]'>模型的参数和超参数</a></li><li><a class="l" href="#pfd" data-dest-detail='[13,"XYZ",70.87,141.03,null]'>偏差-方差分解</a></li><li><a class="l" href="#pf10" data-dest-detail='[16,"XYZ",70.87,760.2,null]'>交叉验证</a><ul><li><a class="l" href="#pf10" data-dest-detail='[16,"XYZ",70.87,422.52,null]'>简单交叉验证</a></li><li><a class="l" href="#pf10" data-dest-detail='[16,"XYZ",70.87,258.55,null]'>K 折交叉验证</a></li><li><a class="l" href="#pf10" data-dest-detail='[16,"XYZ",70.87,129.68,null]'>留一法和留 P 法</a></li><li><a class="l" href="#pf11" data-dest-detail='[17,"XYZ",70.87,579.88,null]'>时序交叉验证</a></li></ul></li></ul></li><li><a class="l" href="#pf13" data-dest-detail='[19,"XYZ",70.87,799.37,null]'>评估模型</a><ul><li><a class="l" href="#pf13" data-dest-detail='[19,"XYZ",70.87,496.81,null]'>回归</a><ul><li><a class="l" href="#pf13" data-dest-detail='[19,"XYZ",70.87,414.93,null]'>均方误差</a></li></ul></li><li><a class="l" href="#pf13" data-dest-detail='[19,"XYZ",70.87,219.19,null]'>分类</a><ul><li><a class="l" href="#pf13" data-dest-detail='[19,"XYZ",70.87,135.78,null]'>混淆矩阵</a></li><li><a class="l" href="#pf14" data-dest-detail='[20,"XYZ",70.87,263.07,null]'>Error Rate与accuracy</a></li><li><a class="l" href="#pf15" data-dest-detail='[21,"XYZ",70.87,533.97,null]'>Precision、Recall</a></li><li><a class="l" href="#pf16" data-dest-detail='[22,"XYZ",70.87,42.52,null]'>TPR、FPR</a></li><li><a class="l" href="#pf17" data-dest-detail='[23,"XYZ",70.87,577.78,null]'>ROC、AUC</a></li><li><a class="l" href="#pf19" data-dest-detail='[25,"XYZ",70.87,267.14,null]'>代价敏感错误率</a></li></ul></li></ul></li><li><a class="l" href="#pf1b" data-dest-detail='[27,"XYZ",70.87,799.37,null]'>信息熵*</a></li></ul></li><li><a class="l" href="#pf1d" data-dest-detail='[29,"XYZ",70.87,577.15,null]'>第二部分 机器学习中阶  传统模型</a><ul><li><a class="l" href="#pf1f" data-dest-detail='[31,"XYZ",70.87,799.37,null]'>决策树</a><ul><li><a class="l" href="#pf1f" data-dest-detail='[31,"XYZ",70.87,662.93,null]'>简介</a></li><li><a class="l" href="#pf1f" data-dest-detail='[31,"XYZ",70.87,41.41,null]'>决策树基本算法</a></li><li><a class="l" href="#pf20" data-dest-detail='[32,"XYZ",70.87,284.16,null]'>划分选择</a><ul><li><a class="l" href="#pf21" data-dest-detail='[33,"XYZ",70.87,272.5,null]'>信息增益</a></li><li><a class="l" href="#pf22" data-dest-detail='[34,"XYZ",70.87,142.86,null]'>信息增益比</a></li><li><a class="l" href="#pf23" data-dest-detail='[35,"XYZ",70.87,618.1,null]'>基尼指数</a></li></ul></li><li><a class="l" href="#pf23" data-dest-detail='[35,"XYZ",70.87,292.23,null]'>连续值处理</a></li><li><a class="l" href="#pf24" data-dest-detail='[36,"XYZ",70.87,629.53,null]'>缺失值处理</a></li><li><a class="l" href="#pf25" data-dest-detail='[37,"XYZ",70.87,625.67,null]'>剪枝</a><ul><li><a class="l" href="#pf25" data-dest-detail='[37,"XYZ",70.87,450.82,null]'>预剪枝</a></li><li><a class="l" href="#pf25" data-dest-detail='[37,"XYZ",70.87,293.83,null]'>后剪枝</a><ul><li><a class="l" href="#pf25" data-dest-detail='[37,"XYZ",70.87,166.8,null]'>错误率降低剪枝(Reduced-Error Pruning, REP)</a></li><li><a class="l" href="#pf26" data-dest-detail='[38,"XYZ",70.87,715.61,null]'>悲观错误剪枝(Pessimistic Error Pruning, PEP)</a></li><li><a class="l" href="#pf26" data-dest-detail='[38,"XYZ",70.87,238.21,null]'>代价复杂度剪枝(Cost-Complexity Pruning, CCP)</a></li></ul></li></ul></li><li><a class="l" href="#pf29" data-dest-detail='[41,"XYZ",70.87,200.12,null]'>多变量决策树</a></li><li><a class="l" href="#pf2a" data-dest-detail='[42,"XYZ",70.87,251.97,null]'>总结</a></li><li><a class="l" href="#pf2b" data-dest-detail='[43,"XYZ",70.87,590.72,null]'>Python代码</a></li></ul></li><li><a class="l" href="#pf2d" data-dest-detail='[45,"XYZ",70.87,799.37,null]'>Perceptron</a><ul><li><a class="l" href="#pf2e" data-dest-detail='[46,"XYZ",70.87,547.16,null]'>损失函数</a></li><li><a class="l" href="#pf2e" data-dest-detail='[46,"XYZ",70.87,41.41,null]'>参数更新</a></li><li><a class="l" href="#pf31" data-dest-detail='[49,"XYZ",70.87,761.27,null]'>感知器收敛性</a></li><li><a class="l" href="#pf31" data-dest-detail='[49,"XYZ",70.87,440.6,null]'>感知机的缺陷</a></li></ul></li></ul></li><li><a class="l" href="#pf33" data-dest-detail='[51,"XYZ",70.87,577.15,null]'>第三部分 机器学习高阶  优化方法</a><ul><li><a class="l" href="#pf35" data-dest-detail='[53,"XYZ",70.87,799.37,null]'>凸优化基础概念</a><ul><li><a class="l" href="#pf35" data-dest-detail='[53,"XYZ",70.87,662.85,null]'>凸集</a></li><li><a class="l" href="#pf36" data-dest-detail='[54,"XYZ",70.87,206.12,null]'>重要的凸集</a></li><li><a class="l" href="#pf37" data-dest-detail='[55,"XYZ",70.87,295.38,null]'>保持凸性的运算</a><ul><li><a class="l" href="#pf37" data-dest-detail='[55,"XYZ",70.87,244.74,null]'>交集</a></li><li><a class="l" href="#pf37" data-dest-detail='[55,"XYZ",70.87,175.34,null]'>仿射函数</a></li></ul></li></ul></li><li><a class="l" href="#pf39" data-dest-detail='[57,"XYZ",70.87,799.37,null]'>梯度下降</a><ul><li><a class="l" href="#pf39" data-dest-detail='[57,"XYZ",70.87,662.93,null]'>梯度下降原理</a></li></ul></li><li><a class="l" href="#pf3b" data-dest-detail='[59,"XYZ",70.87,799.37,null]'>Backpropagation</a><ul><li><a class="l" href="#pf3b" data-dest-detail='[59,"XYZ",70.87,660.96,null]'>神经网络</a></li><li><a class="l" href="#pf3b" data-dest-detail='[59,"XYZ",70.87,391.25,null]'>基本函数</a></li><li><a class="l" href="#pf3c" data-dest-detail='[60,"XYZ",70.87,664.07,null]'>前向传播</a></li><li><a class="l" href="#pf3d" data-dest-detail='[61,"XYZ",70.87,41.41,null]'>反向传播</a><ul><li><a class="l" href="#pf3e" data-dest-detail='[62,"XYZ",70.87,647.03,null]'>输出层</a></li><li><a class="l" href="#pf3f" data-dest-detail='[63,"XYZ",70.87,743.58,null]'>隐藏层</a></li></ul></li><li><a class="l" href="#pf3f" data-dest-detail='[63,"XYZ",70.87,203.12,null]'>权值更新归纳</a></li></ul></li></ul></li><li><a class="l" href="#pf41" data-dest-detail='[65,"XYZ",70.87,568.85,null]'>第四部分 神经网络</a><ul><li><a class="l" href="#pf43" data-dest-detail='[67,"XYZ",70.87,799.37,null]'>Perceptron</a><ul><li><a class="l" href="#pf44" data-dest-detail='[68,"XYZ",70.87,547.16,null]'>损失函数</a></li><li><a class="l" href="#pf44" data-dest-detail='[68,"XYZ",70.87,41.41,null]'>参数更新</a></li><li><a class="l" href="#pf47" data-dest-detail='[71,"XYZ",70.87,761.27,null]'>感知器收敛性</a></li><li><a class="l" href="#pf47" data-dest-detail='[71,"XYZ",70.87,440.6,null]'>感知机的缺陷</a></li></ul></li><li><a class="l" href="#pf49" data-dest-detail='[73,"XYZ",70.87,799.37,null]'>Recurrent Neural Networks</a><ul><li><a class="l" href="#pf49" data-dest-detail='[73,"XYZ",70.87,682.86,null]'>Simple Recurrent Network</a><ul><li><a class="l" href="#pf49" data-dest-detail='[73,"XYZ",70.87,640.54,null]'>前向传播</a></li><li><a class="l" href="#pf4b" data-dest-detail='[75,"XYZ",70.87,260.69,null]'>反向传播</a></li><li><a class="l" href="#pf4c" data-dest-detail='[76,"XYZ",70.87,718.55,null]'>title</a></li></ul></li><li><a class="l" href="#pf4c" data-dest-detail='[76,"XYZ",70.87,665.09,null]'>LSTM </a><ul><li><a class="l" href="#pf4c" data-dest-detail='[76,"XYZ",70.87,625.87,null]'>LSTM 概述</a></li><li><a class="l" href="#pf4c" data-dest-detail='[76,"XYZ",70.87,530.55,null]'>LSTM与RNN的区别</a></li><li><a class="l" href="#pf4d" data-dest-detail='[77,"XYZ",70.87,399.38,null]'>遗忘门</a></li><li><a class="l" href="#pf4d" data-dest-detail='[77,"XYZ",70.87,135.06,null]'>输入门</a></li><li><a class="l" href="#pf4e" data-dest-detail='[78,"XYZ",70.87,709.21,null]'>细胞状态更新</a></li><li><a class="l" href="#pf4e" data-dest-detail='[78,"XYZ",70.87,559.23,null]'>输出门</a></li></ul></li><li><a class="l" href="#pf4e" data-dest-detail='[78,"XYZ",70.87,381.09,null]'>带窥孔的LSTM</a></li><li><a class="l" href="#pf4e" data-dest-detail='[78,"XYZ",70.87,238.54,null]'>GRU</a></li></ul></li><li><a class="l" href="#pf51" data-dest-detail='[81,"XYZ",70.87,799.37,null]'>Seq2Seq</a><ul><li><a class="l" href="#pf51" data-dest-detail='[81,"XYZ",70.87,661.1,null]'>Encoder-Decoder</a></li><li><a class="l" href="#pf52" data-dest-detail='[82,"XYZ",70.87,525.87,null]'>Seq2Seq</a></li><li><a class="l" href="#pf52" data-dest-detail='[82,"XYZ",70.87,29.4,null]'>Attention机制</a></li></ul></li></ul></li></ul></div>
</div>
<div id="page-container">
<div id="pf1" class="pf w0 h0" data-page-no="1"><div class="pc pc1 w0 h0"><div class="t m0 x0 h1 y0 ff1 fs0 fc0 sc0 ls0 ws0">机器学习</div><div class="t m0 x1 h2 y1 ff2 fs1 fc0 sc0 ls0 ws0">siwing</div><div class="t m0 x2 h3 y2 ff2 fs1 fc0 sc0 ls0 ws0">2020<span class="_ _0"> </span><span class="ff1">年<span class="_ _0"> </span></span>10<span class="_ _0"> </span><span class="ff1">月<span class="_ _0"> </span></span>13<span class="_ _0"> </span><span class="ff1">日</span></div></div><div class="pi" data-data='{"ctm":[1.500000,0.000000,0.000000,1.500000,0.000000,0.000000]}'></div></div>
<div id="pf2" class="pf w0 h0" data-page-no="2"><div class="pc pc2 w0 h0"><div class="t m0 x3 h4 y3 ff3 fs2 fc0 sc0 ls0 ws0">2</div></div><div class="pi" data-data='{"ctm":[1.500000,0.000000,0.000000,1.500000,0.000000,0.000000]}'></div></div>
<div id="pf3" class="pf w0 h0" data-page-no="3"><div class="pc pc3 w0 h0"><div class="t m0 x4 h5 y4 ff4 fs3 fc0 sc0 ls0 ws0">目录</div><div class="t m0 x3 h5 y5 ff4 fs4 fc0 sc0 ls0 ws0">第一部分 <span class="fs3">模型选择与评估<span class="_ _1"> </span></span><span class="ff5">1</span></div><div class="t m0 x3 h6 y6 ff4 fs2 fc0 sc0 ls0 ws0">第一章<span class="_ _2"> </span>概述<span class="_ _3"> </span><span class="ff6">3</span></div><div class="t m0 x5 h6 y7 ff3 fs2 fc0 sc0 ls0 ws0">1.1<span class="_ _4"> </span><span class="ff1">基本概念 </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _6"> </span>3</div><div class="t m0 x5 h6 y8 ff3 fs2 fc0 sc0 ls0 ws0">1.2<span class="_ _4"> </span><span class="ff1">假设空间 </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _6"> </span>4</div><div class="t m0 x6 h6 y9 ff3 fs2 fc0 sc0 ls0 ws0">1.2.1<span class="_ _7"> </span><span class="ff1">线性模型<span class="_ _8"> </span></span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _6"> </span>5</div><div class="t m0 x6 h6 ya ff3 fs2 fc0 sc0 ls0 ws0">1.2.2<span class="_ _7"> </span><span class="ff1">非线性模型<span class="_ _9"> </span></span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _6"> </span>5</div><div class="t m0 x5 h4 yb ff3 fs2 fc0 sc0 ls0 ws0">1.3</div><div class="t m0 x6 h6 yc ff1 fs2 fc0 sc0 ls0 ws0">学习准则</div><div class="t m0 x7 h4 yb ff3 fs2 fc0 sc0 ls0 ws0">.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _6"> </span>5</div><div class="t m0 x6 h6 yd ff3 fs2 fc0 sc0 ls0 ws0">1.3.1<span class="_ _7"> </span><span class="ff1">风险最小化准则<span class="_ _a"> </span></span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _6"> </span>5</div><div class="t m0 x6 h6 ye ff3 fs2 fc0 sc0 ls0 ws0">1.3.2<span class="_ _7"> </span><span class="ff1">结构风险最小化准则<span class="_ _b"> </span></span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _6"> </span>6</div><div class="t m0 x3 h6 yf ff4 fs2 fc0 sc0 ls0 ws0">第二章<span class="_ _2"> </span>评估假设空间<span class="_ _c"> </span><span class="ff6">7</span></div><div class="t m0 x5 h6 y10 ff3 fs2 fc0 sc0 ls0 ws0">2.1<span class="_ _4"> </span><span class="ff1">模型的参数和超参数<span class="_ _9"> </span></span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _6"> </span>7</div><div class="t m0 x5 h6 y11 ff3 fs2 fc0 sc0 ls0 ws0">2.2<span class="_ _4"> </span><span class="ff1">偏差</span>-<span class="ff1">方差分解 </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _6"> </span>7</div><div class="t m0 x5 h6 y12 ff3 fs2 fc0 sc0 ls0 ws0">2.3<span class="_ _4"> </span><span class="ff1">交叉验证 </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _7"> </span>10</div><div class="t m0 x6 h6 y13 ff3 fs2 fc0 sc0 ls0 ws0">2.3.1<span class="_ _7"> </span><span class="ff1">简单交叉验证<span class="_ _0"> </span></span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _7"> </span>10</div><div class="t m0 x6 h6 y14 ff3 fs2 fc0 sc0 ls0 ws0">2.3.2<span class="_ _7"> </span>K<span class="_ _d"> </span><span class="ff1">折交叉验证<span class="_ _e"> </span></span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _7"> </span>10</div><div class="t m0 x6 h6 y15 ff3 fs2 fc0 sc0 ls0 ws0">2.3.3<span class="_ _7"> </span><span class="ff1">留一法和留<span class="_ _d"> </span></span>P<span class="_ _d"> </span><span class="ff1">法<span class="_ _9"> </span></span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _7"> </span>10</div><div class="t m0 x6 h6 y16 ff3 fs2 fc0 sc0 ls0 ws0">2.3.4<span class="_ _7"> </span><span class="ff1">时序交叉验证<span class="_ _0"> </span></span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _7"> </span>11</div><div class="t m0 x3 h6 y17 ff4 fs2 fc0 sc0 ls0 ws0">第三章<span class="_ _2"> </span>评估模型<span class="_ _f"> </span><span class="ff6">13</span></div><div class="t m0 x5 h6 y18 ff3 fs2 fc0 sc0 ls0 ws0">3.1<span class="_ _4"> </span><span class="ff1">回归<span class="_ _10"> </span></span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _7"> </span>13</div><div class="t m0 x6 h6 y19 ff3 fs2 fc0 sc0 ls0 ws0">3.1.1<span class="_ _7"> </span><span class="ff1">均方误差<span class="_ _8"> </span></span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _7"> </span>13</div><div class="t m0 x5 h6 y1a ff3 fs2 fc0 sc0 ls0 ws0">3.2<span class="_ _4"> </span><span class="ff1">分类<span class="_ _10"> </span></span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _7"> </span>13</div><div class="t m0 x6 h6 y1b ff3 fs2 fc0 sc0 ls0 ws0">3.2.1<span class="_ _7"> </span><span class="ff1">混淆矩阵<span class="_ _8"> </span></span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _7"> </span>13</div><div class="t m0 x6 h4 y1c ff3 fs2 fc0 sc0 ls0 ws0">3.2.2<span class="_ _7"> </span>Error<span class="_ _d"> </span>Rate</div><div class="t m0 x8 h6 y1d ff1 fs2 fc0 sc0 ls0 ws0">与</div><div class="t m0 x9 h4 y1c ff3 fs2 fc0 sc0 ls0 ws0">accuracy<span class="_ _8"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _7"> </span>14</div><div class="t m0 x6 h6 y1e ff3 fs2 fc0 sc0 ls0 ws0">3.2.3<span class="_ _7"> </span>Precision<span class="ff1">、</span>Recall<span class="_ _e"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _7"> </span>15</div><div class="t m0 x6 h6 y1f ff3 fs2 fc0 sc0 ls0 ws0">3.2.4<span class="_ _7"> </span>TPR<span class="ff1">、</span>FPR<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _11"> </span>17</div><div class="t m0 x6 h6 y20 ff3 fs2 fc0 sc0 ls0 ws0">3.2.5<span class="_ _7"> </span>R<span class="_ _12"></span>OC<span class="ff1">、</span>A<span class="_ _12"></span>UC .<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _7"> </span>17</div><div class="t m0 xa h4 y3 ff3 fs2 fc0 sc0 ls0 ws0">3</div><a class="l" href="#pf7" data-dest-detail='[7,"XYZ",70.87,568.85,null]'><div class="d m1" style="border-style:none;position:absolute;left:106.299000px;bottom:950.154000px;width:204.414000px;height:20.663000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf9" data-dest-detail='[9,"XYZ",70.87,799.37,null]'><div class="d m1" style="border-style:none;position:absolute;left:106.299000px;bottom:901.585500px;width:63.273000px;height:10.909000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf9" data-dest-detail='[9,"XYZ",70.87,662.85,null]'><div class="d m1" style="border-style:none;position:absolute;left:130.845000px;bottom:865.557000px;width:68.727000px;height:15.458000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfa" data-dest-detail='[10,"XYZ",70.87,332.06,null]'><div class="d m1" style="border-style:none;position:absolute;left:130.845000px;bottom:831.972000px;width:68.727000px;height:15.458000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfa" data-dest-detail='[10,"XYZ",70.87,40.4,null]'><div class="d m1" style="border-style:none;position:absolute;left:168.481500px;bottom:798.388500px;width:78.545000px;height:15.458000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfb" data-dest-detail='[11,"XYZ",70.87,703.86,null]'><div class="d m1" style="border-style:none;position:absolute;left:168.481500px;bottom:764.803500px;width:89.454000px;height:15.458000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfb" data-dest-detail='[11,"XYZ",70.87,471.49,null]'><div class="d m1" style="border-style:none;position:absolute;left:130.845000px;bottom:731.220000px;width:68.727000px;height:15.458000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfb" data-dest-detail='[11,"XYZ",70.87,151.63,null]'><div class="d m1" style="border-style:none;position:absolute;left:168.481500px;bottom:697.635000px;width:111.272000px;height:15.458000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfc" data-dest-detail='[12,"XYZ",70.87,670.51,null]'><div class="d m1" style="border-style:none;position:absolute;left:168.481500px;bottom:664.051500px;width:133.091000px;height:15.458000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfd" data-dest-detail='[13,"XYZ",70.87,799.37,null]'><div class="d m1" style="border-style:none;position:absolute;left:106.299000px;bottom:615.868500px;width:106.909000px;height:10.909000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfd" data-dest-detail='[13,"XYZ",70.87,662.93,null]'><div class="d m1" style="border-style:none;position:absolute;left:130.845000px;bottom:579.840000px;width:123.272000px;height:15.458000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfd" data-dest-detail='[13,"XYZ",70.87,141.03,null]'><div class="d m1" style="border-style:none;position:absolute;left:130.845000px;bottom:546.256500px;width:94.178000px;height:15.458000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf10" data-dest-detail='[16,"XYZ",70.87,760.2,null]'><div class="d m1" style="border-style:none;position:absolute;left:130.845000px;bottom:512.671500px;width:68.727000px;height:15.458000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf10" data-dest-detail='[16,"XYZ",70.87,422.52,null]'><div class="d m1" style="border-style:none;position:absolute;left:168.481500px;bottom:479.088000px;width:100.363000px;height:15.458000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf10" data-dest-detail='[16,"XYZ",70.87,258.55,null]'><div class="d m1" style="border-style:none;position:absolute;left:168.481500px;bottom:445.503000px;width:101.574000px;height:15.458000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf10" data-dest-detail='[16,"XYZ",70.87,129.68,null]'><div class="d m1" style="border-style:none;position:absolute;left:168.481500px;bottom:411.919500px;width:115.058000px;height:15.458000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf11" data-dest-detail='[17,"XYZ",70.87,579.88,null]'><div class="d m1" style="border-style:none;position:absolute;left:168.481500px;bottom:378.334500px;width:100.363000px;height:15.458000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf13" data-dest-detail='[19,"XYZ",70.87,799.37,null]'><div class="d m1" style="border-style:none;position:absolute;left:106.299000px;bottom:330.153000px;width:85.091000px;height:10.909000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf13" data-dest-detail='[19,"XYZ",70.87,496.81,null]'><div class="d m1" style="border-style:none;position:absolute;left:130.845000px;bottom:294.124500px;width:46.909000px;height:15.458000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf13" data-dest-detail='[19,"XYZ",70.87,414.93,null]'><div class="d m1" style="border-style:none;position:absolute;left:168.481500px;bottom:260.539500px;width:78.545000px;height:15.458000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf13" data-dest-detail='[19,"XYZ",70.87,219.19,null]'><div class="d m1" style="border-style:none;position:absolute;left:130.845000px;bottom:226.956000px;width:46.909000px;height:15.458000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf13" data-dest-detail='[19,"XYZ",70.87,135.78,null]'><div class="d m1" style="border-style:none;position:absolute;left:168.481500px;bottom:193.371000px;width:78.545000px;height:15.458000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf14" data-dest-detail='[20,"XYZ",70.87,263.07,null]'><div class="d m1" style="border-style:none;position:absolute;left:168.481500px;bottom:159.787500px;width:146.541000px;height:15.458000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf15" data-dest-detail='[21,"XYZ",70.87,533.97,null]'><div class="d m1" style="border-style:none;position:absolute;left:168.481500px;bottom:126.202500px;width:118.331000px;height:15.458000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf16" data-dest-detail='[22,"XYZ",70.87,42.52,null]'><div class="d m1" style="border-style:none;position:absolute;left:168.481500px;bottom:92.619000px;width:91.734000px;height:15.458000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf17" data-dest-detail='[23,"XYZ",70.87,577.78,null]'><div class="d m1" style="border-style:none;position:absolute;left:168.481500px;bottom:59.034000px;width:93.840000px;height:15.458000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.500000,0.000000,0.000000,1.500000,0.000000,0.000000]}'></div></div>
<div id="pf4" class="pf w0 h0" data-page-no="4"><div class="pc pc4 w0 h0"><div class="t m0 x3 h7 y21 ff7 fs5 fc0 sc0 ls0 ws0">目录</div><div class="t m0 x6 h6 y22 ff3 fs2 fc0 sc0 ls0 ws0">3.2.6<span class="_ _7"> </span><span class="ff1">代价敏感错误率<span class="_ _a"> </span></span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _11"> </span>19</div><div class="t m0 x3 h6 y23 ff4 fs2 fc0 sc0 ls0 ws0">第四章<span class="_ _2"> </span>信息熵<span class="_ _e"> </span><span class="ff6">*<span class="_ _13"> </span>21</span></div><div class="t m0 x3 h5 y24 ff4 fs4 fc0 sc0 ls0 ws0">第二部分 <span class="fs3">机器学习中阶</span></div><div class="t m0 x3 h3 y25 ff8 fs1 fc0 sc0 ls0 ws0">传统模型<span class="_ _14"> </span><span class="ff5 fs4">23</span></div><div class="t m0 x3 h6 y26 ff4 fs2 fc0 sc0 ls0 ws0">第五章<span class="_ _2"> </span>决策树<span class="_ _15"> </span><span class="ff6">25</span></div><div class="t m0 x5 h6 y27 ff3 fs2 fc0 sc0 ls0 ws0">5.1<span class="_ _4"> </span><span class="ff1">简介<span class="_ _10"> </span></span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _7"> </span>25</div><div class="t m0 x5 h6 y28 ff3 fs2 fc0 sc0 ls0 ws0">5.2<span class="_ _4"> </span><span class="ff1">决策树基本算法<span class="_ _d"> </span></span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _7"> </span>26</div><div class="t m0 x5 h6 y29 ff3 fs2 fc0 sc0 ls0 ws0">5.3<span class="_ _4"> </span><span class="ff1">划分选择 </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _7"> </span>26</div><div class="t m0 x6 h6 y2a ff3 fs2 fc0 sc0 ls0 ws0">5.3.1<span class="_ _7"> </span><span class="ff1">信息增益<span class="_ _8"> </span></span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _7"> </span>27</div><div class="t m0 x6 h6 y2b ff3 fs2 fc0 sc0 ls0 ws0">5.3.2<span class="_ _7"> </span><span class="ff1">信息增益比<span class="_ _9"> </span></span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _7"> </span>28</div><div class="t m0 x6 h6 y2c ff3 fs2 fc0 sc0 ls0 ws0">5.3.3<span class="_ _7"> </span><span class="ff1">基尼指数<span class="_ _8"> </span></span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _7"> </span>29</div><div class="t m0 x5 h6 y2d ff3 fs2 fc0 sc0 ls0 ws0">5.4<span class="_ _4"> </span><span class="ff1">连续值处理<span class="_ _2"> </span></span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _7"> </span>29</div><div class="t m0 x5 h6 y2e ff3 fs2 fc0 sc0 ls0 ws0">5.5<span class="_ _4"> </span><span class="ff1">缺失值处理<span class="_ _2"> </span></span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _7"> </span>30</div><div class="t m0 x5 h6 y2f ff3 fs2 fc0 sc0 ls0 ws0">5.6<span class="_ _4"> </span><span class="ff1">剪枝<span class="_ _10"> </span></span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _7"> </span>31</div><div class="t m0 x6 h6 y30 ff3 fs2 fc0 sc0 ls0 ws0">5.6.1<span class="_ _7"> </span><span class="ff1">预剪枝<span class="_ _e"> </span></span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _7"> </span>31</div><div class="t m0 x6 h6 y31 ff3 fs2 fc0 sc0 ls0 ws0">5.6.2<span class="_ _7"> </span><span class="ff1">后剪枝<span class="_ _e"> </span></span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _7"> </span>31</div><div class="t m0 xb h6 y32 ff3 fs2 fc0 sc0 ls0 ws0">5.6.2.1<span class="_ _16"> </span><span class="ff1">错误率降低剪枝<span class="_ _d"> </span></span>(Reduced-Error<span class="_ _d"> </span>Pruning,<span class="_ _d"> </span>REP)<span class="_ _17"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _7"> </span>31</div><div class="t m0 xb h6 y33 ff3 fs2 fc0 sc0 ls0 ws0">5.6.2.2<span class="_ _16"> </span><span class="ff1">悲观错误剪枝<span class="_ _d"> </span></span>(P<span class="_ _12"></span>essimistic<span class="_ _d"> </span>Error<span class="_ _d"> </span>Pruning,<span class="_ _d"> </span>PEP)<span class="_ _17"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _7"> </span>32</div><div class="t m0 xb h6 y34 ff3 fs2 fc0 sc0 ls0 ws0">5.6.2.3<span class="_ _16"> </span><span class="ff1">代价复杂度剪枝<span class="_ _d"> </span></span>(Cost-Complexit<span class="_ _12"></span>y<span class="_ _d"> </span>Pruning,<span class="_ _d"> </span>CCP)<span class="_ _18"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _7"> </span>32</div><div class="t m0 x5 h6 y35 ff3 fs2 fc0 sc0 ls0 ws0">5.7<span class="_ _4"> </span><span class="ff1">多变量决策树<span class="_ _19"> </span></span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _7"> </span>35</div><div class="t m0 x5 h6 y36 ff3 fs2 fc0 sc0 ls0 ws0">5.8<span class="_ _4"> </span><span class="ff1">总结<span class="_ _10"> </span></span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _7"> </span>36</div><div class="t m0 x5 h6 y37 ff3 fs2 fc0 sc0 ls0 ws0">5.9<span class="_ _4"> </span>Python<span class="_ _d"> </span><span class="ff1">代码 </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _7"> </span>37</div><div class="t m0 x3 h6 y38 ff4 fs2 fc0 sc0 ls0 ws0">第六章<span class="_ _2"> </span><span class="ff6">P<span class="_ _12"></span>erceptron<span class="_ _1a"> </span>39</span></div><div class="t m0 x5 h6 y39 ff3 fs2 fc0 sc0 ls0 ws0">6.1<span class="_ _4"> </span><span class="ff1">损失函数 </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _7"> </span>40</div><div class="t m0 x5 h6 y3a ff3 fs2 fc0 sc0 ls0 ws0">6.2<span class="_ _4"> </span><span class="ff1">参数更新 </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _7"> </span>41</div><div class="t m0 x5 h6 y3b ff3 fs2 fc0 sc0 ls0 ws0">6.3<span class="_ _4"> </span><span class="ff1">感知器收敛性<span class="_ _19"> </span></span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _7"> </span>43</div><div class="t m0 x5 h6 y3c ff3 fs2 fc0 sc0 ls0 ws0">6.4<span class="_ _4"> </span><span class="ff1">感知机的缺陷<span class="_ _19"> </span></span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _7"> </span>43</div><div class="t m0 x3 h5 y3d ff4 fs4 fc0 sc0 ls0 ws0">第三部分 <span class="fs3">机器学习高阶</span></div><div class="t m0 x3 h3 y3e ff8 fs1 fc0 sc0 ls0 ws0">优化方法<span class="_ _14"> </span><span class="ff5 fs4">45</span></div><div class="t m0 x3 h6 y20 ff4 fs2 fc0 sc0 ls0 ws0">第七章<span class="_ _2"> </span>凸优化基础概念<span class="_ _1b"> </span><span class="ff6">47</span></div><div class="t m0 x3 h4 y3 ff3 fs2 fc0 sc0 ls0 ws0">4</div><a class="l" href="#pf19" data-dest-detail='[25,"XYZ",70.87,267.14,null]'><div class="d m1" style="border-style:none;position:absolute;left:168.481500px;bottom:1177.872000px;width:111.272000px;height:15.458000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf1b" data-dest-detail='[27,"XYZ",70.87,799.37,null]'><div class="d m1" style="border-style:none;position:absolute;left:106.299000px;bottom:1127.169000px;width:84.633000px;height:15.578000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf1d" data-dest-detail='[29,"XYZ",70.87,577.15,null]'><div class="d m1" style="border-style:none;position:absolute;left:106.299000px;bottom:1047.999000px;width:183.751000px;height:20.663000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf1d" data-dest-detail='[29,"XYZ",70.87,577.15,null]'><div class="d m1" style="border-style:none;position:absolute;left:106.299000px;bottom:1022.760000px;width:68.862000px;height:17.216000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf1f" data-dest-detail='[31,"XYZ",70.87,799.37,null]'><div class="d m1" style="border-style:none;position:absolute;left:106.299000px;bottom:973.470000px;width:74.182000px;height:10.909000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf1f" data-dest-detail='[31,"XYZ",70.87,662.93,null]'><div class="d m1" style="border-style:none;position:absolute;left:130.845000px;bottom:937.443000px;width:46.909000px;height:15.458000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf1f" data-dest-detail='[31,"XYZ",70.87,41.41,null]'><div class="d m1" style="border-style:none;position:absolute;left:130.845000px;bottom:903.859500px;width:101.454000px;height:15.458000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf20" data-dest-detail='[32,"XYZ",70.87,284.16,null]'><div class="d m1" style="border-style:none;position:absolute;left:130.845000px;bottom:870.276000px;width:68.727000px;height:15.458000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf21" data-dest-detail='[33,"XYZ",70.87,272.5,null]'><div class="d m1" style="border-style:none;position:absolute;left:168.481500px;bottom:836.692500px;width:78.545000px;height:15.458000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf22" data-dest-detail='[34,"XYZ",70.87,142.86,null]'><div class="d m1" style="border-style:none;position:absolute;left:168.481500px;bottom:803.109000px;width:89.454000px;height:15.459000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf23" data-dest-detail='[35,"XYZ",70.87,618.1,null]'><div class="d m1" style="border-style:none;position:absolute;left:168.481500px;bottom:769.527000px;width:78.545000px;height:15.458000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf23" data-dest-detail='[35,"XYZ",70.87,292.23,null]'><div class="d m1" style="border-style:none;position:absolute;left:130.845000px;bottom:735.943500px;width:79.636000px;height:15.458000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf24" data-dest-detail='[36,"XYZ",70.87,629.53,null]'><div class="d m1" style="border-style:none;position:absolute;left:130.845000px;bottom:702.360000px;width:79.636000px;height:15.458000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf25" data-dest-detail='[37,"XYZ",70.87,625.67,null]'><div class="d m1" style="border-style:none;position:absolute;left:130.845000px;bottom:668.776500px;width:46.909000px;height:15.458000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf25" data-dest-detail='[37,"XYZ",70.87,450.82,null]'><div class="d m1" style="border-style:none;position:absolute;left:168.481500px;bottom:635.194500px;width:67.636000px;height:15.458000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf25" data-dest-detail='[37,"XYZ",70.87,293.83,null]'><div class="d m1" style="border-style:none;position:absolute;left:168.481500px;bottom:601.611000px;width:67.636000px;height:15.458000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf25" data-dest-detail='[37,"XYZ",70.87,166.8,null]'><div class="d m1" style="border-style:none;position:absolute;left:220.845000px;bottom:568.027500px;width:274.887000px;height:15.458000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf26" data-dest-detail='[38,"XYZ",70.87,715.61,null]'><div class="d m1" style="border-style:none;position:absolute;left:220.845000px;bottom:534.444000px;width:274.756000px;height:15.458000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf26" data-dest-detail='[38,"XYZ",70.87,238.21,null]'><div class="d m1" style="border-style:none;position:absolute;left:220.845000px;bottom:500.860500px;width:285.436000px;height:15.459000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf29" data-dest-detail='[41,"XYZ",70.87,200.12,null]'><div class="d m1" style="border-style:none;position:absolute;left:130.845000px;bottom:467.278500px;width:90.545000px;height:15.458000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf2a" data-dest-detail='[42,"XYZ",70.87,251.97,null]'><div class="d m1" style="border-style:none;position:absolute;left:130.845000px;bottom:433.695000px;width:46.909000px;height:15.458000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf2b" data-dest-detail='[43,"XYZ",70.87,590.72,null]'><div class="d m1" style="border-style:none;position:absolute;left:130.845000px;bottom:400.111500px;width:85.560000px;height:15.458000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf2d" data-dest-detail='[45,"XYZ",70.87,799.37,null]'><div class="d m1" style="border-style:none;position:absolute;left:106.299000px;bottom:349.410000px;width:102.186000px;height:15.578000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf2e" data-dest-detail='[46,"XYZ",70.87,547.16,null]'><div class="d m1" style="border-style:none;position:absolute;left:130.845000px;bottom:315.907500px;width:68.727000px;height:15.458000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf2e" data-dest-detail='[46,"XYZ",70.87,41.41,null]'><div class="d m1" style="border-style:none;position:absolute;left:130.845000px;bottom:282.325500px;width:68.727000px;height:15.458000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf31" data-dest-detail='[49,"XYZ",70.87,761.27,null]'><div class="d m1" style="border-style:none;position:absolute;left:130.845000px;bottom:248.742000px;width:90.545000px;height:15.458000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf31" data-dest-detail='[49,"XYZ",70.87,440.6,null]'><div class="d m1" style="border-style:none;position:absolute;left:130.845000px;bottom:215.158500px;width:90.545000px;height:15.458000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf33" data-dest-detail='[51,"XYZ",70.87,577.15,null]'><div class="d m1" style="border-style:none;position:absolute;left:106.299000px;bottom:135.907500px;width:183.751000px;height:20.662000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf33" data-dest-detail='[51,"XYZ",70.87,577.15,null]'><div class="d m1" style="border-style:none;position:absolute;left:106.299000px;bottom:110.769000px;width:68.862000px;height:17.215000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf35" data-dest-detail='[53,"XYZ",70.87,799.37,null]'><div class="d m1" style="border-style:none;position:absolute;left:106.299000px;bottom:61.479000px;width:117.818000px;height:10.909000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.500000,0.000000,0.000000,1.500000,0.000000,0.000000]}'></div></div>
<div id="pf5" class="pf w0 h0" data-page-no="5"><div class="pc pc5 w0 h0"><div class="t m0 xc h7 y21 ff7 fs5 fc0 sc0 ls0 ws0">目录</div><div class="t m0 x5 h6 y22 ff3 fs2 fc0 sc0 ls0 ws0">7.1<span class="_ _4"> </span><span class="ff1">凸集<span class="_ _10"> </span></span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _7"> </span>47</div><div class="t m0 x5 h6 y3f ff3 fs2 fc0 sc0 ls0 ws0">7.2<span class="_ _4"> </span><span class="ff1">重要的凸集<span class="_ _2"> </span></span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _7"> </span>48</div><div class="t m0 x5 h6 y40 ff3 fs2 fc0 sc0 ls0 ws0">7.3<span class="_ _4"> </span><span class="ff1">保持凸性的运算<span class="_ _d"> </span></span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _7"> </span>49</div><div class="t m0 x6 h6 y41 ff3 fs2 fc0 sc0 ls0 ws0">7.3.1<span class="_ _7"> </span><span class="ff1">交集<span class="_ _19"> </span></span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _7"> </span>49</div><div class="t m0 x6 h6 y42 ff3 fs2 fc0 sc0 ls0 ws0">7.3.2<span class="_ _7"> </span><span class="ff1">仿射函数<span class="_ _8"> </span></span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _7"> </span>49</div><div class="t m0 x3 h6 y43 ff4 fs2 fc0 sc0 ls0 ws0">第八章<span class="_ _2"> </span>梯度下降<span class="_ _f"> </span><span class="ff6">51</span></div><div class="t m0 x5 h6 y44 ff3 fs2 fc0 sc0 ls0 ws0">8.1<span class="_ _4"> </span><span class="ff1">梯度下降原理<span class="_ _19"> </span></span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _7"> </span>51</div><div class="t m0 x3 h6 y45 ff4 fs2 fc0 sc0 ls0 ws0">第九章<span class="_ _2"> </span><span class="ff6">Bac<span class="_ _12"></span>kpropagation<span class="_ _1c"> </span>53</span></div><div class="t m0 x5 h6 y46 ff3 fs2 fc0 sc0 ls0 ws0">9.1<span class="_ _4"> </span><span class="ff1">神经网络 </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _7"> </span>53</div><div class="t m0 x5 h6 y47 ff3 fs2 fc0 sc0 ls0 ws0">9.2<span class="_ _4"> </span><span class="ff1">基本函数 </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _7"> </span>53</div><div class="t m0 x5 h6 y48 ff3 fs2 fc0 sc0 ls0 ws0">9.3<span class="_ _4"> </span><span class="ff1">前向传播 </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _7"> </span>54</div><div class="t m0 x5 h6 y49 ff3 fs2 fc0 sc0 ls0 ws0">9.4<span class="_ _4"> </span><span class="ff1">反向传播 </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _7"> </span>56</div><div class="t m0 x6 h6 y4a ff3 fs2 fc0 sc0 ls0 ws0">9.4.1<span class="_ _7"> </span><span class="ff1">输出层<span class="_ _e"> </span></span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _7"> </span>56</div><div class="t m0 x6 h6 y4b ff3 fs2 fc0 sc0 ls0 ws0">9.4.2<span class="_ _7"> </span><span class="ff1">隐藏层<span class="_ _e"> </span></span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _7"> </span>57</div><div class="t m0 x5 h6 y4c ff3 fs2 fc0 sc0 ls0 ws0">9.5<span class="_ _4"> </span><span class="ff1">权值更新归纳<span class="_ _19"> </span></span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _7"> </span>57</div><div class="t m0 x3 h5 y4d ff4 fs4 fc0 sc0 ls0 ws0">第四部分 <span class="fs3">神经网络<span class="_ _1d"> </span></span><span class="ff5">59</span></div><div class="t m0 x3 h6 y4e ff4 fs2 fc0 sc0 ls0 ws0">第十章<span class="_ _2"> </span><span class="ff6">P<span class="_ _12"></span>erceptron<span class="_ _1a"> </span>61</span></div><div class="t m0 x5 h6 y4f ff3 fs2 fc0 sc0 ls0 ws0">10.1<span class="_ _5"> </span><span class="ff1">损失函数<span class="_ _4"> </span></span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _7"> </span>62</div><div class="t m0 x5 h6 y50 ff3 fs2 fc0 sc0 ls0 ws0">10.2<span class="_ _5"> </span><span class="ff1">参数更新<span class="_ _4"> </span></span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _7"> </span>63</div><div class="t m0 x5 h6 y51 ff3 fs2 fc0 sc0 ls0 ws0">10.3<span class="_ _5"> </span><span class="ff1">感知器收敛性<span class="_ _19"> </span></span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _7"> </span>65</div><div class="t m0 x5 h6 y52 ff3 fs2 fc0 sc0 ls0 ws0">10.4<span class="_ _5"> </span><span class="ff1">感知机的缺陷<span class="_ _19"> </span></span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _7"> </span>65</div><div class="t m0 x3 h6 y53 ff4 fs2 fc0 sc0 ls0 ws0">第十一章<span class="_ _2"> </span><span class="ff6">Recurren<span class="_ _12"></span>t<span class="_ _e"> </span>Neural<span class="_ _1e"> </span>Net<span class="_ _12"></span>w<span class="_ _12"></span>orks<span class="_ _1f"> </span>67</span></div><div class="t m0 x5 h4 y54 ff3 fs2 fc0 sc0 ls0 ws0">11.1<span class="_ _5"> </span>Simple<span class="_ _d"> </span>Recurrent<span class="_ _d"> </span>Net<span class="_ _12"></span>w<span class="_ _12"></span>ork<span class="_ _1e"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _7"> </span>67</div><div class="t m0 x6 h6 y55 ff3 fs2 fc0 sc0 ls0 ws0">11.1.1<span class="_ _20"> </span><span class="ff1">前向传播<span class="_ _8"> </span></span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _7"> </span>67</div><div class="t m0 x6 h6 y56 ff3 fs2 fc0 sc0 ls0 ws0">11.1.2<span class="_ _20"> </span><span class="ff1">反向传播<span class="_ _8"> </span></span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _7"> </span>69</div><div class="t m0 x6 h4 y57 ff3 fs2 fc0 sc0 ls0 ws0">11.1.3<span class="_ _20"> </span>title<span class="_ _2"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _7"> </span>70</div><div class="t m0 x5 h4 y58 ff3 fs2 fc0 sc0 ls0 ws0">11.2<span class="_ _5"> </span>LSTM<span class="_ _20"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _7"> </span>70</div><div class="t m0 x6 h6 y59 ff3 fs2 fc0 sc0 ls0 ws0">11.2.1<span class="_ _20"> </span>LSTM<span class="_ _d"> </span><span class="ff1">概述<span class="_ _18"> </span></span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _7"> </span>70</div><div class="t m0 x6 h6 y5a ff3 fs2 fc0 sc0 ls0 ws0">11.2.2<span class="_ _20"> </span>LSTM<span class="_ _d"> </span><span class="ff1">与<span class="_ _d"> </span></span>RNN<span class="_ _d"> </span><span class="ff1">的区别<span class="_ _d"> </span></span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _7"> </span>70</div><div class="t m0 x6 h6 y5b ff3 fs2 fc0 sc0 ls0 ws0">11.2.3<span class="_ _20"> </span><span class="ff1">遗忘门<span class="_ _e"> </span></span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _7"> </span>71</div><div class="t m0 x6 h6 y20 ff3 fs2 fc0 sc0 ls0 ws0">11.2.4<span class="_ _20"> </span><span class="ff1">输入门<span class="_ _e"> </span></span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _7"> </span>71</div><div class="t m0 xd h4 y3 ff3 fs2 fc0 sc0 ls0 ws0">5</div><a class="l" href="#pf35" data-dest-detail='[53,"XYZ",70.87,662.85,null]'><div class="d m1" style="border-style:none;position:absolute;left:130.845000px;bottom:1177.872000px;width:46.909000px;height:15.458000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf36" data-dest-detail='[54,"XYZ",70.87,206.12,null]'><div class="d m1" style="border-style:none;position:absolute;left:130.845000px;bottom:1144.336500px;width:79.636000px;height:15.458000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf37" data-dest-detail='[55,"XYZ",70.87,295.38,null]'><div class="d m1" style="border-style:none;position:absolute;left:130.845000px;bottom:1110.802500px;width:101.454000px;height:15.458000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf37" data-dest-detail='[55,"XYZ",70.87,244.74,null]'><div class="d m1" style="border-style:none;position:absolute;left:168.481500px;bottom:1077.268500px;width:56.727000px;height:15.458000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf37" data-dest-detail='[55,"XYZ",70.87,175.34,null]'><div class="d m1" style="border-style:none;position:absolute;left:168.481500px;bottom:1043.733000px;width:78.545000px;height:15.458000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf39" data-dest-detail='[57,"XYZ",70.87,799.37,null]'><div class="d m1" style="border-style:none;position:absolute;left:106.299000px;bottom:995.800500px;width:85.091000px;height:10.909000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf39" data-dest-detail='[57,"XYZ",70.87,662.93,null]'><div class="d m1" style="border-style:none;position:absolute;left:130.845000px;bottom:959.821500px;width:90.545000px;height:15.458000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf3b" data-dest-detail='[59,"XYZ",70.87,799.37,null]'><div class="d m1" style="border-style:none;position:absolute;left:106.299000px;bottom:909.363000px;width:133.778000px;height:15.578000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf3b" data-dest-detail='[59,"XYZ",70.87,660.96,null]'><div class="d m1" style="border-style:none;position:absolute;left:130.845000px;bottom:875.910000px;width:68.727000px;height:15.458000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf3b" data-dest-detail='[59,"XYZ",70.87,391.25,null]'><div class="d m1" style="border-style:none;position:absolute;left:130.845000px;bottom:842.376000px;width:68.727000px;height:15.458000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf3c" data-dest-detail='[60,"XYZ",70.87,664.07,null]'><div class="d m1" style="border-style:none;position:absolute;left:130.845000px;bottom:808.842000px;width:68.727000px;height:15.458000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf3d" data-dest-detail='[61,"XYZ",70.87,41.41,null]'><div class="d m1" style="border-style:none;position:absolute;left:130.845000px;bottom:775.306500px;width:68.727000px;height:15.459000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf3e" data-dest-detail='[62,"XYZ",70.87,647.03,null]'><div class="d m1" style="border-style:none;position:absolute;left:168.481500px;bottom:741.772500px;width:67.636000px;height:15.458000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf3f" data-dest-detail='[63,"XYZ",70.87,743.58,null]'><div class="d m1" style="border-style:none;position:absolute;left:168.481500px;bottom:708.238500px;width:67.636000px;height:15.458000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf3f" data-dest-detail='[63,"XYZ",70.87,203.12,null]'><div class="d m1" style="border-style:none;position:absolute;left:130.845000px;bottom:674.703000px;width:90.545000px;height:15.459000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf41" data-dest-detail='[65,"XYZ",70.87,568.85,null]'><div class="d m1" style="border-style:none;position:absolute;left:106.299000px;bottom:596.122500px;width:142.426000px;height:20.663000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf43" data-dest-detail='[67,"XYZ",70.87,799.37,null]'><div class="d m1" style="border-style:none;position:absolute;left:106.299000px;bottom:545.277000px;width:102.186000px;height:15.578000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf44" data-dest-detail='[68,"XYZ",70.87,547.16,null]'><div class="d m1" style="border-style:none;position:absolute;left:130.845000px;bottom:511.824000px;width:68.727000px;height:15.459000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf44" data-dest-detail='[68,"XYZ",70.87,41.41,null]'><div class="d m1" style="border-style:none;position:absolute;left:130.845000px;bottom:478.290000px;width:68.727000px;height:15.458000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf47" data-dest-detail='[71,"XYZ",70.87,761.27,null]'><div class="d m1" style="border-style:none;position:absolute;left:130.845000px;bottom:444.756000px;width:90.545000px;height:15.458000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf47" data-dest-detail='[71,"XYZ",70.87,440.6,null]'><div class="d m1" style="border-style:none;position:absolute;left:130.845000px;bottom:411.220500px;width:90.545000px;height:15.459000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf49" data-dest-detail='[73,"XYZ",70.87,799.37,null]'><div class="d m1" style="border-style:none;position:absolute;left:106.299000px;bottom:360.762000px;width:205.135000px;height:15.578000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf49" data-dest-detail='[73,"XYZ",70.87,682.86,null]'><div class="d m1" style="border-style:none;position:absolute;left:130.845000px;bottom:327.310500px;width:151.691000px;height:15.458000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf49" data-dest-detail='[73,"XYZ",70.87,640.54,null]'><div class="d m1" style="border-style:none;position:absolute;left:168.481500px;bottom:293.775000px;width:78.545000px;height:15.458000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf4b" data-dest-detail='[75,"XYZ",70.87,260.69,null]'><div class="d m1" style="border-style:none;position:absolute;left:168.481500px;bottom:260.241000px;width:78.545000px;height:15.458000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf4c" data-dest-detail='[76,"XYZ",70.87,718.55,null]'><div class="d m1" style="border-style:none;position:absolute;left:168.481500px;bottom:226.707000px;width:54.305000px;height:15.458000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf4c" data-dest-detail='[76,"XYZ",70.87,665.09,null]'><div class="d m1" style="border-style:none;position:absolute;left:130.845000px;bottom:193.171500px;width:55.854000px;height:15.458000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf4c" data-dest-detail='[76,"XYZ",70.87,625.87,null]'><div class="d m1" style="border-style:none;position:absolute;left:168.481500px;bottom:159.637500px;width:91.123000px;height:15.458000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf4c" data-dest-detail='[76,"XYZ",70.87,530.55,null]'><div class="d m1" style="border-style:none;position:absolute;left:168.481500px;bottom:126.103500px;width:144.600000px;height:15.458000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf4d" data-dest-detail='[77,"XYZ",70.87,399.38,null]'><div class="d m1" style="border-style:none;position:absolute;left:168.481500px;bottom:92.568000px;width:67.636000px;height:15.458000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf4d" data-dest-detail='[77,"XYZ",70.87,135.06,null]'><div class="d m1" style="border-style:none;position:absolute;left:168.481500px;bottom:59.034000px;width:67.636000px;height:15.458000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.500000,0.000000,0.000000,1.500000,0.000000,0.000000]}'></div></div>
<div id="pf6" class="pf w0 h0" data-page-no="6"><div class="pc pc6 w0 h0"><div class="t m0 x6 h6 y22 ff3 fs2 fc0 sc0 ls0 ws0">11.2.5<span class="_ _20"> </span><span class="ff1">细胞状态更新<span class="_ _0"> </span></span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _7"> </span>72</div><div class="t m0 x6 h6 y5c ff3 fs2 fc0 sc0 ls0 ws0">11.2.6<span class="_ _20"> </span><span class="ff1">输出门<span class="_ _e"> </span></span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _7"> </span>72</div><div class="t m0 x5 h6 y5d ff3 fs2 fc0 sc0 ls0 ws0">11.3<span class="_ _5"> </span><span class="ff1">带窥孔的<span class="_ _d"> </span></span>LSTM<span class="_ _21"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _7"> </span>72</div><div class="t m0 x5 h4 y5e ff3 fs2 fc0 sc0 ls0 ws0">11.4<span class="_ _5"> </span>GRU<span class="_ _1e"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _7"> </span>72</div><div class="t m0 x3 h6 y5f ff4 fs2 fc0 sc0 ls0 ws0">第十二章<span class="_ _2"> </span><span class="ff6">Seq2Seq<span class="_ _22"> </span>75</span></div><div class="t m0 x5 h4 y60 ff3 fs2 fc0 sc0 ls0 ws0">12.1<span class="_ _5"> </span>Enco<span class="_ _23"></span>der-Deco<span class="_ _23"></span>der<span class="_ _b"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _7"> </span>75</div><div class="t m0 x5 h4 y61 ff3 fs2 fc0 sc0 ls0 ws0">12.2<span class="_ _5"> </span>Seq2Seq<span class="_ _10"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _7"> </span>76</div><div class="t m0 x5 h6 y62 ff3 fs2 fc0 sc0 ls0 ws0">12.3<span class="_ _5"> </span>Atten<span class="_ _12"></span>tion<span class="_ _d"> </span><span class="ff1">机制<span class="_ _2"> </span></span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _0"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _5"> </span>.<span class="_ _7"> </span>77</div><a class="l" href="#pf4e" data-dest-detail='[78,"XYZ",70.87,709.21,null]'><div class="d m1" style="border-style:none;position:absolute;left:168.481500px;bottom:1177.872000px;width:100.363000px;height:15.458000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf4e" data-dest-detail='[78,"XYZ",70.87,559.23,null]'><div class="d m1" style="border-style:none;position:absolute;left:168.481500px;bottom:1144.456500px;width:67.636000px;height:15.458000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf4e" data-dest-detail='[78,"XYZ",70.87,381.09,null]'><div class="d m1" style="border-style:none;position:absolute;left:130.845000px;bottom:1111.042500px;width:103.123000px;height:15.458000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf4e" data-dest-detail='[78,"XYZ",70.87,238.54,null]'><div class="d m1" style="border-style:none;position:absolute;left:130.845000px;bottom:1077.627000px;width:49.560000px;height:15.458000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf51" data-dest-detail='[81,"XYZ",70.87,799.37,null]'><div class="d m1" style="border-style:none;position:absolute;left:106.299000px;bottom:1027.767000px;width:97.320000px;height:15.578000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf51" data-dest-detail='[81,"XYZ",70.87,661.1,null]'><div class="d m1" style="border-style:none;position:absolute;left:130.845000px;bottom:994.434000px;width:106.974000px;height:15.458000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf52" data-dest-detail='[82,"XYZ",70.87,525.87,null]'><div class="d m1" style="border-style:none;position:absolute;left:130.845000px;bottom:961.018500px;width:63.883000px;height:15.459000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf52" data-dest-detail='[82,"XYZ",70.87,29.4,null]'><div class="d m1" style="border-style:none;position:absolute;left:130.845000px;bottom:927.604500px;width:96.305000px;height:15.458000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.500000,0.000000,0.000000,1.500000,0.000000,0.000000]}'></div></div>
<div id="pf7" class="pf w0 h0" data-page-no="7"><div class="pc pc7 w0 h0"><div class="t m0 xe h5 y63 ff4 fs3 fc0 sc0 ls0 ws0">第一部分</div><div class="t m0 xf h5 y64 ff4 fs3 fc0 sc0 ls0 ws0">模型选择与评估</div><div class="t m0 xa h4 y3 ff3 fs2 fc0 sc0 ls0 ws0">1</div></div><div class="pi" data-data='{"ctm":[1.500000,0.000000,0.000000,1.500000,0.000000,0.000000]}'></div></div>
<div id="pf8" class="pf w0 h0" data-page-no="8"><div class="pc pc8 w0 h0"></div><div class="pi" data-data='{"ctm":[1.500000,0.000000,0.000000,1.500000,0.000000,0.000000]}'></div></div>
<div id="pf9" class="pf w0 h0" data-page-no="9"><div class="pc pc9 w0 h0"><img class="bi x3 y65 w1 h8" alt="" src="bg9.png"/><div class="t m0 x10 h5 y4 ff4 fs3 fc0 sc0 ls0 ws0">第一章 概述</div><div class="t m0 x11 h9 y66 ff5 fs6 fc0 sc0 ls0 ws0">1.1<span class="_ _24"> </span><span class="ff9">基本概念</span></div><div class="t m0 x3 h6 y67 ff1 fs2 fc0 sc0 ls0 ws0">在早期的工程领域，<span class="_ _12"></span>机器学习也经常称为<span class="ff4">模式识别<span class="_ _12"></span><span class="ff1">（<span class="ff3">P<span class="_ _12"></span>attern<span class="_ _25"> </span>Recognition<span class="ff1">，<span class="_ _12"></span><span class="ff3">PR<span class="ff1">）<span class="_ _26"></span>，<span class="_ _12"></span>但模式识别更</span></span></span></span></span></span></div><div class="t m0 x3 h6 y68 ff1 fs2 fc0 sc0 ls0 ws0">偏向于具体的应用任务，<span class="_ _27"></span>比如光学字符识别、<span class="_ _27"></span>语音识别、<span class="_ _27"></span>人脸识别等。<span class="_ _28"></span>这些任务的特点是，<span class="_ _27"></span>对于</div><div class="t m0 x3 h6 y69 ff1 fs2 fc0 sc0 ls0 ws0">我们人类而言，<span class="_ _29"></span>这些任务很容易完成，<span class="_ _29"></span>但我们不知道自己是如何做到的，<span class="_ _29"></span>因此也很难人工设计一</div><div class="t m0 x3 h6 y6a ff1 fs2 fc0 sc0 ls0 ws0">个计<span class="_ _23"></span>算机程<span class="_ _23"></span>序来完<span class="_ _23"></span>成这些<span class="_ _23"></span>任务。一<span class="_ _23"></span>个可<span class="_ _23"></span>行的方<span class="_ _23"></span>法是设<span class="_ _23"></span>计一个<span class="_ _23"></span>算法可<span class="_ _23"></span>以让计<span class="_ _23"></span>算机自<span class="_ _23"></span>己从<span class="_ _23"></span>有标注<span class="_ _23"></span>的</div><div class="t m0 x3 h6 y6b ff1 fs2 fc0 sc0 ls0 ws0">样本上学习其中的规律，<span class="_ _29"></span>并用来完成各种识别任务。<span class="_ _29"></span>随着机器学习技术的应用越来越广，<span class="_ _29"></span>现在机</div><div class="t m0 x3 h6 y6c ff1 fs2 fc0 sc0 ls0 ws0">器学习的概念逐渐替代模式识别，成为这一类问题及其解决方法的统称。</div><div class="t m0 x3 h6 y6d ff4 fs2 fc0 sc0 ls0 ws0">定义<span class="ff6">1.1<span class="_ _5"> </span></span><span class="fc1">浅层学习：<span class="_ _e"> </span></span><span class="ff1">传<span class="_ _23"></span>统的机器学习<span class="_ _23"></span>主要关注如何<span class="_ _23"></span>学习一个预测<span class="_ _23"></span>模型。一般需要<span class="_ _23"></span>首先将数据表</span></div><div class="t m0 x3 h6 y6e ff1 fs2 fc0 sc0 ls0 ws0">示为一组特征<span class="_ _2a"></span>（<span class="ff3">F<span class="_ _27"></span>eature<span class="ff1">）<span class="_ _26"></span>，<span class="_ _2b"></span>特征的表示形式可以是连续的数值、<span class="_ _2c"></span>离散的符号或其他形式。<span class="_ _2c"></span>然后将这</span></span></div><div class="t m0 x3 h6 y6f ff1 fs2 fc0 sc0 ls0 ws0">些特征输入到预测模型，<span class="_ _2d"></span>并输出预测结果。<span class="_ _2a"></span>这类机器学习可以看作<span class="ff4">浅层学习<span class="_ _2e"></span><span class="ff1">（<span class="ff3">Shallo<span class="_ _12"></span>w Learning<span class="ff1">）<span class="_ _26"></span>。</span></span></span></span></div><div class="t m0 x3 h6 y70 ff1 fs2 fc2 sc0 ls0 ws0">浅层学习的一个重要特点是不涉及特征学习，其特征主要靠<span class="ff4">人工经验</span>或特征转换方法来抽取。</div><div class="t m0 x3 h6 y71 ff4 fs2 fc0 sc0 ls0 ws0">定义<span class="ff6">1.2<span class="_ _5"> </span></span><span class="fc1">表示学习：<span class="_ _25"> </span></span><span class="ff1">为了提高机器学习系统的准确率，我们希望将输入信息转换为有效的特征，</span></div><div class="t m0 x3 h6 y72 ff1 fs2 fc0 sc0 ls0 ws0">或者更一般性地称为表示<span class="_ _29"></span>（<span class="ff3">Representation</span>）<span class="_ _26"></span>。<span class="_ _29"></span>如果有一种算法可以自动地学习出有效的特征，<span class="_ _2e"></span>并</div><div class="t m0 x3 h6 y73 ff1 fs2 fc0 sc0 ls0 ws0">提高最终机器学习模型的性能，那么这种学习就可以叫作表示学习（<span class="ff3">Represen<span class="_ _28"></span>tation<span class="_ _d"> </span>Learning<span class="ff1">）<span class="_ _2f"></span>。</span></span></div><div class="t m0 x3 h6 y74 ff4 fs2 fc0 sc0 ls0 ws0">定义<span class="ff6">1.3<span class="_ _5"> </span></span><span class="fc1">语义鸿沟：<span class="_ _d"> </span></span><span class="ff1">表<span class="_ _23"></span>示学习的关键是解决语义<span class="_ _23"></span>鸿沟（<span class="ff3">Seman<span class="_ _28"></span>tic<span class="_ _e"> </span>Gap<span class="ff1">）问题。语义鸿<span class="_ _23"></span>沟问题是</span></span></span></div><div class="t m0 x3 h6 y75 ff1 fs2 fc0 sc0 ls0 ws0">指输入数据的底层特征和高层语义信息之间的不一致性和差异性。</div><div class="t m0 x12 h6 y76 ff1 fs2 fc0 sc0 ls0 ws0">在机器学习中，<span class="_ _27"></span>底层特征来自计算机直接记录的数据，<span class="_ _30"></span>而高层特征来自人类的观察。<span class="_ _27"></span>例如：</div><div class="t m0 x13 h6 y77 ff3 fs2 fc0 sc0 ls0 ws0">1.<span class="_ _5"> </span><span class="ff1">计算机使用<span class="_ _23"></span>唯一的整数表<span class="_ _23"></span>示一个字词，如<span class="_ _e"> </span></span>Unico<span class="_ _23"></span>de<span class="_ _e"> </span><span class="ff1">编码，计算<span class="_ _23"></span>机看到的底层<span class="_ _23"></span>特征只</span></div><div class="t m0 x6 h6 y78 ff1 fs2 fc0 sc0 ls0 ws0">是一<span class="_ _23"></span>个个数<span class="_ _23"></span>字。然而<span class="_ _23"></span>这些字<span class="_ _23"></span>词在人<span class="_ _23"></span>类的认<span class="_ _23"></span>知中存<span class="_ _23"></span>在更丰<span class="_ _23"></span>富的含<span class="_ _23"></span>义，如<span class="_ _23"></span>一些字<span class="_ _23"></span>词是近</div><div class="t m0 x6 h6 y79 ff1 fs2 fc0 sc0 ls0 ws0">义词或者反义词，不同的字词表达了不同的情绪等等。</div><div class="t m0 x13 h6 y7a ff3 fs2 fc0 sc0 ls0 ws0">2.<span class="_ _5"> </span><span class="ff1">图片在<span class="_ _23"></span>计算中<span class="_ _23"></span>以一个<span class="_ _23"></span>个像素<span class="_ _23"></span>点呈现，<span class="_ _23"></span>但在人<span class="_ _23"></span>类对图<span class="_ _23"></span>片的观<span class="_ _23"></span>察是建<span class="_ _23"></span>立在比<span class="_ _23"></span>较抽象<span class="_ _23"></span>的高</span></div><div class="t m0 x6 h6 y7b ff1 fs2 fc0 sc0 ls0 ws0">层语义上的，<span class="_ _29"></span>例如，<span class="_ _29"></span>人类会根据图片中物体的颜色、<span class="_ _29"></span>形状等等特征去辨识事物。<span class="_ _30"></span>因此</div><div class="t m0 x6 h6 y7c ff1 fs2 fc0 sc0 ls0 ws0">为了<span class="_ _23"></span>从图像<span class="_ _23"></span>的原始<span class="_ _23"></span>数据中<span class="_ _23"></span>识别具<span class="_ _23"></span>体的场<span class="_ _23"></span>景，可能<span class="_ _23"></span>需要以<span class="_ _23"></span>适当算<span class="_ _23"></span>法对像<span class="_ _23"></span>素进行<span class="_ _23"></span>选择和</div><div class="t m0 x6 h6 y7d ff1 fs2 fc0 sc0 ls0 ws0">操纵，提取出高层的特征。</div><div class="t m0 x3 h6 y7e ff1 fs2 fc0 sc0 ls0 ws0">如果<span class="_ _23"></span>一个预<span class="_ _23"></span>测模型<span class="_ _23"></span>直接<span class="_ _23"></span>建立在<span class="_ _23"></span>底层特<span class="_ _23"></span>征之上，<span class="_ _23"></span>会导致<span class="_ _23"></span>对预<span class="_ _23"></span>测模型<span class="_ _23"></span>的能力<span class="_ _23"></span>要求过<span class="_ _23"></span>高。如<span class="_ _23"></span>果可以<span class="_ _23"></span>有</div><div class="t m0 x3 h6 y7f ff1 fs2 fc0 sc0 ls0 ws0">一个<span class="_ _23"></span>好的表<span class="_ _23"></span>示在某<span class="_ _23"></span>种程度<span class="_ _23"></span>上能够<span class="_ _23"></span>反映<span class="_ _23"></span>出数据<span class="_ _23"></span>的高层<span class="_ _23"></span>语义特<span class="_ _23"></span>征，那么<span class="_ _23"></span>我们就<span class="_ _23"></span>能相对<span class="_ _23"></span>容易<span class="_ _23"></span>地构建<span class="_ _23"></span>后</div><div class="t m0 x3 h6 y80 ff1 fs2 fc0 sc0 ls0 ws0">续的机器学习模型。在表示学习中，有<span class="_ _23"></span>两个核心问题：一是“什么是一个好的表示”<span class="_ _2f"></span>；二是“如</div><div class="t m0 x3 h6 y81 ff1 fs2 fc0 sc0 ls0 ws0">何学习到好的表示”<span class="_ _26"></span>。</div><div class="t m0 x14 h6 y82 ff4 fs2 fc0 sc0 ls0 ws0">“好的表示”是一个<span class="_ _23"></span>非常主观的概念，没有一个<span class="_ _23"></span>明确的标准。<span class="ff1">但一般而言，一<span class="_ _23"></span>个好的表示具有以</span></div><div class="t m0 x3 h6 y83 ff1 fs2 fc0 sc0 ls0 ws0">下几个优点：</div><div class="t m0 x15 h6 y84 ff3 fs2 fc0 sc0 ls0 ws0">1.<span class="_ _5"> </span><span class="ff1">一个好的表示应该具有很强的表示能力，即同样大小的向量可以表示</span>-<span class="ff1">更多信息。</span></div><div class="t m0 x15 h6 y85 ff3 fs2 fc0 sc0 ls0 ws0">2.<span class="_ _5"> </span><span class="ff1">一个好的表示应该使后续的学习任务变得简单，即需要包含更高层的语义信息。</span></div><div class="t m0 x15 h6 y86 ff3 fs2 fc0 sc0 ls0 ws0">3.<span class="_ _5"> </span><span class="ff1">一个好的表示应该具有一般性，是任<span class="_ _23"></span>务或领域独立的。虽然目前的大部分表示学习方<span class="_ _23"></span>法还</span></div><div class="t m0 x13 h6 y87 ff1 fs2 fc0 sc0 ls0 ws0">是基于某个任务来学习，但我们期望其学到的表示可以比较容易地迁移到其他任务上。</div><div class="t m0 x3 h6 y20 ff1 fs2 fc0 sc0 ls0 ws0">在机器学习中，<span class="_ _27"></span>我们经常使用两种方式来表示特征：<span class="_ _30"></span>局部表示<span class="_ _28"></span>（<span class="ff3">Lo<span class="_ _23"></span>cal<span class="_ _25"> </span>Rep-<span class="_ _d"> </span>resen<span class="_ _12"></span>tation<span class="ff1">）<span class="_ _28"></span>和分布</span></span></div><div class="t m0 xa h4 y3 ff3 fs2 fc0 sc0 ls0 ws0">3</div></div><div class="pi" data-data='{"ctm":[1.500000,0.000000,0.000000,1.500000,0.000000,0.000000]}'></div></div>
<div id="pfa" class="pf w0 h0" data-page-no="a"><div class="pc pca w0 h0"><div class="t m0 x3 h7 y21 ff3 fs5 fc0 sc0 ls0 ws0">1.2<span class="_ _8"> </span><span class="ff7">假设空间</span></div><div class="t m0 x3 h6 y22 ff1 fs2 fc0 sc0 ls0 ws0">式表示（<span class="ff3">Distributed<span class="_ _d"> </span>Represen<span class="_ _12"></span>tation<span class="ff1">）<span class="_ _26"></span>。</span></span></div><div class="t m0 x3 h6 y5c ff1 fs2 fc0 sc0 ls0 ws0">以颜色表示为例，<span class="_ _29"></span>我们可以用很多词来形容不同的颜色，<span class="_ _30"></span>除了基本的红、<span class="_ _30"></span>蓝、<span class="_ _30"></span>绿、<span class="_ _30"></span>白、<span class="_ _30"></span>黑等之外，</div><div class="t m0 x3 h6 y88 ff1 fs2 fc0 sc0 ls0 ws0">还有很多以地区或物品命名的，<span class="_ _30"></span>比如中国红、<span class="_ _28"></span>天蓝色、<span class="_ _27"></span>咖啡色、<span class="_ _27"></span>琥珀色等。<span class="_ _28"></span>如果要在计算机中表</div><div class="t m0 x3 h6 y89 ff1 fs2 fc0 sc0 ls0 ws0">示颜色，</div><div class="t m0 x3 h6 y8a ff4 fs2 fc0 sc0 ls0 ws0">定义<span class="ff6">1.4<span class="_ _5"> </span></span><span class="fc1">局部表示：<span class="_ _e"> </span></span><span class="ff1">以<span class="_ _23"></span>不同名字来<span class="_ _23"></span>命名不同的颜<span class="_ _23"></span>色，这种表示方<span class="_ _23"></span>式叫作局部表<span class="_ _23"></span>示，也称为离<span class="_ _23"></span>散</span></div><div class="t m0 x3 h6 y8b ff1 fs2 fc0 sc0 ls0 ws0">表示或符号表示。局部表示通常可以表示为<span class="_ _d"> </span><span class="ff3">one-hot<span class="_ _d"> </span></span>向量的形式。</div><div class="t m0 x3 h6 y8c ff1 fs2 fc0 sc0 ls0 ws0">局部表示有两个优点：</div><div class="t m0 x15 h6 y8d ff3 fs2 fc0 sc0 ls0 ws0">1.<span class="_ _5"> </span><span class="ff1">这种离散的表示方式具有很好的解<span class="_ _23"></span>释性，有利于人工归纳和总结特征，并通过特征组<span class="_ _23"></span>合进</span></div><div class="t m0 x13 h6 y8e ff1 fs2 fc0 sc0 ls0 ws0">行高效的特征工程。</div><div class="t m0 x15 h6 y8f ff3 fs2 fc0 sc0 ls0 ws0">2.<span class="_ _5"> </span><span class="ff1">通过多种特征组合得到的表示向量<span class="_ _23"></span>通常是稀疏的二值向量，当用于线性模型时计算效<span class="_ _23"></span>率非</span></div><div class="t m0 x13 h6 y90 ff1 fs2 fc0 sc0 ls0 ws0">常高。</div><div class="t m0 x3 h6 y91 ff1 fs2 fc0 sc0 ls0 ws0">但局部表示有两个不足之处：</div><div class="t m0 x15 h6 y92 ff3 fs2 fc0 sc0 ls0 ws0">1.<span class="_ _5"> </span>one-hot<span class="_ _e"> </span><span class="ff1">向<span class="_ _23"></span>量的维<span class="_ _23"></span>数很高，<span class="_ _23"></span>且不能扩<span class="_ _23"></span>展。如果<span class="_ _23"></span>有一种<span class="_ _23"></span>新的颜<span class="_ _23"></span>色，我们<span class="_ _23"></span>就需要增<span class="_ _23"></span>加一维<span class="_ _23"></span>来表</span></div><div class="t m0 x13 h6 y93 ff1 fs2 fc0 sc0 ls0 ws0">示。</div><div class="t m0 x15 h6 y94 ff3 fs2 fc0 sc0 ls0 ws0">2.<span class="_ _5"> </span><span class="ff1">不同颜色之间的相似度都为<span class="_ _25"> </span></span>0<span class="ff1">，<span class="_ _2e"></span>即我们无法知道<span class="_ _30"></span>“红色”<span class="_ _30"></span>和<span class="_ _27"></span>“中国红”<span class="_ _30"></span>的相似度要高于<span class="_ _30"></span>“红</span></div><div class="t m0 x13 h6 y95 ff1 fs2 fc0 sc0 ls0 ws0">色”和“黑色”的相似度。</div><div class="t m0 x3 h6 y96 ff4 fs2 fc0 sc0 ls0 ws0">定义<span class="ff6">1.5<span class="_ _5"> </span></span><span class="fc1">分布式表示：<span class="_ _25"> </span></span><span class="ff1">分布式表示通常可以表示为低维的稠密向量，向量的单个维度没有意义，</span></div><div class="t m0 x3 h6 y97 ff1 fs2 fc0 sc0 ls0 ws0">各个维度组合起来才能表示具体的数据。<span class="_ _30"></span>例如，<span class="_ _30"></span>用<span class="_ _25"> </span><span class="ff3">RGB<span class="_ _25"> </span></span>值来表示颜色，<span class="_ _30"></span>不同颜色对应到<span class="_ _25"> </span><span class="ff3">R</span>、<span class="_ _30"></span><span class="ff3">G<span class="ff1">、</span></span></div><div class="t m0 x3 h6 y98 ff3 fs2 fc0 sc0 ls0 ws0">B<span class="_ _d"> </span><span class="ff1">三维空间中一个点。</span></div><div class="t m0 x3 h6 y99 ff1 fs2 fc0 sc0 ls0 ws0">在传统的机器学习中，<span class="_ _30"></span>也有很多有关特征学习的方法，<span class="_ _30"></span>比如主成分分析、<span class="_ _30"></span>线性判别分析、<span class="_ _27"></span>独立成</div><div class="t m0 x3 h6 y9a ff1 fs2 fc0 sc0 ls0 ws0">分分析等。<span class="_ _29"></span>但是，<span class="_ _29"></span>传统的特征学习一般是通过人为地设计一些准则，<span class="_ _29"></span>然后根据这些准则来选取有</div><div class="t m0 x3 h6 y9b ff1 fs2 fc0 sc0 ls0 ws0">效的<span class="_ _23"></span>特征。特<span class="_ _23"></span>征的学<span class="_ _23"></span>习是<span class="_ _23"></span>和最终<span class="_ _23"></span>预测模<span class="_ _23"></span>型的学<span class="_ _23"></span>习分开<span class="_ _23"></span>进行<span class="_ _23"></span>的，因此<span class="_ _23"></span>学习到<span class="_ _23"></span>的特征<span class="_ _23"></span>不一<span class="_ _23"></span>定可以<span class="_ _23"></span>提</div><div class="t m0 x3 h6 y9c ff1 fs2 fc0 sc0 ls0 ws0">升最终模型的性能。</div><div class="t m0 x3 h6 y9d ff1 fs2 fc0 sc0 ls0 ws0">神经网<span class="_ _23"></span>络可以将高<span class="_ _23"></span>维的局部表<span class="_ _23"></span>示空间<span class="_ _e"> </span><span class="ffa">R</span></div><div class="t m0 x16 ha y9e ffb fs7 fc0 sc0 ls0 ws0">|<span class="ffc">v<span class="_ _23"></span></span>|</div><div class="t m0 x17 h6 y9d ff1 fs2 fc0 sc0 ls0 ws0">映射到<span class="_ _23"></span>一个非常低<span class="_ _23"></span>维的分布式<span class="_ _23"></span>表示空间<span class="_ _e"> </span><span class="ffa">R</span></div><div class="t m0 x18 hb y9e ffc fs7 fc0 sc0 ls0 ws0">D</div><div class="t m0 x19 h6 y9d ffd fs2 fc0 sc0 ls0 ws0">,<span class="_ _31"> </span>D<span class="_ _e"> </span>&lt;<span class="_ _d"> </span><span class="ffe">|</span>v<span class="_ _23"></span><span class="ffe">|<span class="ff1">。</span></span></div><div class="t m0 x3 h6 y9f ff1 fs2 fc0 sc0 ls0 ws0">在这个低维空间中，<span class="_ _2a"></span>每个特征不再是坐标轴上的点，<span class="_ _2a"></span>而是分散在整个低维空间中。<span class="_ _2e"></span>在机器学习中，</div><div class="t m0 x3 h6 ya0 ff1 fs2 fc0 sc0 ls0 ws0">这个过程也称为嵌入<span class="_ _28"></span>（<span class="ff3">Embedding<span class="_ _d"> </span>)</span>。<span class="_ _28"></span>嵌入通常指将一个度量空间中的一些对象映射到另一个低</div><div class="t m0 x3 h6 ya1 ff1 fs2 fc0 sc0 ls0 ws0">维的度量空间中，<span class="_ _29"></span>并尽可能保持不同对象之间的拓扑关系。<span class="_ _29"></span>比如自然语言中词的分布式表示，<span class="_ _29"></span>也</div><div class="t m0 x3 h6 ya2 ff1 fs2 fc0 sc0 ls0 ws0">经常叫作词嵌入。</div><div class="t m0 x11 h9 ya3 ff5 fs6 fc0 sc0 ls0 ws0">1.2<span class="_ _24"> </span><span class="ff9">假设空间</span></div><div class="t m0 x3 h6 ya4 ff1 fs2 fc0 sc0 ls0 ws0">输入空间<span class="_ _25"> </span><span class="ff3">X </span>和输出空间<span class="_ _25"> </span><span class="ff3">y<span class="_ _25"> </span></span>构成了一个样本空间。<span class="_ _29"></span>对于样本空间中的样本<span class="_ _25"> </span><span class="fff">(<span class="ff10">x<span class="ffd">,<span class="_ _31"> </span>y<span class="_ _23"></span></span></span>)<span class="_ _32"> </span><span class="ffe">∈<span class="_ _32"> </span><span class="ffd">X<span class="_ _a"> </span></span>×<span class="_ _33"></span><span class="ffd">y<span class="_ _23"></span></span></span></span>，<span class="_ _2e"></span>假定<span class="_ _25"> </span><span class="ff10">x</span></div><div class="t m0 x3 h6 ya5 ff1 fs2 fc0 sc0 ls0 ws0">和<span class="_ _a"> </span><span class="ffd">y<span class="_ _25"> </span></span>之间的关系可以通过一个未知的真实映射函数<span class="_ _32"> </span><span class="ffd">y<span class="_ _25"> </span><span class="fff">=<span class="_ _32"> </span></span>g<span class="_ _23"></span><span class="fff">(</span>x<span class="fff">)<span class="_ _32"> </span></span></span>或真实条件概率分布<span class="_ _a"> </span><span class="ffd">p</span></div><div class="t m0 x1a hb ya6 ffc fs7 fc0 sc0 ls0 ws0">r</div><div class="t m0 x1b h6 ya5 fff fs2 fc0 sc0 ls0 ws0">(<span class="ffd">y<span class="_ _25"> </span><span class="ffe">|<span class="_ _32"> </span><span class="ff10">x</span></span></span>)<span class="_ _32"> </span><span class="ff1">来描</span></div><div class="t m0 x3 h6 ya7 ff1 fs2 fc0 sc0 ls0 ws0">述。机器学习的目标是找到一个模型来近似真实映射函数<span class="_ _d"> </span><span class="ff3">g<span class="_ _d"> </span><span class="fff">(<span class="ff10">x</span>)<span class="_ _d"> </span></span></span>或真实条件概率分布<span class="_ _d"> </span><span class="ffd">p</span></div><div class="t m0 x1c hb ya8 ffc fs7 fc0 sc0 ls0 ws0">r</div><div class="t m0 x1d h6 ya7 fff fs2 fc0 sc0 ls0 ws0">(<span class="ffd">y<span class="_ _25"> </span><span class="ffe">|<span class="_ _32"> </span><span class="ff10">x</span></span></span>)<span class="ff1">。</span></div><div class="t m0 x3 h6 ya9 ff1 fs2 fc0 sc0 ls0 ws0">由于我<span class="_ _23"></span>们不知<span class="_ _23"></span>道真实的<span class="_ _23"></span>映射函数<span class="_ _1e"> </span><span class="ffd">g<span class="_ _23"></span><span class="fff">(</span>x<span class="fff">)<span class="_ _e"> </span></span></span>或条<span class="_ _23"></span>件概率分<span class="_ _23"></span>布<span class="_ _e"> </span><span class="ffd">p</span></div><div class="t m0 x1e hb yaa ffc fs7 fc0 sc0 ls0 ws0">r</div><div class="t m0 x1f h6 ya9 fff fs2 fc0 sc0 ls0 ws0">(<span class="ffd">y<span class="_ _1e"> </span><span class="ffe">|<span class="_ _d"> </span><span class="ff10">x</span></span></span>)<span class="_ _1e"> </span><span class="ff1">的具体<span class="_ _23"></span>形式，因而<span class="_ _23"></span>只能根据<span class="_ _23"></span>经</span></div><div class="t m0 x3 h6 yab ff1 fs2 fc0 sc0 ls0 ws0">验来假设一个函数集合<span class="_ _25"> </span><span class="ffe">F<span class="_ _34"></span></span>，<span class="_ _29"></span>称为假设空间<span class="_ _27"></span>（<span class="ff3">Hyp<span class="_ _23"></span>othesis Space<span class="_ _d"> </span></span>）<span class="_ _26"></span>，<span class="_ _29"></span>然后通过观测其在训练集<span class="_ _25"> </span><span class="ff3">D<span class="_ _d"> </span></span>上</div><div class="t m0 x3 h6 yac ff1 fs2 fc0 sc0 ls0 ws0">的特性，从中选择一个理想的假设（<span class="ff3">Hyp<span class="_ _23"></span>othesis<span class="_ _25"> </span>)<span class="_ _d"> </span><span class="ffd">f</span></span></div><div class="t m0 x20 ha yad ffb fs7 fc0 sc0 ls0 ws0">∗</div><div class="t m0 x21 h6 yac ffe fs2 fc0 sc0 ls0 ws0">∈<span class="_ _32"> </span>F<span class="_ _34"></span><span class="ff1">。</span></div><div class="t m0 x3 h6 yae ff4 fs2 fc0 sc0 ls0 ws0">定义<span class="ff6">1.6<span class="_ _5"> </span></span><span class="fc1">假设空间：<span class="_ _d"> </span></span><span class="ff1">假设空间<span class="_ _d"> </span><span class="ffe">F<span class="_ _35"> </span></span>通常为一个参数化的函数族</span></div><div class="t m0 x22 h4 yaf ffe fs2 fc0 sc0 ls0 ws0">F<span class="_ _e"> </span><span class="fff">=</span></div><div class="t m0 x23 hc yb0 ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x24 h4 yaf ffd fs2 fc0 sc0 ls0 ws0">f<span class="_ _34"></span><span class="fff">(<span class="ff10">x</span>;<span class="_ _31"> </span></span>θ<span class="_ _23"></span><span class="fff">)<span class="_ _a"> </span><span class="ffe">|<span class="_ _32"> </span></span></span>θ<span class="_ _25"> </span><span class="ffe">∈<span class="_ _32"> </span><span class="ffa">R</span></span></div><div class="t m0 x25 hb yb1 ffc fs7 fc0 sc0 ls0 ws0">D</div><div class="t m0 x26 hc yb0 ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x3 h6 y87 ff1 fs2 fc0 sc0 ls0 ws0">其中<span class="_ _d"> </span><span class="ffd">f<span class="_ _34"></span><span class="fff">(</span>x<span class="fff">;<span class="_ _31"> </span></span>θ<span class="_ _23"></span><span class="fff">)<span class="_ _25"> </span></span></span>是参数为<span class="_ _d"> </span><span class="ffd">θ<span class="_ _e"> </span></span>的函数，也称为模型<span class="_ _d"> </span><span class="ff3">(Mo<span class="_ _23"></span>del)</span>，<span class="ff3">D<span class="_ _d"> </span></span>为参数的数量。</div><div class="t m0 x3 h6 y20 ff1 fs2 fc0 sc0 ls0 ws0">常见的假设空间可以分为线性和非线性两种，<span class="_ _12"></span>对应的模型<span class="_ _25"> </span><span class="ffd">f<span class="_ _0"> </span></span>也分别称为线性模型和非线性模型。</div><div class="t m0 x3 h4 y3 ff3 fs2 fc0 sc0 ls0 ws0">4</div></div><div class="pi" data-data='{"ctm":[1.500000,0.000000,0.000000,1.500000,0.000000,0.000000]}'></div></div>
<div id="pfb" class="pf w0 h0" data-page-no="b"><div class="pc pcb w0 h0"><div class="t m0 x27 h7 y21 ff3 fs5 fc0 sc0 ls0 ws0">1.3<span class="_ _8"> </span><span class="ff7">学习准则</span></div><div class="t m0 x3 hd yb2 ff5 fs8 fc0 sc0 ls0 ws0">1.2.1<span class="_ _36"> </span><span class="ff9">线性模型</span></div><div class="t m0 x3 h6 yb3 ff1 fs2 fc0 sc0 ls0 ws0">线性模型的假设空间为一个参数化的线性函数族，即</div><div class="t m0 x28 h4 yb4 ffd fs2 fc0 sc0 ls0 ws0">f<span class="_ _34"></span><span class="fff">(<span class="ff10">x</span>;<span class="_ _31"> </span></span>θ<span class="_ _23"></span><span class="fff">)<span class="_ _a"> </span>=<span class="_ _32"> </span><span class="ff10">w</span></span></div><div class="t m0 x29 ha yb5 ffb fs7 fc0 sc0 ls0 ws0">⊤</div><div class="t m0 x2a h4 yb4 ff10 fs2 fc0 sc0 ls0 ws0">x<span class="_ _37"> </span><span class="fff">+<span class="_ _37"> </span><span class="ffd">b</span></span></div><div class="t m0 x3 h6 yb6 ff1 fs2 fc0 sc0 ls0 ws0">其中参数<span class="_ _d"> </span><span class="ffd">θ<span class="_ _e"> </span></span>包含了权重向量<span class="_ _d"> </span><span class="ffd">w<span class="_ _e"> </span></span>和偏置<span class="_ _25"> </span><span class="ffd">b</span>。</div><div class="t m0 x3 hd yb7 ff5 fs8 fc0 sc0 ls0 ws0">1.2.2<span class="_ _36"> </span><span class="ff9">非线性模型</span></div><div class="t m0 x3 h6 yb8 ff1 fs2 fc0 sc0 ls0 ws0">广义的非线性模型可以写为多个非线性基函数<span class="_ _d"> </span><span class="ffd">ϕ<span class="fff">(</span>x<span class="fff">)<span class="_ _d"> </span></span></span>的线性组合</div><div class="t m0 x11 h4 yb9 ffd fs2 fc0 sc0 ls0 ws0">f<span class="_ _34"></span><span class="fff">(<span class="ff10">x</span>;<span class="_ _31"> </span></span>θ<span class="_ _23"></span><span class="fff">)<span class="_ _a"> </span>=<span class="_ _32"> </span><span class="ff10">w</span></span></div><div class="t m0 x2b ha yba ffb fs7 fc0 sc0 ls0 ws0">⊤</div><div class="t m0 x29 h4 yb9 ffd fs2 fc0 sc0 ls0 ws0">ϕ<span class="fff">(<span class="ff10">x</span>)<span class="_ _37"> </span>+<span class="_ _37"> </span></span>b</div><div class="t m0 x3 h6 ybb ff1 fs2 fc0 sc0 ls0 ws0">其中<span class="_ _d"> </span><span class="ffd">ϕ<span class="fff">(<span class="ff10">x</span>)<span class="_ _32"> </span>=<span class="_ _32"> </span>[</span>ϕ</span></div><div class="t m0 x2c ha ybc ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 xb h4 ybb fff fs2 fc0 sc0 ls0 ws0">(<span class="ff10">x</span>)<span class="ffd">,<span class="_ _31"> </span>ϕ</span></div><div class="t m0 x2d ha ybc ff12 fs7 fc0 sc0 ls0 ws0">2</div><div class="t m0 x2e h4 ybb fff fs2 fc0 sc0 ls0 ws0">(<span class="ff10">x</span>)<span class="ffd">,<span class="_ _31"> </span><span class="ffe">·<span class="_ _31"></span>·<span class="_ _31"></span>·<span class="_ _d"> </span></span>,<span class="_ _31"> </span>ϕ</span></div><div class="t m0 x2 hb ybd ffc fs7 fc0 sc0 ls0 ws0">K</div><div class="t m0 x10 h4 ybb fff fs2 fc0 sc0 ls0 ws0">(<span class="ff10">x</span>)]</div><div class="t m0 x2f ha ybe ffb fs7 fc0 sc0 ls0 ws0">⊤</div><div class="t m0 x23 h6 ybb ff1 fs2 fc0 sc0 ls0 ws0">为<span class="_ _d"> </span><span class="ffd">K<span class="_ _1e"> </span></span>个非线性基函数组成的向量，参数<span class="_ _e"> </span><span class="ffd">θ<span class="_ _e"> </span></span>包含了权重</div><div class="t m0 x3 h6 ybf ff1 fs2 fc0 sc0 ls0 ws0">向量<span class="_ _d"> </span><span class="ffd">w<span class="_ _e"> </span></span>和偏置<span class="_ _d"> </span><span class="ffd">b</span>。</div><div class="t m0 x3 h6 yc0 ff1 fs2 fc0 sc0 ls0 ws0">如果<span class="_ _d"> </span><span class="ffd">ϕ<span class="fff">(<span class="ff10">x</span>)<span class="_ _d"> </span></span></span>本身为可学习的基函数，比如</div><div class="t m0 x8 he yc1 ffd fs2 fc0 sc0 ls0 ws0">ϕ</div><div class="t m0 x30 hb yc2 ffc fs7 fc0 sc0 ls0 ws0">k</div><div class="t m0 x31 h4 yc1 fff fs2 fc0 sc0 ls0 ws0">(<span class="ff10">x</span>)<span class="_ _32"> </span>=<span class="_ _32"> </span><span class="ffd">h</span></div><div class="t m0 x28 hc yc3 ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x32 hf yc1 ff10 fs2 fc0 sc0 ls0 ws0">w</div><div class="t m0 x33 ha yc4 ffb fs7 fc0 sc0 ls0 ws0">⊤</div><div class="t m0 x33 hb yc5 ffc fs7 fc0 sc0 ls0 ws0">k</div><div class="t m0 x1 he yc1 ffd fs2 fc0 sc0 ls0 ws0">ϕ</div><div class="t m0 x34 ha yc4 ffb fs7 fc0 sc0 ls0 ws0">′</div><div class="t m0 x35 h4 yc1 fff fs2 fc0 sc0 ls0 ws0">(<span class="ff10">x</span>)<span class="_ _37"> </span>+<span class="_ _37"> </span><span class="ffd">b</span></div><div class="t m0 x36 hb yc2 ffc fs7 fc0 sc0 ls0 ws0">k</div><div class="t m0 x21 hc yc3 ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x37 h4 yc1 ff3 fs2 fc0 sc0 ls0 ws0">�<span class="ffe">∀<span class="fff">1<span class="_ _32"> </span></span>≤<span class="_ _32"> </span><span class="ffd">k<span class="_ _25"> </span></span>≤<span class="_ _32"> </span><span class="ffd">K</span></span></div><div class="t m0 x3 h6 yc6 ff1 fs2 fc0 sc0 ls0 ws0">其中<span class="_ _25"> </span><span class="ffd">h<span class="fff">(<span class="ffe">·</span>)<span class="_ _d"> </span></span></span>为非线性函数，<span class="_ _28"></span><span class="ffd">ϕ</span></div><div class="t m0 x38 ha yc7 ffb fs7 fc0 sc0 ls0 ws0">′</div><div class="t m0 x8 h6 yc6 fff fs2 fc0 sc0 ls0 ws0">(<span class="ffd">x</span>)<span class="_ _25"> </span><span class="ff1">为另一组基函数，<span class="_ _12"></span><span class="ff3">w</span></span></div><div class="t m0 x36 hb yc8 ffc fs7 fc0 sc0 ls0 ws0">k</div><div class="t m0 x39 h6 yc6 ff1 fs2 fc0 sc0 ls0 ws0">和<span class="_ _25"> </span><span class="ffd">b</span></div><div class="t m0 x26 hb yc8 ffc fs7 fc0 sc0 ls0 ws0">k</div><div class="t m0 x3a h6 yc6 ff1 fs2 fc0 sc0 ls0 ws0">为可学习的参数，<span class="_ _28"></span>则<span class="_ _d"> </span><span class="ffd">f<span class="_ _34"></span><span class="fff">(</span>x<span class="fff">;<span class="_ _31"> </span></span>θ<span class="_ _23"></span><span class="fff">)<span class="_ _25"> </span></span></span>就等价</div><div class="t m0 x3 h6 yc9 ff1 fs2 fc0 sc0 ls0 ws0">于神经网络模型。</div><div class="t m0 x11 h9 yca ff5 fs6 fc0 sc0 ls0 ws0">1.3<span class="_ _24"> </span><span class="ff9">学习准则</span></div><div class="t m0 x3 h6 ycb ff1 fs2 fc0 sc0 ls0 ws0">令训练<span class="_ _23"></span>集<span class="_ _e"> </span><span class="ffe">D<span class="_ _e"> </span><span class="fff">=</span></span></div><div class="t m0 x3b hc ycc ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x3c hf ycb ff10 fs2 fc0 sc0 ls0 ws0">x</div><div class="t m0 x3d ha ycd ff12 fs7 fc0 sc0 ls0 ws0">(<span class="ffc">n</span>)</div><div class="t m0 x2d he ycb ffd fs2 fc0 sc0 ls0 ws0">,<span class="_ _31"> </span>y</div><div class="t m0 x3e ha ycd ff12 fs7 fc0 sc0 ls0 ws0">(<span class="ffc">n</span>)</div><div class="t m0 x3f hc ycc ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x40 hb yce ffc fs7 fc0 sc0 ls0 ws0">N</div><div class="t m0 x40 ha ycf ffc fs7 fc0 sc0 ls0 ws0">n<span class="ff12">=1</span></div><div class="t m0 x41 h6 ycb ff1 fs2 fc0 sc0 ls0 ws0">是由<span class="_ _e"> </span><span class="ffd">N<span class="_ _5"> </span></span>个独立<span class="_ _23"></span>同分布的<span class="_ _23"></span>（<span class="ff3">Iden<span class="_ _28"></span>tically<span class="_ _1e"> </span>and<span class="_ _e"> </span>Indep<span class="_ _23"></span>enden<span class="_ _12"></span>tly<span class="_ _e"> </span>Dis-</span></div><div class="t m0 x3 h6 yd0 ff3 fs2 fc0 sc0 ls0 ws0">tributed<span class="ff1">，<span class="_ _12"></span><span class="ff3">I<span class="_ _23"></span>ID<span class="_ _25"> </span>)<span class="_ _d"> </span><span class="ff1">样本组成，即每个样本<span class="_ _25"> </span><span class="fff">(<span class="ff10">x<span class="ffd">,<span class="_ _31"> </span>y<span class="_ _23"></span></span></span>)<span class="_ _a"> </span><span class="ffe">∈<span class="_ _32"> </span><span class="ffd">X<span class="_ _25"> </span></span>×<span class="_ _37"> </span><span class="ffd">y<span class="_ _e"> </span></span></span></span>是从<span class="_ _d"> </span></span>X<span class="_ _25"> </span><span class="ff1">和<span class="_ _d"> </span></span>y<span class="_ _d"> </span><span class="ff1">的联合空间中按照某个未知</span></span></span></div><div class="t m0 x3 h6 yd1 ff1 fs2 fc0 sc0 ls0 ws0">分布<span class="_ _1e"> </span><span class="ffd">p</span></div><div class="t m0 x42 hb yd2 ffc fs7 fc0 sc0 ls0 ws0">r</div><div class="t m0 x43 h6 yd1 fff fs2 fc0 sc0 ls0 ws0">(<span class="ff10">x<span class="ffd">,<span class="_ _31"> </span>y<span class="_ _23"></span></span></span>)<span class="_ _e"> </span><span class="ff1">独<span class="_ _23"></span>立地随<span class="_ _23"></span>机产生<span class="_ _23"></span>的。这里要<span class="_ _23"></span>求样本<span class="_ _23"></span>分布<span class="_ _1e"> </span><span class="ffd">p</span></span></div><div class="t m0 x44 hb yd2 ffc fs7 fc0 sc0 ls0 ws0">r</div><div class="t m0 x25 h6 yd1 fff fs2 fc0 sc0 ls0 ws0">(<span class="ff10">x<span class="ffd">,<span class="_ _31"> </span>y<span class="_ _23"></span></span></span>)<span class="_ _e"> </span><span class="ff1">必<span class="_ _23"></span>须是固<span class="_ _23"></span>定的（虽<span class="_ _23"></span>然可以是<span class="_ _23"></span>未知</span></div><div class="t m0 x3 h6 yd3 ff1 fs2 fc0 sc0 ls0 ws0">的<span class="ff3">)</span>，不会随时间而变化<span class="ff3">.<span class="_ _0"> </span></span>如果<span class="_ _23"></span>一个好的模型<span class="_ _d"> </span><span class="ffd">f<span class="_ _32"> </span><span class="fff">(<span class="ff10">x</span></span>,<span class="_ _31"> </span>θ</span></div><div class="t m0 x45 ha yd4 ffb fs7 fc0 sc0 ls0 ws0">∗</div><div class="t m0 x36 h6 yd3 fff fs2 fc0 sc0 ls0 ws0">)<span class="_ _d"> </span><span class="ff1">应该在所有<span class="_ _e"> </span></span>(<span class="ff10">x<span class="ffd">,<span class="_ _31"> </span>y<span class="_ _23"></span></span></span>)<span class="_ _d"> </span><span class="ff1">的可能取值上都<span class="_ _23"></span>与真实</span></div><div class="t m0 x3 h6 yd5 ff1 fs2 fc0 sc0 ls0 ws0">映射函数<span class="_ _d"> </span><span class="ffd">y<span class="_ _25"> </span><span class="fff">=<span class="_ _32"> </span></span>g<span class="_ _23"></span><span class="fff">(</span>x<span class="fff">)<span class="_ _d"> </span></span></span>一致，即</div><div class="t m0 x46 h4 yd6 ffe fs2 fc0 sc0 ls0 ws0">|<span class="ffd">f<span class="_ _a"> </span><span class="fff">(<span class="ff10">x</span></span>,<span class="_ _31"> </span>θ</span></div><div class="t m0 x47 ha yd7 ffb fs7 fc0 sc0 ls0 ws0">∗</div><div class="t m0 x48 h4 yd6 fff fs2 fc0 sc0 ls0 ws0">)<span class="_ _37"> </span><span class="ffe">−<span class="_ _37"> </span><span class="ffd">y<span class="_ _23"></span></span>|<span class="_ _a"> </span><span class="ffd">&lt;<span class="_ _32"> </span>ϵ,<span class="_ _11"> </span></span>∀</span>(<span class="ff10">x<span class="ffd">,<span class="_ _31"> </span>y<span class="_ _23"></span></span></span>)<span class="_ _32"> </span><span class="ffe">∈<span class="_ _32"> </span><span class="ffd">X<span class="_ _25"> </span></span>×<span class="_ _37"> </span><span class="ffd">y</span></span></div><div class="t m0 x3 h6 yd8 ff1 fs2 fc0 sc0 ls0 ws0">或与真实条件概率分布<span class="_ _d"> </span><span class="ffd">p</span></div><div class="t m0 x49 hb yd9 ffc fs7 fc0 sc0 ls0 ws0">r</div><div class="t m0 x4a h6 yd8 fff fs2 fc0 sc0 ls0 ws0">(<span class="ffd">y<span class="_ _25"> </span><span class="ffe">|<span class="_ _32"> </span><span class="ff10">x</span></span></span>)<span class="_ _d"> </span><span class="ff1">一致，即</span></div><div class="t m0 x4b h4 yda ffe fs2 fc0 sc0 ls0 ws0">|<span class="ffd">f</span></div><div class="t m0 x38 hb ydb ffc fs7 fc0 sc0 ls0 ws0">y</div><div class="t m0 x4c h4 yda fff fs2 fc0 sc0 ls0 ws0">(<span class="ff10">x<span class="ffd">,<span class="_ _31"> </span>θ</span></span></div><div class="t m0 x4d ha ydc ffb fs7 fc0 sc0 ls0 ws0">∗</div><div class="t m0 x4e h4 yda fff fs2 fc0 sc0 ls0 ws0">)<span class="_ _37"> </span><span class="ffe">−<span class="_ _37"> </span><span class="ffd">p</span></span></div><div class="t m0 xe hb ydb ffc fs7 fc0 sc0 ls0 ws0">r</div><div class="t m0 x4f h4 yda fff fs2 fc0 sc0 ls0 ws0">(<span class="ffd">y<span class="_ _25"> </span><span class="ffe">|<span class="_ _32"> </span><span class="ff10">x</span></span></span>)<span class="ffe">|<span class="_ _32"> </span><span class="ffd">&lt;<span class="_ _32"> </span>ϵ,<span class="_ _11"> </span></span>∀</span>(<span class="ff10">x<span class="ffd">,<span class="_ _31"> </span>y<span class="_ _23"></span></span></span>)<span class="_ _32"> </span><span class="ffe">∈<span class="_ _32"> </span><span class="ffd">X<span class="_ _25"> </span></span>×<span class="_ _37"> </span><span class="ffd">y</span></span></div><div class="t m0 x3 h6 ydd ff1 fs2 fc0 sc0 ls0 ws0">其中<span class="_ _d"> </span><span class="ffd">ϵ<span class="_ _d"> </span></span>是<span class="_ _23"></span>一个很小的正数<span class="ff3">,<span class="_ _d"> </span><span class="ffd">f</span></span></div><div class="t m0 x50 hb yde ffc fs7 fc0 sc0 ls0 ws0">y</div><div class="t m0 x46 h4 ydd fff fs2 fc0 sc0 ls0 ws0">(<span class="ff10">x<span class="ffd">,<span class="_ _31"> </span>θ</span></span></div><div class="t m0 x4e ha ydf ffb fs7 fc0 sc0 ls0 ws0">∗</div><div class="t m0 x51 h6 ydd fff fs2 fc0 sc0 ls0 ws0">)<span class="_ _d"> </span><span class="ff1">为模型预测的<span class="_ _23"></span>条件概率分布中<span class="_ _d"> </span><span class="ffd">y<span class="_ _e"> </span></span>对应<span class="_ _23"></span>的概率。模型<span class="_ _d"> </span><span class="ffd">f<span class="_ _34"></span></span></span>(<span class="ff10">x</span>;<span class="_ _31"> </span><span class="ffd">θ<span class="_ _23"></span></span>)</div><div class="t m0 x3 h6 ye0 ff1 fs2 fc0 sc0 ls0 ws0">的好坏可以通过<span class="fc2">期望风险<span class="_ _d"> </span></span><span class="ff3">(<span class="_ _d"> </span>Exp<span class="_ _23"></span>ected<span class="_ _25"> </span>Risk<span class="_ _d"> </span>)<span class="_ _d"> </span><span class="ffe">R<span class="fff">(<span class="ffd">θ<span class="_ _23"></span></span>)<span class="_ _d"> </span></span></span></span>来衡量，其定义为</div><div class="t m0 x9 h4 ye1 ffe fs2 fc0 sc0 ls0 ws0">R<span class="fff">(<span class="ffd">θ<span class="_ _23"></span></span>)<span class="_ _a"> </span>=<span class="_ _32"> </span><span class="ffa">E</span></span></div><div class="t m0 x52 ha ye2 ff12 fs7 fc0 sc0 ls0 ws0">(<span class="ffc">x,y<span class="_ _23"></span></span>)<span class="ffb">∼<span class="ffc">p</span></span></div><div class="t m0 x53 h10 ye3 ff13 fs9 fc0 sc0 ls0 ws0">r</div><div class="t m0 xa ha ye2 ff12 fs7 fc0 sc0 ls0 ws0">(<span class="ffc">x,y<span class="_ _23"></span></span>)</div><div class="t m0 x45 h4 ye1 fff fs2 fc0 sc0 ls0 ws0">[<span class="ffe">L</span>(<span class="ffd">y<span class="_ _23"></span>,<span class="_ _33"> </span>f<span class="_ _34"> </span></span>(<span class="ff10">x</span>;<span class="_ _38"> </span><span class="ffd">θ<span class="_ _23"></span></span>))]</div><div class="t m0 x3 h6 ye4 ff1 fs2 fc0 sc0 ls0 ws0">其中<span class="_ _d"> </span><span class="ffd">p</span></div><div class="t m0 x42 hb ye5 ffc fs7 fc0 sc0 ls0 ws0">r</div><div class="t m0 x43 h6 ye4 fff fs2 fc0 sc0 ls0 ws0">(<span class="ff10">x<span class="ffd">,<span class="_ _31"> </span>y<span class="_ _23"></span></span></span>)<span class="_ _d"> </span><span class="ff1">为真实的数据分布<span class="_ _d"> </span><span class="ffd">,<span class="_ _31"> </span><span class="ffe">L</span></span></span>(<span class="ffd">y<span class="_ _23"></span>,<span class="_ _31"> </span>f<span class="_ _34"> </span></span>(<span class="ff10">x</span>;<span class="_ _31"> </span><span class="ffd">θ<span class="_ _23"></span></span>))<span class="_ _d"> </span><span class="ff1">为<span class="ff4">损失函数</span>。损失函数用来量化两个变<span class="_ _23"></span>量之间的</span></div><div class="t m0 x3 h6 ye6 ff1 fs2 fc0 sc0 ls0 ws0">差异。</div><div class="t m0 x3 hd ye7 ff5 fs8 fc0 sc0 ls0 ws0">1.3.1<span class="_ _36"> </span><span class="ff9">风险最小化准则</span></div><div class="t m0 x3 h6 ye8 ff1 fs2 fc0 sc0 ls0 ws0">一个好的模型<span class="_ _d"> </span><span class="ffd">f<span class="_ _34"></span><span class="fff">(</span>x<span class="fff">;<span class="_ _31"> </span></span>θ<span class="_ _23"></span><span class="fff">)<span class="_ _d"> </span></span></span>应当有一个比较小的期望错误，但由于不知道真实的数据分布和映射函数</div><div class="t m0 x14 h6 ye9 ff1 fs2 fc0 sc0 ls0 ws0">（即不知道总体）<span class="_ _26"></span>，<span class="_ _39"></span>实际上无法计算其期望风险<span class="_ _37"> </span><span class="ffe">R<span class="fff">(<span class="ffd">θ<span class="_ _23"></span></span>)</span></span>。<span class="_ _26"></span>我们只可以计算<span class="ff4">经验风险<span class="_ _37"> </span><span class="fff">(<span class="_ _d"> </span><span class="ff3">Empirical<span class="_ _d"> </span>Risk<span class="_ _d"> </span></span>)</span></span>，</div><div class="t m0 x3 h6 y20 ff1 fs2 fc0 sc0 ls0 ws0">即在训练集<span class="_ _d"> </span><span class="ffe">D<span class="_ _25"> </span><span class="fff">=</span></span></div><div class="t m0 x54 hc yea ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x55 hf y20 ff10 fs2 fc0 sc0 ls0 ws0">x</div><div class="t m0 x56 ha yeb ff12 fs7 fc0 sc0 ls0 ws0">(<span class="ffc">n</span>)</div><div class="t m0 x57 he y20 ffd fs2 fc0 sc0 ls0 ws0">,<span class="_ _31"> </span>y</div><div class="t m0 x4a ha yeb ff12 fs7 fc0 sc0 ls0 ws0">(<span class="ffc">n</span>)</div><div class="t m0 x58 hc yea ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x9 hb yec ffc fs7 fc0 sc0 ls0 ws0">N</div><div class="t m0 x9 ha yed ffc fs7 fc0 sc0 ls0 ws0">n<span class="ff12">=1</span></div><div class="t m0 x51 h6 y20 ff1 fs2 fc0 sc0 ls0 ws0">上的平均损失：</div><div class="t m0 xd h4 y3 ff3 fs2 fc0 sc0 ls0 ws0">5</div></div><div class="pi" data-data='{"ctm":[1.500000,0.000000,0.000000,1.500000,0.000000,0.000000]}'></div></div>
<div id="pfc" class="pf w0 h0" data-page-no="c"><div class="pc pcc w0 h0"><img class="bi x3 yee w1 h11" alt="" src="bgc.png"/><div class="t m0 x3 h7 y21 ff3 fs5 fc0 sc0 ls0 ws0">1.3<span class="_ _8"> </span><span class="ff7">学习准则</span></div><div class="t m0 x4c h4 yef ffe fs2 fc0 sc0 ls0 ws0">R</div><div class="t m0 x59 hb yf0 ffc fs7 fc0 sc0 ls0 ws0">emp</div><div class="t m0 x59 ha yf1 ffb fs7 fc0 sc0 ls0 ws0">D</div><div class="t m0 x5a h4 yef fff fs2 fc0 sc0 ls0 ws0">(<span class="ffd">θ<span class="_ _23"></span></span>)<span class="_ _a"> </span>=</div><div class="t m0 x5b h4 yf2 fff fs2 fc0 sc0 ls0 ws0">1</div><div class="t m0 x52 he yf3 ffd fs2 fc0 sc0 ls0 ws0">N</div><div class="t m0 x5c hb yf4 ffc fs7 fc0 sc0 ls0 ws0">N</div><div class="t m0 x5d hc yf5 ff11 fs2 fc0 sc0 ls0 ws0">X</div><div class="t m0 x5d ha yf6 ffc fs7 fc0 sc0 ls0 ws0">n<span class="ff12">=1</span></div><div class="t m0 x5e h4 yef ffe fs2 fc0 sc0 ls0 ws0">L</div><div class="t m0 x2b hc yf7 ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x5f he yef ffd fs2 fc0 sc0 ls0 ws0">y</div><div class="t m0 x45 ha yf8 ff12 fs7 fc0 sc0 ls0 ws0">(<span class="ffc">n</span>)</div><div class="t m0 x60 he yef ffd fs2 fc0 sc0 ls0 ws0">,<span class="_ _31"> </span>f</div><div class="t m0 x25 hc yf7 ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x61 hf yef ff10 fs2 fc0 sc0 ls0 ws0">x</div><div class="t m0 x62 ha yf8 ff12 fs7 fc0 sc0 ls0 ws0">(<span class="ffc">n</span>)</div><div class="t m0 x63 h4 yef fff fs2 fc0 sc0 ls0 ws0">;<span class="_ _31"> </span><span class="ffd">θ</span></div><div class="t m0 x64 hc yf7 ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x3 h6 yf9 ff1 fs2 fc0 sc0 ls0 ws0">根据大数定律，当样本数<span class="_ _d"> </span><span class="ffd">N<span class="_ _35"> </span></span>趋于无穷大时，经验风险可以作为期望风险的估计。因此，一个切</div><div class="t m0 x3 h6 yfa ff1 fs2 fc0 sc0 ls0 ws0">实可行的学习准则是找到一组参数<span class="_ _d"> </span><span class="ffd">θ<span class="_ _e"> </span></span>使得经验风险最小，即</div><div class="t m0 x48 he yfb ffd fs2 fc0 sc0 ls0 ws0">θ</div><div class="t m0 x28 ha yfc ffb fs7 fc0 sc0 ls0 ws0">∗</div><div class="t m0 x4f h4 yfb fff fs2 fc0 sc0 ls0 ws0">=<span class="_ _32"> </span><span class="ff3">arg<span class="_ _31"> </span>min</span></div><div class="t m0 x65 hb yfd ffc fs7 fc0 sc0 ls0 ws0">θ</div><div class="t m0 x5f h4 yfb ffe fs2 fc0 sc0 ls0 ws0">R</div><div class="t m0 x2a hb yfe ffc fs7 fc0 sc0 ls0 ws0">emp</div><div class="t m0 x2a ha yff ffb fs7 fc0 sc0 ls0 ws0">D</div><div class="t m0 x66 h4 yfb fff fs2 fc0 sc0 ls0 ws0">(<span class="ffd">θ<span class="_ _23"></span></span>)</div><div class="t m0 x3 h6 y100 ff1 fs2 fc0 sc0 ls0 ws0">这就是经验风险最小化（<span class="ff3">Empirical<span class="_ _d"> </span>Risk<span class="_ _d"> </span>Minimization,ERM<span class="_ _d"> </span>)<span class="_ _d"> </span></span>准则。</div><div class="t m0 x3 hd y101 ff5 fs8 fc0 sc0 ls0 ws0">1.3.2<span class="_ _36"> </span><span class="ff9">结构风险最小化准则</span></div><div class="t m0 x3 h6 y102 ff1 fs2 fc0 sc0 ls0 ws0">但由<span class="_ _23"></span>于训练<span class="_ _23"></span>样本往<span class="_ _23"></span>往是真<span class="_ _23"></span>实数据<span class="_ _23"></span>的一<span class="_ _23"></span>个很小<span class="_ _23"></span>的子集<span class="_ _23"></span>或者包<span class="_ _23"></span>含一定<span class="_ _23"></span>的噪声<span class="_ _23"></span>数据，不<span class="_ _23"></span>能很<span class="_ _23"></span>好地反<span class="_ _23"></span>映</div><div class="t m0 x3 h6 y103 ff1 fs2 fc0 sc0 ls0 ws0">全部数据的真实分布．<span class="_ _2e"></span>经验风险最小化原则很容易导致模型在训练集上错误率很低，<span class="_ _2a"></span>但是在未知</div><div class="t m0 x3 h6 y104 ff1 fs2 fc0 sc0 ls0 ws0">数据上错误率很高．这就是过拟合（<span class="ff3">Ov<span class="_ _12"></span>ertting<span class="_ _d"> </span><span class="ff1">）<span class="_ _26"></span>。</span></span></div><div class="t m0 x3 h6 y105 ff4 fs2 fc0 sc0 ls0 ws0">定义<span class="ff6">1.7<span class="_ _5"> </span></span><span class="fc1">过拟合：<span class="_ _d"> </span></span><span class="ff1">给定<span class="_ _23"></span>一个假设空间<span class="_ _d"> </span><span class="ffe">F<span class="_ _34"></span></span>，一个假设<span class="_ _e"> </span><span class="ffd">f<span class="_ _0"> </span></span>属于<span class="_ _d"> </span><span class="ffe">F<span class="_ _34"></span></span>，如果存在其他的假<span class="_ _23"></span>设<span class="_ _d"> </span><span class="ffd">f</span></span></div><div class="t m0 x67 ha y106 ffb fs7 fc0 sc0 ls0 ws0">′</div><div class="t m0 x68 h6 y105 ff1 fs2 fc0 sc0 ls0 ws0">也属于</div><div class="t m0 x3 h6 y107 ffe fs2 fc0 sc0 ls0 ws0">F<span class="_ _34"></span><span class="ff1">，<span class="_ _29"></span>使得在训练集上<span class="_ _d"> </span><span class="ffd">f<span class="_ _1e"> </span></span>的损失比<span class="_ _d"> </span><span class="ffd">f</span></span></div><div class="t m0 x5a ha y108 ffb fs7 fc0 sc0 ls0 ws0">′</div><div class="t m0 x69 h6 y107 ff1 fs2 fc0 sc0 ls0 ws0">的损失小，<span class="_ _30"></span>但在整个样本空间上<span class="_ _25"> </span><span class="ffd">f</span></div><div class="t m0 x6a ha y108 ffb fs7 fc0 sc0 ls0 ws0">′</div><div class="t m0 x6b h6 y107 ff1 fs2 fc0 sc0 ls0 ws0">的损失比<span class="_ _25"> </span><span class="ffd">f<span class="_ _35"> </span></span>的损失小<span class="ff3">,<span class="_ _25"> </span></span>那</div><div class="t m0 x3 h6 y109 ff1 fs2 fc0 sc0 ls0 ws0">么就说假设<span class="_ _d"> </span><span class="ffd">f<span class="_ _35"> </span></span>过度拟合训练数据<span class="_ _d"> </span><span class="ff3">[Mitchell,<span class="_ _25"> </span>1997]</span>。</div><div class="t m0 x3 h6 y10a ff1 fs2 fc0 sc0 ls0 ws0">过拟合问<span class="_ _23"></span>题往往是由<span class="_ _23"></span>于训练数据少<span class="_ _23"></span>和噪声以及<span class="_ _23"></span>模型能力强等<span class="_ _23"></span>原因造成的。<span class="_ _23"></span>为了解决过拟<span class="_ _23"></span>合问题，</div><div class="t m0 x3 h6 y10b ff1 fs2 fc0 sc0 ls0 ws0">一般在经验风险最小化的基础上再引入参数的正则化<span class="_ _2a"></span>（<span class="ff3">Regularization</span>）<span class="_ _2e"></span>来限制模型能力，<span class="_ _2b"></span><span class="ff4">使其不</span></div><div class="t m0 x3 h6 y10c ff4 fs2 fc0 sc0 ls0 ws0">要过度地最小化经验风险<span class="ff1">。<span class="_ _3a"></span>这种准则就是结构风险最小化<span class="_ _29"></span>（<span class="ff3">Structure Risk<span class="_ _25"> </span>Minimization</span>，<span class="_ _2e"></span><span class="ff3">SRM<span class="ff1">）</span></span></span></div><div class="t m0 x3 h6 y10d ff1 fs2 fc0 sc0 ls0 ws0">准则：</div><div class="t m0 x2e he y10e ffd fs2 fc0 sc0 ls0 ws0">θ</div><div class="t m0 x3e ha y10f ffb fs7 fc0 sc0 ls0 ws0">∗</div><div class="t m0 x6c h4 y10e fff fs2 fc0 sc0 ls0 ws0">=<span class="_ _32"> </span><span class="ff3">arg<span class="_ _31"> </span>min</span></div><div class="t m0 x6d hb y110 ffc fs7 fc0 sc0 ls0 ws0">θ</div><div class="t m0 x6e h4 y10e ffe fs2 fc0 sc0 ls0 ws0">R</div><div class="t m0 x48 h12 y10f ff14 fs7 fc0 sc0 ls0 ws0">struct</div><div class="t m0 x48 ha y111 ffb fs7 fc0 sc0 ls0 ws0">D</div><div class="t m0 x24 h4 y10e fff fs2 fc0 sc0 ls0 ws0">(<span class="ffd">θ<span class="_ _23"></span></span>)</div><div class="t m0 x6c h4 y112 fff fs2 fc0 sc0 ls0 ws0">=<span class="_ _32"> </span><span class="ff3">arg<span class="_ _31"> </span>min</span></div><div class="t m0 x6d hb y113 ffc fs7 fc0 sc0 ls0 ws0">θ</div><div class="t m0 x6e h4 y112 ffe fs2 fc0 sc0 ls0 ws0">R</div><div class="t m0 x48 hb y114 ffc fs7 fc0 sc0 ls0 ws0">emp</div><div class="t m0 x48 ha y115 ffb fs7 fc0 sc0 ls0 ws0">D</div><div class="t m0 x23 h4 y112 fff fs2 fc0 sc0 ls0 ws0">(<span class="ffd">θ<span class="_ _23"></span></span>)<span class="_ _38"> </span>+</div><div class="t m0 x6f h4 y116 fff fs2 fc0 sc0 ls0 ws0">1</div><div class="t m0 x6f h4 y117 fff fs2 fc0 sc0 ls0 ws0">2</div><div class="t m0 x70 h4 y112 ffd fs2 fc0 sc0 ls0 ws0">λ<span class="ffe">∥</span>θ<span class="_ _23"></span><span class="ffe">∥</span></div><div class="t m0 x71 ha y118 ff12 fs7 fc0 sc0 ls0 ws0">2</div><div class="t m0 x6c h4 y119 fff fs2 fc0 sc0 ls0 ws0">=<span class="_ _32"> </span><span class="ff3">arg<span class="_ _31"> </span>min</span></div><div class="t m0 x6d hb y11a ffc fs7 fc0 sc0 ls0 ws0">θ</div><div class="t m0 x72 h4 y11b fff fs2 fc0 sc0 ls0 ws0">1</div><div class="t m0 x73 he y11c ffd fs2 fc0 sc0 ls0 ws0">N</div><div class="t m0 x16 hb y11d ffc fs7 fc0 sc0 ls0 ws0">N</div><div class="t m0 x28 hc y11e ff11 fs2 fc0 sc0 ls0 ws0">X</div><div class="t m0 x28 hb y11f ffc fs7 fc0 sc0 ls0 ws0">n</div><div class="t m0 x16 ha y120 ff12 fs7 fc0 sc0 ls0 ws0">=1</div><div class="t m0 x24 h4 y119 ffe fs2 fc0 sc0 ls0 ws0">L</div><div class="t m0 x74 hc y121 ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x75 he y119 ffd fs2 fc0 sc0 ls0 ws0">y</div><div class="t m0 x6f ha y122 ff12 fs7 fc0 sc0 ls0 ws0">(<span class="ffc">n</span>)</div><div class="t m0 x76 he y119 ffd fs2 fc0 sc0 ls0 ws0">,<span class="_ _31"> </span>f</div><div class="t m0 x36 hc y121 ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x77 he y119 ffd fs2 fc0 sc0 ls0 ws0">x</div><div class="t m0 x78 ha y122 ff12 fs7 fc0 sc0 ls0 ws0">(<span class="ffc">n</span>)</div><div class="t m0 x79 h4 y119 fff fs2 fc0 sc0 ls0 ws0">;<span class="_ _31"> </span><span class="ffd">θ</span></div><div class="t m0 x7a hc y121 ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x7b h4 y119 fff fs2 fc0 sc0 ls0 ws0">+</div><div class="t m0 x7c h4 y11b fff fs2 fc0 sc0 ls0 ws0">1</div><div class="t m0 x7c h4 y11c fff fs2 fc0 sc0 ls0 ws0">2</div><div class="t m0 x7d h4 y119 ffd fs2 fc0 sc0 ls0 ws0">λ<span class="ffe">∥</span>θ<span class="_ _23"></span><span class="ffe">∥</span></div><div class="t m0 x7e ha y122 ff12 fs7 fc0 sc0 ls0 ws0">2</div><div class="t m0 x3 h6 y123 ff1 fs2 fc0 sc0 ls0 ws0">其中<span class="_ _d"> </span><span class="ffe">∥<span class="ffd">θ<span class="_ _23"></span></span>∥<span class="_ _25"> </span></span>是<span class="_ _d"> </span><span class="ffd">ℓ</span></div><div class="t m0 x7f ha y124 ff12 fs7 fc0 sc0 ls0 ws0">2</div><div class="t m0 x3b h6 y123 ff1 fs2 fc0 sc0 ls0 ws0">范数的正则化项，用来减少参数空间，避免过拟合；<span class="ffd">λ<span class="_ _d"> </span></span>用来控制正则化的强度。</div><div class="t m0 x12 h6 y125 ff1 fs2 fc0 sc0 ls0 ws0">因为引入了正则项，当模型的参数越多，模型越复杂，正则项的值就会越大，<span class="_ _12"></span>这样就会迫</div><div class="t m0 x12 h6 y126 ff1 fs2 fc0 sc0 ls0 ws0">使模型在学习时不会选择过多的参数。因此这是对模型复杂度的惩罚机制。</div><div class="t m0 x3 h6 y127 ff1 fs2 fc0 sc0 ls0 ws0">正则化项也可以使用<span class="_ _23"></span>其他函数，比如<span class="_ _d"> </span><span class="ffd">ℓ</span></div><div class="t m0 x2f ha y128 ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 x80 h6 y127 ff1 fs2 fc0 sc0 ls0 ws0">范数<span class="ff3">.<span class="_ _0"> </span><span class="ffd">ℓ</span></span></div><div class="t m0 x81 ha y128 ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 x76 h6 y127 ff1 fs2 fc0 sc0 ls0 ws0">范数的引入通常会使<span class="_ _23"></span>得参数有一定稀疏性，因</div><div class="t m0 x3 h6 y129 ff1 fs2 fc0 sc0 ls0 ws0">此在很多算法中也经常使用。<span class="_ _29"></span>从贝叶斯学习的角度来讲，<span class="_ _29"></span>正则化是引入了参数的先验分布，<span class="_ _29"></span>使其</div><div class="t m0 x3 h6 y12a ff1 fs2 fc0 sc0 ls0 ws0">不完全依赖训练数据。</div><div class="t m0 x3 h4 y3 ff3 fs2 fc0 sc0 ls0 ws0">6</div></div><div class="pi" data-data='{"ctm":[1.500000,0.000000,0.000000,1.500000,0.000000,0.000000]}'></div></div>
<div id="pfd" class="pf w0 h0" data-page-no="d"><div class="pc pcd w0 h0"><img class="bi x82 y12b w2 h13" alt="" src="bgd.png"/><div class="t m0 x83 h5 y4 ff4 fs3 fc0 sc0 ls0 ws0">第二章 评估假设空间</div><div class="t m0 x58 h9 y66 ff5 fs6 fc0 sc0 ls0 ws0">2.1<span class="_ _24"> </span><span class="ff9">模型的参数和超参数</span></div><div class="t m0 x3 h6 y12c ff1 fs2 fc0 sc0 ls0 ws0">参数<span class="_ _29"></span>（<span class="ff3">parameter</span>）<span class="_ _29"></span>和超参数<span class="_ _29"></span>（<span class="ff3">hyperparameter</span>）<span class="_ _30"></span>在文献中常被混为一谈。<span class="_ _3a"></span>研究者经常提到的<span class="_ _27"></span>“调</div><div class="t m0 x3 h6 y12d ff1 fs2 fc0 sc0 ls0 ws0">参”<span class="_ _26"></span>，实际上是调整超参数。为了防止语言上的混淆，我们首先对两者进行界定。</div><div class="t m0 x3 h6 y12e ff1 fs2 fc0 sc0 ls0 ws0">参数是模型的内部变量，<span class="_ _26"></span>是模型通过学习可以确定的参数。<span class="_ _3b"></span>以简单的一元线性回归模型<span class="_ _37"> </span><span class="ffd">y<span class="_ _d"> </span><span class="fff">=<span class="_ _a"> </span></span>k<span class="_ _23"></span>x<span class="_ _23"></span><span class="fff">+<span class="_ _23"></span></span>b</span></div><div class="t m0 x3 h6 y12f ff1 fs2 fc0 sc0 ls0 ws0">为例，<span class="_ _2e"></span>斜率<span class="_ _32"> </span><span class="ffd">k<span class="_ _d"> </span></span>和截距<span class="_ _32"> </span><span class="ffd">b<span class="_ _25"> </span></span>是该模型的参数。<span class="_ _3a"></span>支持向量机模型的支持向量，<span class="_ _2e"></span>神经网络模型的神经元连</div><div class="t m0 x3 h6 y130 ff1 fs2 fc0 sc0 ls0 ws0">接权值都是模型的参数。对于决策树类的模型而言，每一步分裂的规则也属于模型参数的范畴。</div><div class="t m0 x3 h6 y131 ff1 fs2 fc0 sc0 ls0 ws0">超参数是模型的外部变量，<span class="_ _2a"></span>是使用者用来确定假设空间的参数。<span class="_ _2e"></span>假设我们希望采用回归模型对一</div><div class="t m0 x3 h6 y132 ff1 fs2 fc0 sc0 ls0 ws0">组自变量<span class="_ _37"> </span><span class="ffd">x<span class="_ _37"> </span></span>和因变量<span class="_ _37"> </span><span class="ffd">y<span class="_ _32"> </span></span>进行拟合，<span class="_ _3c"></span>究竟使用线性<span class="_ _3b"></span>（一次）<span class="_ _3b"></span>模型<span class="_ _37"> </span><span class="ffd">y<span class="_ _d"> </span><span class="fff">=<span class="_ _32"> </span></span>k<span class="_ _23"></span>x<span class="fff">+</span>b</span>、<span class="_ _2f"></span>二次模型<span class="_ _37"> </span><span class="ffd">y<span class="_ _25"> </span><span class="fff">=<span class="_ _32"> </span></span>k</span></div><div class="t m0 x84 ha y133 ff12 fs7 fc0 sc0 ls0 ws0">2</div><div class="t m0 x84 hb y134 ffc fs7 fc0 sc0 ls0 ws0">x</div><div class="t m0 x85 h4 y132 fff fs2 fc0 sc0 ls0 ws0">+<span class="ffd">k</span></div><div class="t m0 x86 ha y135 ff12 fs7 fc0 sc0 ls0 ws0">2</div><div class="t m0 x87 h6 y132 ffd fs2 fc0 sc0 ls0 ws0">x<span class="fff">+ </span>b<span class="ff1">、</span></div><div class="t m0 x3 h6 y136 ff1 fs2 fc0 sc0 ls0 ws0">三次模型<span class="_ _25"> </span><span class="ffd">y<span class="_ _25"> </span><span class="fff">=<span class="_ _32"> </span></span>k</span></div><div class="t m0 x3b ha y137 ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 x88 he y136 ffd fs2 fc0 sc0 ls0 ws0">x</div><div class="t m0 x3c ha y138 ff12 fs7 fc0 sc0 ls0 ws0">3</div><div class="t m0 x89 h4 y136 fff fs2 fc0 sc0 ls0 ws0">+<span class="_ _31"> </span><span class="ffd">k</span></div><div class="t m0 x8a ha y137 ff12 fs7 fc0 sc0 ls0 ws0">2</div><div class="t m0 x8b he y136 ffd fs2 fc0 sc0 ls0 ws0">x</div><div class="t m0 x8c ha y138 ff12 fs7 fc0 sc0 ls0 ws0">2</div><div class="t m0 x8d h4 y136 fff fs2 fc0 sc0 ls0 ws0">+<span class="_ _31"> </span><span class="ffd">k</span></div><div class="t m0 x46 ha y137 ff12 fs7 fc0 sc0 ls0 ws0">3</div><div class="t m0 x59 h6 y136 ffd fs2 fc0 sc0 ls0 ws0">x<span class="_ _31"> </span><span class="fff">+<span class="_ _31"> </span></span>b<span class="_ _25"> </span><span class="ff1">或者更高次的回归模型，<span class="_ _29"></span>这里的多项式次数就是模型的超参</span></div><div class="t m0 x3 h6 y139 ff1 fs2 fc0 sc0 ls0 ws0">数。下图展示了对回归模型中参数和超参数的辨析。</div><div class="t m0 x11 h6 y13a ff1 fs2 fc0 sc0 ls0 ws0">图<span class="_ _d"> </span><span class="ff3">2.1:<span class="_ _35"> </span></span>超参数和参数</div><div class="t m0 x3 h6 y13b ff1 fs2 fc0 sc0 ls0 ws0">支持向量机模型中核函数类型、<span class="_ _3a"></span>惩罚系数等，<span class="_ _2e"></span>随机森林模型的树棵数、<span class="_ _3a"></span>最大特征数、<span class="_ _3a"></span>剪枝参数等，</div><div class="t m0 x3 h6 y13c ff3 fs2 fc0 sc0 ls0 ws0">X<span class="_ _12"></span>GBo<span class="_ _23"></span>ost<span class="_ _25"> </span><span class="ff1">模型的学习率、<span class="_ _12"></span>最大树深度、<span class="_ _12"></span>行采样比例等、<span class="_ _12"></span>神经网络模型的网络层数、<span class="_ _28"></span>神经元个数、</span></div><div class="t m0 x3 h6 y13d ff1 fs2 fc0 sc0 ls0 ws0">激活函数类型等，这些都属于模型的超参数。</div><div class="t m0 x3 h6 y13e ff1 fs2 fc0 sc0 ls0 ws0">模型<span class="_ _23"></span>的参数<span class="_ _23"></span>可以从<span class="_ _23"></span>训练<span class="_ _23"></span>集学习<span class="_ _23"></span>到，模型<span class="_ _23"></span>的超参<span class="_ _23"></span>数无法<span class="_ _23"></span>从训<span class="_ _23"></span>练集中<span class="_ _23"></span>直接学<span class="_ _23"></span>习到。模<span class="_ _23"></span>型的<span class="_ _23"></span>超参数<span class="_ _23"></span>应</div><div class="t m0 x3 h6 y13f ff1 fs2 fc0 sc0 ls0 ws0">如何学习？<span class="_ _29"></span>在解答这一问题之前，<span class="_ _2e"></span>首先要介绍模型超参数选择不当导致的问题<span class="_ _12"></span>—<span class="_ _28"></span>—欠拟合和过拟</div><div class="t m0 x3 h6 y140 ff1 fs2 fc0 sc0 ls0 ws0">合。</div><div class="t m0 x2 h9 y141 ff5 fs6 fc0 sc0 ls0 ws0">2.2<span class="_ _24"> </span><span class="ff9">偏差</span>-<span class="ff9">方差分解</span></div><div class="t m0 x3 h6 y20 ff4 fs2 fc0 sc0 ls0 ws0">定义<span class="ff6">2.1<span class="_ _5"> </span></span><span class="fc1">误差<span class="_ _e"> </span><span class="ff6">(error)</span>：<span class="_ _d"> </span></span><span class="ff1">样本的真实值与预测结果之间的差异。</span></div><div class="t m0 xa h4 y3 ff3 fs2 fc0 sc0 ls0 ws0">7</div></div><div class="pi" data-data='{"ctm":[1.500000,0.000000,0.000000,1.500000,0.000000,0.000000]}'></div></div>
<div id="pfe" class="pf w0 h0" data-page-no="e"><div class="pc pce w0 h0"><img class="bi x3 y142 w1 h14" alt="" src="bge.png"/><div class="t m0 x3 h7 y21 ff3 fs5 fc0 sc0 ls0 ws0">2.2<span class="_ _8"> </span><span class="ff7">偏差</span>-<span class="ff7">方差分解</span></div><div class="t m0 x12 h6 y143 ff1 fs2 fc0 sc0 ls0 ws0">训练误差<span class="_ _d"> </span><span class="ff3">(training<span class="_ _d"> </span>error)</span>：在训练集上的误差，又称为经验误差（<span class="ff3">empirical<span class="_ _d"> </span>error</span>）</div><div class="t m0 x12 h6 y144 ff1 fs2 fc0 sc0 ls0 ws0">测试误差（<span class="ff3">test<span class="_ _d"> </span>error</span>）<span class="_ _26"></span>：在测试集上的误差。</div><div class="t m0 x12 h6 y145 ff1 fs2 fc0 sc0 ls0 ws0">泛化误差（<span class="ff3">generalization<span class="_ _25"> </span>error</span>）<span class="_ _2f"></span>：在所有新样本上的误差，即测试误差<span class="_ _12"></span>（测试集的样本都</div><div class="t m0 x12 h6 y146 ff1 fs2 fc0 sc0 ls0 ws0">是新样本）<span class="_ _26"></span>。</div><div class="t m0 x3 h6 y147 ff1 fs2 fc0 sc0 ls0 ws0">训练误差很小是没什么用的，<span class="_ _2e"></span>我们希望得到在新样本上表现得很好的学习器，<span class="_ _2a"></span>即泛化误差小的学</div><div class="t m0 x3 h6 y148 ff1 fs2 fc0 sc0 ls0 ws0">习器。因此，我们应该让学习器尽可能<span class="_ _23"></span>地从训练集中学出普适性的“一般特征”<span class="_ _2f"></span>，这样在遇到新</div><div class="t m0 x3 h6 y149 ff1 fs2 fc0 sc0 ls0 ws0">样本时才能做出正确的判别。<span class="_ _27"></span>然而，<span class="_ _30"></span>当学习器把训练集学得<span class="_ _28"></span>“太好”<span class="_ _28"></span>的时候，<span class="_ _30"></span>即把一些训练样本</div><div class="t m0 x3 h6 y14a ff1 fs2 fc0 sc0 ls0 ws0">的自身特点当做了普遍特征；<span class="_ _2e"></span>同时也有学习能力不足的情况，<span class="_ _2a"></span>即训练集的基本特征都没有学习出</div><div class="t m0 x3 h6 y14b ff1 fs2 fc0 sc0 ls0 ws0">来。我们定义：</div><div class="t m0 x3 h6 y14c ff1 fs2 fc0 sc0 ls0 ws0">过拟合（<span class="ff3">o<span class="_ _12"></span>v<span class="_ _12"></span>ertting<span class="ff1">）<span class="_ _26"></span>：当训练误差减小，测试误差增大，则存在过拟合。</span></span></div><div class="t m0 x3 h6 y14d ff1 fs2 fc0 sc0 ls0 ws0">欠拟合（<span class="ff3">undertting</span>）<span class="_ _26"></span>：训练误差和测试误差都在减小，则存在欠拟合。</div><div class="t m0 x73 h6 y14e ff1 fs2 fc0 sc0 ls0 ws0">图<span class="_ _d"> </span><span class="ff3">2.2:<span class="_ _35"> </span></span>欠拟合与过拟合</div><div class="t m0 x3 h6 y14f ff1 fs2 fc0 sc0 ls0 ws0">可以得知：<span class="_ _27"></span>在过拟合问题中，<span class="_ _27"></span>训练误差十分小，<span class="_ _27"></span>但测试误差教大；<span class="_ _28"></span>在欠拟合问题中，<span class="_ _27"></span>训练误差和</div><div class="t m0 x3 h6 y150 ff1 fs2 fc0 sc0 ls0 ws0">测试误差都比较大。<span class="_ _30"></span>目前，<span class="_ _27"></span>欠拟合问题比较容易克服，<span class="_ _30"></span>例如增加迭代次数等，<span class="_ _30"></span>但过拟合问题还没</div><div class="t m0 x3 h6 y151 ff1 fs2 fc0 sc0 ls0 ws0">有十分好的解决方案，过拟合是机器学习面临的关键障碍。</div><div class="t m0 x3 h6 y152 ff1 fs2 fc0 sc0 ls0 ws0">对于一般的回归问题，<span class="_ _2a"></span>如果我们假设<span class="_ _25"> </span><span class="ff15">Y <span class="fff">=<span class="_ _32"> </span><span class="ffd">f<span class="_ _34"></span></span>(</span>X<span class="fff">)<span class="_ _33"> </span>+<span class="_ _33"> </span><span class="ffd">ϵ</span></span></span>，<span class="_ _2a"></span>其中<span class="_ _25"> </span><span class="ff15">E<span class="fff">(<span class="ffd">ϵ</span>)<span class="_ _32"> </span>=<span class="_ _32"> </span>0</span></span>，<span class="_ _2a"></span>并且<span class="_ _25"> </span><span class="ff15">Var<span class="fff">(<span class="ffd">ϵ</span>)<span class="_ _32"> </span>=<span class="_ _32"> </span><span class="ffd">σ</span></span></span></div><div class="t m0 x8e ha y153 ff12 fs7 fc0 sc0 ls0 ws0">2</div><div class="t m0 x8e hb y154 ffc fs7 fc0 sc0 ls0 ws0">ϵ</div><div class="t m0 x8f h6 y152 ff1 fs2 fc0 sc0 ls0 ws0">。<span class="_ _2e"></span>如果使用</div><div class="t m0 x3 h6 y155 ff1 fs2 fc0 sc0 ls0 ws0">均方误差<span class="_ _27"></span>（<span class="ff3">mean<span class="_ _25"> </span>squared<span class="_ _25"> </span>error</span>，<span class="_ _30"></span><span class="ff3">MSE<span class="ff1">）<span class="_ _27"></span>来衡量模型拟合程度的优劣的情况下，<span class="_ _30"></span>在输入点<span class="_ _25"> </span><span class="ff15">X <span class="fff">=<span class="_ _32"> </span><span class="ffd">x</span></span></span></span></span></div><div class="t m0 x90 ha y156 ff12 fs7 fc0 sc0 ls0 ws0">0</div><div class="t m0 x3 h6 y157 ff1 fs2 fc0 sc0 ls0 ws0">处，回归拟合值</div><div class="t m0 x91 h4 y158 fff fs2 fc0 sc0 ls0 ws0">ˆ</div><div class="t m0 x92 h6 y157 ffd fs2 fc0 sc0 ls0 ws0">f<span class="_ _34"></span><span class="fff">(<span class="ff15">X</span>)<span class="_ _d"> </span><span class="ff1">的均方误差：</span></span></div><div class="t m0 x54 h4 y159 ff3 fs2 fc0 sc0 ls0 ws0">MSE<span class="_ _31"> </span><span class="fff">(<span class="ffd">x</span></span></div><div class="t m0 x8c ha y15a ff12 fs7 fc0 sc0 ls0 ws0">0</div><div class="t m0 x6c h4 y159 fff fs2 fc0 sc0 ls0 ws0">)<span class="_ _32"> </span>=<span class="_ _32"> </span><span class="ff3">E</span></div><div class="t m0 x93 hc y15b ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x2 hc y15c ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x4e h4 y159 ffd fs2 fc0 sc0 ls0 ws0">Y<span class="_ _35"> </span><span class="ffe">−</span></div><div class="t m0 x94 h4 y15d fff fs2 fc0 sc0 ls0 ws0">ˆ</div><div class="t m0 x95 h4 y159 ffd fs2 fc0 sc0 ls0 ws0">f<span class="_ _a"> </span><span class="fff">(</span>x</div><div class="t m0 x96 ha y15a ff12 fs7 fc0 sc0 ls0 ws0">0</div><div class="t m0 x5c h4 y159 fff fs2 fc0 sc0 ls0 ws0">)</div><div class="t m0 x34 hc y15c ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x97 ha y15e ff12 fs7 fc0 sc0 ls0 ws0">2</div><div class="t m0 x98 h4 y159 ffe fs2 fc0 sc0 ls0 ws0">|<span class="ffd">X<span class="_ _e"> </span><span class="fff">=<span class="_ _a"> </span></span>x</span></div><div class="t m0 x99 ha y15a ff12 fs7 fc0 sc0 ls0 ws0">0</div><div class="t m0 x44 hc y15b ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x38 h4 y15f fff fs2 fc0 sc0 ls0 ws0">=<span class="_ _32"> </span><span class="ffd">σ</span></div><div class="t m0 x9a ha y160 ff12 fs7 fc0 sc0 ls0 ws0">2</div><div class="t m0 x9 hb y161 ffc fs7 fc0 sc0 ls0 ws0">ε</div><div class="t m0 xf h4 y15f fff fs2 fc0 sc0 ls0 ws0">+</div><div class="t m0 x9b hc y162 ff11 fs2 fc0 sc0 ls0 ws0">h</div><div class="t m0 x73 h4 y15f ff3 fs2 fc0 sc0 ls0 ws0">E</div><div class="t m0 x9c h4 y163 fff fs2 fc0 sc0 ls0 ws0">ˆ</div><div class="t m0 x48 h4 y15f ffd fs2 fc0 sc0 ls0 ws0">f<span class="_ _a"> </span><span class="fff">(</span>x</div><div class="t m0 x9d ha y164 ff12 fs7 fc0 sc0 ls0 ws0">0</div><div class="t m0 x17 h4 y15f fff fs2 fc0 sc0 ls0 ws0">)<span class="_ _37"> </span><span class="ffe">−<span class="_ _37"> </span><span class="ffd">f<span class="_ _a"> </span></span></span>(<span class="ffd">x</span></div><div class="t m0 x5f ha y164 ff12 fs7 fc0 sc0 ls0 ws0">0</div><div class="t m0 x45 h4 y15f fff fs2 fc0 sc0 ls0 ws0">)</div><div class="t m0 x9e hc y162 ff11 fs2 fc0 sc0 ls0 ws0">i</div><div class="t m0 x71 ha y165 ff12 fs7 fc0 sc0 ls0 ws0">2</div><div class="t m0 x99 h4 y15f fff fs2 fc0 sc0 ls0 ws0">+<span class="_ _37"> </span><span class="ff3">E</span></div><div class="t m0 x9f hc y162 ff11 fs2 fc0 sc0 ls0 ws0">h</div><div class="t m0 xa0 h4 y163 fff fs2 fc0 sc0 ls0 ws0">ˆ</div><div class="t m0 x3a h4 y15f ffd fs2 fc0 sc0 ls0 ws0">f<span class="_ _a"> </span><span class="fff">(</span>x</div><div class="t m0 xa1 ha y164 ff12 fs7 fc0 sc0 ls0 ws0">0</div><div class="t m0 xa2 h4 y15f fff fs2 fc0 sc0 ls0 ws0">)<span class="_ _37"> </span><span class="ffe">−<span class="_ _37"> </span><span class="ffd">E</span></span></div><div class="t m0 xa3 h4 y163 fff fs2 fc0 sc0 ls0 ws0">ˆ</div><div class="t m0 xa4 h4 y15f ffd fs2 fc0 sc0 ls0 ws0">f<span class="_ _a"> </span><span class="fff">(</span>x</div><div class="t m0 xa5 ha y164 ff12 fs7 fc0 sc0 ls0 ws0">0</div><div class="t m0 xa6 h4 y15f fff fs2 fc0 sc0 ls0 ws0">)</div><div class="t m0 xa7 hc y162 ff11 fs2 fc0 sc0 ls0 ws0">i</div><div class="t m0 xa8 ha y165 ff12 fs7 fc0 sc0 ls0 ws0">2</div><div class="t m0 x38 h4 y166 fff fs2 fc0 sc0 ls0 ws0">=<span class="_ _32"> </span><span class="ffd">σ</span></div><div class="t m0 x9a ha y167 ff12 fs7 fc0 sc0 ls0 ws0">2</div><div class="t m0 x9 hb y168 ffc fs7 fc0 sc0 ls0 ws0">ε</div><div class="t m0 xf h4 y166 fff fs2 fc0 sc0 ls0 ws0">+<span class="_ _37"> </span><span class="ff3">Bias</span></div><div class="t m0 xe ha y167 ff12 fs7 fc0 sc0 ls0 ws0">2</div><div class="t m0 x5b hc y169 ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x17 h4 y16a fff fs2 fc0 sc0 ls0 ws0">ˆ</div><div class="t m0 xa9 h4 y166 ffd fs2 fc0 sc0 ls0 ws0">f<span class="_ _a"> </span><span class="fff">(</span>x</div><div class="t m0 x65 ha y16b ff12 fs7 fc0 sc0 ls0 ws0">0</div><div class="t m0 x6f h4 y166 fff fs2 fc0 sc0 ls0 ws0">)</div><div class="t m0 x81 hc y169 ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 xaa h4 y166 fff fs2 fc0 sc0 ls0 ws0">+<span class="_ _37"> </span><span class="ff3">Var</span></div><div class="t m0 xab hc y169 ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x61 h4 y16a fff fs2 fc0 sc0 ls0 ws0">ˆ</div><div class="t m0 x79 h4 y166 ffd fs2 fc0 sc0 ls0 ws0">f<span class="_ _a"> </span><span class="fff">(</span>x</div><div class="t m0 xac ha y16b ff12 fs7 fc0 sc0 ls0 ws0">0</div><div class="t m0 xad h4 y166 fff fs2 fc0 sc0 ls0 ws0">)</div><div class="t m0 xae hc y169 ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x38 h4 y16c fff fs2 fc0 sc0 ls0 ws0">=<span class="_ _3d"> </span><span class="ff3">Irreducible<span class="_ _d"> </span>Error<span class="_ _18"> </span></span>+<span class="_ _19"> </span><span class="ff3">Bias</span></div><div class="t m0 x1e ha y16d ff12 fs7 fc0 sc0 ls0 ws0">2</div><div class="t m0 x26 h4 y16c fff fs2 fc0 sc0 ls0 ws0">+<span class="_ _18"> </span><span class="ff3">V<span class="_ _28"></span>ariance</span></div><div class="t m0 xaf h4 y16e ff3 fs2 fc0 sc0 ls0 ws0">(2.1)</div><div class="t m0 x12 h6 y16f ff1 fs2 fc0 sc0 ls0 ws0">注意，<span class="_ _27"></span>输入点<span class="_ _d"> </span><span class="ff15">X <span class="fff">=<span class="_ _a"> </span><span class="ffd">x</span></span></span></div><div class="t m0 x8b ha y170 ff12 fs7 fc0 sc0 ls0 ws0">0</div><div class="t m0 xb0 h6 y16f ff1 fs2 fc0 sc0 ls0 ws0">是固定的，<span class="_ _27"></span><span class="ff15">Y <span class="fff">=<span class="_ _32"> </span><span class="ffd">f<span class="_ _34"> </span></span>(</span>X</span></div><div class="t m0 x35 h12 y170 ff15 fs7 fc0 sc0 ls0 ws0">0</div><div class="t m0 x53 h4 y16f fff fs2 fc0 sc0 ls0 ws0">)<span class="_ _38"> </span>+<span class="_ _38"> </span><span class="ffd">ϵ<span class="_ _32"> </span></span>=<span class="_ _32"> </span><span class="ffd">Y</span></div><div class="t m0 x37 ha y170 ff12 fs7 fc0 sc0 ls0 ws0">0</div><div class="t m0 xab h6 y16f ff1 fs2 fc0 sc0 ls0 ws0">，<span class="_ _27"></span><span class="ff15">Y<span class="_ _d"> </span><span class="ff1">也是固定的，<span class="_ _27"></span>即常数。<span class="_ _28"></span>而不固定</span></span></div><div class="t m0 x12 h6 y171 ff1 fs2 fc0 sc0 ls0 ws0">的是</div><div class="t m0 x6 h4 y172 fff fs2 fc0 sc0 ls0 ws0">ˆ</div><div class="t m0 xb1 h4 y171 ffd fs2 fc0 sc0 ls0 ws0">f<span class="_ _34"></span><span class="fff">(</span>x</div><div class="t m0 xb2 ha y173 ff12 fs7 fc0 sc0 ls0 ws0">0</div><div class="t m0 xb3 h6 y171 fff fs2 fc0 sc0 ls0 ws0">)<span class="ff1">，显然</span></div><div class="t m0 xb4 h4 y172 fff fs2 fc0 sc0 ls0 ws0">ˆ</div><div class="t m0 xb5 h4 y171 ffd fs2 fc0 sc0 ls0 ws0">f<span class="_ _34"></span><span class="fff">(</span>x</div><div class="t m0 xb0 ha y173 ff12 fs7 fc0 sc0 ls0 ws0">0</div><div class="t m0 x83 h6 y171 fff fs2 fc0 sc0 ls0 ws0">)<span class="_ _d"> </span><span class="ff1">不固定的原因是</span></div><div class="t m0 x35 h4 y172 fff fs2 fc0 sc0 ls0 ws0">ˆ</div><div class="t m0 x34 h6 y171 ffd fs2 fc0 sc0 ls0 ws0">f<span class="_ _35"> </span><span class="ff1">是不固定的。</span></div><div class="t m0 xb6 h4 y172 fff fs2 fc0 sc0 ls0 ws0">ˆ</div><div class="t m0 xa0 h6 y171 ffd fs2 fc0 sc0 ls0 ws0">f<span class="_ _35"> </span><span class="ff1">不固定的原因可能是训练集的</span></div><div class="t m0 x12 h6 y174 ff1 fs2 fc0 sc0 ls0 ws0">不同<span class="_ _30"></span>（训练集不同会导致模型参数取值不同）<span class="_ _2f"></span>，<span class="_ _3a"></span>或者模型的假设空间不同。<span class="_ _30"></span>但在这里，<span class="_ _29"></span>只能</div><div class="t m0 x12 h6 y175 ff1 fs2 fc0 sc0 ls0 ws0">是训练<span class="_ _23"></span>集的不同，<span class="_ _23"></span>因为<span class="_ _e"> </span><span class="ff3">MSE<span class="fff">(<span class="ffd">x</span></span></span></div><div class="t m0 x4e ha y176 ff12 fs7 fc0 sc0 ls0 ws0">0</div><div class="t m0 x51 h6 y175 fff fs2 fc0 sc0 ls0 ws0">)<span class="_ _e"> </span><span class="ff1">用于<span class="_ _23"></span>评估模型<span class="_ _23"></span>的过拟合和<span class="_ _23"></span>欠拟合情<span class="_ _23"></span>况，假设空<span class="_ _23"></span>间必须是</span></div><div class="t m0 x12 h6 y177 ff1 fs2 fc0 sc0 ls0 ws0">固定的。</div><div class="t m0 x12 h6 y178 ff1 fs2 fc0 sc0 ls0 ws0">很多资料在推导均方误差分解公式时，<span class="_ _29"></span>并没有指明<span class="_ _d"> </span><span class="ff15">Y<span class="_ _25"> </span></span>是常数，<span class="_ _30"></span>或者将<span class="_ _25"> </span><span class="ff15">Y <span class="fff">=<span class="_ _32"> </span><span class="ffd">f<span class="_ _34"></span></span>(</span>X<span class="fff">)<span class="_ _25"> </span></span></span>描述为一</div><div class="t m0 x12 h6 y179 ff1 fs2 fc0 sc0 ls0 ws0">个确定的函数，<span class="_ _23"></span>这是造成<span class="_ _d"> </span><span class="ff3">MSE<span class="_ _e"> </span></span>困惑的原因。实<span class="_ _23"></span>际上，确定的函数（参数确<span class="_ _23"></span>定的函数）并</div><div class="t m0 x12 h6 y17a ff1 fs2 fc0 sc0 ls0 ws0">不意味着<span class="_ _d"> </span><span class="ffd">Y<span class="_ _18"> </span></span>值是确定的，<span class="ffd">Y<span class="_ _19"> </span></span>值是否是常数，还取决于<span class="_ _d"> </span><span class="ffd">x<span class="_ _d"> </span></span>值是否给定。</div><div class="t m0 x3 h4 y3 ff3 fs2 fc0 sc0 ls0 ws0">8</div></div><div class="pi" data-data='{"ctm":[1.500000,0.000000,0.000000,1.500000,0.000000,0.000000]}'></div></div>
<div id="pff" class="pf w0 h0" data-page-no="f"><div class="pc pcf w0 h0"><img class="bi x89 y17b w3 h15" alt="" src="bgf.png"/><div class="t m0 xa8 h7 y21 ff3 fs5 fc0 sc0 ls0 ws0">2.2<span class="_ _8"> </span><span class="ff7">偏差</span>-<span class="ff7">方差分解</span></div><div class="t m0 x3 h6 y22 ff3 fs2 fc0 sc0 ls0 ws0">V<span class="_ _27"></span>ariance<span class="_ _e"> </span><span class="ff1">是指一个模型在不<span class="_ _23"></span>同训练集上的差异，可以<span class="_ _23"></span>用来衡量一个模型是否容<span class="_ _23"></span>易过拟合；</span>Bias</div><div class="t m0 x90 ha y17c ff12 fs7 fc0 sc0 ls0 ws0">2</div><div class="t m0 x3 h6 y17d ff1 fs2 fc0 sc0 ls0 ws0">代表<span class="_ _23"></span>一个模<span class="_ _23"></span>型在不<span class="_ _23"></span>同训练<span class="_ _23"></span>集上的<span class="_ _23"></span>平均<span class="_ _23"></span>性能和<span class="_ _23"></span>最优模<span class="_ _23"></span>型的差<span class="_ _23"></span>异，可以<span class="_ _23"></span>用来衡<span class="_ _23"></span>量一个<span class="_ _23"></span>模型<span class="_ _23"></span>的拟合<span class="_ _23"></span>能</div><div class="t m0 x3 h6 y17e ff1 fs2 fc0 sc0 ls0 ws0">力。</div><div class="t m0 xb7 h6 y17f ff1 fs2 fc0 sc0 ls0 ws0">图<span class="_ _d"> </span><span class="ff3">2.3:<span class="_ _35"> </span></span>机器学习模型的四种偏差和方差组合情况</div><div class="t m0 x3 h6 y180 ff1 fs2 fc0 sc0 ls0 ws0">进一<span class="_ _23"></span>步看，<span class="ff3">V<span class="_ _27"></span>ariance<span class="_ _e"> </span><span class="ff1">代<span class="_ _23"></span>表我们<span class="_ _23"></span>使用不<span class="_ _23"></span>同训练集<span class="_ _23"></span>时模型<span class="_ _23"></span>表现的差<span class="_ _23"></span>异。由于<span class="_ _23"></span>模型的<span class="_ _23"></span>构建通常<span class="_ _23"></span>和训练</span></span></div><div class="t m0 x3 h6 y181 ff1 fs2 fc0 sc0 ls0 ws0">集的统计性质有关，<span class="_ _2a"></span>不同的训练集会导致模型出现差异。<span class="_ _2e"></span>如果某个机器学习方法得到的模型具有</div><div class="t m0 x3 h6 y182 ff1 fs2 fc0 sc0 ls0 ws0">较大的方差，训练集只要有少许变化，模型会有很大的改变。复杂的模型一般具有更大的方差。</div><div class="t m0 x3 h6 y183 ff1 fs2 fc0 sc0 ls0 ws0">第二项偏差代表实际模型与理想模型的差别。<span class="_ _2e"></span>例如线性模型是最常用的模型之一，<span class="_ _2a"></span>而真实世界往</div><div class="t m0 x3 h6 y184 ff1 fs2 fc0 sc0 ls0 ws0">往是非常复杂的，<span class="_ _29"></span>当我们用线性模型这样的简单模型去解释世界时，<span class="_ _3a"></span>很可能会出现问题。<span class="_ _30"></span>如果我</div><div class="t m0 x3 h6 y185 ff1 fs2 fc0 sc0 ls0 ws0">们用复杂度为<span class="_ _32"> </span><span class="ff3">2 </span>的线性模型<span class="_ _29"></span>（包含截距和斜率两个参数）<span class="_ _3a"></span>拟合一个非线性模型<span class="_ _3a"></span>（模型复杂度远大</div><div class="t m0 x3 h6 y186 ff1 fs2 fc0 sc0 ls0 ws0">于<span class="_ _a"> </span><span class="ff3">2</span>）<span class="_ _26"></span>，<span class="_ _3e"></span>将产生较大的均方误差，<span class="_ _3e"></span>其中很大一部分来源于偏差，<span class="_ _3b"></span>这种情况称为欠拟合<span class="_ _2b"></span>（<span class="ff3">undertting</span>）<span class="_ _26"></span>。</div><div class="t m0 x3 h6 y187 ff1 fs2 fc0 sc0 ls0 ws0">当我们不断增加模型的复杂程度，<span class="_ _29"></span>模型的均方误差不断下降，<span class="_ _29"></span>整体表现逐渐提升，<span class="_ _29"></span>主要原因是偏</div><div class="t m0 x3 h6 y188 ff1 fs2 fc0 sc0 ls0 ws0">差逐渐下降，<span class="_ _29"></span>说明模型更加符合真实的情况。<span class="_ _29"></span>然而随着模型的复杂程度进一步增加，<span class="_ _29"></span>可以发现样</div><div class="t m0 x3 h6 y189 ff1 fs2 fc0 sc0 ls0 ws0">本差异导致的方差急剧上升，<span class="_ _2e"></span>说明复杂的模型更多地把握住了属于训练样本独有的特性，<span class="_ _2a"></span>而非数</div><div class="t m0 x3 h6 y18a ff1 fs2 fc0 sc0 ls0 ws0">据的共性，<span class="_ _30"></span>这种情况称为过拟合<span class="_ _27"></span>（<span class="ff3">ov<span class="_ _28"></span>ertting<span class="ff1">）<span class="_ _2f"></span>。<span class="_ _30"></span>均方误差、<span class="_ _30"></span>方差和偏差随模型复杂度的变化关系</span></span></div><div class="t m0 x3 h6 y18b ff1 fs2 fc0 sc0 ls0 ws0">如下图所示。</div><div class="t m0 xb8 h6 y18c ff1 fs2 fc0 sc0 ls0 ws0">图<span class="_ _d"> </span><span class="ff3">2.4:<span class="_ _35"> </span></span>均方误差、方差和偏差随模型复杂度的变化关系（模型的函数空间不同）</div><div class="t m0 x3 h6 y18d ff1 fs2 fc0 sc0 ls0 ws0">偏差<span class="_ _23"></span>和方差<span class="_ _23"></span>分解给<span class="_ _23"></span>机器<span class="_ _23"></span>学习模<span class="_ _23"></span>型提供<span class="_ _23"></span>了一种<span class="_ _23"></span>分析途<span class="_ _23"></span>径。但<span class="_ _23"></span>在实际<span class="_ _23"></span>操作中<span class="_ _23"></span>难以直<span class="_ _23"></span>接衡<span class="_ _23"></span>量．一般<span class="_ _23"></span>来</div><div class="t m0 x3 h6 y18e ff1 fs2 fc0 sc0 ls0 ws0">说。<span class="_ _30"></span>当一个模型在训练集上的错误率比较高时。<span class="_ _27"></span>说明模型的拟合能力不够。<span class="_ _30"></span>偏差比较高．<span class="_ _30"></span>这种情</div><div class="t m0 x3 h6 y20 ff1 fs2 fc0 sc0 ls0 ws0">况可以通过增加数据特征、<span class="_ _29"></span>提高模型复杂度、<span class="_ _29"></span>减小正则化系数等操作来改进．<span class="_ _29"></span>当模型在训练集上</div><div class="t m0 xd h4 y3 ff3 fs2 fc0 sc0 ls0 ws0">9</div></div><div class="pi" data-data='{"ctm":[1.500000,0.000000,0.000000,1.500000,0.000000,0.000000]}'></div></div>
<div id="pf10" class="pf w0 h0" data-page-no="10"><div class="pc pc10 w0 h0"><img class="bi xb9 y18f w4 h16" alt="" src="bg10.png"/><div class="t m0 x3 h7 y21 ff3 fs5 fc0 sc0 ls0 ws0">2.3<span class="_ _8"> </span><span class="ff7">交叉验证</span></div><div class="t m0 x3 h6 y22 ff1 fs2 fc0 sc0 ls0 ws0">的错误率比较低。<span class="_ _30"></span>但验证集上的错误率比较高时。<span class="_ _27"></span>说明模型过拟合。<span class="_ _30"></span>方差比较高．<span class="_ _30"></span>这种情况可以</div><div class="t m0 x3 h6 y17d ff1 fs2 fc0 sc0 ls0 ws0">通过降低模型复杂度、<span class="_ _30"></span>加大正则化系数、<span class="_ _30"></span>引入先验等方法来缓解．<span class="_ _30"></span>此外。<span class="_ _27"></span>还有一种有效降低方差</div><div class="t m0 x3 h6 y17e ff1 fs2 fc0 sc0 ls0 ws0">的方法为集成模型。即通过多个高方差模型的平均来降低方差．</div><div class="t m0 x11 h9 y190 ff5 fs6 fc0 sc0 ls0 ws0">2.3<span class="_ _24"> </span><span class="ff9">交叉验证</span></div><div class="t m0 x3 h6 y191 ff1 fs2 fc0 sc0 ls0 ws0">避免过拟合的重要方法之一是进行交叉验证<span class="_ _3a"></span>（<span class="ff3">cross-v<span class="_ _28"></span>alidation<span class="ff1">）<span class="_ _26"></span>。<span class="_ _2e"></span>英国统计学家<span class="_ _25"> </span><span class="ff3">Mervyn Stone<span class="_ _25"> </span></span>和</span></span></div><div class="t m0 x3 h6 y192 ff1 fs2 fc0 sc0 ls0 ws0">美国<span class="_ _23"></span>统计学<span class="_ _23"></span>家<span class="_ _e"> </span><span class="ff3">Seymour<span class="_ _1e"> </span>Geisser<span class="_ _1e"> </span></span>是<span class="_ _23"></span>交叉验<span class="_ _23"></span>证理<span class="_ _23"></span>论的先<span class="_ _23"></span>驱。交叉<span class="_ _23"></span>验证理<span class="_ _23"></span>论并非<span class="_ _23"></span>仅针对<span class="_ _23"></span>机器<span class="_ _23"></span>学习模</div><div class="t m0 x3 h6 y193 ff1 fs2 fc0 sc0 ls0 ws0">型。<span class="_ _3a"></span>而是针对任何统计模型。<span class="_ _3a"></span><span class="ff3 fc2">Stone<span class="_ _25"> </span><span class="ff1">和<span class="_ _25"> </span></span>Geisser<span class="_ _25"> </span><span class="ff1">在<span class="_ _32"> </span></span>1974<span class="_ _25"> </span><span class="ff1">年分别独立地提出。<span class="_ _29"></span>在评价某个统计模型</span></span></div><div class="t m0 x3 h6 y194 ff1 fs2 fc2 sc0 ls0 ws0">的表现时。应使用在估计模型环节未使用过的数据。<span class="_ _28"></span><span class="fc0">随后<span class="_ _d"> </span><span class="ff3">Devijver<span class="_ _25"> </span>Pierre</span>（<span class="ff3">1982</span>）<span class="_ _26"></span>、<span class="ff3">K<span class="_ _12"></span>oha<span class="_ _12"></span>vi<span class="_ _d"> </span>Ron</span></span></div><div class="t m0 x14 h6 y195 ff1 fs2 fc0 sc0 ls0 ws0">（<span class="ff3">1995</span>）等将交叉验<span class="_ _23"></span>证的思想引入模式识别以<span class="_ _23"></span>及机器学习。在评价机器学<span class="_ _23"></span>习模型表现时。使用不</div><div class="t m0 x3 h6 y196 ff1 fs2 fc0 sc0 ls0 ws0">曾在<span class="_ _23"></span>训练环<span class="_ _23"></span>节出<span class="_ _23"></span>现过的<span class="_ _23"></span>样本进<span class="_ _23"></span>行验证。<span class="fc2">如<span class="_ _23"></span>果模<span class="_ _23"></span>型在验<span class="_ _23"></span>证时性<span class="_ _23"></span>能和<span class="_ _23"></span>训练时<span class="_ _23"></span>大致相<span class="_ _23"></span>同。那么<span class="_ _23"></span>就可<span class="_ _23"></span>以</span></div><div class="t m0 x3 h6 y197 ff1 fs2 fc2 sc0 ls0 ws0">确信模型真的<span class="_ _28"></span>“学会”<span class="_ _28"></span>了如何发现数据中的一般规律。<span class="_ _27"></span>而不是<span class="_ _28"></span>“记住”<span class="_ _28"></span>训练样本。<span class="_ _30"></span><span class="fc0">这和学生考试</span></div><div class="t m0 x3 h6 y198 ff1 fs2 fc0 sc0 ls0 ws0">的情形类似。要想考察学生是否掌握<span class="_ _23"></span>了某个知识点。不能使用课堂上讲过的“例题”<span class="_ _2f"></span>。而应当使</div><div class="t m0 x3 h6 y199 ff1 fs2 fc0 sc0 ls0 ws0">用相似的“习题”<span class="_ _26"></span>。</div><div class="t m0 x3 h6 y19a ff1 fs2 fc0 sc0 ls0 ws0">交叉验证的核心思想是先将全部样本划分成两部分。<span class="_ _29"></span>一部分用来训练模型。<span class="_ _29"></span>称为训练集；<span class="_ _29"></span>另外一</div><div class="t m0 x3 h6 y19b ff1 fs2 fc0 sc0 ls0 ws0">部分用来验证模型。<span class="_ _29"></span>称为验证集。<span class="_ _29"></span>随后考察模型在训练集和验证集的表现是否接近。<span class="_ _29"></span>如果两者接</div><div class="t m0 x3 h6 y19c ff1 fs2 fc0 sc0 ls0 ws0">近。<span class="_ _29"></span>说明模型具备较好的预测性能；<span class="_ _3a"></span>如果训练集的表现远优于验证集。<span class="_ _30"></span>说明模型存在过拟合的风</div><div class="t m0 x3 h6 y19d ff1 fs2 fc0 sc0 ls0 ws0">险。</div><div class="t m0 x3 h6 y19e ff1 fs2 fc0 sc0 ls0 ws0">当我<span class="_ _23"></span>们需要<span class="_ _23"></span>对不同<span class="_ _23"></span>超参<span class="_ _23"></span>数设置<span class="_ _23"></span>下的多<span class="_ _23"></span>个模型<span class="_ _23"></span>进行比<span class="_ _23"></span>较时。<span class="_ _23"></span>可以考<span class="_ _23"></span>察模型<span class="_ _23"></span>在验证<span class="_ _23"></span>集的<span class="_ _23"></span>表现。选<span class="_ _23"></span>择</div><div class="t m0 x3 h6 y19f ff1 fs2 fc0 sc0 ls0 ws0">验证集表现最优的那组超<span class="_ _23"></span>参数作为最终模型的超参数。这一过程称为调参<span class="_ _23"></span>（<span class="ff3">parameter<span class="_ _25"> </span>tuning</span>）<span class="_ _3e"></span>。</div><div class="t m0 x3 h6 y1a0 ff1 fs2 fc0 sc0 ls0 ws0">虽然名为“调参”<span class="_ _26"></span>。本质上是“调超参”<span class="_ _2f"></span>。</div><div class="t m0 x3 h6 y1a1 ff1 fs2 fc0 sc0 ls0 ws0">根据训练集和验证集的划分方式。<span class="_ _3a"></span>交叉验证方法又可以细分为简单交叉验证、<span class="_ _3a"></span><span class="ff3">K<span class="_ _25"> </span><span class="ff1">折交叉验证、<span class="_ _3a"></span>留</span></span></div><div class="t m0 x3 h6 y1a2 ff1 fs2 fc0 sc0 ls0 ws0">一法、留<span class="_ _d"> </span><span class="ff3">P<span class="_ _d"> </span></span>法和时序交叉验证。</div><div class="t m0 x3 hd y1a3 ff5 fs8 fc0 sc0 ls0 ws0">2.3.1<span class="_ _36"> </span><span class="ff9">简单交叉验证</span></div><div class="t m0 x3 h6 y1a4 ff1 fs2 fc0 sc0 ls0 ws0">从总样<span class="_ _23"></span>本中随机<span class="_ _23"></span>选取一定<span class="_ _23"></span>比例（如<span class="_ _1e"> </span><span class="ff3">30%</span>）的样<span class="_ _23"></span>本作为验<span class="_ _23"></span>证集。其余<span class="_ _23"></span>作为训练<span class="_ _23"></span>集。这种方<span class="_ _23"></span>法称为</div><div class="t m0 x3 h6 y1a5 ff1 fs2 fc0 sc0 ls0 ws0">简单交叉验证。也称为留出法交叉验证（<span class="ff3">hold-out<span class="_ _d"> </span>cross-v<span class="_ _28"></span>alidation<span class="ff1">）<span class="_ _2f"></span>。</span></span></div><div class="t m0 x3 h6 y1a6 ff1 fs2 fc0 sc0 ls0 ws0">优点：<span class="_ _25"> </span><span class="ff3">1<span class="_ _25"> </span></span>只需要训练一次模型。速度较快。</div><div class="t m0 x3 h6 y1a7 ff1 fs2 fc0 sc0 ls0 ws0">缺点：<span class="_ _33"> </span><span class="ff3">1<span class="_ _d"> </span></span>一部分数据从未参与训练。<span class="_ _29"></span>可能削弱模型的准确性。<span class="_ _29"></span>在极端情况下。<span class="_ _30"></span>当验证集中数据本</div><div class="t m0 x3 h6 y1a8 ff1 fs2 fc0 sc0 ls0 ws0">身就是整体数据的<span class="_ _30"></span>“噪点”<span class="_ _30"></span>时。<span class="_ _3a"></span>模型的准确度将会大大降低。<span class="_ _31"> </span><span class="ff3">2<span class="_ _25"> </span></span>最终的模型评价结果可能受到训</div><div class="t m0 x3 h6 y1a9 ff1 fs2 fc0 sc0 ls0 ws0">练集和验证集划分过程中的随机因素干扰。</div><div class="t m0 x3 hd y1aa ff5 fs8 fc0 sc0 ls0 ws0">2.3.2<span class="_ _36"> </span>K<span class="_ _5"> </span><span class="ff9">折交叉验证</span></div><div class="t m0 x3 h6 y1ab ff1 fs2 fc0 sc0 ls0 ws0">针对简单交叉验证的缺陷。<span class="_ _3a"></span>研究者提出<span class="_ _25"> </span><span class="ff3">K </span>折交互验证<span class="_ _29"></span>（<span class="ff3">K-fold<span class="_ _25"> </span>cross-v<span class="_ _28"></span>alidation<span class="ff1">）<span class="_ _29"></span>的方法。<span class="_ _29"></span>随机将</span></span></div><div class="t m0 x3 h6 y1ac ff1 fs2 fc0 sc0 ls0 ws0">全体样本<span class="_ _23"></span>分为<span class="_ _d"> </span><span class="ff3">K<span class="_ _e"> </span></span>个部<span class="_ _23"></span>分。每次用其中<span class="_ _23"></span>的一部分作为<span class="_ _23"></span>验证集。其余部<span class="_ _23"></span>分作为训练集。<span class="_ _23"></span>重复<span class="_ _d"> </span><span class="ff3">K<span class="_ _e"> </span></span>次。</div><div class="t m0 x3 h6 y1ad ff1 fs2 fc0 sc0 ls0 ws0">直到所有部<span class="_ _23"></span>分都被验证过。下图展<span class="_ _23"></span>示了<span class="_ _d"> </span><span class="ff3">5<span class="_ _e"> </span></span>折交互验证的<span class="_ _23"></span>过程。将全体样本随机<span class="_ _23"></span>划分成<span class="_ _d"> </span><span class="ff3">5<span class="_ _e"> </span></span>个不重</div><div class="t m0 x3 h6 y1ae ff1 fs2 fc0 sc0 ls0 ws0">叠的部分。每次用<span class="_ _e"> </span><span class="ff3">4/5<span class="_ _d"> </span></span>作为<span class="_ _23"></span>训练集（粉色部分）<span class="_ _3e"></span>。其余<span class="_ _d"> </span><span class="ff3">1/5<span class="_ _e"> </span></span>部分作为验证<span class="_ _23"></span>集（灰色部分）<span class="_ _3e"></span>。最终</div><div class="t m0 x3 h6 y1af ff1 fs2 fc0 sc0 ls0 ws0">将得到<span class="_ _d"> </span><span class="ff3">5<span class="_ _d"> </span></span>个验证集的均方误差（或其它损失函数形式）<span class="_ _26"></span>。取均值作为验证集的平均表现。</div><div class="t m0 x3 hd y1b0 ff5 fs8 fc0 sc0 ls0 ws0">2.3.3<span class="_ _36"> </span><span class="ff9">留一法和留</span></div><div class="t m0 xba h17 y1b1 ff5 fs8 fc0 sc0 ls0 ws0">P</div><div class="t m0 x9a hd y1b0 ff9 fs8 fc0 sc0 ls0 ws0">法</div><div class="t m0 x3 h6 y18e ff1 fs2 fc0 sc0 ls0 ws0">除了<span class="_ _23"></span>将样本<span class="_ _23"></span>分成<span class="_ _1e"> </span><span class="ff3">K<span class="_ _1e"> </span></span>个部<span class="_ _23"></span>分。还可<span class="_ _23"></span>以每次<span class="_ _23"></span>取一<span class="_ _23"></span>个固定<span class="_ _23"></span>数目的<span class="_ _23"></span>样本作<span class="_ _23"></span>为验证<span class="_ _23"></span>集。假设<span class="_ _23"></span>样本<span class="_ _23"></span>量为<span class="_ _1e"> </span><span class="ff3">N</span>。</div><div class="t m0 x3 h6 y20 ff1 fs2 fc0 sc0 ls0 ws0">如<span class="_ _23"></span>果每<span class="_ _23"></span>次<span class="_ _23"></span>取一<span class="_ _23"></span>个<span class="_ _23"></span>样本<span class="_ _23"></span>验证。<span class="_ _23"></span>把<span class="_ _23"></span>其余<span class="_ _23"></span>样<span class="_ _23"></span>本用<span class="_ _23"></span>来<span class="_ _23"></span>训练。<span class="_ _23"></span>重<span class="_ _23"></span>复<span class="_ _35"> </span><span class="ff3">N<span class="_ _3f"> </span></span>次。<span class="_ _23"></span>这种<span class="_ _23"></span>方<span class="_ _23"></span>法称<span class="_ _23"></span>为<span class="_ _23"></span>留一<span class="_ _23"></span>法交<span class="_ _23"></span>叉<span class="_ _23"></span>验证</div><div class="t m0 x3 h4 y3 ff3 fs2 fc0 sc0 ls0 ws0">10</div></div><div class="pi" data-data='{"ctm":[1.500000,0.000000,0.000000,1.500000,0.000000,0.000000]}'></div></div>
<div id="pf11" class="pf w0 h0" data-page-no="11"><div class="pc pc11 w0 h0"><img class="bi x89 y1b2 w3 h18" alt="" src="bg11.png"/><div class="t m0 x27 h7 y21 ff3 fs5 fc0 sc0 ls0 ws0">2.3<span class="_ _8"> </span><span class="ff7">交叉验证</span></div><div class="t m0 x46 h6 y1b3 ff1 fs2 fc0 sc0 ls0 ws0">图<span class="_ _d"> </span><span class="ff3">2.5:<span class="_ _35"> </span>K<span class="_ _d"> </span></span>折交叉验证示意图（<span class="ff3">K=5</span>）</div><div class="t m0 x14 h6 y1b4 ff1 fs2 fc0 sc0 ls0 ws0">（<span class="ff3">lea<span class="_ _12"></span>v<span class="_ _12"></span>e-one-out<span class="_ _25"> </span>cross-v<span class="_ _28"></span>alidation<span class="ff1">。<span class="_ _28"></span><span class="ff3">LOOCV<span class="ff1">）<span class="_ _2f"></span>。<span class="_ _27"></span>还可以每次取<span class="_ _d"> </span><span class="ff3">P<span class="_ _25"> </span></span>个样本验证。<span class="_ _28"></span>重复<span class="_ _d"> </span><span class="ff3">C</span></span></span></span></span></div><div class="t m0 xbb hb y1b5 ffc fs7 fc0 sc0 ls0 ws0">P</div><div class="t m0 xbb hb y1b6 ffc fs7 fc0 sc0 ls0 ws0">N</div><div class="t m0 x18 h6 y1b4 ff1 fs2 fc0 sc0 ls0 ws0">次。<span class="_ _28"></span>这种方</div><div class="t m0 x3 h6 y1b7 ff1 fs2 fc0 sc0 ls0 ws0">法称为留<span class="_ _d"> </span><span class="ff3">P<span class="_ _25"> </span></span>法（<span class="ff3">leav<span class="_ _28"></span>e-p-out<span class="_ _d"> </span>cross-v<span class="_ _28"></span>alidation<span class="ff1">。</span>LPOCV<span class="ff1">）<span class="_ _26"></span>。留一法和留<span class="_ _25"> </span><span class="ff3">P<span class="_ _d"> </span></span>法适用于样本量较小的</span></span></div><div class="t m0 x3 h6 y1b8 ff1 fs2 fc0 sc0 ls0 ws0">情形。<span class="_ _30"></span>当样本量较大时。<span class="_ _30"></span>上述两种方法所需的重复次数较大。<span class="_ _27"></span>运算速度相对较慢。<span class="_ _30"></span>因此通常不采</div><div class="t m0 x3 h6 y1b9 ff1 fs2 fc0 sc0 ls0 ws0">用留一法和留<span class="_ _d"> </span><span class="ff3">P<span class="_ _d"> </span></span>法。而是使用<span class="_ _d"> </span><span class="ff3">K<span class="_ _d"> </span></span>折交叉验证。</div><div class="t m0 x3 hd y1ba ff5 fs8 fc0 sc0 ls0 ws0">2.3.4<span class="_ _36"> </span><span class="ff9">时序交叉验证</span></div><div class="t m0 x3 h6 y1bb ff1 fs2 fc0 sc0 ls0 ws0">以上<span class="_ _23"></span>四种传<span class="_ _23"></span>统交叉<span class="_ _23"></span>验证方<span class="_ _23"></span>法成立<span class="_ _23"></span>的前<span class="_ _23"></span>提是样<span class="_ _23"></span>本服从<span class="_ _23"></span>独立同<span class="_ _23"></span>分布。独<span class="_ _23"></span>立是指<span class="_ _23"></span>样本之<span class="_ _23"></span>间不<span class="_ _23"></span>存在相<span class="_ _23"></span>关</div><div class="t m0 x3 h6 y1bc ff1 fs2 fc0 sc0 ls0 ws0">性。<span class="_ _2e"></span>从一条样本无法推知另一条样本的取值；<span class="_ _2a"></span>同分布是指包括训练集和验证集在内的全部样本需</div><div class="t m0 x3 h6 y1bd ff1 fs2 fc0 sc0 ls0 ws0">取自同一分布。<span class="_ _30"></span>当样本是时间序列时。<span class="_ _30"></span>数据随时间演进的过程生成。<span class="_ _27"></span>可能包含周期性、<span class="_ _30"></span>过去和未</div><div class="t m0 x3 h6 y1be ff1 fs2 fc0 sc0 ls0 ws0">来数<span class="_ _23"></span>据间相<span class="_ _23"></span>互关系<span class="_ _23"></span>等信<span class="_ _23"></span>息。并不<span class="_ _23"></span>满足交<span class="_ _23"></span>叉验证<span class="_ _23"></span>中数据<span class="_ _23"></span>独立<span class="_ _23"></span>同分布<span class="_ _23"></span>的基本<span class="_ _23"></span>假设。此<span class="_ _23"></span>时如<span class="_ _23"></span>果依然<span class="_ _23"></span>采</div><div class="t m0 x3 h6 y1bf ff1 fs2 fc0 sc0 ls0 ws0">用传统交叉验证方法。<span class="_ _29"></span>可能会将未来时刻的数据划入训练集。<span class="_ _29"></span>历史时刻的数据划入验证集。<span class="_ _29"></span>进而</div><div class="t m0 x3 h6 y1c0 ff1 fs2 fc0 sc0 ls0 ws0">出现用未来规律预测历史结果的<span class="_ _27"></span>“作弊”<span class="_ _27"></span>行为。<span class="_ _30"></span>因此需要一种既能保证数据利用率。<span class="_ _29"></span>又能保留时</div><div class="t m0 x3 h6 y1c1 ff1 fs2 fc0 sc0 ls0 ws0">序数据之间相互关系的交叉验证方法。这就是时序交叉验证方法（<span class="ff3">time-series<span class="_ _d"> </span>cross-v<span class="_ _28"></span>alidation<span class="ff1">）<span class="_ _2f"></span>。</span></span></div><div class="t m0 x3 h6 y1c2 ff1 fs2 fc0 sc0 ls0 ws0">如下图所示。</div><div class="t m0 x9b h6 y1c3 ff1 fs2 fc0 sc0 ls0 ws0">图<span class="_ _d"> </span><span class="ff3">2.6:<span class="_ _35"> </span>5<span class="_ _d"> </span></span>折时序交叉验证</div><div class="t m0 x3 h6 y1c4 ff1 fs2 fc0 sc0 ls0 ws0">以上图为例说明时序交叉验证方法。<span class="_ _28"></span>假设样本时间跨度为<span class="_ _25"> </span><span class="ff3">10<span class="_ _d"> </span></span>个月。<span class="_ _27"></span>采用<span class="_ _d"> </span><span class="ff3">5<span class="_ _25"> </span></span>折时序交叉验证。<span class="_ _28"></span>那</div><div class="t m0 x3 h6 y1c5 ff1 fs2 fc0 sc0 ls0 ws0">么首先<span class="_ _23"></span>将样本等分<span class="_ _23"></span>成<span class="_ _e"> </span><span class="ff3">5<span class="_ _e"> </span></span>个部分。以<span class="_ _23"></span>第<span class="_ _e"> </span><span class="ff3">1<span class="_ _e"> </span>2<span class="_ _e"> </span></span>月数据<span class="_ _23"></span>作为训练<span class="_ _23"></span>集。第<span class="_ _e"> </span><span class="ff3">3<span class="_ _e"> </span>4<span class="_ _e"> </span></span>月作为<span class="_ _23"></span>验证集。进<span class="_ _23"></span>行第<span class="_ _e"> </span><span class="ff3">1</span></div><div class="t m0 x3 h6 y1c6 ff1 fs2 fc0 sc0 ls0 ws0">次验证。<span class="_ _28"></span>再以第<span class="_ _25"> </span><span class="ff3">1<span class="_ _d"> </span>4<span class="_ _25"> </span></span>月数据作为训练集。<span class="_ _28"></span>第<span class="_ _d"> </span><span class="ff3">5<span class="_ _25"> </span>6<span class="_ _d"> </span></span>月为验证集。<span class="_ _28"></span>进行第<span class="_ _d"> </span><span class="ff3">2<span class="_ _25"> </span></span>次验证。<span class="_ _28"></span>以此类推。<span class="_ _28"></span>第<span class="_ _d"> </span><span class="ff3">4</span></div><div class="t m0 x3 h6 y1c7 ff1 fs2 fc0 sc0 ls0 ws0">次验证以第<span class="_ _d"> </span><span class="ff3">1<span class="_ _25"> </span>8<span class="_ _d"> </span></span>月数据作为训练集。第<span class="_ _25"> </span><span class="ff3">9<span class="_ _d"> </span>10<span class="_ _d"> </span></span>月作为验证集。再将总共<span class="_ _25"> </span><span class="ff3">4<span class="_ _d"> </span></span>次验证的模型评价指标</div><div class="t m0 x3 h6 y1c8 ff1 fs2 fc0 sc0 ls0 ws0">取平<span class="_ _23"></span>均数。时<span class="_ _23"></span>序交叉<span class="_ _23"></span>验证<span class="_ _23"></span>避免了<span class="_ _23"></span>使用未<span class="_ _23"></span>来信息<span class="_ _23"></span>的可能。<span class="_ _23"></span>对于<span class="_ _23"></span>时序数<span class="_ _23"></span>据的机<span class="_ _23"></span>器学习<span class="_ _23"></span>而言<span class="_ _23"></span>是较为<span class="_ _23"></span>合</div><div class="t m0 x3 h6 y1c9 ff1 fs2 fc0 sc0 ls0 ws0">理的选择。</div><div class="t m0 x3 h6 y1ca ff3 fs2 fc0 sc0 ls0 ws0">T<span class="_ _27"></span>ashman<span class="ff1">（</span>2000<span class="ff1">）<span class="_ _2c"></span>、<span class="ff3">V<span class="_ _27"></span>arma<span class="_ _1e"> </span><span class="ff1">和<span class="_ _e"> </span></span>Simon<span class="ff1">（</span>2006<span class="ff1">）<span class="_ _23"></span>和<span class="_ _e"> </span></span>Bergmeir<span class="_ _1e"> </span><span class="ff1">和<span class="_ _1e"> </span></span>Benitez<span class="ff1">（</span>2012<span class="ff1">）<span class="_ _23"></span>等研究表<span class="_ _23"></span>明。时</span></span></span></div><div class="t m0 x3 h6 y1cb ff1 fs2 fc0 sc0 ls0 ws0">序交叉验证<span class="_ _23"></span>方法在时序数据<span class="_ _23"></span>上的表现优于传统<span class="_ _23"></span>交叉验证方法。时<span class="_ _23"></span>序特性是金融数据<span class="_ _23"></span>的典型特征。</div><div class="t m0 x3 h6 y1cc ff1 fs2 fc0 sc0 ls0 ws0">然而时序交叉验证在投资领域的效果尚没有被系统性地测试。</div><div class="t m0 xbc h4 y3 ff3 fs2 fc0 sc0 ls0 ws0">11</div></div><div class="pi" data-data='{"ctm":[1.500000,0.000000,0.000000,1.500000,0.000000,0.000000]}'></div></div>
<div id="pf12" class="pf w0 h0" data-page-no="12"><div class="pc pc12 w0 h0"><div class="t m0 x3 h7 y21 ff3 fs5 fc0 sc0 ls0 ws0">2.3<span class="_ _8"> </span><span class="ff7">交叉验证</span></div><div class="t m0 x3 h4 y3 ff3 fs2 fc0 sc0 ls0 ws0">12</div></div><div class="pi" data-data='{"ctm":[1.500000,0.000000,0.000000,1.500000,0.000000,0.000000]}'></div></div>
<div id="pf13" class="pf w0 h0" data-page-no="13"><div class="pc pc13 w0 h0"><img class="bi xbd y1cd w5 h19" alt="" src="bg13.png"/><div class="t m0 x31 h5 y4 ff4 fs3 fc0 sc0 ls0 ws0">第三章 评估模型</div><div class="t m0 x3 h6 y1ce ff1 fs2 fc0 sc0 ls0 ws0">对于一个具体的模型，<span class="_ _3a"></span>如何评估其泛化能力呢？<span class="_ _27"></span>模型的泛化能力的评价需要人为制定标准，<span class="_ _3a"></span>这就</div><div class="t m0 x3 h6 y1cf ff1 fs2 fc0 sc0 ls0 ws0">是性能度量<span class="_ _d"> </span><span class="ff3">(p<span class="_ _23"></span>erformance<span class="_ _25"> </span>measure)</span>。</div><div class="t m0 x3 h6 y1d0 ff1 fs2 fc2 sc0 ls0 ws0">衡量模型泛化能力也就是计算模型的测试误差<span class="fc0">，性能度量也就是测试误差的具体实例。</span></div><div class="t m0 x3 h6 y1d1 ff1 fs2 fc0 sc0 ls0 ws0">性能度量反映了任务需求，<span class="_ _2e"></span>在对比不同模型的能力时，<span class="_ _2a"></span>使用不同的性能度量往往会导致不同的评</div><div class="t m0 x3 h6 y1d2 ff1 fs2 fc0 sc0 ls0 ws0">判结果。<span class="_ _29"></span>也就是模型的好坏并不是绝对的，<span class="_ _29"></span>这视不同的性能度量而定，<span class="_ _29"></span>而选取什么样的性能度量</div><div class="t m0 x3 h6 y1d3 ff1 fs2 fc0 sc0 ls0 ws0">取决于任务需求。</div><div class="t m0 x3 h6 y1d4 ff1 fs2 fc0 sc0 ls0 ws0">以下介绍常见的性能度量。</div><div class="t m0 x3 h6 y1d5 ff1 fs2 fc0 sc0 ls0 ws0">在预测任务中，<span class="_ _3a"></span>给定样本集<span class="_ _25"> </span><span class="ffd">D<span class="_ _25"> </span><span class="fff">=<span class="_ _32"> </span><span class="ffe">{</span>(</span>x</span></div><div class="t m0 x72 hb y1d6 ffc fs7 fc0 sc0 ls0 ws0">i</div><div class="t m0 x11 he y1d5 ffd fs2 fc0 sc0 ls0 ws0">,<span class="_ _31"> </span>y</div><div class="t m0 xe hb y1d6 ffc fs7 fc0 sc0 ls0 ws0">i</div><div class="t m0 x32 h6 y1d5 fff fs2 fc0 sc0 ls0 ws0">)<span class="ffe">} <span class="ffd">i<span class="_ _32"> </span></span></span>=<span class="_ _32"> </span>1<span class="ffd">,<span class="_ _31"> </span></span>2<span class="ffd">,<span class="_ _31"> </span><span class="ffe">·<span class="_ _31"></span>·<span class="_ _31"></span>·<span class="_ _d"> </span></span>,<span class="_ _31"> </span>m<span class="ff1">，<span class="_ _3a"></span>其中<span class="_ _25"> </span><span class="ffd">y</span></span></span></div><div class="t m0 xbe hb y1d6 ffc fs7 fc0 sc0 ls0 ws0">i</div><div class="t m0 xbf h6 y1d5 ff1 fs2 fc0 sc0 ls0 ws0">是实例<span class="_ _25"> </span><span class="ffd">x</span></div><div class="t m0 xa8 hb y1d6 ffc fs7 fc0 sc0 ls0 ws0">i</div><div class="t m0 xc0 h6 y1d5 ff1 fs2 fc0 sc0 ls0 ws0">的真实<span class="_ _25"> </span><span class="ff3">lab<span class="_ _23"></span>el</span>。<span class="_ _3a"></span>要</div><div class="t m0 x3 h6 y1d7 ff1 fs2 fc0 sc0 ls0 ws0">评估学习器<span class="_ _d"> </span><span class="ffd">f<span class="_ _35"> </span></span>的性能，就要把学习器预测结果<span class="_ _d"> </span><span class="ffd">f<span class="_ _34"> </span><span class="fff">(</span>x<span class="fff">)<span class="_ _d"> </span></span></span>与真实<span class="_ _d"> </span><span class="ff3">lab<span class="_ _23"></span>el<span class="_ _d"> </span><span class="ffd">y<span class="_ _e"> </span></span></span>进行比较。</div><div class="t m0 x52 h9 y1d8 ff5 fs6 fc0 sc0 ls0 ws0">3.1<span class="_ _24"> </span><span class="ff9">回归</span></div><div class="t m0 x3 hd y1d9 ff5 fs8 fc0 sc0 ls0 ws0">3.1.1<span class="_ _36"> </span><span class="ff9">均方误差</span></div><div class="t m0 x3 h6 y1da ff1 fs2 fc0 sc0 ls0 ws0">在回归任务中，<span class="_ _27"></span>即预测连续值的问题，<span class="_ _28"></span>最常用的性能度量是<span class="_ _12"></span>“均方误差”<span class="_ _3c"></span>（<span class="ff3">mean<span class="_ _d"> </span>squared<span class="_ _25"> </span>error</span>）<span class="_ _2f"></span>。</div><div class="t m0 xc1 h4 y1db ffd fs2 fc0 sc0 ls0 ws0">E<span class="_ _23"></span><span class="fff">(</span>f<span class="_ _34"> </span><span class="fff">;<span class="_ _31"> </span></span>D<span class="_ _23"></span><span class="fff">)<span class="_ _32"> </span>=</span></div><div class="t m0 xc2 h4 y1dc fff fs2 fc0 sc0 ls0 ws0">1</div><div class="t m0 xbd he y1dd ffd fs2 fc0 sc0 ls0 ws0">m</div><div class="t m0 xa hb y1de ffc fs7 fc0 sc0 ls0 ws0">m</div><div class="t m0 x53 hc y1df ff11 fs2 fc0 sc0 ls0 ws0">X</div><div class="t m0 xc3 ha y1e0 ffc fs7 fc0 sc0 ls0 ws0">i<span class="ff12">=1</span></div><div class="t m0 x5f h4 y1db fff fs2 fc0 sc0 ls0 ws0">(<span class="ffd">f<span class="_ _a"> </span></span>(<span class="ff10">x</span></div><div class="t m0 x37 hb y1e1 ffc fs7 fc0 sc0 ls0 ws0">i</div><div class="t m0 x44 h4 y1db fff fs2 fc0 sc0 ls0 ws0">)<span class="_ _37"> </span><span class="ffe">−<span class="_ _37"> </span><span class="ffd">y</span></span></div><div class="t m0 xc4 hb y1e1 ffc fs7 fc0 sc0 ls0 ws0">i</div><div class="t m0 xc5 h4 y1db fff fs2 fc0 sc0 ls0 ws0">)</div><div class="t m0 xc6 ha y1e2 ff12 fs7 fc0 sc0 ls0 ws0">2</div><div class="t m0 xaf h4 y1db ff3 fs2 fc0 sc0 ls0 ws0">(3.1)</div><div class="t m0 x3 h6 y1e3 ff1 fs2 fc0 sc0 ls0 ws0">更一般的，对于数据分布<span class="_ _d"> </span><span class="ffe">D<span class="_ _e"> </span></span>和概率密度函数<span class="_ _d"> </span><span class="ffd">p<span class="fff">(<span class="ffe">·</span>)</span></span>，均方误差可描为：</div><div class="t m0 x31 h4 y1e4 ffd fs2 fc0 sc0 ls0 ws0">E<span class="_ _23"></span><span class="fff">(</span>f<span class="_ _34"> </span><span class="fff">;<span class="_ _31"> </span><span class="ffe">D<span class="_ _23"></span></span>)<span class="_ _32"> </span>=</span></div><div class="t m0 xc7 hc y1e5 ff11 fs2 fc0 sc0 ls0 ws0">Z</div><div class="t m0 x17 ha y1e6 ff10 fs7 fc0 sc0 ls0 ws0">x<span class="ffb">∼D</span></div><div class="t m0 xc3 h4 y1e4 fff fs2 fc0 sc0 ls0 ws0">(<span class="ffd">f<span class="_ _34"></span></span>(<span class="ff10">x</span>)<span class="_ _37"> </span><span class="ffe">−<span class="_ _37"> </span><span class="ffd">y<span class="_ _23"></span></span></span>)</div><div class="t m0 xc8 ha y1e7 ff12 fs7 fc0 sc0 ls0 ws0">2</div><div class="t m0 x61 h4 y1e4 ffd fs2 fc0 sc0 ls0 ws0">p<span class="fff">(<span class="ff10">x</span>)<span class="ff3">d<span class="ff10">x<span class="_ _40"> </span></span>(3.2)</span></span></div><div class="t m0 x3 h6 y1e8 ff1 fs2 fc2 sc0 ls0 ws0">均方误差在数理统计中说过了，<span class="_ _2e"></span>这里再强调一下：<span class="_ _2a"></span>均方误差是反映估计量与被估计量之间差异程</div><div class="t m0 x3 h6 y1e9 ff1 fs2 fc2 sc0 ls0 ws0">度的一种度量。当估计量是无偏时，均方误差就是方差。</div><div class="t m0 x52 h9 y1ea ff5 fs6 fc0 sc0 ls0 ws0">3.2<span class="_ _24"> </span><span class="ff9">分类</span></div><div class="t m0 x3 hd y1eb ff5 fs8 fc0 sc0 ls0 ws0">3.2.1<span class="_ _36"> </span><span class="ff9">混淆矩阵</span></div><div class="t m0 x3 h6 y86 ff1 fs2 fc0 sc0 ls0 ws0">对于分类问题来说，<span class="_ _2e"></span>很多评价指标都来源于二分类的混淆矩阵，<span class="_ _2a"></span>多分类或多标签的评价指标则从</div><div class="t m0 x3 h6 y87 ff1 fs2 fc0 sc0 ls0 ws0">二分类的评价指标拓展得到。</div><div class="t m0 x3 h6 y20 ff1 fs2 fc0 sc0 ls0 ws0">对于二分类问题，分类结果混淆矩阵如表<span class="ff3">3.1</span>所示：</div><div class="t m0 xc3 h4 y3 ff3 fs2 fc0 sc0 ls0 ws0">13</div><a class="l" href="#pf14" data-dest-detail='[20,"XYZ",70.87,806.14,null]'><div class="d m1" style="border-style:none;position:absolute;left:400.845000px;bottom:59.034000px;width:13.942000px;height:15.458000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.500000,0.000000,0.000000,1.500000,0.000000,0.000000]}'></div></div>
<div id="pf14" class="pf w0 h0" data-page-no="14"><div class="pc pc14 w0 h0"><img class="bi x38 y1ec w6 h1a" alt="" src="bg14.png"/><div class="t m0 x3 h7 y21 ff3 fs5 fc0 sc0 ls0 ws0">3.2<span class="_ _8"> </span><span class="ff7">分类</span></div><div class="t m0 x94 h6 y1ed ff1 fs2 fc0 sc0 ls0 ws0">表<span class="_ _d"> </span><span class="ff3">3.1:<span class="_ _35"> </span></span>混淆矩阵</div><div class="t m0 x4c h6 y1ee ff1 fs2 fc0 sc0 ls0 ws0">真实情况</div><div class="t m0 xc9 h6 y1ef ff1 fs2 fc0 sc0 ls0 ws0">预测结果</div><div class="t m0 xc2 h6 y1f0 ff1 fs2 fc0 sc0 ls0 ws0">正例<span class="_ _41"> </span>反例</div><div class="t m0 x9 h6 y1f1 ff1 fs2 fc0 sc0 ls0 ws0">正例<span class="_ _42"> </span><span class="ff3">TP(</span>真正例<span class="ff3">)<span class="_ _7"> </span>FN(</span>假反例<span class="ff3">)</span></div><div class="t m0 x9 h6 y1f2 ff1 fs2 fc0 sc0 ls0 ws0">反例<span class="_ _43"> </span><span class="ff3">FP(</span>假正例<span class="ff3">)<span class="_ _7"> </span>TN(</span>真反例<span class="ff3">)</span></div><div class="t m0 x3 h6 y1f3 ff1 fs2 fc0 sc0 ls0 ws0">对于二分类问题，<span class="_ _30"></span>样本被分为了正类和负类，<span class="_ _30"></span>其预测结果也只有两种：<span class="_ _27"></span>正类或负类，<span class="_ _30"></span>因此可以将</div><div class="t m0 x3 h6 y1f4 ff1 fs2 fc0 sc0 ls0 ws0">所有样本分为四类：</div><div class="t m0 x15 h6 y1f5 ff3 fs2 fc0 sc0 ls0 ws0">•<span class="_ _5"> </span>T<span class="_ _27"></span>rue<span class="_ _d"> </span>P<span class="_ _12"></span>ositiv<span class="_ _12"></span>e<span class="ff1">：实际为正类，预测结果也是正类，也称真阳性或者命中<span class="_ _d"> </span></span>(Hit)<span class="ff1">。</span></div><div class="t m0 x15 h6 y1f6 ff3 fs2 fc0 sc0 ls0 ws0">•<span class="_ _5"> </span>T<span class="_ _27"></span>rue<span class="_ _d"> </span>Negative<span class="ff1">：实际为负类，预测结果也是负类，也称真阴性或者正确拒绝<span class="_ _d"> </span></span>(Correct<span class="_ _e"> </span>Re-</div><div class="t m0 x13 h6 y1f7 ff3 fs2 fc0 sc0 ls0 ws0">jection)<span class="ff1">。</span></div><div class="t m0 x15 h6 y1f8 ff3 fs2 fc0 sc0 ls0 ws0">•<span class="_ _5"> </span>F<span class="_ _27"></span>alse<span class="_ _25"> </span>Positiv<span class="_ _12"></span>e<span class="ff1">：<span class="_ _28"></span>实际为负类，<span class="_ _28"></span>预测结果却是正类，<span class="_ _28"></span>也称伪阳性或假警报<span class="_ _25"> </span><span class="ff3">(F<span class="_ _28"></span>alse<span class="_ _25"> </span>Alarm)<span class="ff1">，<span class="_ _28"></span>指</span></span></span></div><div class="t m0 x13 h6 y1f9 ff1 fs2 fc0 sc0 ls0 ws0">代统计学第一型错误<span class="_ _d"> </span><span class="ff3">(T<span class="_ _12"></span>yp<span class="_ _23"></span>e<span class="_ _25"> </span>I<span class="_ _d"> </span>Error)<span class="ff1">。</span></span></div><div class="t m0 x15 h6 y1fa ff3 fs2 fc0 sc0 ls0 ws0">•<span class="_ _5"> </span>F<span class="_ _27"></span>alse<span class="_ _25"> </span>Negative<span class="ff1">：<span class="_ _27"></span>实际为正类，<span class="_ _27"></span>预测结果却是负类，<span class="_ _28"></span>也称伪阴性或未命中<span class="_ _25"> </span><span class="ff3">(Miss)</span>，<span class="_ _28"></span>指代统计</span></div><div class="t m0 x13 h6 y1fb ff1 fs2 fc0 sc0 ls0 ws0">学第二型错误<span class="_ _d"> </span><span class="ff3">(T<span class="_ _12"></span>yp<span class="_ _23"></span>e<span class="_ _25"> </span>I<span class="_ _23"></span>I<span class="_ _d"> </span>Error)<span class="ff1">。</span></span></div><div class="t m0 x3 h6 y1fc ff1 fs2 fc0 sc0 ls0 ws0">进一步，<span class="_ _2e"></span>为了更好的理解这种样本分类，<span class="_ _2a"></span>我们还可以按照三种不同的方法将这四种类别归为两大</div><div class="t m0 x3 h6 y1fd ff1 fs2 fc0 sc0 ls0 ws0">类：</div><div class="t m0 x3 h6 y1fe ff4 fs2 fc0 sc0 ls0 ws0">按照预测结果是否正确进行归类：</div><div class="t m0 x15 h6 y1ff ff3 fs2 fc0 sc0 ls0 ws0">1.<span class="_ _5"> </span><span class="ff1">预测正确的样本：</span>TP<span class="_ _25"> </span>+<span class="_ _d"> </span>TN</div><div class="t m0 x15 h6 y200 ff3 fs2 fc0 sc0 ls0 ws0">2.<span class="_ _5"> </span><span class="ff1">预测错误的样本：</span>FN<span class="_ _25"> </span>+<span class="_ _d"> </span>FP</div><div class="t m0 x3 h6 y201 ff4 fs2 fc0 sc0 ls0 ws0">按照样本的实际类别进行归类：</div><div class="t m0 x15 h6 y202 ff3 fs2 fc0 sc0 ls0 ws0">1.<span class="_ _5"> </span><span class="ff1">实际类别为正类的样本：</span>TP<span class="_ _25"> </span>+<span class="_ _d"> </span>FN</div><div class="t m0 x15 h6 y203 ff3 fs2 fc0 sc0 ls0 ws0">2.<span class="_ _5"> </span><span class="ff1">实际类别为负类的样本：</span>TN<span class="_ _25"> </span>+<span class="_ _d"> </span>FP</div><div class="t m0 x3 h6 y204 ff4 fs2 fc0 sc0 ls0 ws0">按照样本的预测类别进行归类：</div><div class="t m0 x15 h6 y205 ff3 fs2 fc0 sc0 ls0 ws0">1.<span class="_ _5"> </span><span class="ff1">预测为正类的样本：</span>TP<span class="_ _25"> </span>+<span class="_ _d"> </span>FP</div><div class="t m0 x15 h6 y206 ff3 fs2 fc0 sc0 ls0 ws0">2.<span class="_ _5"> </span><span class="ff1">预测为负类的样本：</span>TN<span class="_ _25"> </span>+<span class="_ _d"> </span>FN</div><div class="t m0 x3 h6 y207 ff1 fs2 fc2 sc0 ls0 ws0">下面介绍的性能度量，<span class="_ _27"></span>用于从不同的侧面对模型进行描述，<span class="_ _27"></span>其共同之处是都是由<span class="_ _d"> </span><span class="ff3">TP</span>、<span class="_ _27"></span><span class="ff3">TN<span class="ff1">、<span class="_ _28"></span><span class="ff3">FP<span class="ff1">、</span></span></span></span></div><div class="t m0 x3 h6 y208 ff3 fs2 fc2 sc0 ls0 ws0">FN<span class="_ _d"> </span><span class="ff1">中的部分或全部所组成的表达式。</span></div><div class="t m0 x3 hd y209 ff5 fs8 fc0 sc0 ls0 ws0">3.2.2<span class="_ _36"> </span>Error<span class="_ _5"> </span>Rate<span class="_ _5"> </span><span class="ff9">与<span class="_ _18"> </span></span>accuracy</div><div class="t m0 x3 h6 y20a ff1 fs2 fc0 sc0 ls0 ws0">在分类任务中，即预测离散值的问题，最常用的是错误率和精度。</div><div class="t m0 x3 h6 y20b ff4 fs2 fc0 sc0 ls0 ws0">定义<span class="ff6">3.1<span class="_ _5"> </span><span class="fc1">Error<span class="_ _e"> </span>Rate(<span class="ff4">错误率</span>)<span class="ff4">：<span class="_ _d"> </span></span></span><span class="ff1">分类错误的样本数占样本总数的比例。</span></span></div><div class="t m0 x3 h6 y20c ff4 fs2 fc0 sc0 ls0 ws0">定义<span class="ff6">3.2<span class="_ _5"> </span><span class="fc1">accuracy(<span class="ff4">精度，准确率</span>)<span class="ff4">：<span class="_ _d"> </span></span></span><span class="ff1">分类正确的样本数占样本总数的比例，简记为<span class="_ _d"> </span><span class="ffd">AC<span class="_ _23"></span>C<span class="_ _34"></span></span>。</span></span></div><div class="t m0 x3 h6 y20d ff1 fs2 fc0 sc0 ls0 ws0">一般来说，<span class="_ _3a"></span>说到<span class="_ _25"> </span><span class="ff3">accuracy</span>，<span class="_ _3a"></span>指的都是总的准确率，<span class="_ _29"></span>但实际上，<span class="_ _3a"></span>不仅可以计算出总分类的<span class="_ _25"> </span><span class="ff3">accuracy</span></div><div class="t m0 x3 h6 y20e ff1 fs2 fc0 sc0 ls0 ws0">和<span class="_ _d"> </span><span class="ff3">Error<span class="_ _d"> </span>Rate</span>，也可以计算出各分类的<span class="_ _d"> </span><span class="ff3">accuracy<span class="_ _d"> </span></span>和<span class="_ _d"> </span><span class="ff3">Error<span class="_ _d"> </span>Rate</span>。</div><div class="t m0 x3 h6 y20f ff4 fs2 fc0 sc0 ls0 ws0">以下是总分类情形下的定义：</div><div class="t m0 x3 h6 y210 ff1 fs2 fc0 sc0 ls0 ws0">错误率定义为：</div><div class="t m0 xca h4 y211 ffd fs2 fc0 sc0 ls0 ws0">E<span class="_ _23"></span><span class="fff">(</span>f<span class="_ _34"> </span><span class="fff">;<span class="_ _31"> </span></span>D<span class="_ _23"></span><span class="fff">)<span class="_ _32"> </span>=</span></div><div class="t m0 x5c h4 y212 fff fs2 fc0 sc0 ls0 ws0">1</div><div class="t m0 x1 he y213 ffd fs2 fc0 sc0 ls0 ws0">m</div><div class="t m0 x6f hb y214 ffc fs7 fc0 sc0 ls0 ws0">m</div><div class="t m0 x97 hc y215 ff11 fs2 fc0 sc0 ls0 ws0">X</div><div class="t m0 x53 ha y216 ffc fs7 fc0 sc0 ls0 ws0">i<span class="ff12">=1</span></div><div class="t m0 xaa h4 y211 ffa fs2 fc0 sc0 ls0 ws0">I<span class="_ _31"> </span><span class="fff">(<span class="ffd">f<span class="_ _a"> </span></span>(<span class="ff10">x</span></span></div><div class="t m0 xab hb y217 ffc fs7 fc0 sc0 ls0 ws0">i</div><div class="t m0 x1e h4 y211 fff fs2 fc0 sc0 ls0 ws0">)<span class="_ _32"> </span><span class="ffe"≯</span>=<span class="_ _32"> </span><span class="ffd">y</span></div><div class="t m0 xcb hb y217 ffc fs7 fc0 sc0 ls0 ws0">i</div><div class="t m0 xad h4 y211 fff fs2 fc0 sc0 ls0 ws0">)<span class="_ _44"> </span><span class="ff3">(3.3)</span></div><div class="t m0 x3 h4 y3 ff3 fs2 fc0 sc0 ls0 ws0">14</div></div><div class="pi" data-data='{"ctm":[1.500000,0.000000,0.000000,1.500000,0.000000,0.000000]}'></div></div>
<div id="pf15" class="pf w0 h0" data-page-no="15"><div class="pc pc15 w0 h0"><img class="bi x9b y218 w7 h1b" alt="" src="bg15.png"/><div class="t m0 x85 h7 y21 ff3 fs5 fc0 sc0 ls0 ws0">3.2<span class="_ _8"> </span><span class="ff7">分类</span></div><div class="t m0 x3 h6 y22 ff1 fs2 fc0 sc0 ls0 ws0">正确率定义为：</div><div class="t m0 x6d h4 y219 ff3 fs2 fc0 sc0 ls0 ws0">acc<span class="fff">(<span class="ffd">f<span class="_ _34"></span></span>;<span class="_ _31"> </span><span class="ffd">D<span class="_ _23"></span></span>)<span class="_ _a"> </span>=</span></div><div class="t m0 x34 h4 y21a fff fs2 fc0 sc0 ls0 ws0">1</div><div class="t m0 xc2 he y21b ffd fs2 fc0 sc0 ls0 ws0">m</div><div class="t m0 x98 hb y21c ffc fs7 fc0 sc0 ls0 ws0">m</div><div class="t m0 x5e hc y21d ff11 fs2 fc0 sc0 ls0 ws0">X</div><div class="t m0 x6f ha y21e ffc fs7 fc0 sc0 ls0 ws0">i<span class="ff12">=1</span></div><div class="t m0 x29 h4 y219 ffa fs2 fc0 sc0 ls0 ws0">I<span class="_ _31"> </span><span class="fff">(<span class="ffd">f<span class="_ _a"> </span></span>(<span class="ff10">x</span></span></div><div class="t m0 x25 hb y21f ffc fs7 fc0 sc0 ls0 ws0">i</div><div class="t m0 x79 h4 y219 fff fs2 fc0 sc0 ls0 ws0">)<span class="_ _32"> </span>=<span class="_ _32"> </span><span class="ffd">y</span></div><div class="t m0 xad hb y21f ffc fs7 fc0 sc0 ls0 ws0">i</div><div class="t m0 xae h4 y219 fff fs2 fc0 sc0 ls0 ws0">)</div><div class="t m0 x9d h4 y220 fff fs2 fc0 sc0 ls0 ws0">=<span class="_ _32"> </span>1<span class="_ _37"> </span><span class="ffe">−<span class="_ _37"> </span><span class="ffd">E<span class="_ _23"></span></span></span>(<span class="ffd">f<span class="_ _34"> </span></span>;<span class="_ _31"> </span><span class="ffd">D<span class="_ _23"></span></span>)</div><div class="t m0 xaf h4 y221 ff3 fs2 fc0 sc0 ls0 ws0">(3.4)</div><div class="t m0 x3 h6 y222 ff1 fs2 fc0 sc0 ls0 ws0">更一般的，对于数据分布<span class="_ _d"> </span><span class="ffe">D<span class="_ _e"> </span></span>和概率密度函数<span class="_ _d"> </span><span class="ffd">p<span class="fff">(<span class="ffe">·</span>)<span class="_ _d"> </span></span></span>，错误率与精度可分别描述为：</div><div class="t m0 x40 h4 y223 ffd fs2 fc0 sc0 ls0 ws0">E<span class="_ _23"></span><span class="fff">(</span>f<span class="_ _34"> </span><span class="fff">;<span class="_ _31"> </span><span class="ffe">D<span class="_ _23"></span></span>)<span class="_ _32"> </span>=</span></div><div class="t m0 x4f hc y224 ff11 fs2 fc0 sc0 ls0 ws0">Z</div><div class="t m0 xc7 ha y225 ff10 fs7 fc0 sc0 ls0 ws0">x<span class="ffb">∼D</span></div><div class="t m0 x75 h4 y223 ffa fs2 fc0 sc0 ls0 ws0">I<span class="fff">(<span class="ffd">f<span class="_ _34"></span></span>(<span class="ff10">x</span>)<span class="_ _32"> </span><span class="ffe"≯</span>=<span class="_ _32"> </span><span class="ffd">y<span class="_ _23"></span></span>)<span class="ffd">p</span>(<span class="ff10">x</span>)<span class="ff3">d<span class="ff10">x</span></span></span></div><div class="t m0 xaf h4 y226 ff3 fs2 fc0 sc0 ls0 ws0">(3.5)</div><div class="t m0 x30 h4 y227 ff3 fs2 fc0 sc0 ls0 ws0">acc<span class="fff">(<span class="ffd">f<span class="_ _34"></span></span>;<span class="_ _31"> </span><span class="ffe">D<span class="_ _23"></span></span>)<span class="_ _a"> </span>=</span></div><div class="t m0 x33 hc y228 ff11 fs2 fc0 sc0 ls0 ws0">Z</div><div class="t m0 x96 ha y229 ff10 fs7 fc0 sc0 ls0 ws0">x<span class="ffb">∼D</span></div><div class="t m0 xa h4 y227 ffa fs2 fc0 sc0 ls0 ws0">I<span class="fff">(<span class="ffd">f<span class="_ _34"></span></span>(<span class="ff10">x</span>)<span class="_ _32"> </span>=<span class="_ _32"> </span><span class="ffd">y<span class="_ _23"></span></span>)<span class="ffd">p</span>(<span class="ff10">x</span>)<span class="ff3">d<span class="ff10">x</span></span></span></div><div class="t m0 xe h4 y22a fff fs2 fc0 sc0 ls0 ws0">=<span class="_ _32"> </span>1<span class="_ _37"> </span><span class="ffe">−<span class="_ _37"> </span><span class="ffd">E<span class="_ _23"></span></span></span>(<span class="ffd">f<span class="_ _34"> </span></span>;<span class="_ _31"> </span><span class="ffe">D<span class="_ _23"></span></span>)</div><div class="t m0 xaf h4 y22b ff3 fs2 fc0 sc0 ls0 ws0">(3.6)</div><div class="t m0 x3 h6 y22c ff4 fs2 fc0 sc0 ls0 ws0">以下是各分类情形下的定义：</div><div class="t m0 x3 h6 y22d ff1 fs2 fc0 sc0 ls0 ws0">根据混淆矩阵</div><div class="t m0 xcc h4 y22e ff3 fs2 fc0 sc0 ls0 ws0">(</div><div class="t m0 x3b h6 y22d ff1 fs2 fc0 sc0 ls0 ws0">表<span class="ff3">3.1)</span>，各分类的错误率和准确率定义如下：</div><div class="t m0 xcd he y22f ffd fs2 fc0 sc0 ls0 ws0">E</div><div class="t m0 x4b hb y230 ffc fs7 fc0 sc0 ls0 ws0">P</div><div class="t m0 xce h4 y22f fff fs2 fc0 sc0 ls0 ws0">(<span class="ffd">f<span class="_ _34"></span></span>;<span class="_ _31"> </span><span class="ffd">D<span class="_ _23"></span></span>)<span class="_ _a"> </span>=</div><div class="t m0 x16 he y231 ffd fs2 fc0 sc0 ls0 ws0">T<span class="_ _33"> </span>N</div><div class="t m0 x47 h4 y232 ffd fs2 fc0 sc0 ls0 ws0">T<span class="_ _33"> </span>P<span class="_ _e"> </span><span class="fff">+<span class="_ _37"> </span></span>F<span class="_ _33"> </span>N</div><div class="t m0 xcf he y22f ffd fs2 fc0 sc0 ls0 ws0">E</div><div class="t m0 x71 hb y230 ffc fs7 fc0 sc0 ls0 ws0">N</div><div class="t m0 x78 h4 y22f fff fs2 fc0 sc0 ls0 ws0">(<span class="ffd">f<span class="_ _34"></span></span>;<span class="_ _31"> </span><span class="ffd">D<span class="_ _23"></span></span>)<span class="_ _a"> </span>=</div><div class="t m0 xd0 he y231 ffd fs2 fc0 sc0 ls0 ws0">F<span class="_ _33"> </span>P</div><div class="t m0 x64 h4 y232 ffd fs2 fc0 sc0 ls0 ws0">T<span class="_ _33"> </span>N<span class="_ _d"> </span><span class="fff">+<span class="_ _37"> </span></span>F<span class="_ _33"> </span>P</div><div class="t m0 xd1 he y233 ffd fs2 fc0 sc0 ls0 ws0">acc</div><div class="t m0 x3e hb y234 ffc fs7 fc0 sc0 ls0 ws0">P</div><div class="t m0 x4b h4 y233 fff fs2 fc0 sc0 ls0 ws0">(<span class="ffd">f<span class="_ _34"></span></span>;<span class="_ _31"> </span><span class="ffd">D<span class="_ _23"></span></span>)<span class="_ _a"> </span>=</div><div class="t m0 x28 he y235 ffd fs2 fc0 sc0 ls0 ws0">T<span class="_ _33"> </span>P</div><div class="t m0 x9b h4 y236 ffd fs2 fc0 sc0 ls0 ws0">T<span class="_ _33"> </span>P<span class="_ _e"> </span><span class="fff">+<span class="_ _37"> </span></span>F<span class="_ _33"> </span>N</div><div class="t m0 x5f he y233 ffd fs2 fc0 sc0 ls0 ws0">acc</div><div class="t m0 x71 hb y234 ffc fs7 fc0 sc0 ls0 ws0">N</div><div class="t m0 x78 h4 y233 fff fs2 fc0 sc0 ls0 ws0">(<span class="ffd">f<span class="_ _34"></span></span>;<span class="_ _31"> </span><span class="ffd">D<span class="_ _23"></span></span>)<span class="_ _a"> </span>=</div><div class="t m0 xd0 he y235 ffd fs2 fc0 sc0 ls0 ws0">T<span class="_ _33"> </span>N</div><div class="t m0 x64 h4 y236 ffd fs2 fc0 sc0 ls0 ws0">T<span class="_ _33"> </span>N<span class="_ _d"> </span><span class="fff">+<span class="_ _37"> </span></span>F<span class="_ _33"> </span>P</div><div class="t m0 xaf h4 y237 ff3 fs2 fc0 sc0 ls0 ws0">(3.7)</div><div class="t m0 x3 hd y238 ff5 fs8 fc0 sc0 ls0 ws0">3.2.3<span class="_ _36"> </span>Precision<span class="ff9">、</span>Recall</div><div class="t m0 x3 h6 y239 ff1 fs2 fc0 sc0 ls0 ws0">错误率和精度虽然常用，<span class="_ _30"></span>但不能满足所有的需求，<span class="_ _30"></span>例如：<span class="_ _27"></span>在推荐系统中，<span class="_ _30"></span>我们只关心推送给用户</div><div class="t m0 x3 h6 y23a ff1 fs2 fc0 sc0 ls0 ws0">的内容用户是否感兴趣（即查准率）<span class="_ _2f"></span>，或<span class="_ _23"></span>者说所有用户感兴趣的内容我们推送出来了多少（即查</div><div class="t m0 x3 h6 y23b ff1 fs2 fc0 sc0 ls0 ws0">全率）<span class="_ _26"></span>。因此，使用查准<span class="ff3">/</span>查全率更适合描述这类问题。</div><div class="t m0 x3 h6 y23c ff4 fs2 fc0 sc0 ls0 ws0">定义<span class="ff6">3.3<span class="_ _5"> </span><span class="fc1">Recall(<span class="ff4">查全率、<span class="_ _23"></span>召回率</span>)<span class="ff4">：<span class="_ _e"> </span></span></span><span class="ff1">模型<span class="_ _23"></span>挑选出正类<span class="_ _23"></span>样本的能力。<span class="_ _23"></span>所有正例样<span class="_ _23"></span>本中，预测正<span class="_ _23"></span>确</span></span></div><div class="t m0 x3 h6 y23d ff1 fs2 fc0 sc0 ls0 ws0">的样本所占比例。</div><div class="t m0 x3 h6 y23e ff4 fs2 fc0 sc0 ls0 ws0">定义<span class="ff6">3.4<span class="_ _5"> </span><span class="fc1">Precision(<span class="ff4">查准率</span>)<span class="ff4">：<span class="_ _d"> </span></span></span><span class="ff1">在所有预测为正例的样本中，预测正确的样本所占比例。</span></span></div><div class="t m0 x22 h4 y23f ffd fs2 fc0 sc0 ls0 ws0">P<span class="_ _33"> </span>r<span class="_ _23"></span>ecision<span class="_ _a"> </span><span class="fff">=</span></div><div class="t m0 xd2 he y240 ffd fs2 fc0 sc0 ls0 ws0">T<span class="_ _33"> </span>P</div><div class="t m0 x76 h4 y241 ffd fs2 fc0 sc0 ls0 ws0">T<span class="_ _33"> </span>P<span class="_ _e"> </span><span class="fff">+<span class="_ _37"> </span></span>F<span class="_ _33"> </span>P</div><div class="t m0 xaf h4 y23f ff3 fs2 fc0 sc0 ls0 ws0">(3.8)</div><div class="t m0 xd3 h4 y242 ffd fs2 fc0 sc0 ls0 ws0">Recal<span class="_ _23"></span>l<span class="_ _32"> </span><span class="fff">=</span></div><div class="t m0 xd4 he y243 ffd fs2 fc0 sc0 ls0 ws0">T<span class="_ _33"> </span>P</div><div class="t m0 x98 h4 y244 ffd fs2 fc0 sc0 ls0 ws0">T<span class="_ _33"> </span>P<span class="_ _e"> </span><span class="fff">+<span class="_ _37"> </span></span>F<span class="_ _33"> </span>N</div><div class="t m0 xaf h4 y242 ff3 fs2 fc0 sc0 ls0 ws0">(3.9)</div><div class="t m0 x3 h6 y245 ff1 fs2 fc0 sc0 ls0 ws0">根据上式，可以看出，<span class="ff3">Recall<span class="_ _d"> </span></span>就是各分类情形下的<span class="_ _d"> </span><span class="ff3">accuracy</span>。</div><div class="t m0 x3 h6 y246 ff1 fs2 fc0 sc0 ls0 ws0">很多<span class="_ _23"></span>时候，分<span class="_ _23"></span>类模型<span class="_ _23"></span>的精<span class="_ _23"></span>度与召<span class="_ _23"></span>回率之<span class="_ _23"></span>间存在<span class="_ _23"></span>着某种<span class="_ _23"></span>此消<span class="_ _23"></span>彼长的<span class="_ _23"></span>关系。通<span class="_ _23"></span>常只有<span class="_ _23"></span>在一<span class="_ _23"></span>些简单<span class="_ _23"></span>的</div><div class="t m0 x3 h6 y247 ff1 fs2 fc0 sc0 ls0 ws0">任务中，才可能使<span class="_ _d"> </span><span class="ff3">Recall</span>、<span class="ff3">Precision<span class="_ _d"> </span></span>都很高。</div><div class="t m0 x3 h6 y248 ff1 fs2 fc0 sc0 ls0 ws0">对于某些应用来讲，我们可能希望<span class="_ _25"> </span><span class="ff3">Precision<span class="_ _d"> </span></span>越高越好，那么就需要适当牺牲一些召回率，<span class="_ _12"></span>将分</div><div class="t m0 x3 h6 y249 ff1 fs2 fc0 sc0 ls0 ws0">类阈值调高；<span class="_ _23"></span>而对于另一些应<span class="_ _23"></span>用来讲，我们可能希<span class="_ _23"></span>望<span class="_ _d"> </span><span class="ff3">Recall<span class="_ _e"> </span></span>越高越好，那<span class="_ _23"></span>么就需要适当牺牲<span class="_ _23"></span>一</div><div class="t m0 x3 h6 y24a ff1 fs2 fc0 sc0 ls0 ws0">些<span class="_ _25"> </span><span class="ff3">Precision</span>，<span class="_ _29"></span>将分类阈值调低，<span class="_ _29"></span>从而使更多的样本被分为正类。<span class="_ _29"></span>因此，<span class="_ _29"></span>对于不同的应用场景，<span class="_ _29"></span>对</div><div class="t m0 x3 h6 y24b ff3 fs2 fc0 sc0 ls0 ws0">Precision<span class="_ _d"> </span><span class="ff1">和<span class="_ _d"> </span></span>Recall<span class="_ _d"> </span><span class="ff1">的关注程度也会有所不同，需要根据实际情况进行权衡。</span></div><div class="t m0 x3 h6 y24c ff1 fs2 fc0 sc0 ls0 ws0">在很<span class="_ _23"></span>多情形<span class="_ _23"></span>下，学习<span class="_ _23"></span>器可<span class="_ _23"></span>以得到<span class="_ _23"></span>样本属<span class="_ _23"></span>于正类<span class="_ _23"></span>的概率<span class="_ _23"></span>（或者<span class="_ _23"></span>其他度<span class="_ _23"></span>量样本<span class="_ _23"></span>属于正<span class="_ _23"></span>类可<span class="_ _23"></span>能性大<span class="_ _23"></span>小</div><div class="t m0 x3 h6 y24d ff1 fs2 fc0 sc0 ls0 ws0">的量）<span class="_ _2f"></span>。我们可以按概率的大小对样本<span class="_ _23"></span>进行排序，然后逐个把样本对应的概率作为分类阈值，则</div><div class="t m0 x3 h6 y24e ff1 fs2 fc0 sc0 ls0 ws0">每次可以计算出当前的<span class="_ _d"> </span><span class="ff3">Precision<span class="_ _d"> </span></span>和<span class="_ _d"> </span><span class="ff3">Recall</span>。以<span class="_ _25"> </span><span class="ff3">Precision<span class="_ _d"> </span></span>和<span class="_ _d"> </span><span class="ff3">Recall<span class="_ _d"> </span></span>分别作为纵轴、横轴，就得</div><div class="t m0 x3 h6 y24f ff1 fs2 fc0 sc0 ls0 ws0">到了“查准率<span class="ff3">-</span>查全<span class="_ _23"></span>率曲线”<span class="_ _3e"></span>，简称<span class="fc2">“<span class="ff3">P-R<span class="_ _d"> </span></span>曲线<span class="_ _23"></span>（<span class="ff3">Precision<span class="_ _d"> </span>Recall<span class="_ _d"> </span>Curve</span>）<span class="_ _3e"></span>”<span class="fc0">，显示该曲线的图<span class="_ _23"></span>称</span></span></div><div class="t m0 x3 h6 y250 ff1 fs2 fc0 sc0 ls0 ws0">为<span class="ff3">”P-R<span class="_ _d"> </span></span>图<span class="ff3">”</span>。</div><div class="t m0 x3 h6 y251 ff3 fs2 fc0 sc0 ls0 ws0">P-R<span class="_ _e"> </span><span class="ff1">曲<span class="_ _23"></span>线的作<span class="_ _23"></span>用：很好地<span class="_ _23"></span>表示精<span class="_ _23"></span>度与召回<span class="_ _23"></span>率之间<span class="_ _23"></span>的权衡关<span class="_ _23"></span>系，在实<span class="_ _23"></span>际应用<span class="_ _23"></span>中可以根<span class="_ _23"></span>据实际<span class="_ _23"></span>情况</span></div><div class="t m0 x3 h6 y252 ff1 fs2 fc0 sc0 ls0 ws0">选取曲线上合适的点所对于的分类阈值作为最终分类器的阈值。</div><div class="t m0 x3 h6 y253 ff1 fs2 fc0 sc0 ls0 ws0">示意图中有三个学习器的<span class="_ _d"> </span><span class="ff3">P-R<span class="_ _d"> </span></span>曲线。</div><div class="t m0 xbc h4 y3 ff3 fs2 fc0 sc0 ls0 ws0">15</div><a class="l" href="#pf14" data-dest-detail='[20,"XYZ",70.87,806.14,null]'><div class="d m1" style="border-style:none;position:absolute;left:232.659000px;bottom:893.680500px;width:13.942000px;height:15.458000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.500000,0.000000,0.000000,1.500000,0.000000,0.000000]}'></div></div>
<div id="pf16" class="pf w0 h0" data-page-no="16"><div class="pc pc16 w0 h0"><img class="bi x3 y142 w1 h14" alt="" src="bg16.png"/><div class="t m0 x3 h7 y21 ff3 fs5 fc0 sc0 ls0 ws0">3.2<span class="_ _8"> </span><span class="ff7">分类</span></div><div class="t m0 xf h6 y254 ff1 fs2 fc0 sc0 ls0 ws0">图<span class="_ _d"> </span><span class="ff3">3.1:<span class="_ _35"> </span>Precision<span class="_ _d"> </span>Recall<span class="_ _d"> </span>Curve</span></div><div class="t m0 x13 h6 y255 ff6 fs2 fc2 sc0 ls0 ws0">1.<span class="_ _5"> </span><span class="ff4">显然，若一个学习器<span class="_ _1e"> </span></span>C<span class="_ _1e"> </span><span class="ff4">的<span class="_ _1e"> </span></span>P-R<span class="_ _e"> </span><span class="ff4">曲线被另一个<span class="_ _23"></span>学习器<span class="_ _e"> </span></span>A<span class="_ _1e"> </span><span class="ff4">的<span class="_ _e"> </span></span>P-R<span class="_ _1e"> </span><span class="ff4">曲线完全包住，</span></div><div class="t m0 x13 h6 y256 ff4 fs2 fc2 sc0 ls0 ws0">则称：<span class="ff6">A<span class="_ _e"> </span></span>的性能优于<span class="_ _1e"> </span><span class="ff6">C</span>。</div><div class="t m0 x3 h6 y257 ff1 fs2 fc0 sc0 ls0 ws0">如果两个学习器的<span class="_ _d"> </span><span class="ff3">P-R<span class="_ _e"> </span></span>曲线发生了交叉，例如图<span class="ff3">3.1</span>中的<span class="_ _d"> </span><span class="ff3">A<span class="_ _e"> </span></span>与<span class="_ _d"> </span><span class="ff3">B<span class="_ _d"> </span></span>，则不能一般性地断言<span class="_ _23"></span>两者孰</div><div class="t m0 x3 h6 y258 ff1 fs2 fc0 sc0 ls0 ws0">优孰劣。<span class="_ _30"></span>只能在具体的查准率或查全率条件下进行比较。<span class="_ _27"></span>然而，<span class="_ _30"></span>在很多情形下，<span class="_ _30"></span>人们往往仍希望</div><div class="t m0 x3 h6 y259 ff1 fs2 fc0 sc0 ls0 ws0">把学习器<span class="_ _d"> </span><span class="ff3">A<span class="_ _d"> </span></span>与<span class="_ _d"> </span><span class="ff3">B<span class="_ _d"> </span></span>比出个高低。存在以下比较准则：</div><div class="t m0 x13 h6 y25a ff6 fs2 fc2 sc0 ls0 ws0">2.<span class="_ _5"> </span><span class="ff4">若<span class="_ _e"> </span></span>A<span class="_ _1e"> </span><span class="ff4">和<span class="_ _1e"> </span></span>B<span class="_ _e"> </span><span class="ff4">的曲线发生了交叉，则谁的曲线下的面积大，谁的性能更优。</span></div><div class="t m0 x3 h6 y25b ff1 fs2 fc0 sc0 ls0 ws0">但曲线下的面积难以进行估算，<span class="_ _30"></span>所以，<span class="_ _30"></span>人们设计了一些综合考虑查准率、<span class="_ _27"></span>查全率的性能度量，<span class="_ _30"></span>例</div><div class="t m0 x3 h6 y25c ff1 fs2 fc0 sc0 ls0 ws0">如<span class="ff4">平衡点</span>（平衡点如图<span class="ff3">3.1</span>所示）<span class="_ _26"></span>。</div><div class="t m0 x13 h6 y25d ff6 fs2 fc2 sc0 ls0 ws0">3. <span class="ff4">平衡点（</span>Break-Even<span class="_ _28"></span>t<span class="_ _1e"> </span>Poin<span class="_ _28"></span>t<span class="ff4">，简称<span class="_ _35"> </span></span>BEP<span class="ff4">）<span class="_ _3e"></span>：即当<span class="_ _1e"> </span><span class="ff6">P=R<span class="_ _1e"> </span></span>时<span class="_ _23"></span>的取值，平衡点的</span></div><div class="t m0 x13 h6 y25e ff4 fs2 fc2 sc0 ls0 ws0">取值越高，性能更优。</div><div class="t m0 x3 h6 y25f ff1 fs2 fc0 sc0 ls0 ws0">但<span class="_ _d"> </span><span class="ff3">BEP<span class="_ _d"> </span></span>还是过于简化了些，更常用的是<span class="_ _d"> </span><span class="ff6">F1<span class="_ _d"> </span></span>度量<span class="_ _d"> </span><span class="ff3">(<span class="ff6">F1<span class="_ _d"> </span></span></span>度量实际是<span class="ff4">调和平均值<span class="ff3">)</span></span>：</div><div class="t m0 x13 h6 y260 ff6 fs2 fc2 sc0 ls0 ws0">4.<span class="_ _5"> </span>F1<span class="_ _e"> </span><span class="ff4">值越大，性能越优。</span></div><div class="t m0 xd5 h4 y261 ffd fs2 fc0 sc0 ls0 ws0">F<span class="_ _33"> </span><span class="fff">1<span class="_ _a"> </span>=</span></div><div class="t m0 x59 h4 y262 fff fs2 fc0 sc0 ls0 ws0">1</div><div class="t m0 x49 ha y263 ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 x49 ha y264 ff12 fs7 fc0 sc0 ls0 ws0">2</div><div class="t m0 x3f h4 y265 ffe fs2 fc0 sc0 ls0 ws0">×<span class="_ _37"> </span><span class="fff">(</span></div><div class="t m0 x31 ha y263 ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 x0 hb y264 ffc fs7 fc0 sc0 ls0 ws0">P</div><div class="t m0 xc1 h4 y265 fff fs2 fc0 sc0 ls0 ws0">+</div><div class="t m0 x51 ha y263 ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 x10 hb y264 ffc fs7 fc0 sc0 ls0 ws0">R</div><div class="t m0 x72 h4 y265 fff fs2 fc0 sc0 ls0 ws0">)</div><div class="t m0 xd6 h4 y261 fff fs2 fc0 sc0 ls0 ws0">=</div><div class="t m0 x23 h4 y262 fff fs2 fc0 sc0 ls0 ws0">2<span class="_ _37"> </span><span class="ffe">×<span class="_ _37"> </span><span class="ffd">P<span class="_ _e"> </span></span>×<span class="_ _37"> </span><span class="ffd">R</span></span></div><div class="t m0 x96 h4 y266 ffd fs2 fc0 sc0 ls0 ws0">P<span class="_ _e"> </span><span class="fff">+<span class="_ _37"> </span></span>R</div><div class="t m0 x9e h4 y261 fff fs2 fc0 sc0 ls0 ws0">=</div><div class="t m0 x63 h4 y262 fff fs2 fc0 sc0 ls0 ws0">2<span class="_ _37"> </span><span class="ffe">×<span class="_ _37"> </span><span class="ffd">T<span class="_ _33"> </span>P</span></span></div><div class="t m0 x78 h6 y267 ff1 fs2 fc0 sc0 ls0 ws0">样本总数<span class="_ _37"> </span><span class="fff">+<span class="_ _37"> </span><span class="ffd">T<span class="_ _33"> </span>P<span class="_ _e"> </span><span class="ffe">−<span class="_ _37"> </span></span>T<span class="_ _33"> </span>N</span></span></div><div class="t m0 x86 h4 y261 ff3 fs2 fc0 sc0 ls0 ws0">(3.10)</div><div class="t m0 x3 h6 y268 ff1 fs2 fc2 sc0 ls0 ws0">容易证明：<span class="_ _2e"></span><span class="ff3">F1 Score<span class="_ _25"> </span><span class="ff1">与查准率和召回率之间存在着正向的关系，<span class="_ _2e"></span>也就是查准率越高，<span class="_ _2e"></span><span class="ff3">F1<span class="_ _25"> </span>Score<span class="_ _25"> </span><span class="ff1">就</span></span></span></span></div><div class="t m0 x3 h6 y269 ff1 fs2 fc2 sc0 ls0 ws0">越大，同样召回率越高，<span class="ff3">F1<span class="_ _d"> </span>Score<span class="_ _d"> </span></span>也就越大。</div><div class="t m0 x3 h6 y26a ff1 fs2 fc0 sc0 ls0 ws0">但是在<span class="_ _23"></span>一些应用中，对<span class="_ _23"></span>查准率和查<span class="_ _23"></span>全率的重视程<span class="_ _23"></span>度有所不同，<span class="_ _23"></span>这就需要对<span class="_ _23"></span>它们赋予不同<span class="_ _23"></span>的权重，</div><div class="t m0 x3 h6 y26b ff1 fs2 fc0 sc0 ls0 ws0">因此有<span class="_ _d"> </span><span class="ff3">F1<span class="_ _d"> </span></span>的更一般形式<span class="_ _d"> </span><span class="ffd">F</span></div><div class="t m0 xce hb y26c ffc fs7 fc0 sc0 ls0 ws0">β</div><div class="t m0 xd7 h6 y26b ff3 fs2 fc0 sc0 ls0 ws0">(<span class="ff4">加权调和平均</span>)<span class="ff1">：</span></div><div class="t m0 x58 he y26d ffd fs2 fc0 sc0 ls0 ws0">F</div><div class="t m0 x0 hb y26e ffc fs7 fc0 sc0 ls0 ws0">β</div><div class="t m0 xd8 h4 y26d fff fs2 fc0 sc0 ls0 ws0">=</div><div class="t m0 x16 h4 y26f fff fs2 fc0 sc0 ls0 ws0">1</div><div class="t m0 x69 ha y270 ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 x10 hb y271 ffc fs7 fc0 sc0 ls0 ws0">β</div><div class="t m0 x73 h1c y272 ff16 fs9 fc0 sc0 ls0 ws0">2</div><div class="t m0 x11 h4 y273 fff fs2 fc0 sc0 ls0 ws0">(</div><div class="t m0 x28 ha y270 ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 x9c hb y274 ffc fs7 fc0 sc0 ls0 ws0">P</div><div class="t m0 x52 h4 y273 fff fs2 fc0 sc0 ls0 ws0">+</div><div class="t m0 x96 hb y275 ffc fs7 fc0 sc0 ls0 ws0">β</div><div class="t m0 x5c h1c y276 ff16 fs9 fc0 sc0 ls0 ws0">2</div><div class="t m0 x5d hb y274 ffc fs7 fc0 sc0 ls0 ws0">R</div><div class="t m0 xd9 h4 y273 fff fs2 fc0 sc0 ls0 ws0">)</div><div class="t m0 x5e h4 y26d fff fs2 fc0 sc0 ls0 ws0">=</div><div class="t m0 x76 h4 y26f fff fs2 fc0 sc0 ls0 ws0">(1<span class="_ _37"> </span>+<span class="_ _37"> </span><span class="ffd">β</span></div><div class="t m0 x44 ha y277 ff12 fs7 fc0 sc0 ls0 ws0">2</div><div class="t m0 x25 h4 y26f fff fs2 fc0 sc0 ls0 ws0">)<span class="_ _37"> </span><span class="ffe">×<span class="_ _37"> </span><span class="ffd">P<span class="_ _e"> </span></span>×<span class="_ _37"> </span><span class="ffd">R</span></span></div><div class="t m0 x36 he y278 ffd fs2 fc0 sc0 ls0 ws0">β</div><div class="t m0 x60 ha y279 ff12 fs7 fc0 sc0 ls0 ws0">2</div><div class="t m0 x66 h4 y278 ffe fs2 fc0 sc0 ls0 ws0">×<span class="_ _37"> </span><span class="ffd">P<span class="_ _e"> </span><span class="fff">+<span class="_ _37"> </span></span>R</span></div><div class="t m0 x86 h4 y26d ff3 fs2 fc0 sc0 ls0 ws0">(3.11)</div><div class="t m0 x3 h6 y27a ff1 fs2 fc0 sc0 ls0 ws0">其中<span class="_ _25"> </span><span class="ffd">β<span class="_ _d"> </span>&gt;<span class="_ _32"> </span><span class="fff">0<span class="_ _25"> </span></span></span>度量了查全率对查准率的相对重要性。<span class="_ _27"></span><span class="ffd">β<span class="_ _d"> </span><span class="fff">=<span class="_ _32"> </span>1<span class="_ _25"> </span><span class="ff1">时退化为标准的<span class="_ _d"> </span><span class="ff3">F1;<span class="_ _25"> </span></span></span></span>β<span class="_ _d"> </span>&gt;<span class="_ _32"> </span><span class="fff">1<span class="_ _d"> </span><span class="ff1">时查全率有</span></span></span></div><div class="t m0 x3 h6 y27b ff1 fs2 fc0 sc0 ls0 ws0">更大影响<span class="ff3">;<span class="_ _d"> </span><span class="ffd">β<span class="_ _d"> </span>&lt;<span class="_ _a"> </span><span class="fff">1<span class="_ _d"> </span></span></span></span>时查准率有更大影响。</div><div class="t m0 x12 h6 y27c ff1 fs2 fc0 sc0 ls0 ws0">与算术平均</div><div class="t m0 xda ha y27d ffc fs7 fc0 sc0 ls0 ws0">P<span class="_ _34"> </span><span class="ff12">+</span>R</div><div class="t m0 x54 ha y27e ff12 fs7 fc0 sc0 ls0 ws0">2</div><div class="t m0 xdb h6 y27c ff1 fs2 fc0 sc0 ls0 ws0">和几何平均</div><div class="t m0 x2 h4 y27f ffe fs2 fc0 sc0 ls0 ws0">√</div><div class="t m0 x10 h6 y27c ffd fs2 fc0 sc0 ls0 ws0">P<span class="_ _e"> </span><span class="ffe">×<span class="_ _37"> </span></span>R<span class="_ _d"> </span><span class="ff1">相比，调和平均更重视较小值。</span></div><div class="t m0 x3 h4 y3 ff3 fs2 fc0 sc0 ls0 ws0">16</div><a class="l" href="#pf16" data-dest-detail='[22,"XYZ",70.87,806.14,null]'><div class="d m1" style="border-style:none;position:absolute;left:457.413000px;bottom:737.709000px;width:13.942000px;height:15.459000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf16" data-dest-detail='[22,"XYZ",70.87,806.14,null]'><div class="d m1" style="border-style:none;position:absolute;left:269.935500px;bottom:581.751000px;width:13.942000px;height:15.458000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.500000,0.000000,0.000000,1.500000,0.000000,0.000000]}'></div></div>
<div id="pf17" class="pf w0 h0" data-page-no="17"><div class="pc pc17 w0 h0"><img class="bi xdc y280 w8 h1d" alt="" src="bg17.png"/><div class="t m0 x85 h7 y21 ff3 fs5 fc0 sc0 ls0 ws0">3.2<span class="_ _8"> </span><span class="ff7">分类</span></div><div class="t m0 x3 hd yb2 ff5 fs8 fc0 sc0 ls0 ws0">3.2.4<span class="_ _36"> </span>TPR<span class="ff9">、</span>FPR</div><div class="t m0 x3 h6 y281 ff4 fs2 fc0 sc0 ls0 ws0">定义<span class="ff6">3.5<span class="_ _5"> </span><span class="fc1">TPR<span class="ff4">：<span class="_ _e"> </span></span></span><span class="ff3">T<span class="_ _27"></span>rue<span class="_ _e"> </span>Positiv<span class="_ _28"></span>e<span class="_ _e"> </span>Rate<span class="ff1">，真<span class="_ _23"></span>正例率。所有正<span class="_ _23"></span>例样本中，预<span class="_ _23"></span>测正确的样本<span class="_ _23"></span>所占比例。</span></span></span></div><div class="t m0 x3 h6 y282 ff3 fs2 fc0 sc0 ls0 ws0">TPR<span class="_ _d"> </span><span class="ff1">就是<span class="_ _d"> </span></span>Recall<span class="ff1">。</span></div><div class="t m0 x3 h6 y283 ff4 fs2 fc0 sc0 ls0 ws0">定义<span class="ff6">3.6<span class="_ _5"> </span><span class="fc1">FPR<span class="ff4">：<span class="_ _25"> </span></span></span><span class="ff3">F<span class="_ _28"></span>alse<span class="_ _d"> </span>P<span class="_ _12"></span>ositiv<span class="_ _12"></span>e<span class="_ _d"> </span>Rate<span class="ff1">，伪阳性率、假正例率、也称误报率（</span>Probabilit<span class="_ _28"></span>y<span class="_ _d"> </span>of<span class="_ _d"> </span>F<span class="_ _27"></span>alse</span></span></div><div class="t m0 x3 h6 y284 ff3 fs2 fc0 sc0 ls0 ws0">Alarm<span class="ff1">）<span class="_ _26"></span>、错误命中率、假警报率，<span class="_ _12"></span>简记为<span class="_ _d"> </span><span class="ff3">FPR</span>。在所有实际上为负类的样本中，<span class="_ _12"></span>误判为正类的</span></div><div class="t m0 x3 h6 y285 ff1 fs2 fc0 sc0 ls0 ws0">样本所占的比例。</div><div class="t m0 xd6 h4 y286 ffd fs2 fc0 sc0 ls0 ws0">T<span class="_ _33"> </span>P<span class="_ _33"> </span>R<span class="_ _32"> </span><span class="fff">=</span></div><div class="t m0 x29 he y287 ffd fs2 fc0 sc0 ls0 ws0">T<span class="_ _33"> </span>P</div><div class="t m0 x6f h4 y288 ffd fs2 fc0 sc0 ls0 ws0">T<span class="_ _33"> </span>P<span class="_ _e"> </span><span class="fff">+<span class="_ _37"> </span></span>F<span class="_ _33"> </span>N</div><div class="t m0 x86 h4 y286 ff3 fs2 fc0 sc0 ls0 ws0">(3.12)</div><div class="t m0 xd6 h4 y289 ffd fs2 fc0 sc0 ls0 ws0">F<span class="_ _33"> </span>P<span class="_ _33"> </span>R<span class="_ _32"> </span><span class="fff">=</span></div><div class="t m0 x29 he y28a ffd fs2 fc0 sc0 ls0 ws0">F<span class="_ _33"> </span>P</div><div class="t m0 x6f h4 y28b ffd fs2 fc0 sc0 ls0 ws0">T<span class="_ _33"> </span>N<span class="_ _d"> </span><span class="fff">+<span class="_ _37"> </span></span>F<span class="_ _33"> </span>P</div><div class="t m0 x86 h4 y289 ff3 fs2 fc0 sc0 ls0 ws0">(3.13)</div><div class="t m0 x3 h6 y28c ff1 fs2 fc0 sc0 ls0 ws0">除了<span class="_ _25"> </span><span class="ff3">TPR</span>、<span class="_ _27"></span><span class="ff3">FPR<span class="ff1">，<span class="_ _27"></span>还有真负例率和假负例率。<span class="_ _27"></span><span class="ff3 fc2">TPR<span class="ff1">、<span class="_ _27"></span><span class="ff3">FPR<span class="_ _25"> </span><span class="ff1">有一个很好的特性：<span class="_ _27"></span>对数据集是否均</span></span></span></span></span></span></div><div class="t m0 x3 h6 y28d ff1 fs2 fc2 sc0 ls0 ws0">衡不敏感<span class="fc0">，<span class="_ _2a"></span>因为<span class="_ _25"> </span><span class="ff6">TPR<span class="ff4">、<span class="_ _2e"></span><span class="ff6">FPR<span class="_ _d"> </span><span class="ff4">的分子和分母只涉及了单一类别的样本<span class="ff1">。<span class="_ _2e"></span><span class="ff3">R<span class="_ _12"></span>OC <span class="ff1">曲线以<span class="_ _32"> </span></span>TPR<span class="ff1">、<span class="_ _2e"></span><span class="ff3">FPR</span></span></span></span></span></span></span></span></span></div><div class="t m0 x3 h6 y28e ff1 fs2 fc0 sc0 ls0 ws0">基础的，所以这也是<span class="_ _d"> </span><span class="ff3">R<span class="_ _12"></span>OC<span class="_ _d"> </span><span class="ff1">曲线的优点。</span></span></div><div class="t m0 x3 hd y28f ff5 fs8 fc0 sc0 ls0 ws0">3.2.5<span class="_ _36"> </span>R<span class="_ _28"></span>OC<span class="ff9">、</span>A<span class="_ _12"></span>UC</div><div class="t m0 x3 h6 y290 ff1 fs2 fc0 sc0 ls0 ws0">很多学习器是为测试样本产生一个实值或概率预测，<span class="_ _2e"></span>然后将这个预测值与一个分类阈值<span class="_ _25"> </span><span class="ff3">(thresh-</span></div><div class="t m0 x3 h6 y291 ff3 fs2 fc0 sc0 ls0 ws0">old)<span class="_ _1e"> </span><span class="ff1">进行比<span class="_ _23"></span>较，若大<span class="_ _23"></span>于阈值<span class="_ _23"></span>则分为<span class="_ _23"></span>正类，否<span class="_ _23"></span>则为反<span class="_ _23"></span>类。这个<span class="_ _23"></span>实值或<span class="_ _23"></span>概率预测<span class="_ _23"></span>结果的<span class="_ _23"></span>好坏，直<span class="_ _23"></span>接</span></div><div class="t m0 x3 h6 y292 ff1 fs2 fc0 sc0 ls0 ws0">决定<span class="_ _23"></span>了学习<span class="_ _23"></span>器的<span class="_ _23"></span>泛化能<span class="_ _23"></span>力。实际<span class="_ _23"></span>上，根据<span class="_ _23"></span>这个<span class="_ _23"></span>实值或<span class="_ _23"></span>概率预<span class="_ _23"></span>测结<span class="_ _23"></span>果，我们<span class="_ _23"></span>可将测<span class="_ _23"></span>试样本<span class="_ _23"></span>进行<span class="_ _23"></span>排</div><div class="t m0 x3 h6 y293 ff1 fs2 fc0 sc0 ls0 ws0">序，<span class="_ _39"></span>“最可能”<span class="_ _28"></span>是正例的排在最前面，<span class="_ _30"></span><span class="ff3">”<span class="_ _d"> </span><span class="ff1">最不可能</span>”<span class="_ _25"> </span><span class="ff1">是正例的排在最后面。<span class="_ _27"></span>这样，<span class="_ _30"></span>分类过程就相当</span></span></div><div class="t m0 x3 h6 y294 ff1 fs2 fc0 sc0 ls0 ws0">于在这个排序中以某个<span class="ff3">”<span class="_ _25"> </span></span>截断点<span class="ff3">”<span class="_ _d"> </span>(cut<span class="_ _d"> </span>p<span class="_ _23"></span>oin<span class="_ _28"></span>t)<span class="_ _d"> </span><span class="ff1">将样本分为两部分，<span class="_ _28"></span>前一部分判作正例，<span class="_ _28"></span>后一部分</span></span></div><div class="t m0 x3 h6 y295 ff1 fs2 fc0 sc0 ls0 ws0">则判作反例。</div><div class="t m0 x3 h6 y296 ff4 fs2 fc0 sc0 ls0 ws0">定义<span class="ff6">3.7<span class="_ _5"> </span><span class="fc1">R<span class="_ _28"></span>OC<span class="ff4">：<span class="ff3 fc0">R<span class="_ _28"></span>OC <span class="ff1">曲线的全称为<span class="_ _a"> </span></span>Receiver<span class="_ _a"> </span>Operating Characteristic<span class="ff1">，<span class="_ _2b"></span>其纵轴为<span class="_ _37"> </span><span class="ff3">T<span class="_ _28"></span>rue P<span class="_ _28"></span>ositive</span></span></span></span></span></span></div><div class="t m0 x3 h6 y297 ff3 fs2 fc0 sc0 ls0 ws0">Rate<span class="_ _25"> </span>(TPR)<span class="ff1">，<span class="_ _30"></span>也就是召回率，<span class="_ _30"></span>横轴为伪阳性率<span class="_ _25"> </span><span class="ff3">F<span class="_ _27"></span>alse<span class="_ _d"> </span>P<span class="_ _12"></span>ositiv<span class="_ _12"></span>e<span class="_ _25"> </span>Rate<span class="_ _25"> </span>(FPR)<span class="ff1">。<span class="_ _27"></span>显示<span class="_ _25"> </span><span class="ff3">ROC </span>曲线的图</span></span></span></div><div class="t m0 x3 h6 y298 ff1 fs2 fc0 sc0 ls0 ws0">称为<span class="ff3">”R<span class="_ _12"></span>OC<span class="_ _d"> </span><span class="ff1">图。</span></span></div><div class="t m0 x3 h6 y299 ff1 fs2 fc0 sc0 ls0 ws0">下图给出了一个示意图：</div><div class="t m0 x22 h6 y29a ff1 fs2 fc0 sc0 ls0 ws0">图<span class="_ _d"> </span><span class="ff3">3.2:<span class="_ _35"> </span>ro<span class="_ _23"></span>c<span class="_ _d"> </span></span>与<span class="_ _d"> </span><span class="ff3">auc<span class="_ _d"> </span></span>曲线</div><div class="t m0 x3 h6 y29b ff1 fs2 fc0 sc0 ls0 ws0">看几个特殊点或特殊曲线：</div><div class="t m0 x15 h6 y29c ff3 fs2 fc0 sc0 ls0 ws0">•<span class="_ _5"> </span><span class="ff1">第一个点：<span class="fff">(0<span class="ffd">,<span class="_ _33"> </span></span>1)</span>，<span class="ffd">F<span class="_ _33"> </span>P<span class="_ _33"> </span>R<span class="_ _25"> </span><span class="fff">=<span class="_ _a"> </span>0 </span>T<span class="_ _33"> </span>P<span class="_ _33"> </span>R<span class="_ _25"> </span><span class="fff">=<span class="_ _32"> </span>1<span class="_ _d"> </span></span></span>，这意味着所有的样本都分类正确。</span></div><div class="t m0 x15 h6 y29d ff3 fs2 fc0 sc0 ls0 ws0">•<span class="_ _5"> </span><span class="ff1">第二个点：<span class="fff">(1<span class="ffd">,<span class="_ _31"> </span></span>0)</span>，<span class="ffd">F<span class="_ _33"> </span>P<span class="_ _33"> </span>R<span class="_ _25"> </span><span class="fff">=<span class="_ _d"> </span>1</span>T<span class="_ _33"> </span>P<span class="_ _33"> </span>R<span class="_ _25"> </span><span class="fff">=<span class="_ _25"> </span>0<span class="_ _e"> </span></span></span>，和第一个<span class="_ _23"></span>点比较，这是第一个点<span class="_ _23"></span>的完全反面，意</span></div><div class="t m0 x13 h6 y29e ff1 fs2 fc0 sc0 ls0 ws0">味着是个最糟糕的分类器，<span class="_ _23"></span>将所有的样本都分类错误了（但其实可以直接取<span class="_ _23"></span>反，就是最好</div><div class="t m0 x13 h6 y29f ff1 fs2 fc0 sc0 ls0 ws0">的模型，因为是二分类问题）<span class="_ _26"></span>。</div><div class="t m0 x15 h6 y18e ff3 fs2 fc0 sc0 ls0 ws0">•<span class="_ _5"> </span><span class="ff1">第三个点：<span class="fff">(0<span class="ffd">,<span class="_ _31"> </span></span>0)</span>，<span class="ffd">F<span class="_ _33"> </span>P<span class="_ _33"> </span>R<span class="_ _25"> </span><span class="fff">=<span class="_ _d"> </span>0</span>T<span class="_ _33"> </span>P<span class="_ _33"> </span>R<span class="_ _25"> </span><span class="fff">=<span class="_ _25"> </span>0<span class="_ _e"> </span></span></span>也就是原点，<span class="_ _23"></span>这个点表示的意思是，<span class="_ _23"></span>分类器预测所</span></div><div class="t m0 x13 h6 y20 ff1 fs2 fc0 sc0 ls0 ws0">有的样本都为负类。</div><div class="t m0 xbc h4 y3 ff3 fs2 fc0 sc0 ls0 ws0">17</div></div><div class="pi" data-data='{"ctm":[1.500000,0.000000,0.000000,1.500000,0.000000,0.000000]}'></div></div>
<div id="pf18" class="pf w0 h0" data-page-no="18"><div class="pc pc18 w0 h0"><img class="bi x2e y2a0 w9 h1e" alt="" src="bg18.png"/><div class="t m0 x3 h7 y21 ff3 fs5 fc0 sc0 ls0 ws0">3.2<span class="_ _8"> </span><span class="ff7">分类</span></div><div class="t m0 x15 h6 y22 ff3 fs2 fc0 sc0 ls0 ws0">•<span class="_ _5"> </span><span class="ff1">第四个点：<span class="_ _30"></span><span class="fff">(1<span class="ffd">,<span class="_ _31"> </span></span>1)<span class="ff1">，<span class="_ _30"></span><span class="ffd">F<span class="_ _33"> </span>P<span class="_ _33"> </span>R<span class="_ _32"> </span><span class="fff">=<span class="_ _32"> </span>1</span>T<span class="_ _33"> </span>P<span class="_ _33"> </span>R<span class="_ _25"> </span><span class="fff">=<span class="_ _32"> </span>1<span class="ff1">，<span class="_ _30"></span>和第三个点对应，<span class="_ _27"></span>表示分类器预测所有的样本都为</span></span></span></span></span></span></div><div class="t m0 x13 h6 y17d ff1 fs2 fc0 sc0 ls0 ws0">正类。</div><div class="t m0 x15 h6 y2a1 ff3 fs2 fc0 sc0 ls0 ws0">•<span class="_ _5"> </span><span class="ff1">一条线：<span class="ffd">y<span class="_ _25"> </span><span class="fff">=<span class="_ _32"> </span></span>x</span>，对角线对应于“随机猜测”模型。</span></div><div class="t m0 x3 h6 y2a2 ff1 fs2 fc0 sc0 ls0 ws0">于是，对<span class="_ _23"></span>于特定的<span class="_ _23"></span>分类模型，<span class="_ _23"></span>如果<span class="_ _e"> </span><span class="ff3">ROC<span class="_ _d"> </span></span>曲<span class="_ _23"></span>线位于对<span class="_ _23"></span>角线左上<span class="_ _23"></span>方，说明模<span class="_ _23"></span>型性能好<span class="_ _23"></span>于随机猜<span class="_ _23"></span>测，</div><div class="t m0 x3 h6 y2a3 ff1 fs2 fc0 sc0 ls0 ws0">如果<span class="_ _d"> </span><span class="ff3">R<span class="_ _12"></span>OC<span class="_ _d"> </span><span class="ff1">曲线位于对角线右下方，说明模型性能劣于随机猜测。</span></span></div><div class="t m0 x3 h6 y2a4 ff1 fs2 fc0 sc0 ls0 ws0">图<span class="ff3">3.2(a) </span>是理想化的<span class="_ _32"> </span><span class="ff3">ROC </span>曲线图，<span class="_ _2d"></span>但在现实任务中，<span class="_ _2a"></span>通常只能利用有限个测试样本来绘制<span class="_ _a"> </span><span class="ff3">ROC</span></div><div class="t m0 x3 h6 y2a5 ff1 fs2 fc0 sc0 ls0 ws0">图，此时只<span class="_ _23"></span>有有限个<span class="_ _e"> </span><span class="fff">(<span class="ffd">T<span class="_ _33"> </span>P<span class="_ _33"> </span>R,<span class="_ _31"> </span>F<span class="_ _33"> </span>P<span class="_ _33"> </span>R</span>)<span class="_ _e"> </span></span>坐<span class="_ _23"></span>标对，无法产<span class="_ _23"></span>生图<span class="ff3">3.2(a)<span class="_ _d"> </span></span>中<span class="_ _23"></span>的光滑<span class="_ _e"> </span><span class="ff3">R<span class="_ _12"></span>OC<span class="_ _e"> </span><span class="ff1">曲线，只能<span class="_ _23"></span>绘制</span></span></div><div class="t m0 x3 h6 y2a6 ff1 fs2 fc0 sc0 ls0 ws0">出图<span class="ff3">3.2(b)<span class="_ _d"> </span></span>中的近似<span class="_ _d"> </span><span class="ff3">R<span class="_ _12"></span>OC<span class="_ _d"> </span><span class="ff1">曲线。<span class="ff4">绘制<span class="_ _e"> </span><span class="ff6">ROC<span class="_ _e"> </span></span>曲线的过程如下：</span></span></span></div><div class="t m0 x3 h6 y2a7 ff1 fs2 fc0 sc0 ls0 ws0">设数据集共有<span class="_ _d"> </span><span class="ffd">m</span></div><div class="t m0 xdd ha y2a8 ff12 fs7 fc0 sc0 ls0 ws0">+</div><div class="t m0 xde h6 y2a7 ff1 fs2 fc0 sc0 ls0 ws0">个正例，<span class="ffd">m</span></div><div class="t m0 x0 ha y2a8 ffb fs7 fc0 sc0 ls0 ws0">−</div><div class="t m0 xc1 h6 y2a7 ff1 fs2 fc0 sc0 ls0 ws0">个反例</div><div class="t m0 x15 h6 y8f ff3 fs2 fc0 sc0 ls0 ws0">1.<span class="_ _5"> </span><span class="ff1">将所有的样本按模型的预测打分<span class="_ _d"> </span></span>(score)<span class="_ _d"> </span><span class="ff1">由大到小排序；</span></div><div class="t m0 x15 h6 y2a9 ff3 fs2 fc0 sc0 ls0 ws0">2.<span class="_ _5"> </span><span class="ff1">将分类阈值<span class="_ _23"></span>设为最大，即把<span class="_ _23"></span>所有样本都归<span class="_ _23"></span>类为反例，此时<span class="_ _e"> </span><span class="ffd">T<span class="_ _33"> </span>P<span class="_ _33"> </span>R<span class="_ _d"> </span><span class="fff">=<span class="_ _d"> </span></span>F<span class="_ _33"> </span>P<span class="_ _33"> </span>R<span class="_ _d"> </span><span class="fff">=<span class="_ _d"> </span>0</span></span>，得到<span class="_ _e"> </span><span class="fff">(0<span class="ffd">,<span class="_ _31"> </span></span>0)</span></span></div><div class="t m0 x13 h6 y2aa ff1 fs2 fc0 sc0 ls0 ws0">坐标点；</div><div class="t m0 x15 h6 y2ab ff3 fs2 fc0 sc0 ls0 ws0">3.<span class="_ _5"> </span><span class="ff1">将分类阈值依次设为每个样本的打<span class="_ _23"></span>分，即依次把每个样本划分为正例。设前一个标记<span class="_ _23"></span>点的</span></div><div class="t m0 x13 h6 y2ac ff1 fs2 fc0 sc0 ls0 ws0">坐标为<span class="_ _32"> </span><span class="fff">(<span class="ffd">x,<span class="_ _31"> </span>y<span class="_ _23"></span></span>)</span>，<span class="_ _3a"></span>若当前为真正例，<span class="_ _3a"></span>则当前标记点的坐标为<span class="_ _25"> </span><span class="fff">(<span class="ffd">x,<span class="_ _31"> </span>y<span class="_ _38"> </span></span>+</span></div><div class="t m0 xa4 ha y2ad ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 x6a hb y2ae ffc fs7 fc0 sc0 ls0 ws0">m</div><div class="t m0 xa3 h1c y2af ff16 fs9 fc0 sc0 ls0 ws0">+</div><div class="t m0 xdf h6 y2ac fff fs2 fc0 sc0 ls0 ws0">)<span class="ff1">，<span class="_ _2e"></span>若当前为假正例，<span class="_ _3a"></span>则</span></div><div class="t m0 x13 h6 y2b0 ff1 fs2 fc0 sc0 ls0 ws0">当前标记点的坐标为<span class="_ _d"> </span><span class="fff">(<span class="ffd">x<span class="_ _37"> </span></span>+</span></div><div class="t m0 x41 ha y2b1 ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 xc1 hb y2b2 ffc fs7 fc0 sc0 ls0 ws0">m</div><div class="t m0 x5a h1f y2b3 ff17 fs9 fc0 sc0 ls0 ws0">−</div><div class="t m0 x6e h6 y2b0 ffd fs2 fc0 sc0 ls0 ws0">,<span class="_ _31"> </span>y<span class="_ _23"></span><span class="fff">)<span class="ff1">。</span></span></div><div class="t m0 x3 h6 y2b4 ff1 fs2 fc0 sc0 ls0 ws0">现设数<span class="_ _23"></span>据集共有<span class="_ _e"> </span><span class="fff">10<span class="_ _e"> </span></span>个<span class="_ _23"></span>正例，<span class="fff">10<span class="_ _e"> </span></span>个反例，<span class="_ _23"></span>如下表。<span class="ff3">Class<span class="_ _e"> </span></span>一栏<span class="_ _23"></span>表示每个测<span class="_ _23"></span>试样本真<span class="_ _23"></span>正的标签（<span class="ff3">p</span></div><div class="t m0 x3 h6 y2b5 ff1 fs2 fc0 sc0 ls0 ws0">表示正样本，<span class="_ _29"></span><span class="ff3">n <span class="ff1">表示负样本）<span class="_ _2f"></span>，<span class="_ _3a"></span><span class="ff3">Score<span class="_ _25"> </span><span class="ff1">表示每个测试样本属于正样本的概率。<span class="_ _30"></span>我们根据每个测试样</span></span></span></span></div><div class="t m0 x3 h6 y2b6 ff1 fs2 fc0 sc0 ls0 ws0">本属于正样本的概率值从大到小排序。</div><div class="t m0 x3e h4 y2b7 ff6 fs2 fc0 sc0 ls0 ws0">n<span class="_ _12"></span>um<span class="_ _45"> </span>Class<span class="_ _45"> </span>Score<span class="_ _45"> </span>num<span class="_ _45"> </span>Class<span class="_ _45"> </span>Score</div><div class="t m0 x50 h4 y2b8 ff3 fs2 fc0 sc0 ls0 ws0">1<span class="_ _45"> </span><span class="ff6">p<span class="_ _46"> </span></span>0.9<span class="_ _47"> </span>11<span class="_ _45"> </span><span class="ff6">p<span class="_ _46"> </span></span>0.4</div><div class="t m0 x50 h4 y2b9 ff3 fs2 fc0 sc0 ls0 ws0">2<span class="_ _45"> </span><span class="ff6">p<span class="_ _46"> </span></span>0.8<span class="_ _47"> </span>12<span class="_ _45"> </span><span class="ff6">n<span class="_ _48"> </span></span>0.39</div><div class="t m0 x50 h4 y2ba ff3 fs2 fc0 sc0 ls0 ws0">3<span class="_ _45"> </span><span class="ff6">n<span class="_ _46"> </span></span>0.7<span class="_ _47"> </span>13<span class="_ _45"> </span><span class="ff6">p<span class="_ _48"> </span></span>0.38</div><div class="t m0 x50 h4 y2bb ff3 fs2 fc0 sc0 ls0 ws0">4<span class="_ _45"> </span><span class="ff6">p<span class="_ _46"> </span></span>0.6<span class="_ _47"> </span>14<span class="_ _45"> </span><span class="ff6">n<span class="_ _48"> </span></span>0.37</div><div class="t m0 x50 h4 y2bc ff3 fs2 fc0 sc0 ls0 ws0">5<span class="_ _45"> </span><span class="ff6">p<span class="_ _48"> </span></span>0.55<span class="_ _47"> </span>15<span class="_ _45"> </span><span class="ff6">n<span class="_ _48"> </span></span>0.36</div><div class="t m0 x50 h4 y2bd ff3 fs2 fc0 sc0 ls0 ws0">6<span class="_ _45"> </span><span class="ff6">p<span class="_ _48"> </span></span>0.54<span class="_ _47"> </span>16<span class="_ _45"> </span><span class="ff6">n<span class="_ _48"> </span></span>0.35</div><div class="t m0 x50 h4 y2be ff3 fs2 fc0 sc0 ls0 ws0">7<span class="_ _45"> </span><span class="ff6">n<span class="_ _48"> </span></span>0.53<span class="_ _47"> </span>17<span class="_ _45"> </span><span class="ff6">p<span class="_ _48"> </span></span>0.34</div><div class="t m0 x50 h4 y2bf ff3 fs2 fc0 sc0 ls0 ws0">8<span class="_ _45"> </span><span class="ff6">n<span class="_ _48"> </span></span>0.52<span class="_ _47"> </span>18<span class="_ _45"> </span><span class="ff6">n<span class="_ _48"> </span></span>0.33</div><div class="t m0 x50 h4 y2c0 ff3 fs2 fc0 sc0 ls0 ws0">9<span class="_ _45"> </span><span class="ff6">p<span class="_ _48"> </span></span>0.51<span class="_ _47"> </span>19<span class="_ _45"> </span><span class="ff6">p<span class="_ _46"> </span></span>0.3</div><div class="t m0 xce h4 y2c1 ff3 fs2 fc0 sc0 ls0 ws0">10<span class="_ _45"> </span><span class="ff6">n<span class="_ _49"> </span></span>0.505<span class="_ _47"> </span>20<span class="_ _45"> </span><span class="ff6">n<span class="_ _46"> </span></span>0.1</div><div class="t m0 x15 h6 y2c2 ff3 fs2 fc0 sc0 ls0 ws0">1.<span class="_ _5"> </span><span class="ff1">阈值<span class="_ _d"> </span><span class="ffd">t<span class="_ _a"> </span>&gt;<span class="_ _32"> </span><span class="fff">0</span>.<span class="fff">9</span></span>，则<span class="_ _d"> </span><span class="ffd">T<span class="_ _33"> </span>P<span class="_ _35"> </span><span class="fff">=<span class="_ _32"> </span></span>F<span class="_ _33"> </span>P<span class="_ _35"> </span><span class="fff">=<span class="_ _a"> </span>0</span></span>，<span class="ffd">T<span class="_ _33"> </span>P<span class="_ _33"> </span>R<span class="_ _25"> </span><span class="fff">=<span class="_ _32"> </span>0</span></span>，<span class="ffd">F<span class="_ _33"> </span>P<span class="_ _33"> </span>R<span class="_ _32"> </span><span class="fff">=<span class="_ _32"> </span>0</span></span>；</span></div><div class="t m0 x15 h6 y2c3 ff3 fs2 fc0 sc0 ls0 ws0">2.<span class="_ _5"> </span><span class="ff1">阈值<span class="_ _d"> </span><span class="ffd">t<span class="_ _a"> </span><span class="ffe">≥<span class="_ _32"> </span><span class="fff">0</span></span>.<span class="fff">9</span></span>，则<span class="_ _d"> </span><span class="ffd">T<span class="_ _33"> </span>P<span class="_ _35"> </span><span class="fff">=<span class="_ _32"> </span>1</span></span>，<span class="ffd">F<span class="_ _33"> </span>P<span class="_ _35"> </span><span class="fff">=<span class="_ _a"> </span>0</span></span>，<span class="ffd">T<span class="_ _33"> </span>P<span class="_ _33"> </span>R<span class="_ _25"> </span><span class="fff">=</span></span></span></div><div class="t m0 x36 ha y2c4 ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 x2a ha y2c5 ff12 fs7 fc0 sc0 ls0 ws0">10</div><div class="t m0 xe0 h6 y2c3 ff1 fs2 fc0 sc0 ls0 ws0">，<span class="ffd">F<span class="_ _33"> </span>P<span class="_ _33"> </span>R<span class="_ _32"> </span><span class="fff">=<span class="_ _32"> </span>0</span></span>；</div><div class="t m0 x15 h6 y2c6 ff3 fs2 fc0 sc0 ls0 ws0">3.<span class="_ _5"> </span><span class="ff1">阈值<span class="_ _d"> </span><span class="ffd">t<span class="_ _a"> </span><span class="ffe">≥<span class="_ _32"> </span><span class="fff">0</span></span>.<span class="fff">9</span></span>，则<span class="_ _d"> </span><span class="ffd">T<span class="_ _33"> </span>P<span class="_ _35"> </span><span class="fff">=<span class="_ _32"> </span>1</span></span>，<span class="ffd">F<span class="_ _33"> </span>P<span class="_ _35"> </span><span class="fff">=<span class="_ _a"> </span>0</span></span>，<span class="ffd">T<span class="_ _33"> </span>P<span class="_ _33"> </span>R<span class="_ _25"> </span><span class="fff">=</span></span></span></div><div class="t m0 x36 ha y2c7 ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 x2a ha y2c8 ff12 fs7 fc0 sc0 ls0 ws0">10</div><div class="t m0 xe0 h6 y2c6 ff1 fs2 fc0 sc0 ls0 ws0">，<span class="ffd">F<span class="_ _33"> </span>P<span class="_ _33"> </span>R<span class="_ _32"> </span><span class="fff">=<span class="_ _32"> </span>0</span></span>；</div><div class="t m0 x15 h4 y2c9 ff3 fs2 fc0 sc0 ls0 ws0">4.<span class="_ _5"> </span><span class="ffe">·<span class="_ _33"></span>·<span class="_ _31"></span>·</span></div><div class="t m0 x15 h6 ya7 ff3 fs2 fc0 sc0 ls0 ws0">5.<span class="_ _5"> </span><span class="ff1">阈值<span class="_ _d"> </span><span class="ffd">t<span class="_ _a"> </span><span class="ffe">≥<span class="_ _32"> </span><span class="fff">0</span></span>.<span class="fff">1</span></span>，则<span class="_ _d"> </span><span class="ffd">T<span class="_ _33"> </span>P<span class="_ _35"> </span><span class="fff">=<span class="_ _32"> </span>10</span></span>，<span class="ffd">F<span class="_ _33"> </span>P<span class="_ _35"> </span><span class="fff">=<span class="_ _a"> </span>10</span></span>，<span class="ffd">T<span class="_ _33"> </span>P<span class="_ _33"> </span>R<span class="_ _25"> </span><span class="fff">=<span class="_ _32"> </span>1</span></span>，<span class="ffd">F<span class="_ _33"> </span>P<span class="_ _33"> </span>R<span class="_ _32"> </span><span class="fff">=<span class="_ _32"> </span>1</span></span>。</span></div><div class="t m0 x3 h6 ya9 ff1 fs2 fc0 sc0 ls0 ws0">最后绘制出来的<span class="_ _d"> </span><span class="ff3">R<span class="_ _12"></span>OC<span class="_ _d"> </span><span class="ff1">图如下所示：</span></span></div><div class="t m0 x3 h6 y2ca ff3 fs2 fc0 sc0 ls0 ws0">R<span class="_ _12"></span>OC<span class="_ _d"> </span><span class="ff1">曲线可<span class="_ _23"></span>以很直观的展示模型的好坏，<span class="_ _23"></span>但是如果不同模型的<span class="_ _e"> </span></span>R<span class="_ _12"></span>OC<span class="_ _d"> </span><span class="ff1">曲线存在<span class="_ _23"></span>交叉，则很难依</span></div><div class="t m0 x3 h6 y2cb ff1 fs2 fc0 sc0 ls0 ws0">靠视觉来对<span class="_ _23"></span>模型的优劣进行比<span class="_ _23"></span>较，此时可以使用<span class="_ _23"></span>曲线下面积<span class="_ _e"> </span><span class="ff3">(Area<span class="_ _d"> </span>Under<span class="_ _e"> </span>Curve,<span class="_ _d"> </span>AUC)<span class="_ _d"> </span></span>这个指</div><div class="t m0 x3 h6 yae ff1 fs2 fc0 sc0 ls0 ws0">标来进行评价。</div><div class="t m0 x3 h6 y2cc ff4 fs2 fc0 sc0 ls0 ws0">定义<span class="ff6">3.8<span class="_ _5"> </span><span class="fc1">A<span class="_ _28"></span>UC<span class="ff4">：<span class="_ _37"> </span><span class="ff1 fc0">指的是<span class="_ _25"> </span><span class="ff3">ROC </span>曲线右下方的面积，<span class="_ _30"></span>该面积越大，<span class="_ _29"></span>一般表示模型的预测能力越好，</span></span></span></span></div><div class="t m0 x3 h6 y86 ff1 fs2 fc0 sc0 ls0 ws0">此时可以将<span class="_ _d"> </span><span class="ff3">R<span class="_ _12"></span>OC<span class="_ _d"> </span><span class="ff1">曲线上离左上角最近的点所对于的分类阈值作为最终分类器的阈值。</span></span></div><div class="t m0 x3 h6 y18e ff1 fs2 fc0 sc0 ls0 ws0">由定义可<span class="_ _23"></span>知，<span class="ff3">A<span class="_ _28"></span>UC<span class="_ _e"> </span><span class="ff1">可通过<span class="_ _23"></span>对<span class="_ _d"> </span></span>ROC<span class="_ _d"> </span><span class="ff1">曲线下<span class="_ _23"></span>各部分的面积<span class="_ _23"></span>求和而得。假定<span class="_ _e"> </span></span>ROC<span class="_ _d"> </span><span class="ff1">曲线是<span class="_ _23"></span>由坐标为</span></span></div><div class="t m0 x3 h4 y20 ffe fs2 fc0 sc0 ls0 ws0">{<span class="fff">(<span class="ffd">x</span></span></div><div class="t m0 x5 ha y2cd ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 xe1 he y20 ffd fs2 fc0 sc0 ls0 ws0">,<span class="_ _31"> </span>y</div><div class="t m0 xb9 ha y2cd ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 x43 h4 y20 fff fs2 fc0 sc0 ls0 ws0">)<span class="ffd">,<span class="_ _31"> </span></span>(<span class="ffd">x</span></div><div class="t m0 xe2 ha y2cd ff12 fs7 fc0 sc0 ls0 ws0">2</div><div class="t m0 xe3 he y20 ffd fs2 fc0 sc0 ls0 ws0">,<span class="_ _31"> </span>y</div><div class="t m0 xe4 ha y2cd ff12 fs7 fc0 sc0 ls0 ws0">2</div><div class="t m0 xe5 h4 y20 fff fs2 fc0 sc0 ls0 ws0">)<span class="ffd">,<span class="_ _31"> </span><span class="ffe">·<span class="_ _31"></span>·<span class="_ _31"></span>·<span class="_ _d"> </span></span>,<span class="_ _31"> </span></span>(<span class="ffd">x</span></div><div class="t m0 xe6 hb y2cd ffc fs7 fc0 sc0 ls0 ws0">m</div><div class="t m0 x83 he y20 ffd fs2 fc0 sc0 ls0 ws0">,<span class="_ _31"> </span>y</div><div class="t m0 x50 hb y2cd ffc fs7 fc0 sc0 ls0 ws0">m</div><div class="t m0 xe7 h6 y20 fff fs2 fc0 sc0 ls0 ws0">)<span class="ffe">}<span class="_ _25"> </span><span class="ff1">的点按序连接而形成<span class="_ _25"> </span></span></span>(<span class="ffd">x</span></div><div class="t m0 xab ha y2cd ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 x1f h4 y20 fff fs2 fc0 sc0 ls0 ws0">=<span class="_ _32"> </span>0<span class="ffd">,<span class="_ _31"> </span>x</span></div><div class="t m0 xe8 hb y2cd ffc fs7 fc0 sc0 ls0 ws0">m</div><div class="t m0 xe9 h6 y20 fff fs2 fc0 sc0 ls0 ws0">=<span class="_ _32"> </span>1)<span class="ff1">，<span class="_ _29"></span>参见图<span class="ff3">3.2(b)</span>，<span class="_ _30"></span>则<span class="_ _25"> </span><span class="ff3">AUC</span></span></div><div class="t m0 x3 h4 y3 ff3 fs2 fc0 sc0 ls0 ws0">18</div><a class="l" href="#pf17" data-dest-detail='[23,"XYZ",70.87,353.66,null]'><div class="d m1" style="border-style:none;position:absolute;left:122.662500px;bottom:1041.888000px;width:13.942000px;height:15.459000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf17" data-dest-detail='[23,"XYZ",70.87,353.66,null]'><div class="d m1" style="border-style:none;position:absolute;left:509.788500px;bottom:1021.564500px;width:13.942000px;height:15.458000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf17" data-dest-detail='[23,"XYZ",70.87,353.66,null]'><div class="d m1" style="border-style:none;position:absolute;left:139.026000px;bottom:1001.241000px;width:13.942000px;height:15.458000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf17" data-dest-detail='[23,"XYZ",70.87,353.66,null]'><div class="d m1" style="border-style:none;position:absolute;left:672.174000px;bottom:59.034000px;width:13.941000px;height:15.458000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.500000,0.000000,0.000000,1.500000,0.000000,0.000000]}'></div></div>
<div id="pf19" class="pf w0 h0" data-page-no="19"><div class="pc pc19 w0 h0"><img class="bi x3 y2ce w1 h20" alt="" src="bg19.png"/><div class="t m0 x85 h7 y21 ff3 fs5 fc0 sc0 ls0 ws0">3.2<span class="_ _8"> </span><span class="ff7">分类</span></div><div class="t m0 x3 h6 y2cf ff1 fs2 fc0 sc0 ls0 ws0">可估算为：</div><div class="t m0 x40 h4 y2d0 ff3 fs2 fc0 sc0 ls0 ws0">AUC <span class="fff">=</span></div><div class="t m0 x48 h4 y2d1 fff fs2 fc0 sc0 ls0 ws0">1</div><div class="t m0 x48 h4 y2d2 fff fs2 fc0 sc0 ls0 ws0">2</div><div class="t m0 xe ha y2d3 ffc fs7 fc0 sc0 ls0 ws0">m<span class="ffb">−<span class="ff12">1</span></span></div><div class="t m0 x94 hc y2d4 ff11 fs2 fc0 sc0 ls0 ws0">X</div><div class="t m0 x16 ha y2d5 ffc fs7 fc0 sc0 ls0 ws0">i<span class="ff12">=1</span></div><div class="t m0 x4 h4 y2d0 fff fs2 fc0 sc0 ls0 ws0">(<span class="ffd">x</span></div><div class="t m0 x75 ha y2d6 ffc fs7 fc0 sc0 ls0 ws0">i<span class="ff12">+1</span></div><div class="t m0 xc9 h4 y2d0 ffe fs2 fc0 sc0 ls0 ws0">−<span class="_ _37"> </span><span class="ffd">x</span></div><div class="t m0 xd2 hb y2d6 ffc fs7 fc0 sc0 ls0 ws0">i</div><div class="t m0 x77 h4 y2d0 fff fs2 fc0 sc0 ls0 ws0">)<span class="_ _37"> </span><span class="ffe">·<span class="_ _37"> </span></span>(<span class="ffd">y</span></div><div class="t m0 x61 hb y2d6 ffc fs7 fc0 sc0 ls0 ws0">i</div><div class="t m0 xea h4 y2d0 fff fs2 fc0 sc0 ls0 ws0">+<span class="_ _37"> </span><span class="ffd">y</span></div><div class="t m0 xeb ha y2d6 ffc fs7 fc0 sc0 ls0 ws0">i<span class="ff12">+1</span></div><div class="t m0 xec h4 y2d0 fff fs2 fc0 sc0 ls0 ws0">)<span class="_ _4a"> </span><span class="ff3">(3.14)</span></div><div class="t m0 x12 h6 y2d7 ff1 fs2 fc0 sc0 ls0 ws0">这是梯形面积的计算公式，因为当存在正例和反例的打分相等时，则会出现梯形；<span class="_ _12"></span>若不存</div><div class="t m0 x12 h6 y2d8 ff1 fs2 fc0 sc0 ls0 ws0">在这种情况，则只会出现长方形，而长方形的面积亦可使用梯形面积公式计算。</div><div class="t m0 x3 h6 y2d9 ff1 fs2 fc0 sc0 ls0 ws0">形式化地看，<span class="_ _28"></span><span class="ff3">AUC<span class="_ _25"> </span><span class="ff1">考虑的是样本预测的排序质量，<span class="_ _12"></span>因此它与排序误差有紧密联系，<span class="_ _28"></span>给定<span class="_ _d"> </span><span class="ffd">m</span></span></span></div><div class="t m0 xed ha y2da ff12 fs7 fc0 sc0 ls0 ws0">+</div><div class="t m0 xbc h6 y2d9 ff1 fs2 fc0 sc0 ls0 ws0">个</div><div class="t m0 x3 h6 y2db ff1 fs2 fc0 sc0 ls0 ws0">正例和<span class="_ _d"> </span><span class="ffd">m</span></div><div class="t m0 xee ha y2dc ffb fs7 fc0 sc0 ls0 ws0">−</div><div class="t m0 xb2 h6 y2db ff1 fs2 fc0 sc0 ls0 ws0">个反例，另<span class="_ _d"> </span><span class="ffd">D</span></div><div class="t m0 x8d ha y2dc ff12 fs7 fc0 sc0 ls0 ws0">+</div><div class="t m0 xd7 h6 y2db ff1 fs2 fc0 sc0 ls0 ws0">和<span class="_ _d"> </span><span class="ffd">D</span></div><div class="t m0 x41 ha y2dc ffb fs7 fc0 sc0 ls0 ws0">−</div><div class="t m0 x73 h6 y2db ff1 fs2 fc0 sc0 ls0 ws0">分别表示正、反例集合，则排序“损失”<span class="ff3">(loss)<span class="_ _d"> </span></span>定义为</div><div class="t m0 xef he y2dd ffd fs2 fc0 sc0 ls0 ws0">ℓ</div><div class="t m0 xf0 h12 y2de ff14 fs7 fc0 sc0 ls0 ws0">rank</div><div class="t m0 xf1 h4 y2dd fff fs2 fc0 sc0 ls0 ws0">=</div><div class="t m0 xf2 h4 y2df fff fs2 fc0 sc0 ls0 ws0">1</div><div class="t m0 x2c he y2e0 ffd fs2 fc0 sc0 ls0 ws0">m</div><div class="t m0 x54 ha y2e1 ff12 fs7 fc0 sc0 ls0 ws0">+</div><div class="t m0 xd5 he y2e0 ffd fs2 fc0 sc0 ls0 ws0">m</div><div class="t m0 xdb ha y2e1 ffb fs7 fc0 sc0 ls0 ws0">−</div><div class="t m0 x3f hc y2e2 ff11 fs2 fc0 sc0 ls0 ws0">X</div><div class="t m0 x2e h21 y2e3 ff10 fs7 fc0 sc0 ls0 ws0">x</div><div class="t m0 xcd h1c y2e4 ff16 fs9 fc0 sc0 ls0 ws0">+</div><div class="t m0 xb0 ha y2e3 ffb fs7 fc0 sc0 ls0 ws0">∈<span class="ffc">D</span></div><div class="t m0 x8 h1c y2e4 ff16 fs9 fc0 sc0 ls0 ws0">+</div><div class="t m0 x40 h21 y2e3 ff10 fs7 fc0 sc0 ls0 ws0">x</div><div class="t m0 x31 h1f y2e4 ff17 fs9 fc0 sc0 ls0 ws0">−</div><div class="t m0 x6d h21 y2e3 ff10 fs7 fc0 sc0 ls0 ws0">p</div><div class="t m0 xf h1f y2e4 ff17 fs9 fc0 sc0 ls0 ws0">−</div><div class="t m0 x4e hc y2e5 ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x73 h22 y2dd ffa fs2 fc0 sc0 ls0 ws0">I</div><div class="t m0 xf3 hc y2e6 ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 xd6 he y2dd ffd fs2 fc0 sc0 ls0 ws0">f</div><div class="t m0 x4f hc y2e6 ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 xc7 hf y2dd ff10 fs2 fc0 sc0 ls0 ws0">x</div><div class="t m0 xf4 ha y2e7 ff12 fs7 fc0 sc0 ls0 ws0">+</div><div class="t m0 xc2 hc y2e6 ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x65 he y2dd ffd fs2 fc0 sc0 ls0 ws0">&lt;<span class="_ _32"> </span>f</div><div class="t m0 x5f hc y2e6 ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 xf5 hf y2dd ff10 fs2 fc0 sc0 ls0 ws0">x</div><div class="t m0 xd2 ha y2e7 ffb fs7 fc0 sc0 ls0 ws0">−</div><div class="t m0 xe0 hc y2e6 ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x25 h4 y2dd fff fs2 fc0 sc0 ls0 ws0">+</div><div class="t m0 xea h4 y2df fff fs2 fc0 sc0 ls0 ws0">1</div><div class="t m0 xea h4 y2e0 fff fs2 fc0 sc0 ls0 ws0">2</div><div class="t m0 xc4 h22 y2dd ffa fs2 fc0 sc0 ls0 ws0">I</div><div class="t m0 xcb hc y2e6 ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x7b he y2dd ffd fs2 fc0 sc0 ls0 ws0">f</div><div class="t m0 xf6 hc y2e6 ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 xec hf y2dd ff10 fs2 fc0 sc0 ls0 ws0">x</div><div class="t m0 xbe ha y2e7 ff12 fs7 fc0 sc0 ls0 ws0">+</div><div class="t m0 xf7 hc y2e6 ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 xa4 h4 y2dd fff fs2 fc0 sc0 ls0 ws0">=<span class="_ _32"> </span><span class="ffd">f</span></div><div class="t m0 xf8 hc y2e6 ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 xf9 hf y2dd ff10 fs2 fc0 sc0 ls0 ws0">x</div><div class="t m0 xfa ha y2e7 ffb fs7 fc0 sc0 ls0 ws0">−</div><div class="t m0 xfb hc y2e6 ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 xfc hc y2e5 ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x86 h4 y2dd ff3 fs2 fc0 sc0 ls0 ws0">(3.15)</div><div class="t m0 x3 h6 y2e8 ff1 fs2 fc0 sc0 ls0 ws0">即考虑每一对正、<span class="_ _28"></span>反例，<span class="_ _28"></span>若正例的预测值小于反例，<span class="_ _28"></span>则记一个罚分，<span class="_ _28"></span>若相等，<span class="_ _28"></span>记<span class="_ _d"> </span><span class="ff3">0.5<span class="_ _25"> </span></span>个罚分。<span class="_ _28"></span>容</div><div class="t m0 x3 h6 y2e9 ff1 fs2 fc0 sc0 ls0 ws0">易看出，<span class="_ _3a"></span><span class="ffd">ℓ</span></div><div class="t m0 xee h12 y2ea ff14 fs7 fc0 sc0 ls0 ws0">rank</div><div class="t m0 xfd h6 y2e9 ff1 fs2 fc0 sc0 ls0 ws0">对应的是<span class="_ _25"> </span><span class="ff3">R<span class="_ _12"></span>OC <span class="ff1">曲线之上的面积：<span class="_ _3a"></span>若一个正例在<span class="_ _25"> </span><span class="ff3">ROC </span>曲线上对应标记点的坐标为</span></span></div><div class="t m0 x3 h6 y2eb fff fs2 fc0 sc0 ls0 ws0">(<span class="ffd">x,<span class="_ _31"> </span>y<span class="_ _23"></span></span>)<span class="ff1">，则<span class="_ _d"> </span><span class="ffd">x<span class="_ _d"> </span></span>恰是排序在其之前的反例所占的比例，即假正率。因此有</span></div><div class="t m0 x94 h4 y2ec ff3 fs2 fc0 sc0 ls0 ws0">AUC <span class="fff">=<span class="_ _a"> </span>1<span class="_ _37"> </span><span class="ffe">−<span class="_ _37"> </span><span class="ffd">ℓ</span></span></span></div><div class="t m0 xd2 h12 y2ed ff14 fs7 fc0 sc0 ls0 ws0">rank</div><div class="t m0 x86 h4 y2ec ff3 fs2 fc0 sc0 ls0 ws0">(3.16)</div><div class="t m0 x3 hd y2ee ff5 fs8 fc0 sc0 ls0 ws0">3.2.6<span class="_ _36"> </span><span class="ff9">代价敏感错误率</span></div><div class="t m0 x3 h6 y2ef ff1 fs2 fc0 sc0 ls0 ws0">有时候，<span class="_ _29"></span>不同类型的错误所造成的后果不同。<span class="_ _29"></span>为权衡不同类型错误所造成的不同损失，<span class="_ _29"></span>可为错误</div><div class="t m0 x3 h6 y2f0 ff1 fs2 fc0 sc0 ls0 ws0">赋予“非均等代价”<span class="ff3">(unequa1<span class="_ _d"> </span>cost)</span>。</div><div class="t m0 x3 h6 y2f1 ff1 fs2 fc0 sc0 ls0 ws0">以二分类任务为例，<span class="_ _28"></span>我们可以根据任务的领域知识设定一个<span class="_ _12"></span>“代价矩阵”<span class="_ _12"></span><span class="ff3">(cost<span class="_ _25"> </span>matrix)<span class="ff1">，<span class="_ _12"></span>如下表</span></span></div><div class="t m0 x3 h6 y2f2 ff1 fs2 fc0 sc0 ls0 ws0">所示。其中，<span class="ffd">cost</span></div><div class="t m0 x3c hb y2f3 ffc fs7 fc0 sc0 ls0 ws0">ij</div><div class="t m0 xfe h6 y2f2 ff1 fs2 fc0 sc0 ls0 ws0">表示将第<span class="_ _d"> </span><span class="ffd">i<span class="_ _d"> </span></span>类样本预测为第<span class="_ _d"> </span><span class="ffd">j<span class="_ _1e"> </span></span>类样本的代价。一般来说，<span class="ffd">cost</span></div><div class="t m0 xbb hb y2f3 ffc fs7 fc0 sc0 ls0 ws0">ii</div><div class="t m0 x1b h6 y2f2 fff fs2 fc0 sc0 ls0 ws0">=<span class="_ _32"> </span>0<span class="ff1">。</span></div><div class="t m0 x41 h6 y2f4 ff1 fs2 fc0 sc0 ls0 ws0">真实情况</div><div class="t m0 xc9 h6 y2f5 ff1 fs2 fc0 sc0 ls0 ws0">预测结果</div><div class="t m0 xd9 h6 y2f6 ff1 fs2 fc0 sc0 ls0 ws0">第<span class="_ _d"> </span><span class="ff3">0<span class="_ _d"> </span></span>类<span class="_ _45"> </span>第<span class="_ _d"> </span><span class="ff3">1<span class="_ _d"> </span></span>类</div><div class="t m0 xff h6 y2f7 ff1 fs2 fc0 sc0 ls0 ws0">第<span class="_ _d"> </span><span class="ff3">0<span class="_ _d"> </span></span>类<span class="_ _4b"> </span><span class="ff3">0<span class="_ _4c"> </span><span class="ffd">cost</span></span></div><div class="t m0 x62 ha y2f8 ff12 fs7 fc0 sc0 ls0 ws0">01</div><div class="t m0 xff h6 y2f9 ff1 fs2 fc0 sc0 ls0 ws0">第<span class="_ _d"> </span><span class="ff3">1<span class="_ _d"> </span></span>类<span class="_ _4d"> </span><span class="ffd">cost</span></div><div class="t m0 xaa ha y2fa ff12 fs7 fc0 sc0 ls0 ws0">10</div><div class="t m0 x61 h4 y2f9 ff3 fs2 fc0 sc0 ls0 ws0">0</div><div class="t m0 xbc h4 y3 ff3 fs2 fc0 sc0 ls0 ws0">19</div></div><div class="pi" data-data='{"ctm":[1.500000,0.000000,0.000000,1.500000,0.000000,0.000000]}'></div></div>
<div id="pf1a" class="pf w0 h0" data-page-no="1a"><div class="pc pc1a w0 h0"><img class="bi x3 y2fb w1 h23" alt="" src="bg1a.png"/><div class="t m0 x3 h7 y21 ff3 fs5 fc0 sc0 ls0 ws0">3.2<span class="_ _8"> </span><span class="ff7">分类</span></div><div class="t m0 x12 h6 y2fc ff1 fs2 fc0 sc0 ls0 ws0">重要的是代价比值而非绝对值，例如<span class="_ _d"> </span><span class="ffd">cost</span></div><div class="t m0 x34 ha y2fd ff12 fs7 fc0 sc0 ls0 ws0">01</div><div class="t m0 xa h4 y2fc fff fs2 fc0 sc0 ls0 ws0">:<span class="_ _32"> </span><span class="ffd">cost</span></div><div class="t m0 x36 ha y2fd ff12 fs7 fc0 sc0 ls0 ws0">01</div><div class="t m0 x78 h6 y2fc fff fs2 fc0 sc0 ls0 ws0">=<span class="_ _32"> </span>5<span class="_ _32"> </span>:<span class="_ _32"> </span>1<span class="_ _d"> </span><span class="ff1">与<span class="_ _d"> </span></span>50<span class="_ _32"> </span>:<span class="_ _32"> </span>10<span class="_ _d"> </span><span class="ff1">的效果是一样的。</span></div><div class="t m0 x3 h6 y2fe ff1 fs2 fc0 sc0 ls0 ws0">前面介绍的性能度量都是假设均等代价，<span class="_ _29"></span>也就是犯错误次数越少越好。<span class="_ _29"></span>在非均等错误代价下，<span class="_ _29"></span>我</div><div class="t m0 x3 h6 y2ff ff1 fs2 fc0 sc0 ls0 ws0">们希望的是最小化“总体代价”<span class="_ _26"></span>，则“代价敏感”错误率为：</div><div class="t m0 x2e h4 y300 ffd fs2 fc0 sc0 ls0 ws0">E<span class="_ _23"></span><span class="fff">(</span>f<span class="_ _34"> </span><span class="fff">;<span class="_ _31"> </span></span>D<span class="_ _23"></span><span class="fff">;<span class="_ _31"> </span><span class="ff3">cos<span class="_ _31"> </span></span></span>t<span class="fff">)<span class="_ _32"> </span>=</span></div><div class="t m0 x94 h4 y301 fff fs2 fc0 sc0 ls0 ws0">1</div><div class="t m0 x95 he y302 ffd fs2 fc0 sc0 ls0 ws0">m</div><div class="t m0 x9d hc y303 ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x9d hc y304 ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x100 hc y305 ff11 fs2 fc0 sc0 ls0 ws0">X</div><div class="t m0 x4 h21 y306 ff10 fs7 fc0 sc0 ls0 ws0">x</div><div class="t m0 x34 h10 y307 ff13 fs9 fc0 sc0 ls0 ws0">i</div><div class="t m0 x35 ha y306 ffb fs7 fc0 sc0 ls0 ws0">∈<span class="ffc">D</span></div><div class="t m0 x101 h1c y308 ff16 fs9 fc0 sc0 ls0 ws0">+</div><div class="t m0 xaa h4 y300 ffa fs2 fc0 sc0 ls0 ws0">I<span class="_ _31"> </span><span class="fff">(<span class="ffd">f<span class="_ _a"> </span></span>(<span class="ff10">x</span></span></div><div class="t m0 xab hb y309 ffc fs7 fc0 sc0 ls0 ws0">i</div><div class="t m0 x25 h4 y300 fff fs2 fc0 sc0 ls0 ws0">)<span class="_ _32"> </span><span class="ffe"≯</span>=<span class="_ _32"> </span><span class="ffd">y</span></div><div class="t m0 xcb hb y309 ffc fs7 fc0 sc0 ls0 ws0">i</div><div class="t m0 xad h4 y300 fff fs2 fc0 sc0 ls0 ws0">)<span class="_ _37"> </span><span class="ffe">×<span class="_ _37"> </span><span class="ff3">cos<span class="_ _31"> </span><span class="ffd">t</span></span></span></div><div class="t m0 xa4 ha y309 ff12 fs7 fc0 sc0 ls0 ws0">01</div><div class="t m0 x94 h4 y30a fff fs2 fc0 sc0 ls0 ws0">+</div><div class="t m0 xf4 hc y30b ff11 fs2 fc0 sc0 ls0 ws0">X</div><div class="t m0 x9d h21 y30c ff10 fs7 fc0 sc0 ls0 ws0">x</div><div class="t m0 x17 h10 y30d ff13 fs9 fc0 sc0 ls0 ws0">i</div><div class="t m0 x1 ha y30c ffb fs7 fc0 sc0 ls0 ws0">∈<span class="ffc">D</span></div><div class="t m0 x65 h1f y30e ff17 fs9 fc0 sc0 ls0 ws0">−</div><div class="t m0 x98 h4 y30a ffa fs2 fc0 sc0 ls0 ws0">I<span class="_ _31"> </span><span class="fff">(<span class="ffd">f<span class="_ _a"> </span></span>(<span class="ff10">x</span></span></div><div class="t m0 x60 hb y30f ffc fs7 fc0 sc0 ls0 ws0">i</div><div class="t m0 x99 h4 y30a fff fs2 fc0 sc0 ls0 ws0">)<span class="_ _32"> </span><span class="ffe"≯</span>=<span class="_ _32"> </span><span class="ffd">y</span></div><div class="t m0 x7a hb y30f ffc fs7 fc0 sc0 ls0 ws0">i</div><div class="t m0 xa0 h4 y30a fff fs2 fc0 sc0 ls0 ws0">)<span class="_ _37"> </span><span class="ffe">×<span class="_ _37"> </span><span class="ff3">cos<span class="_ _31"> </span><span class="ffd">t</span></span></span></div><div class="t m0 x102 ha y30f ff12 fs7 fc0 sc0 ls0 ws0">10</div><div class="t m0 xa4 hc y310 ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 xa4 hc y311 ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x86 h4 y312 ff3 fs2 fc0 sc0 ls0 ws0">(3.17)</div><div class="t m0 x3 h6 y313 ff1 fs2 fc0 sc0 ls0 ws0">其中，第<span class="_ _d"> </span><span class="ff3">0<span class="_ _d"> </span></span>类作为正类、第<span class="_ _d"> </span><span class="ff3">1<span class="_ _d"> </span></span>类作为反类，<span class="ffd">D</span></div><div class="t m0 x53 ha y314 ff12 fs7 fc0 sc0 ls0 ws0">+</div><div class="t m0 x2b h6 y313 ff1 fs2 fc0 sc0 ls0 ws0">与<span class="_ _d"> </span><span class="ffd">D</span></div><div class="t m0 x77 ha y314 ffb fs7 fc0 sc0 ls0 ws0">−</div><div class="t m0 x103 h6 y313 ff1 fs2 fc0 sc0 ls0 ws0">分别代表样本集<span class="_ _d"> </span><span class="ffd">D<span class="_ _e"> </span></span>的正例集和反例集。</div><div class="t m0 x3 h4 y3 ff3 fs2 fc0 sc0 ls0 ws0">20</div></div><div class="pi" data-data='{"ctm":[1.500000,0.000000,0.000000,1.500000,0.000000,0.000000]}'></div></div>
<div id="pf1b" class="pf w0 h0" data-page-no="1b"><div class="pc pc1b w0 h0"><div class="t m0 x59 h5 y4 ff4 fs3 fc0 sc0 ls0 ws0">第四章 信息熵<span class="_ _9"> </span><span class="ff5">*</span></div><div class="t m0 xc3 h4 y3 ff3 fs2 fc0 sc0 ls0 ws0">21</div></div><div class="pi" data-data='{"ctm":[1.500000,0.000000,0.000000,1.500000,0.000000,0.000000]}'></div></div>
<div id="pf1c" class="pf w0 h0" data-page-no="1c"><div class="pc pc1c w0 h0"><div class="t m0 x3 h4 y3 ff3 fs2 fc0 sc0 ls0 ws0">22</div></div><div class="pi" data-data='{"ctm":[1.500000,0.000000,0.000000,1.500000,0.000000,0.000000]}'></div></div>
<div id="pf1d" class="pf w0 h0" data-page-no="1d"><div class="pc pc1d w0 h0"><div class="t m0 xe h5 y315 ff4 fs3 fc0 sc0 ls0 ws0">第二部分</div><div class="t m0 x10 h5 y316 ff4 fs3 fc0 sc0 ls0 ws0">机器学习中阶</div><div class="t m0 x80 h3 y317 ff8 fs1 fc0 sc0 ls0 ws0">传统模型</div><div class="t m0 xc3 h4 y3 ff3 fs2 fc0 sc0 ls0 ws0">23</div></div><div class="pi" data-data='{"ctm":[1.500000,0.000000,0.000000,1.500000,0.000000,0.000000]}'></div></div>
<div id="pf1e" class="pf w0 h0" data-page-no="1e"><div class="pc pc1e w0 h0"></div><div class="pi" data-data='{"ctm":[1.500000,0.000000,0.000000,1.500000,0.000000,0.000000]}'></div></div>
<div id="pf1f" class="pf w0 h0" data-page-no="1f"><div class="pc pc1f w0 h0"><img class="bi x104 y318 wa h24" alt="" src="bg1f.png"/><div class="t m0 xf h5 y4 ff4 fs3 fc0 sc0 ls0 ws0">第五章 决策树</div><div class="t m0 x52 h9 y66 ff5 fs6 fc0 sc0 ls0 ws0">5.1<span class="_ _24"> </span><span class="ff9">简介</span></div><div class="t m0 x3 h6 y319 ff1 fs2 fc0 sc0 ls0 ws0">决策树起源于概念学习系统<span class="_ _32"> </span><span class="ff3">CLS (concept learning system)</span>。<span class="_ _2a"></span><span class="ff3">CLS <span class="ff1">最早由<span class="_ _32"> </span></span>Hunt.E.B <span class="ff1">等人于<span class="_ _a"> </span></span>1966</span></div><div class="t m0 x3 h6 y31a ff1 fs2 fc0 sc0 ls0 ws0">年提出，并首次用决策树进行概念学习，后来的许多决策树学习算法都可以看作是<span class="_ _d"> </span><span class="ff3">CLS<span class="_ _d"> </span></span>算法的</div><div class="t m0 x3 h6 y31b ff1 fs2 fc0 sc0 ls0 ws0">改进与<span class="_ _23"></span>更新。<span class="ff3">CLS<span class="_ _e"> </span></span>的主要思<span class="_ _23"></span>想是从一<span class="_ _23"></span>个空的决策<span class="_ _23"></span>树出发，通过<span class="_ _23"></span>添加新的判<span class="_ _23"></span>定节点来完<span class="_ _23"></span>善原有的</div><div class="t m0 x3 h6 y31c ff1 fs2 fc0 sc0 ls0 ws0">决策树，直到新的决策树能够正确地将训练实例分类为止。</div><div class="t m0 x3 h6 y31d ff1 fs2 fc0 sc0 ls0 ws0">决策树由结点（<span class="ff3">no<span class="_ _23"></span>de</span>）和有向边（<span class="ff3">directed<span class="_ _25"> </span>edge</span>）组成。结点有两种类型：</div><div class="t m0 x15 h6 y31e ff3 fs2 fc0 sc0 ls0 ws0">•<span class="_ _5"> </span><span class="ff1">内部<span class="_ _23"></span>结点<span class="_ _23"></span>（</span>in<span class="_ _12"></span>ternal<span class="_ _35"> </span>no<span class="_ _23"></span>de<span class="ff1">）<span class="_ _2a"></span>：<span class="_ _23"></span>表<span class="_ _23"></span>示一<span class="_ _23"></span>个特<span class="_ _23"></span>征或<span class="_ _23"></span>属性。<span class="_ _23"></span>内部<span class="_ _23"></span>结<span class="_ _23"></span>点又<span class="_ _23"></span>可以<span class="_ _23"></span>分为<span class="_ _23"></span>父结<span class="_ _23"></span>点<span class="_ _23"></span>（<span class="ff3">paren<span class="_ _28"></span>t</span></span></div><div class="t m0 x13 h6 y31f ff3 fs2 fc0 sc0 ls0 ws0">no<span class="_ _23"></span>de<span class="ff1">）和子结点（</span>c<span class="_ _28"></span>hild<span class="_ _d"> </span>no<span class="_ _23"></span>de<span class="ff1">）<span class="_ _2f"></span>，这是一种相对关系。</span></div><div class="t m0 x15 h6 y320 ff3 fs2 fc0 sc0 ls0 ws0">•<span class="_ _5"> </span><span class="ff1">叶结点（</span>leaf<span class="_ _d"> </span>node,<span class="_ _d"> </span>terminal<span class="_ _d"> </span>no<span class="_ _23"></span>de)<span class="ff1">：表示一个类。</span></div><div class="t m0 x3 h6 y321 ff1 fs2 fc0 sc0 ls0 ws0">树的第一个结点往往会被称为根节点。</div><div class="t m0 xd6 h6 y322 ff1 fs2 fc0 sc0 ls0 ws0">图<span class="_ _d"> </span><span class="ff3">5.1:<span class="_ _35"> </span></span>决策树简图</div><div class="t m0 x3 h6 y20 ff1 fs2 fc0 sc0 ls0 ws0">图中圆型表示内部结点，方形表示叶结点。</div><div class="t m0 xc3 h4 y3 ff3 fs2 fc0 sc0 ls0 ws0">25</div></div><div class="pi" data-data='{"ctm":[1.500000,0.000000,0.000000,1.500000,0.000000,0.000000]}'></div></div>
<div id="pf20" class="pf w0 h0" data-page-no="20"><div class="pc pc20 w0 h0"><img class="bi x3 y323 wb h25" alt="" src="bg20.png"/><div class="t m0 x3 h7 y21 ff3 fs5 fc0 sc0 ls0 ws0">5.2<span class="_ _8"> </span><span class="ff7">决策树基本算法</span></div><div class="t m0 xd8 h9 y324 ff5 fs6 fc0 sc0 ls0 ws0">5.2<span class="_ _24"> </span><span class="ff9">决策树基本算法</span></div><div class="t m0 x3 h6 y325 ff1 fs2 fc0 sc0 ls0 ws0">现在已经有很多种决策树算法，但是大多数决策树算法都是以下核心算法的变体。</div><div class="t m0 x3 h4 y326 ff6 fs2 fc0 sc0 ls0 ws0">Algorithm<span class="_ _e"> </span>1:<span class="_ _d"> </span><span class="ff3">Decision<span class="_ _d"> </span>T<span class="_ _28"></span>ree</span></div><div class="t m0 x3 h26 y327 ff6 fs5 fc0 sc0 ls0 ws0">Input:<span class="_ _1e"> </span><span class="ff1">训练集<span class="_ _25"> </span><span class="ffd">D<span class="_ _32"> </span><span class="fff">=<span class="_ _a"> </span><span class="ffe">{</span>(<span class="ff10">x</span></span></span></span></div><div class="t m0 x8a h27 y328 ff18 fsa fc0 sc0 ls0 ws0">1</div><div class="t m0 xb7 h28 y327 ffd fs5 fc0 sc0 ls0 ws0">,<span class="_ _33"> </span>y</div><div class="t m0 xb0 h27 y328 ff18 fsa fc0 sc0 ls0 ws0">1</div><div class="t m0 x8d h29 y327 fff fs5 fc0 sc0 ls0 ws0">)<span class="_ _33"> </span><span class="ffd">,<span class="_ _31"> </span></span>(<span class="ff10">x</span></div><div class="t m0 x59 h27 y328 ff18 fsa fc0 sc0 ls0 ws0">2</div><div class="t m0 x6d h28 y327 ffd fs5 fc0 sc0 ls0 ws0">,<span class="_ _33"> </span>y</div><div class="t m0 x41 h27 y328 ff18 fsa fc0 sc0 ls0 ws0">2</div><div class="t m0 x4e h29 y327 fff fs5 fc0 sc0 ls0 ws0">)<span class="_ _33"> </span><span class="ffd">,<span class="_ _31"> </span>.<span class="_ _33"> </span>.<span class="_ _33"> </span>.<span class="_ _31"> </span>,<span class="_ _33"> </span></span>(<span class="ff10">x</span></div><div class="t m0 x24 h2a y328 ff19 fsa fc0 sc0 ls0 ws0">m</div><div class="t m0 x5c h28 y327 ffd fs5 fc0 sc0 ls0 ws0">,<span class="_ _33"> </span>y</div><div class="t m0 x65 h2a y328 ff19 fsa fc0 sc0 ls0 ws0">m</div><div class="t m0 x98 h29 y327 fff fs5 fc0 sc0 ls0 ws0">)<span class="ffe">}<span class="ff3">;</span></span></div><div class="t m0 x43 h26 y329 ff1 fs5 fc0 sc0 ls0 ws0">属性集<span class="_ _25"> </span><span class="ffd">A<span class="_ _a"> </span><span class="fff">=<span class="_ _a"> </span><span class="ffe">{</span></span>a</span></div><div class="t m0 x56 h27 y32a ff18 fsa fc0 sc0 ls0 ws0">1</div><div class="t m0 xb4 h28 y329 ffd fs5 fc0 sc0 ls0 ws0">,<span class="_ _33"> </span>a</div><div class="t m0 x3e h27 y32a ff18 fsa fc0 sc0 ls0 ws0">2</div><div class="t m0 x49 h28 y329 ffd fs5 fc0 sc0 ls0 ws0">,<span class="_ _33"> </span>.<span class="_ _31"> </span>.<span class="_ _33"> </span>.<span class="_ _33"> </span>,<span class="_ _31"> </span>a</div><div class="t m0 x9 h2a y32a ff19 fsa fc0 sc0 ls0 ws0">d</div><div class="t m0 xd8 h29 y329 ffe fs5 fc0 sc0 ls0 ws0">}<span class="_ _33"></span><span class="ffd">.</span></div><div class="t m0 x105 h29 y32b ff1a fsb fc0 sc0 ls0 ws0">1<span class="_ _5"> </span><span class="ff6 fs5">F<span class="_ _30"></span>unction<span class="_ _25"> </span><span class="ff3">T<span class="_ _28"></span>reeGenerate(D,<span class="_ _25"> </span>A)</span></span></div><div class="t m0 x105 h29 y32c ff1a fsb fc0 sc0 ls0 ws0">2<span class="_ _5"> </span><span class="ff6 fs5">begin</span></div><div class="t m0 x105 h26 y32d ff1a fsb fc0 sc0 ls0 ws0">3<span class="_ _4e"> </span><span class="ff1 fs5">生成结点<span class="_ _25"> </span><span class="ff3">no<span class="_ _23"></span>de;</span></span></div><div class="t m0 x105 h7 y32e ff1a fsb fc0 sc0 ls0 ws0">4<span class="_ _4e"> </span><span class="ff6 fs5">if<span class="_ _e"> </span><span class="ffd">D<span class="_ _e"> </span><span class="ff7">中样本全属于同一类别<span class="_ _d"> </span></span>C<span class="_ _e"> </span></span>then</span></div><div class="t m0 x106 h26 y32f ff1a fsb fc0 sc0 ls0 ws0">5<span class="_ _4f"> </span><span class="ff1 fs5">将<span class="_ _25"> </span><span class="ff3">no<span class="_ _23"></span>de<span class="_ _32"> </span></span>标记为<span class="_ _25"> </span><span class="ffd">C<span class="_ _e"> </span></span>类叶节点<span class="ff3">;<span class="_ _25"> </span><span class="ff6">return</span></span></span></div><div class="t m0 x105 h29 y330 ff1a fsb fc0 sc0 ls0 ws0">6<span class="_ _4e"> </span><span class="ff6 fs5">end</span></div><div class="t m0 x105 h7 y331 ff1a fsb fc0 sc0 ls0 ws0">7<span class="_ _4e"> </span><span class="ff6 fs5">if<span class="_ _e"> </span><span class="ffd">A<span class="_ _a"> </span><span class="fff">=<span class="_ _a"> </span><span class="ffa">∅<span class="_ _d"> </span><span class="ff1b">or<span class="_ _d"> </span></span></span></span>D<span class="_ _e"> </span><span class="ff7">中样本在<span class="_ _25"> </span></span>A<span class="_ _d"> </span><span class="ff7">上取值相同<span class="_ _25"> </span></span></span>then</span></div><div class="t m0 x106 h26 y332 ff1a fsb fc0 sc0 ls0 ws0">8<span class="_ _4f"> </span><span class="ff1 fs5">将<span class="_ _25"> </span><span class="ff3">no<span class="_ _23"></span>de<span class="_ _32"> </span></span>标记为叶结点<span class="ff3">,<span class="_ _25"> </span></span>其类别标记为<span class="_ _25"> </span><span class="ffd">D<span class="_ _d"> </span></span>中样本权重之和最大的类<span class="ff3">;<span class="_ _25"> </span><span class="ff6">return</span></span></span></div><div class="t m0 x105 h29 y333 ff1a fsb fc0 sc0 ls0 ws0">9<span class="_ _4e"> </span><span class="ff6 fs5">end</span></div><div class="t m0 x5 h26 y334 ff1c fs5 fc3 sc0 ls0 ws0">// <span class="ff8">决策树算法的关键</span></div><div class="t m0 x107 h26 y335 ff1a fsb fc4 sc0 ls0 ws0">10<span class="_ _4e"> </span><span class="ff1 fs5">从<span class="_ _25"> </span><span class="ff3">A<span class="_ _25"> </span></span>中选择最优划分属性<span class="_ _25"> </span><span class="ffd">a</span></span></div><div class="t m0 x30 h2b y336 ff1d fsa fc4 sc0 ls0 ws0">∗</div><div class="t m0 x107 h29 y337 ff1a fsb fc0 sc0 ls0 ws0">11<span class="_ _4e"> </span><span class="ff6 fs5">for<span class="_ _25"> </span><span class="ffd">a</span></span></div><div class="t m0 xf0 h2b y338 ff1d fsa fc0 sc0 ls0 ws0">∗</div><div class="t m0 x108 h7 y337 ff7 fs5 fc0 sc0 ls0 ws0">的每一个值<span class="_ _d"> </span><span class="ffd">a</span></div><div class="t m0 x8a h2a y339 ff19 fsa fc0 sc0 ls0 ws0">v</div><div class="t m0 x8a h2b y33a ff1d fsa fc0 sc0 ls0 ws0">∗</div><div class="t m0 x3e h29 y337 ff6 fs5 fc0 sc0 ls0 ws0">do</div><div class="t m0 x107 h26 y33b ff1a fsb fc0 sc0 ls0 ws0">12<span class="_ _4f"> </span><span class="ff1 fs5">为<span class="_ _25"> </span><span class="ff3">no<span class="_ _23"></span>de<span class="_ _32"> </span></span>生成一个分支<span class="ff3">;</span></span></div><div class="t m0 x107 h26 y33c ff1a fsb fc0 sc0 ls0 ws0">13<span class="_ _4f"> </span><span class="ff1 fs5">令<span class="_ _25"> </span><span class="ffd">D</span></span></div><div class="t m0 xe2 h2a y33d ff19 fsa fc0 sc0 ls0 ws0">v</div><div class="t m0 x109 h26 y33c ff1 fs5 fc0 sc0 ls0 ws0">表示<span class="_ _25"> </span><span class="ffd">D<span class="_ _d"> </span></span>中在<span class="_ _25"> </span><span class="ffd">a</span></div><div class="t m0 x3f h2b y33d ff1d fsa fc0 sc0 ls0 ws0">∗</div><div class="t m0 xd7 h26 y33c ff1 fs5 fc0 sc0 ls0 ws0">上取值为<span class="_ _25"> </span><span class="ffd">a</span></div><div class="t m0 x28 h2a y33e ff19 fsa fc0 sc0 ls0 ws0">v</div><div class="t m0 x28 h2b y33f ff1d fsa fc0 sc0 ls0 ws0">∗</div><div class="t m0 x52 h26 y33c ff1 fs5 fc0 sc0 ls0 ws0">的样本子集<span class="ff3">;</span></div><div class="t m0 x107 h29 y340 ff1a fsb fc0 sc0 ls0 ws0">14<span class="_ _4f"> </span><span class="ff6 fs5">if<span class="_ _e"> </span><span class="ffd">D</span></span></div><div class="t m0 x10a h2a y341 ff19 fsa fc0 sc0 ls0 ws0">v</div><div class="t m0 xb3 h7 y340 ff7 fs5 fc0 sc0 ls0 ws0">为空<span class="_ _25"> </span><span class="ff6">then</span></div><div class="t m0 x10b h26 y342 ff1c fs5 fc0 sc0 ls0 ws0">// <span class="ff8 fc3">如果<span class="_ _5"> </span><span class="ffd">a</span></span></div><div class="t m0 xdb h2a y343 ff19 fsa fc3 sc0 ls0 ws0">v</div><div class="t m0 xdb h2b y344 ff1d fsa fc3 sc0 ls0 ws0">∗</div><div class="t m0 x10c h26 y342 ff8 fs5 fc3 sc0 ls0 ws0">的样本全都被分到其他结点<span class="ff1c">, <span class="ffd">D</span></span></div><div class="t m0 x2a h2a y345 ff19 fsa fc3 sc0 ls0 ws0">v</div><div class="t m0 xe0 h26 y342 ff8 fs5 fc3 sc0 ls0 ws0">则会为空</div><div class="t m0 x10b h26 y346 ff1c fs5 fc0 sc0 ls0 ws0">// <span class="ff8 fc3">即使训练集不存在进入该结点的样本<span class="ff1c">, </span>但预测时可能有新样本进入该节点</span></div><div class="t m0 x10d h26 y347 ff1a fsb fc0 sc0 ls0 ws0">15<span class="_ _50"> </span><span class="ff1 fs5">将分支结点标记为叶结点<span class="ff3">,<span class="_ _25"> </span></span>其类别标记为<span class="_ _25"> </span><span class="ff3">D<span class="_ _25"> </span></span>中样本权重之和最大的类<span class="ff3">;<span class="_ _25"> </span><span class="ff6">return</span></span></span></div><div class="t m0 x107 h29 y348 ff1a fsb fc0 sc0 ls0 ws0">16<span class="_ _4f"> </span><span class="ff6 fs5">else</span></div><div class="t m0 x10d h26 y349 ff1a fsb fc0 sc0 ls0 ws0">17<span class="_ _50"> </span><span class="ff1 fs5">以<span class="_ _25"> </span><span class="ff3">T<span class="_ _27"></span>reeGenerate<span class="_ _25"> </span><span class="fff">(<span class="ffd">D</span></span></span></span></div><div class="t m0 x40 h2a y34a ff19 fsa fc0 sc0 ls0 ws0">v</div><div class="t m0 xe7 h29 y349 ffd fs5 fc0 sc0 ls0 ws0">,<span class="_ _33"> </span>A<span class="ffe">\<span class="_ _31"></span>{</span>a</div><div class="t m0 x22 h2b y34a ff1d fsa fc0 sc0 ls0 ws0">∗</div><div class="t m0 x11 h26 y349 ffe fs5 fc0 sc0 ls0 ws0">}<span class="fff">)<span class="_ _25"> </span><span class="ff1">为分支结点</span></span></div><div class="t m0 x107 h29 y34b ff1a fsb fc0 sc0 ls0 ws0">18<span class="_ _4f"> </span><span class="ff6 fs5">end</span></div><div class="t m0 x107 h29 y34c ff1a fsb fc0 sc0 ls0 ws0">19<span class="_ _4e"> </span><span class="ff6 fs5">end</span></div><div class="t m0 x107 h29 y34d ff1a fsb fc0 sc0 ls0 ws0">20<span class="_ _5"> </span><span class="ff6 fs5">end</span></div><div class="t m0 x3 h26 y34e ff6 fs5 fc0 sc0 ls0 ws0">Output:<span class="_ _1e"> </span><span class="ff1">以<span class="_ _25"> </span><span class="ff3">no<span class="_ _23"></span>de<span class="_ _32"> </span></span>为根节点的一颗决策树</span></div><div class="t m0 x3 h6 y34f ff1 fs2 fc0 sc0 ls0 ws0">决策树的生成可以使用上述递归算法。在决策树基本算法中，有三种情形会致递归的返回：</div><div class="t m0 x15 h6 y350 ff3 fs2 fc0 sc0 ls0 ws0">1.<span class="_ _5"> </span><span class="ff1">当前结点包含的样本全属于同一类别，无需划分</span></div><div class="t m0 x15 h6 y351 ff3 fs2 fc0 sc0 ls0 ws0">2.<span class="_ _5"> </span><span class="ff1">当前性集为空，或是所有样本在所有属性上取值相同，无法划分</span></div><div class="t m0 x15 h6 y352 ff3 fs2 fc0 sc0 ls0 ws0">3.<span class="_ _5"> </span><span class="ff1">当前结点包含的样本集合为空，不能划分</span></div><div class="t m0 x3 h6 y353 ff1 fs2 fc0 sc0 ls0 ws0">情形<span class="_ _d"> </span><span class="ff3">2<span class="_ _25"> </span></span>和情形<span class="_ _d"> </span><span class="ff3">3<span class="_ _d"> </span></span>的处理方式类似，但情形<span class="_ _25"> </span><span class="ff3">2<span class="_ _d"> </span></span>是在利用当前结点的后验分布，而情形<span class="_ _25"> </span><span class="ff3">3<span class="_ _d"> </span></span>则是把父</div><div class="t m0 x3 h6 y354 ff1 fs2 fc0 sc0 ls0 ws0">结点的样本分布作为当前结点的先验分布。</div><div class="t m0 x11 h9 y355 ff5 fs6 fc0 sc0 ls0 ws0">5.3<span class="_ _24"> </span><span class="ff9">划分选择</span></div><div class="t m0 x3 h6 y356 ff1 fs2 fc0 sc0 ls0 ws0">直觉<span class="_ _23"></span>上，随着<span class="_ _23"></span>划分<span class="_ _23"></span>过程不<span class="_ _23"></span>断进行，我<span class="_ _23"></span>们希望<span class="_ _23"></span>决策<span class="_ _23"></span>树的分<span class="_ _23"></span>支结点<span class="_ _23"></span>所包<span class="_ _23"></span>含的样<span class="_ _23"></span>本尽可<span class="_ _23"></span>能属于<span class="_ _23"></span>同一<span class="_ _23"></span>类</div><div class="t m0 x3 h6 y357 ff1 fs2 fc0 sc0 ls0 ws0">别，即结点的“纯度”<span class="_ _26"></span>（<span class="ff3">purity</span>）越来越高。更具体来说：</div><div class="t m0 x15 h6 y358 ff3 fs2 fc0 sc0 ls0 ws0">1.<span class="_ _5"> </span><span class="ff1">如果结点的类别数量不变，我们希望某个类别所占比例越高越好；</span></div><div class="t m0 x15 h6 y2ca ff3 fs2 fc0 sc0 ls0 ws0">2.<span class="_ _5"> </span><span class="ff1">如果结点的类别数量发生变化，我们希望结点的类别数量越少越好。</span></div><div class="t m0 x3 h6 y359 ff1 fs2 fc0 sc0 ls0 ws0">也就是说，我们想找到一个量去量化<span class="_ _23"></span>“纯度”<span class="_ _26"></span>，在<span class="_ _23"></span>样本类别个数不变的条件下，这个量应该随着</div><div class="t m0 x3 h6 y35a ff1 fs2 fc0 sc0 ls0 ws0">类别所占比例的增加而单调递增；<span class="_ _2e"></span>如果样本类别个数发生变化，<span class="_ _2a"></span>这个量应该随着类别个数的增加</div><div class="t m0 x3 h6 y2cc ff1 fs2 fc0 sc0 ls0 ws0">而单调递减。<span class="_ _30"></span>另外，<span class="_ _27"></span>为了方便数学上的处理，<span class="_ _30"></span>我们可能还希望这个量永远不会取到负值，<span class="_ _30"></span>如果是</div><div class="t m0 x3 h6 y86 ff1 fs2 fc0 sc0 ls0 ws0">连续的就更好了。</div><div class="t m0 x3 h6 y18e ff1 fs2 fc0 sc0 ls0 ws0">实际<span class="_ _23"></span>上，以上<span class="_ _23"></span>两点都<span class="_ _23"></span>可以<span class="_ _23"></span>归结为<span class="_ _23"></span>一点，即<span class="_ _23"></span>属于某<span class="_ _23"></span>个类别<span class="_ _23"></span>的样<span class="_ _23"></span>本数量<span class="_ _23"></span>占整个<span class="_ _23"></span>结点的<span class="_ _23"></span>样本<span class="_ _23"></span>总数的<span class="_ _23"></span>比</div><div class="t m0 x3 h6 y20 ff1 fs2 fc0 sc0 ls0 ws0">例越高越好。<span class="_ _30"></span>因为结点类别数量减少，<span class="_ _29"></span>即是某些类别的样本所占比例为<span class="_ _25"> </span><span class="ff3">0</span>。<span class="_ _30"></span>同时，<span class="_ _29"></span>基于大数定律，</div><div class="t m0 x3 h4 y3 ff3 fs2 fc0 sc0 ls0 ws0">26</div></div><div class="pi" data-data='{"ctm":[1.500000,0.000000,0.000000,1.500000,0.000000,0.000000]}'></div></div>
<div id="pf21" class="pf w0 h0" data-page-no="21"><div class="pc pc21 w0 h0"><img class="bi x3 y35b w1 h2c" alt="" src="bg21.png"/><div class="t m0 x27 h7 y21 ff3 fs5 fc0 sc0 ls0 ws0">5.3<span class="_ _8"> </span><span class="ff7">划分选择</span></div><div class="t m0 x3 h6 y22 ff1 fs2 fc0 sc0 ls0 ws0">当样本量较大时，<span class="_ _2a"></span>比例可以作为概率的近似。<span class="_ _2e"></span>因此，<span class="_ _2e"></span><span class="ff3">purit<span class="_ _28"></span>y <span class="ff1">应该是一个关于各个类别概率的函数，</span></span></div><div class="t m0 x3 h6 y17d ff1 fs2 fc0 sc0 ls0 ws0">该概率分布越集中，<span class="ff3">purit<span class="_ _12"></span>y<span class="_ _d"> </span><span class="ff1">的值越大。</span></span></div><div class="t m0 x3 h6 y88 ff1 fs2 fc0 sc0 ls0 ws0">如果有一<span class="_ _23"></span>个量，当类别概率分<span class="_ _23"></span>布越集中时，这个<span class="_ _23"></span>量的取值越小，那么<span class="_ _23"></span>它也可以作为<span class="_ _e"> </span><span class="ff3">purity<span class="_ _d"> </span></span>的度</div><div class="t m0 x3 h6 y89 ff1 fs2 fc0 sc0 ls0 ws0">量，只需<span class="_ _23"></span>要将其取<span class="_ _23"></span>倒数即可。这<span class="_ _23"></span>样的量被<span class="_ _23"></span>称为<span class="_ _e"> </span><span class="ff3">impurit<span class="_ _12"></span>y<span class="ff1">。显然，<span class="_ _23"></span>在数学上，</span>purity<span class="_ _e"> </span><span class="ff1">和<span class="_ _e"> </span></span>impurity</span></div><div class="t m0 x3 h6 y35c ff1 fs2 fc0 sc0 ls0 ws0">都是一样的，它们可以相互转换。实际应用时，一般使用<span class="_ _d"> </span><span class="ff3">impurit<span class="_ _12"></span>y<span class="ff1">。</span></span></div><div class="t m0 x3 h6 y8b ff1 fs2 fc0 sc0 ls0 ws0">我们可以将上面的描述，转换为<span class="_ _d"> </span><span class="ff3">impurit<span class="_ _12"></span>y<span class="_ _d"> </span><span class="ff1">函数的数学定义。</span></span></div><div class="t m0 x3 h6 y8c ff4 fs2 fc0 sc0 ls0 ws0">定义<span class="ff6">5.1<span class="_ _5"> </span><span class="fc1">impurit<span class="_ _28"></span>y<span class="_ _1e"> </span>function<span class="ff4">：<span class="_ _25"> </span><span class="ff3 fc0">impurity<span class="_ _25"> </span><span class="ff1">函数<span class="_ _d"> </span><span class="fff">Φ<span class="_ _d"> </span></span>是定义在<span class="_ _d"> </span><span class="ffd">k<span class="_ _e"> </span></span>维数组<span class="_ _d"> </span><span class="fff">(<span class="ffd">p</span></span></span></span></span></span></span></div><div class="t m0 x10e ha y35d ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 xdf h4 y8c ffd fs2 fc0 sc0 ls0 ws0">,<span class="_ _31"> </span><span class="ffe">·<span class="_ _31"></span>·<span class="_ _31"></span>·<span class="_ _d"> </span></span>,<span class="_ _31"> </span>p</div><div class="t m0 x10f hb y35e ffc fs7 fc0 sc0 ls0 ws0">k</div><div class="t m0 x110 h6 y8c fff fs2 fc0 sc0 ls0 ws0">)<span class="_ _d"> </span><span class="ff1">上的函数，并</span></div><div class="t m0 x3 h6 y35f ff1 fs2 fc0 sc0 ls0 ws0">具有以下三条性质：</div><div class="t m0 x15 h6 y8e ff3 fs2 fc0 sc0 ls0 ws0">1.<span class="_ _5"> </span><span class="fff">Φ<span class="_ _d"> </span><span class="ff1">在<span class="_ _d"> </span><span class="ffd">p</span></span></span></div><div class="t m0 xf1 hb y360 ffc fs7 fc0 sc0 ls0 ws0">j</div><div class="t m0 xfd h6 y8e ff1 fs2 fc0 sc0 ls0 ws0">是均匀分布（即所有<span class="_ _d"> </span><span class="ffd">p</span></div><div class="t m0 x111 hb y360 ffc fs7 fc0 sc0 ls0 ws0">j</div><div class="t m0 x28 h6 y8e ff1 fs2 fc0 sc0 ls0 ws0">相等）时达到最大值。</div><div class="t m0 x15 h6 y8f ff3 fs2 fc0 sc0 ls0 ws0">2.<span class="_ _5"> </span><span class="fff">Φ<span class="_ _d"> </span><span class="ff1">只有在<span class="_ _d"> </span><span class="ffd">p</span></span></span></div><div class="t m0 x92 hb y361 ffc fs7 fc0 sc0 ls0 ws0">j</div><div class="t m0 xd5 h6 y8f fff fs2 fc0 sc0 ls0 ws0">=<span class="_ _32"> </span>1<span class="ffd">,<span class="_ _0"> </span>j<span class="_ _e"> </span><span class="ffe">∈<span class="_ _a"> </span></span></span>(1<span class="ffd">,<span class="_ _31"> </span></span>2<span class="ffd">,<span class="_ _31"> </span><span class="ffe">·<span class="_ _31"></span>·<span class="_ _31"></span>·<span class="_ _d"> </span></span>,<span class="_ _31"> </span>k<span class="_ _23"></span></span>)<span class="_ _d"> </span><span class="ff1">时达到最小值。</span></div><div class="t m0 x15 h6 y2a9 ff3 fs2 fc0 sc0 ls0 ws0">3.<span class="_ _5"> </span><span class="fff">Φ<span class="_ _d"> </span><span class="ff1">是一个对称函数，即置换各个<span class="_ _d"> </span><span class="ffd">p</span></span></span></div><div class="t m0 x4f hb y362 ffc fs7 fc0 sc0 ls0 ws0">j</div><div class="t m0 x33 h6 y2a9 ff1 fs2 fc0 sc0 ls0 ws0">的位置，<span class="fff">Φ<span class="_ _d"> </span></span>的值不变。</div><div class="t m0 x3 h6 y363 ff1 fs2 fc0 sc0 ls0 ws0">其中，<span class="ffd">p</span></div><div class="t m0 xf0 hb y364 ffc fs7 fc0 sc0 ls0 ws0">j</div><div class="t m0 xee h6 y363 ff1 fs2 fc0 sc0 ls0 ws0">满足<span class="_ _d"> </span><span class="ffd">p</span></div><div class="t m0 x88 hb y364 ffc fs7 fc0 sc0 ls0 ws0">j</div><div class="t m0 x3c h4 y363 ffe fs2 fc0 sc0 ls0 ws0">≥<span class="_ _32"> </span><span class="fff">0<span class="ffd">,<span class="_ _0"> </span>j<span class="_ _e"> </span></span></span>∈<span class="_ _a"> </span><span class="fff">(1<span class="ffd">,<span class="_ _31"> </span></span>2<span class="ffd">,<span class="_ _31"> </span></span></span>·<span class="_ _31"></span>·<span class="_ _31"></span>·<span class="_ _d"> </span><span class="ffd">,<span class="_ _31"> </span>k<span class="_ _23"></span><span class="fff">)</span>,<span class="_ _5"> </span><span class="fff">Σ</span></span></div><div class="t m0 x24 hb y364 ffc fs7 fc0 sc0 ls0 ws0">j</div><div class="t m0 x1 he y363 ffd fs2 fc0 sc0 ls0 ws0">p</div><div class="t m0 x34 hb y364 ffc fs7 fc0 sc0 ls0 ws0">j</div><div class="t m0 x97 h6 y363 fff fs2 fc0 sc0 ls0 ws0">=<span class="_ _32"> </span>1<span class="ff1">。</span></div><div class="t m0 x3 h6 y365 ff3 fs2 fc0 sc0 ls0 ws0">purit<span class="_ _12"></span>y<span class="_ _d"> </span><span class="ff1">函数可以有不同的定义，但是它们都满足这个三条性质。</span></div><div class="t m0 x3 h6 y366 ff4 fs2 fc0 sc0 ls0 ws0">定义<span class="ff6">5.2<span class="_ _5"> </span><span class="fc1">impurit<span class="_ _28"></span>y<span class="_ _1e"> </span>measure<span class="ff4">：<span class="_ _d"> </span><span class="ff1 fc0">给定一个<span class="_ _d"> </span><span class="ff3">impurity<span class="_ _25"> </span></span>函数<span class="_ _d"> </span><span class="fff">Φ</span>，则一个结点<span class="_ _d"> </span><span class="ff3">t<span class="_ _d"> </span></span>的<span class="_ _d"> </span><span class="ff3">impurity<span class="_ _25"> </span></span>为：</span></span></span></span></div><div class="t m0 x46 h4 y367 ffd fs2 fc0 sc0 ls0 ws0">i<span class="fff">(</span>t<span class="fff">)<span class="_ _32"> </span>=<span class="_ _32"> </span>Φ(</span>p<span class="fff">(1<span class="_ _32"> </span><span class="ffe">|<span class="_ _32"> </span></span></span>t<span class="fff">)</span>,<span class="_ _31"> </span>p<span class="fff">(2<span class="_ _32"> </span><span class="ffe">|<span class="_ _32"> </span></span></span>t<span class="fff">)</span>,<span class="_ _31"> </span>.<span class="_ _31"> </span>.<span class="_ _31"> </span>.<span class="_ _31"> </span>,<span class="_ _31"> </span>p<span class="fff">(</span>k<span class="_ _25"> </span><span class="ffe">|<span class="_ _32"> </span></span>t<span class="fff">))</span></div><div class="t m0 x3 h6 y368 ff1 fs2 fc0 sc0 ls0 ws0">其中<span class="_ _d"> </span><span class="ffd">p<span class="fff">(</span>j<span class="_ _d"> </span><span class="ffe">|<span class="_ _32"> </span></span>t<span class="fff">)<span class="_ _d"> </span></span></span>是给定结点<span class="_ _d"> </span><span class="ff3">t<span class="_ _d"> </span></span>中的类<span class="_ _d"> </span><span class="ff3">j<span class="_ _d"> </span></span>的估计条件概率（经验后验概率）<span class="_ _26"></span>。</div><div class="t m0 x3 h6 y369 ff1 fs2 fc0 sc0 ls0 ws0">根据<span class="_ _d"> </span><span class="ff3">impurit<span class="_ _12"></span>y<span class="_ _d"> </span>measure<span class="_ _d"> </span><span class="ff1">可以定义结点<span class="_ _d"> </span></span>t<span class="_ _d"> </span><span class="ff1">的分裂优度。</span></span></div><div class="t m0 x3 h6 y36a ff4 fs2 fc0 sc0 ls0 ws0">定<span class="_ _23"></span>义<span class="ff6">5.3<span class="_ _0"> </span><span class="fc1">go<span class="_ _23"></span>o<span class="_ _23"></span>dness<span class="_ _5"> </span>of split<span class="_ _5"> </span>s<span class="_ _18"> </span>for<span class="_ _18"> </span>no<span class="_ _23"></span>de<span class="_ _5"> </span>t<span class="ff4">：<span class="_ _0"> </span></span></span><span class="ff1">假<span class="_ _23"></span>设<span class="_ _23"></span>决策<span class="_ _23"></span>树<span class="_ _23"></span>是<span class="_ _23"></span>一<span class="_ _23"></span>颗二<span class="_ _23"></span>叉<span class="_ _23"></span>树，<span class="_ _23"></span>那么<span class="_ _23"></span>分<span class="_ _23"></span>裂<span class="_ _23"></span>优度<span class="_ _23"></span>记<span class="_ _23"></span>为</span></span></div><div class="t m0 x3 h6 y36b fff fs2 fc0 sc0 ls0 ws0">Φ(<span class="ffd">s,<span class="_ _31"> </span>t</span>)<span class="ff1">。</span></div><div class="t m0 x83 h4 y36c fff fs2 fc0 sc0 ls0 ws0">Φ(<span class="ffd">s,<span class="_ _31"> </span>t</span>)<span class="_ _32"> </span>=<span class="_ _32"> </span>∆<span class="ffd">i</span>(<span class="ffd">s,<span class="_ _31"> </span>t</span>)<span class="_ _32"> </span>=<span class="_ _32"> </span><span class="ffd">i</span>(<span class="ffd">t</span>)<span class="_ _37"> </span><span class="ffe">−<span class="_ _37"> </span><span class="ffd">p</span></span></div><div class="t m0 x21 h10 y36d ff13 fs9 fc0 sc0 ls0 ws0">L</div><div class="t m0 x99 h4 y36c ffd fs2 fc0 sc0 ls0 ws0">i<span class="fff">(</span>t</div><div class="t m0 xc8 hb y36e ffc fs7 fc0 sc0 ls0 ws0">L</div><div class="t m0 x112 h4 y36c fff fs2 fc0 sc0 ls0 ws0">)<span class="_ _37"> </span><span class="ffe">−<span class="_ _37"> </span><span class="ffd">p</span></span></div><div class="t m0 xae h10 y36d ff13 fs9 fc0 sc0 ls0 ws0">R</div><div class="t m0 xf6 h4 y36c ffd fs2 fc0 sc0 ls0 ws0">i<span class="fff">(</span>t</div><div class="t m0 xbe hb y36e ffc fs7 fc0 sc0 ls0 ws0">R</div><div class="t m0 xbf h4 y36c fff fs2 fc0 sc0 ls0 ws0">)</div><div class="t m0 x3 h6 y36f ff1 fs2 fc0 sc0 ls0 ws0">其中，权重<span class="_ _d"> </span><span class="ffd">p</span></div><div class="t m0 x109 h10 y370 ff13 fs9 fc0 sc0 ls0 ws0">L</div><div class="t m0 x3b h6 y36f ff1 fs2 fc0 sc0 ls0 ws0">和<span class="_ _d"> </span><span class="ffd">p</span></div><div class="t m0 x55 h10 y370 ff13 fs9 fc0 sc0 ls0 ws0">R</div><div class="t m0 x2d h6 y36f ff1 fs2 fc0 sc0 ls0 ws0">分别是<span class="_ _d"> </span><span class="ff3">t<span class="_ _d"> </span></span>结点的样本进入左右子结点的比例。</div><div class="t m0 x3 h6 y371 fff fs2 fc0 sc0 ls0 ws0">Φ(<span class="ffd">s,<span class="_ _31"> </span>t</span>)<span class="_ _d"> </span><span class="ff1">值最大的属性为最优划分属性。</span></div><div class="t m0 x3 h6 y372 ff1 fs2 fc0 sc0 ls0 ws0">树<span class="_ _d"> </span><span class="ff3">T<span class="_ _d"> </span></span>的<span class="_ _d"> </span><span class="ff3">impurit<span class="_ _12"></span>y<span class="_ _d"> </span>measure<span class="_ _d"> </span><span class="ff1">总和为</span></span></div><div class="t m0 x4d h4 y373 ffd fs2 fc0 sc0 ls0 ws0">I<span class="_ _51"></span><span class="fff">(</span>T<span class="_ _33"> </span><span class="fff">)<span class="_ _a"> </span>=</span></div><div class="t m0 x23 hc y374 ff11 fs2 fc0 sc0 ls0 ws0">X</div><div class="t m0 x23 ha y375 ffc fs7 fc0 sc0 ls0 ws0">t<span class="ffb">∈</span></div><div class="t m0 x1 ha y376 ff12 fs7 fc0 sc0 ls0 ws0">˜</div><div class="t m0 x96 hb y375 ffc fs7 fc0 sc0 ls0 ws0">T</div><div class="t m0 x34 h4 y373 ffd fs2 fc0 sc0 ls0 ws0">I<span class="_ _51"></span><span class="fff">(</span>t<span class="fff">)<span class="_ _32"> </span>=</span></div><div class="t m0 xcf hc y374 ff11 fs2 fc0 sc0 ls0 ws0">X</div><div class="t m0 xcf ha y375 ffc fs7 fc0 sc0 ls0 ws0">t<span class="ffb">∈</span></div><div class="t m0 x60 ha y376 ff12 fs7 fc0 sc0 ls0 ws0">˜</div><div class="t m0 x21 hb y375 ffc fs7 fc0 sc0 ls0 ws0">T</div><div class="t m0 x37 h4 y373 ffd fs2 fc0 sc0 ls0 ws0">i<span class="fff">(</span>t<span class="fff">)</span>p<span class="fff">(</span>t<span class="fff">)</span></div><div class="t m0 x113 h4 y377 fff fs2 fc0 sc0 ls0 ws0">˜</div><div class="t m0 x3 h6 y378 ffd fs2 fc0 sc0 ls0 ws0">T<span class="_ _3f"> </span><span class="ff1">是<span class="_ _d"> </span><span class="ff3">T<span class="_ _d"> </span></span>树所有的叶子结点，</span>p<span class="fff">(</span>t<span class="fff">)<span class="_ _d"> </span><span class="ff1">是样本进入<span class="_ _d"> </span><span class="ff3">t<span class="_ _d"> </span></span>结点的概率。</span></span></div><div class="t m0 x3 hd y379 ff5 fs8 fc0 sc0 ls0 ws0">5.3.1<span class="_ _36"> </span><span class="ff9">信息增益</span></div><div class="t m0 x3 h6 y37a ff1 fs2 fc0 sc0 ls0 ws0">使用信息熵<span class="_ _32"> </span><span class="ffd">E</span></div><div class="t m0 x114 ha y37b ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 xda h6 y37a ff1 fs2 fc0 sc0 ls0 ws0">衡量某个结点的<span class="_ _30"></span>“纯度”<span class="_ _26"></span>，<span class="_ _2e"></span>使用加权的信息熵衡<span class="_ _32"> </span><span class="ffd">E</span></div><div class="t m0 x64 ha y37b ff12 fs7 fc0 sc0 ls0 ws0">2</div><div class="t m0 x115 h6 y37a ff1 fs2 fc0 sc0 ls0 ws0">量该结点的所有子节点的<span class="_ _30"></span>“纯</div><div class="t m0 x3 h6 y37c ff1 fs2 fc0 sc0 ls0 ws0">度”<span class="_ _3e"></span>。我<span class="_ _23"></span>们显然希望，该结点<span class="_ _23"></span>通过该次分裂，<span class="_ _3b"></span>“纯度”尽可能的提高。<span class="_ _23"></span>也就是说<span class="_ _d"> </span><span class="ffd">E</span></div><div class="t m0 x116 ha y37d ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 x117 h4 y37c ffe fs2 fc0 sc0 ls0 ws0">−<span class="_ _37"> </span><span class="ffd">E</span></div><div class="t m0 x1c ha y37d ff12 fs7 fc0 sc0 ls0 ws0">2</div><div class="t m0 x68 h6 y37c ff1 fs2 fc0 sc0 ls0 ws0">的值越</div><div class="t m0 x3 h6 y37e ff1 fs2 fc0 sc0 ls0 ws0">大越好。于是<span class="_ _d"> </span><span class="ffd">E</span></div><div class="t m0 x88 ha y37f ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 xf2 h6 y37e ff1 fs2 fc0 sc0 ls0 ws0">和<span class="_ _d"> </span><span class="ffd">E</span></div><div class="t m0 x10c ha y37f ff12 fs7 fc0 sc0 ls0 ws0">2</div><div class="t m0 x118 h6 y37e ff1 fs2 fc0 sc0 ls0 ws0">的差就可以用于选择最优“划分属性”<span class="_ _26"></span>。</div><div class="t m0 x3 he y380 ffd fs2 fc0 sc0 ls0 ws0">E</div><div class="t m0 x119 ha y381 ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 x5 h6 y380 ff1 fs2 fc0 sc0 ls0 ws0">和<span class="_ _d"> </span><span class="ffd">E</span></div><div class="t m0 xf0 ha y381 ff12 fs7 fc0 sc0 ls0 ws0">2</div><div class="t m0 x108 h6 y380 ff1 fs2 fc0 sc0 ls0 ws0">的差被称为信息增益（<span class="ff3">Information<span class="_ _e"> </span>Gain</span>）<span class="_ _2f"></span>。选择划分属性时，计算出样<span class="_ _23"></span>本每个属性对</div><div class="t m0 x3 h6 y382 ff1 fs2 fc0 sc0 ls0 ws0">应的<span class="_ _d"> </span><span class="ff3">Gain</span>，再选择最大的<span class="_ _d"> </span><span class="ff3">Gain<span class="_ _d"> </span></span>对应的属性作为划分属性即可。</div><div class="t m0 x3 h6 y383 ff4 fs2 fc0 sc0 ls0 ws0">定义<span class="ff6">5.4<span class="_ _5"> </span></span><span class="fc1">信息<span class="_ _23"></span>熵：<span class="_ _e"> </span></span><span class="ff1">假定当前<span class="_ _23"></span>样本集合<span class="_ _1e"> </span><span class="ffd">D<span class="_ _1e"> </span></span>中第<span class="_ _1e"> </span><span class="ffd">k<span class="_ _1e"> </span></span>类样<span class="_ _23"></span>本所占的比<span class="_ _23"></span>例为<span class="_ _e"> </span><span class="ffd">p</span></span></div><div class="t m0 x11a hb y384 ffc fs7 fc0 sc0 ls0 ws0">k</div><div class="t m0 x11b h6 y383 fff fs2 fc0 sc0 ls0 ws0">(<span class="ffd">k<span class="_ _e"> </span></span>=<span class="_ _e"> </span>1<span class="ffd">,<span class="_ _31"> </span></span>2<span class="ffd">,<span class="_ _31"> </span>.<span class="_ _31"> </span>.<span class="_ _31"> </span>.<span class="_ _31"> </span>,<span class="_ _31"> </span><span class="ffe">|Y<span class="_ _51"></span>|</span></span>)<span class="ff1">，则</span></div><div class="t m0 x3 h6 y385 ffd fs2 fc0 sc0 ls0 ws0">D<span class="_ _e"> </span><span class="ff1">的信息熵定义为</span></div><div class="t m0 x9b h4 y386 ff3 fs2 fc0 sc0 ls0 ws0">Ent<span class="fff">(<span class="ffd">D<span class="_ _23"></span></span>)<span class="_ _a"> </span>=<span class="_ _32"> </span><span class="ffe">−</span></span></div><div class="t m0 x70 ha y387 ffb fs7 fc0 sc0 ls0 ws0">|Y<span class="_ _23"></span>|</div><div class="t m0 x81 hc y388 ff11 fs2 fc0 sc0 ls0 ws0">X</div><div class="t m0 x81 ha y389 ffc fs7 fc0 sc0 ls0 ws0">k<span class="ff12">=1</span></div><div class="t m0 xcf he y386 ffd fs2 fc0 sc0 ls0 ws0">p</div><div class="t m0 xd2 hb y38a ffc fs7 fc0 sc0 ls0 ws0">k</div><div class="t m0 xe0 h4 y386 ff3 fs2 fc0 sc0 ls0 ws0">log</div><div class="t m0 xc8 ha y38b ff12 fs7 fc0 sc0 ls0 ws0">2</div><div class="t m0 x26 he y386 ffd fs2 fc0 sc0 ls0 ws0">p</div><div class="t m0 x62 hb y38a ffc fs7 fc0 sc0 ls0 ws0">k</div><div class="t m0 xaf h4 y386 ff3 fs2 fc0 sc0 ls0 ws0">(5.1)</div><div class="t m0 xbc h4 y3 ff3 fs2 fc0 sc0 ls0 ws0">27</div></div><div class="pi" data-data='{"ctm":[1.500000,0.000000,0.000000,1.500000,0.000000,0.000000]}'></div></div>
<div id="pf22" class="pf w0 h0" data-page-no="22"><div class="pc pc22 w0 h0"><img class="bi x3 y38c w1 h2d" alt="" src="bg22.png"/><div class="t m0 x3 h7 y21 ff3 fs5 fc0 sc0 ls0 ws0">5.3<span class="_ _8"> </span><span class="ff7">划分选择</span></div><div class="t m0 x12 h6 y143 ff1 fs2 fc0 sc0 ls0 ws0">实际上，<span class="_ _28"></span>在信息熵的定义中，<span class="_ _28"></span><span class="ffd">p</span></div><div class="t m0 x11c hb y38d ffc fs7 fc0 sc0 ls0 ws0">k</div><div class="t m0 x6e h6 y143 ff1 fs2 fc0 sc0 ls0 ws0">代表概率，<span class="_ _28"></span>但基于大数定律，<span class="_ _28"></span>样本量较大时，<span class="_ _27"></span>可以用频率</div><div class="t m0 x119 h6 y38e ff1 fs2 fc0 sc0 ls0 ws0">（比例）近似概率。</div><div class="t m0 x3 h6 y38f ff1 fs2 fc0 sc0 ls0 ws0">可以观察当样本类别为二分类时，信息熵的大小与某个类别的样本所占比例的关系。</div><div class="t m0 x3 h6 y390 ff4 fs2 fc0 sc0 ls0 ws0">定义<span class="ff6">5.5<span class="_ _5"> </span></span><span class="fc1">信息增益：<span class="_ _e"> </span></span><span class="ff1">假定<span class="_ _23"></span>离散属性<span class="_ _e"> </span><span class="ffd">a<span class="_ _d"> </span></span>有<span class="_ _e"> </span><span class="ffd">V<span class="_ _b"> </span></span>个可能<span class="_ _23"></span>的取值</span></div><div class="t m0 x11d hc y391 ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x3a he y390 ffd fs2 fc0 sc0 ls0 ws0">a</div><div class="t m0 xc5 ha y392 ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 xc6 he y390 ffd fs2 fc0 sc0 ls0 ws0">,<span class="_ _31"> </span>a</div><div class="t m0 x11e ha y392 ff12 fs7 fc0 sc0 ls0 ws0">2</div><div class="t m0 x7c he y390 ffd fs2 fc0 sc0 ls0 ws0">,<span class="_ _31"> </span>.<span class="_ _31"> </span>.<span class="_ _31"> </span>.<span class="_ _31"> </span>,<span class="_ _31"> </span>a</div><div class="t m0 x11f hb y392 ffc fs7 fc0 sc0 ls0 ws0">V</div><div class="t m0 x120 hc y391 ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x121 h6 y390 ffd fs2 fc0 sc0 ls0 ws0">,<span class="_ _e"> </span><span class="ff1">若使用<span class="_ _e"> </span></span>a<span class="_ _e"> </span><span class="ff1">来对样本</span></div><div class="t m0 x3 h6 y393 ff1 fs2 fc0 sc0 ls0 ws0">集<span class="_ _d"> </span><span class="ffd">D<span class="_ _e"> </span></span>进行划分，则<span class="_ _23"></span>会产生<span class="_ _d"> </span><span class="ff3">V<span class="_ _d"> </span></span>个分支结点<span class="ff3">,<span class="_ _d"> </span></span>其<span class="_ _23"></span>中第<span class="_ _d"> </span><span class="ffd">v<span class="_ _e"> </span></span>个分支结点包含了<span class="_ _e"> </span><span class="ffd">D<span class="_ _e"> </span></span>中所有在属性<span class="_ _d"> </span><span class="ff3">a<span class="_ _e"> </span></span>上取</div><div class="t m0 x3 h6 y394 ff1 fs2 fc0 sc0 ls0 ws0">值为<span class="_ _d"> </span><span class="ffd">a</span></div><div class="t m0 xb9 hb y395 ffc fs7 fc0 sc0 ls0 ws0">v</div><div class="t m0 xb1 h6 y394 ff1 fs2 fc0 sc0 ls0 ws0">的样本<span class="ff3">,<span class="_ _d"> </span></span>记为<span class="_ _d"> </span><span class="ffd">D</span></div><div class="t m0 x3e hb y395 ffc fs7 fc0 sc0 ls0 ws0">v</div><div class="t m0 x49 h6 y394 ff1 fs2 fc0 sc0 ls0 ws0">。</div><div class="t m0 x3f h4 y396 ff3 fs2 fc0 sc0 ls0 ws0">Gain</div><div class="t m0 x93 h4 y397 fff fs2 fc0 sc0 ls0 ws0">(</div><div class="t m0 xf he y396 ffd fs2 fc0 sc0 ls0 ws0">D<span class="_ _23"></span>,<span class="_ _33"> </span>a</div><div class="t m0 x111 h4 y397 fff fs2 fc0 sc0 ls0 ws0">)<span class="_ _32"> </span>=</div><div class="t m0 x5b h4 y396 ff3 fs2 fc0 sc0 ls0 ws0">Ent</div><div class="t m0 x122 h4 y397 fff fs2 fc0 sc0 ls0 ws0">(</div><div class="t m0 x123 he y396 ffd fs2 fc0 sc0 ls0 ws0">D</div><div class="t m0 xa h4 y397 fff fs2 fc0 sc0 ls0 ws0">)</div><div class="t m0 x2b h4 y396 ffe fs2 fc0 sc0 ls0 ws0">−</div><div class="t m0 x2a hb y398 ffc fs7 fc0 sc0 ls0 ws0">V</div><div class="t m0 xf5 hc y399 ff11 fs2 fc0 sc0 ls0 ws0">X</div><div class="t m0 xf5 ha y39a ffc fs7 fc0 sc0 ls0 ws0">v<span class="_ _23"></span><span class="ff12">=1</span></div><div class="t m0 x78 h4 y39b ffe fs2 fc5 sc0 ls0 ws0">|<span class="ffd">D</span></div><div class="t m0 x79 hb y39c ffc fs7 fc5 sc0 ls0 ws0">v</div><div class="t m0 x11d h4 y39b ffe fs2 fc5 sc0 ls0 ws0">|</div><div class="t m0 x124 h4 y39d ffe fs2 fc5 sc0 ls0 ws0">|<span class="ffd">D<span class="_ _23"></span></span>|</div><div class="t m0 x3a h4 y396 ff3 fs2 fc0 sc0 ls0 ws0">Ent</div><div class="t m0 xa1 h4 y397 fff fs2 fc0 sc0 ls0 ws0">(</div><div class="t m0 xa2 he y396 ffd fs2 fc0 sc0 ls0 ws0">D</div><div class="t m0 x7d hb y39e ffc fs7 fc0 sc0 ls0 ws0">v</div><div class="t m0 x125 h4 y397 fff fs2 fc0 sc0 ls0 ws0">)</div><div class="t m0 xaf h4 y396 ff3 fs2 fc0 sc0 ls0 ws0">(5.2)</div><div class="t m0 x3 h6 y39f ff1 fs2 fc0 sc0 ls0 ws0">注意到公式<span class="ff3">5.2</span>标红显示的部分，<span class="ffe">|<span class="ffd">D</span></span></div><div class="t m0 x69 hb y3a0 ffc fs7 fc0 sc0 ls0 ws0">v</div><div class="t m0 x47 h6 y39f ffe fs2 fc0 sc0 ls0 ws0">|<span class="_ _31"></span><span class="fff">/</span>|<span class="ffd">D<span class="_ _23"></span></span>|<span class="_ _25"> </span><span class="ff1">是各个分支结<span class="_ _23"></span>点的权重，因此样本数越多的分支结点</span></div><div class="t m0 x3 h6 y3a1 ff1 fs2 fc0 sc0 ls0 ws0">的影响越大。</div><div class="t m0 x3 h6 y3a2 ff1 fs2 fc0 sc0 ls0 ws0">最终选择属性<span class="_ _d"> </span><span class="ffd">a</span></div><div class="t m0 xe5 ha y3a3 ffb fs7 fc0 sc0 ls0 ws0">∗</div><div class="t m0 x91 h4 y3a2 fff fs2 fc0 sc0 ls0 ws0">=<span class="_ _32"> </span><span class="ff3">arg<span class="_ _31"> </span>max</span></div><div class="t m0 xb4 ha y3a4 ffc fs7 fc0 sc0 ls0 ws0">a<span class="ffb">∈</span>A</div><div class="t m0 x50 h6 y3a2 ff3 fs2 fc0 sc0 ls0 ws0">Gain<span class="fff">(<span class="ffd">D<span class="_ _23"></span>,<span class="_ _33"> </span>a</span>)<span class="ff1">。</span></span></div><div class="t m0 x12 h6 y3a5 ff1 fs2 fc0 sc0 ls0 ws0">实际上，<span class="_ _30"></span>在<span class="_ _d"> </span><span class="ff3">Gain<span class="fff">(<span class="ffd">D,<span class="_ _31"> </span>a</span>)<span class="_ _d"> </span></span></span>的公式中，<span class="_ _30"></span><span class="ff3">Ent<span class="fff">(<span class="ffd">D<span class="_ _23"></span></span>)<span class="_ _25"> </span><span class="ff1">对于当前结点来说是定值，<span class="_ _27"></span>且<span class="_ _25"> </span><span class="ff3">Gain<span class="fff">(<span class="ffd">D<span class="_ _23"></span>,<span class="_ _31"> </span>a</span>)<span class="_ _25"> </span></span></span>为非</span></span></span></div><div class="t m0 x12 h6 y3a6 ff1 fs2 fc0 sc0 ls0 ws0">负数，所以选择最优属性只需要选择</div><div class="t m0 x80 hc y3a7 ff11 fs2 fc0 sc0 ls0 ws0">P</div><div class="t m0 x96 hb y3a8 ffc fs7 fc0 sc0 ls0 ws0">V</div><div class="t m0 x96 ha y3a9 ffc fs7 fc0 sc0 ls0 ws0">v<span class="_ _23"></span><span class="ff12">=1</span></div><div class="t m0 x6f ha y3aa ffb fs7 fc0 sc0 ls0 ws0">|<span class="ffc">D</span></div><div class="t m0 xc9 h10 y3ab ff13 fs9 fc0 sc0 ls0 ws0">v</div><div class="t m0 x126 ha y3aa ffb fs7 fc0 sc0 ls0 ws0">|</div><div class="t m0 x98 ha y3ac ffb fs7 fc0 sc0 ls0 ws0">|<span class="ffc">D</span>|</div><div class="t m0 xf5 h4 y3a6 ff3 fs2 fc0 sc0 ls0 ws0">Ent<span class="_ _31"> </span><span class="fff">(<span class="ffd">D</span></span></div><div class="t m0 x61 hb y3ad ffc fs7 fc0 sc0 ls0 ws0">v</div><div class="t m0 x9f h6 y3a6 fff fs2 fc0 sc0 ls0 ws0">)<span class="_ _d"> </span><span class="ff1">值最小的属性即可。</span></div><div class="t m0 x12 h6 y3ae ff1 fs2 fc0 sc0 ls0 ws0">大多数资料直接说选择<span class="_ _d"> </span><span class="ff3">Gain<span class="fff">(<span class="ffd">D<span class="_ _23"></span>,<span class="_ _33"> </span>a</span>)<span class="_ _d"> </span></span></span>值最大的属性作为划分属性，这可能有以下三点原因：</div><div class="t m0 x13 h6 y3af ff3 fs2 fc0 sc0 ls0 ws0">1.<span class="_ _5"> </span><span class="ff1">为了统一各个<span class="_ _d"> </span></span>impurit<span class="_ _12"></span>y<span class="_ _d"> </span>measure<span class="_ _d"> </span><span class="ff1">分裂优度公式的形式。</span></div><div class="t m0 x13 h6 y3b0 ff3 fs2 fc0 sc0 ls0 ws0">2.<span class="_ _5"> </span><span class="ff1">为了从<span class="_ _d"> </span></span>Gain<span class="_ _d"> </span><span class="ff1">引出<span class="_ _d"> </span></span>Gain<span class="_ _25"> </span>ratio<span class="_ _e"> </span><span class="ff1">的定义。</span></div><div class="t m0 x13 h6 y3b1 ff3 fs2 fc0 sc0 ls0 ws0">3.<span class="_ _5"> </span><span class="ff1">预剪枝策略需要用到<span class="_ _d"> </span></span>Gain<span class="_ _d"> </span><span class="ff1">值。</span></div><div class="t m0 x3 h6 y3b2 ff3 fs2 fc0 sc0 ls0 ws0">ID3<span class="_ _e"> </span><span class="ff1">决策树学习<span class="_ _23"></span>算法<span class="_ _d"> </span></span>[Quinlan,<span class="_ _e"> </span>1986]<span class="_ _e"> </span><span class="ff1">就是以<span class="_ _23"></span>信息增益为准则来<span class="_ _23"></span>选择划分属性，<span class="_ _23"></span>但信息增益准则</span></div><div class="t m0 x3 h6 y3b3 ff1 fs2 fc0 sc0 ls0 ws0">有一个缺点—<span class="_ _28"></span>—偏好可取值数目较多的属性。</div><div class="t m0 x3 h6 y3b4 ff1 fs2 fc0 sc0 ls0 ws0">注意到，<span class="_ _23"></span>信息熵的计<span class="_ _23"></span>算公式<span class="ff3">5.1</span>中需要<span class="_ _23"></span>计算各类样<span class="_ _23"></span>本的概率，这<span class="_ _23"></span>个概率是用<span class="_ _23"></span>频率去估计<span class="_ _23"></span>的。根据</div><div class="t m0 x3 h6 y3b5 ff1 fs2 fc0 sc0 ls0 ws0">大数定律，<span class="_ _29"></span>只有当样本数足够多的时候，<span class="_ _3a"></span>频率才可以足够精确地近似概率。<span class="_ _30"></span>假设选择可取值数目</div><div class="t m0 x3 h6 y3b6 ff1 fs2 fc0 sc0 ls0 ws0">为<span class="_ _d"> </span><span class="ffd">k<span class="_ _1e"> </span></span>的属性<span class="_ _23"></span>进行划分，即需要为<span class="_ _e"> </span><span class="ffd">k<span class="_ _1e"> </span></span>个子结点估计<span class="_ _23"></span>类别分布，<span class="ffd">k<span class="_ _e"> </span></span>越<span class="_ _23"></span>大，需要估计的次数越<span class="_ _23"></span>多，而</div><div class="t m0 x3 h6 y3b7 ff1 fs2 fc0 sc0 ls0 ws0">每个子结点的样本数又越小，<span class="_ _29"></span>频率的方差越大。<span class="_ _29"></span>方差越大，<span class="_ _29"></span>即说明将类别的概率分布估计得比真</div><div class="t m0 x3 h6 y3b8 ff1 fs2 fc0 sc0 ls0 ws0">实分布更为集中的概率越大。类别分布更集中导致子结点的熵越小，即信息增益越大。</div><div class="t m0 x3 hd y3b9 ff5 fs8 fc0 sc0 ls0 ws0">5.3.2<span class="_ _36"> </span><span class="ff9">信息增益比</span></div><div class="t m0 x3 h6 y18d ff1 fs2 fc0 sc0 ls0 ws0">因为信息增益准则对<span class="ff4">可取值数目较多的属性</span>有所偏好，<span class="_ _2e"></span>为减少这种偏好可能带来的不利影响，<span class="_ _2a"></span>著</div><div class="t m0 x3 h6 y18e ff1 fs2 fc0 sc0 ls0 ws0">名的<span class="_ _37"> </span><span class="ff3">C4.5<span class="_ _37"> </span></span>决策树算法<span class="_ _37"> </span><span class="ff3">[Quinlan,1993]<span class="_ _a"> </span></span>不直接使用信息增益，<span class="_ _3c"></span>而是使用<span class="_ _2c"></span>“信息增益比”<span class="_ _52"></span>（<span class="ff3">information</span></div><div class="t m0 x3 h6 y20 ff3 fs2 fc0 sc0 ls0 ws0">gain<span class="_ _d"> </span>ratio<span class="ff1">）来选择最优划分属性。</span></div><div class="t m0 x3 h4 y3 ff3 fs2 fc0 sc0 ls0 ws0">28</div><a class="l" href="#pf22" data-dest-detail='[34,"XYZ",70.87,503.24,null]'><div class="d m1" style="border-style:none;position:absolute;left:188.163000px;bottom:652.048500px;width:13.942000px;height:15.459000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf21" data-dest-detail='[33,"XYZ",70.87,77.68,null]'><div class="d m1" style="border-style:none;position:absolute;left:304.050000px;bottom:292.567500px;width:13.942000px;height:15.458000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.500000,0.000000,0.000000,1.500000,0.000000,0.000000]}'></div></div>
<div id="pf23" class="pf w0 h0" data-page-no="23"><div class="pc pc23 w0 h0"><img class="bi x3 y3ba wc h2e" alt="" src="bg23.png"/><div class="t m0 x110 h7 y21 ff3 fs5 fc0 sc0 ls0 ws0">5.4<span class="_ _8"> </span><span class="ff7">连续值处理</span></div><div class="t m0 x3 h6 y22 ff4 fs2 fc0 sc0 ls0 ws0">定义<span class="ff6">5.6<span class="_ _5"> </span></span><span class="fc1">增益率：</span></div><div class="t m0 xd8 h4 y3bb ff3 fs2 fc0 sc0 ls0 ws0">Gain</div><div class="t m0 x111 ha y3bc ffb fs7 fc0 sc0 ls0 ws0">−</div><div class="t m0 x28 h4 y3bb ff3 fs2 fc0 sc0 ls0 ws0">ratio<span class="fff">(<span class="ffd">D<span class="_ _23"></span>,<span class="_ _33"> </span>a</span>)<span class="_ _32"> </span>=</span></div><div class="t m0 xd2 h4 y3bd ff3 fs2 fc0 sc0 ls0 ws0">Gain<span class="fff">(<span class="ffd">D<span class="_ _23"></span>,<span class="_ _33"> </span>a</span>)</span></div><div class="t m0 x66 h4 y3be ff3 fs2 fc0 sc0 ls0 ws0">IV<span class="fff">(<span class="ffd">a</span>)</span></div><div class="t m0 xaf h4 y3bb ff3 fs2 fc0 sc0 ls0 ws0">(5.3)</div><div class="t m0 x3 h6 y3bf ff1 fs2 fc0 sc0 ls0 ws0">其中</div><div class="t m0 x41 h4 y3c0 ff3 fs2 fc0 sc0 ls0 ws0">IV<span class="fff">(<span class="ffd">a</span>)<span class="_ _32"> </span>=<span class="_ _32"> </span><span class="ffe">−</span></span></div><div class="t m0 xd9 hb y3c1 ffc fs7 fc0 sc0 ls0 ws0">V</div><div class="t m0 xc2 hc y3c2 ff11 fs2 fc0 sc0 ls0 ws0">X</div><div class="t m0 x74 ha y3c3 ffc fs7 fc0 sc0 ls0 ws0">v<span class="_ _23"></span><span class="ff12">=1</span></div><div class="t m0 x101 h4 y3c4 ffe fs2 fc0 sc0 ls0 ws0">|</div><div class="t m0 x2b he y3c5 ffd fs2 fc0 sc0 ls0 ws0">D</div><div class="t m0 xd4 hb y3c6 ffc fs7 fc0 sc0 ls0 ws0">v</div><div class="t m0 x2a h4 y3c4 ffe fs2 fc0 sc0 ls0 ws0">|</div><div class="t m0 x2b h4 y3c7 ffe fs2 fc0 sc0 ls0 ws0">|<span class="ffd">D<span class="_ _23"></span></span>|</div><div class="t m0 x71 h4 y3c0 ff3 fs2 fc0 sc0 ls0 ws0">log</div><div class="t m0 x103 ha y3c8 ff12 fs7 fc0 sc0 ls0 ws0">2</div><div class="t m0 x1f h4 y3c4 ffe fs2 fc0 sc0 ls0 ws0">|</div><div class="t m0 x26 he y3c5 ffd fs2 fc0 sc0 ls0 ws0">D</div><div class="t m0 x127 hb y3c6 ffc fs7 fc0 sc0 ls0 ws0">v</div><div class="t m0 xc5 h4 y3c4 ffe fs2 fc0 sc0 ls0 ws0">|</div><div class="t m0 x26 h4 y3c7 ffe fs2 fc0 sc0 ls0 ws0">|<span class="ffd">D<span class="_ _23"></span></span>|</div><div class="t m0 xaf h4 y3c0 ff3 fs2 fc0 sc0 ls0 ws0">(5.4)</div><div class="t m0 x3 h6 y3c9 ff3 fs2 fc0 sc0 ls0 ws0">IV<span class="_ _d"> </span><span class="ff1">称为属性<span class="_ _d"> </span></span>a<span class="_ _d"> </span><span class="ff1">的“固有值”</span>(in<span class="_ _12"></span>trinsic<span class="_ _d"> </span>v<span class="_ _28"></span>alue)<span class="_ _d"> </span>[Quinlan,<span class="_ _d"> </span>1993]<span class="ff1">。</span></div><div class="t m0 x3 h6 y3ca ff1 fs2 fc0 sc0 ls0 ws0">增益率实际上是将子分支结点的加权信息熵作为子分支结点的惩罚项<span class="_ _d"> </span><span class="ff3">IV</span>。<span class="_ _12"></span>属性<span class="_ _d"> </span><span class="ff3">a<span class="_ _25"> </span></span>的可能取值数</div><div class="t m0 x3 h6 y3cb ff1 fs2 fc0 sc0 ls0 ws0">目越多<span class="_ _d"> </span><span class="ff3">(</span>即子分支的数量<span class="_ _d"> </span><span class="ff3">V<span class="_ _d"> </span></span>越大<span class="ff3">)</span>，则<span class="_ _d"> </span><span class="ff3">IV(a)<span class="_ _d"> </span></span>的值通常会越大。</div><div class="t m0 x3 h6 y3cc ff1 fs2 fc0 sc0 ls0 ws0">显然，<span class="_ _12"></span>增益率准则对<span class="ff4">可取值数目较少的属性</span>有所偏好，因此，<span class="_ _28"></span><span class="ff3">C4.5<span class="_ _d"> </span><span class="ff1">算法<span class="_ _d"> </span></span>[Quinlan,<span class="_ _d"> </span>1993]<span class="_ _d"> </span><span class="ff1">并不是</span></span></div><div class="t m0 x3 h6 y3cd ff1 fs2 fc0 sc0 ls0 ws0">直接选择增益率最大的候选划分属性，<span class="_ _2e"></span>而是使用了一个启发式：<span class="_ _2a"></span>先从候选划分属性中找出信息增</div><div class="t m0 x3 h6 y3ce ff1 fs2 fc0 sc0 ls0 ws0">益高于平均水平的属性，再从中选择增益率最高的。</div><div class="t m0 x3 hd y3cf ff5 fs8 fc0 sc0 ls0 ws0">5.3.3<span class="_ _36"> </span><span class="ff9">基尼指数</span></div><div class="t m0 x3 h6 y3d0 ff1 fs2 fc0 sc0 ls0 ws0">与<span class="_ _d"> </span><span class="ff3">ID3</span>、<span class="ff3">C4.5<span class="_ _d"> </span></span>不同，<span class="ff3">CAR<span class="_ _27"></span>T<span class="_ _d"> </span><span class="ff1">决策树<span class="_ _d"> </span></span>[Breiman<span class="_ _d"> </span>et<span class="_ _d"> </span>al.,<span class="_ _d"> </span>1984]<span class="_ _d"> </span><span class="ff1">不使用基于信息熵的量作为选择划分</span></span></div><div class="t m0 x3 h6 y3d1 ff1 fs2 fc0 sc0 ls0 ws0">属性的准则，而是使用“基尼指数”<span class="ff3">(Gini<span class="_ _d"> </span>index)</span>。</div><div class="t m0 x3 h6 y3d2 ff4 fs2 fc0 sc0 ls0 ws0">定义<span class="ff6">5.7<span class="_ _5"> </span></span><span class="fc1">基尼指数：</span></div><div class="t m0 x6e h4 y3d3 ff3 fs2 fc0 sc0 ls0 ws0">Gini<span class="fff">(<span class="ffd">D<span class="_ _23"></span></span>)<span class="_ _a"> </span>=</span></div><div class="t m0 x98 ha y3d4 ffb fs7 fc0 sc0 ls0 ws0">|Y<span class="_ _23"></span>|</div><div class="t m0 x6f hc y3d5 ff11 fs2 fc0 sc0 ls0 ws0">X</div><div class="t m0 x6f ha y3d6 ffc fs7 fc0 sc0 ls0 ws0">k<span class="ff12">=1</span></div><div class="t m0 xd4 hc y3d5 ff11 fs2 fc0 sc0 ls0 ws0">X</div><div class="t m0 x128 hb y3d7 ffc fs7 fc0 sc0 ls0 ws0">k</div><div class="t m0 xcf h1f y3d8 ff17 fs9 fc0 sc0 ls0 ws0">′</div><div class="t m0 x9e ha y3d7 ffb fs7 fc0 sc0 ls0 ws0"≯<span class="ff12">=<span class="ffc">k</span></span></div><div class="t m0 x78 he y3d3 ffd fs2 fc0 sc0 ls0 ws0">p</div><div class="t m0 x103 hb y3d9 ffc fs7 fc0 sc0 ls0 ws0">k</div><div class="t m0 xc8 he y3d3 ffd fs2 fc0 sc0 ls0 ws0">p</div><div class="t m0 x26 hb y3da ffc fs7 fc0 sc0 ls0 ws0">k</div><div class="t m0 xea h1f y3db ff17 fs9 fc0 sc0 ls0 ws0">′</div><div class="t m0 x122 h4 y3dc fff fs2 fc0 sc0 ls0 ws0">=<span class="_ _32"> </span>1<span class="_ _37"> </span><span class="ffe">−</span></div><div class="t m0 x45 ha y3dd ffb fs7 fc0 sc0 ls0 ws0">|Y<span class="_ _23"></span>|</div><div class="t m0 xd4 hc y3de ff11 fs2 fc0 sc0 ls0 ws0">X</div><div class="t m0 xd4 ha y3df ffc fs7 fc0 sc0 ls0 ws0">k<span class="ff12">=1</span></div><div class="t m0 x99 he y3dc ffd fs2 fc0 sc0 ls0 ws0">p</div><div class="t m0 x44 ha y3e0 ff12 fs7 fc0 sc0 ls0 ws0">2</div><div class="t m0 x44 hb y3e1 ffc fs7 fc0 sc0 ls0 ws0">k</div><div class="t m0 xaf h4 y3e2 ff3 fs2 fc0 sc0 ls0 ws0">(5.5)</div><div class="t m0 x3 h6 y3e3 ff3 fs2 fc0 sc0 ls0 ws0">Gini(D)<span class="_ _e"> </span><span class="ff1">反映了<span class="_ _23"></span>从数据集<span class="_ _e"> </span></span>D<span class="_ _1e"> </span><span class="ff1">中随机抽<span class="_ _23"></span>取两个样本，<span class="_ _23"></span>其类别标记<span class="_ _23"></span>不一致的<span class="_ _23"></span>概率。因此，基尼<span class="_ _23"></span>指数</span></div><div class="t m0 x3 h6 y3e4 ff1 fs2 fc0 sc0 ls0 ws0">也是符合我们对描述“纯度”的量的要求的，<span class="ff3">Gini(D)<span class="_ _d"> </span></span>越小，则数据集<span class="_ _d"> </span><span class="ff3">D<span class="_ _d"> </span></span>的纯度越高。</div><div class="t m0 x3 h6 y3e5 ff1 fs2 fc0 sc0 ls0 ws0">属性<span class="_ _d"> </span><span class="ffd">a<span class="_ _d"> </span></span>的基尼指数定义为</div><div class="t m0 x129 h4 y3e6 ff3 fs2 fc0 sc0 ls0 ws0">Gini<span class="_ _d"> </span>index<span class="_ _d"> </span><span class="fff">(<span class="ffd">D<span class="_ _23"></span>,<span class="_ _33"> </span>a</span>)<span class="_ _32"> </span>=</span></div><div class="t m0 x5f hb y3e7 ffc fs7 fc0 sc0 ls0 ws0">V</div><div class="t m0 xc9 hc y3e8 ff11 fs2 fc0 sc0 ls0 ws0">X</div><div class="t m0 x12a ha y3e9 ffc fs7 fc0 sc0 ls0 ws0">v<span class="_ _23"></span><span class="ff12">=1</span></div><div class="t m0 x71 h4 y3ea ffe fs2 fc0 sc0 ls0 ws0">|<span class="ffd">D</span></div><div class="t m0 x44 hb y3eb ffc fs7 fc0 sc0 ls0 ws0">v</div><div class="t m0 x25 h4 y3ea ffe fs2 fc0 sc0 ls0 ws0">|</div><div class="t m0 x77 h4 y3ec ffe fs2 fc0 sc0 ls0 ws0">|<span class="ffd">D<span class="_ _23"></span></span>|</div><div class="t m0 x61 h4 y3e6 ff3 fs2 fc0 sc0 ls0 ws0">Gini<span class="_ _31"> </span><span class="fff">(<span class="ffd">D</span></span></div><div class="t m0 xec hb y3ed ffc fs7 fc0 sc0 ls0 ws0">v</div><div class="t m0 x12b h4 y3e6 fff fs2 fc0 sc0 ls0 ws0">)</div><div class="t m0 x3 h6 y3ee ff1 fs2 fc0 sc0 ls0 ws0">于是<span class="ff3">,<span class="_ _e"> </span></span>我们在候<span class="_ _23"></span>选属性集合<span class="_ _e"> </span><span class="ff3">A<span class="_ _d"> </span></span>中，<span class="_ _23"></span>选择那个使得划分<span class="_ _23"></span>后基尼指数最小<span class="_ _23"></span>的属性作为最优划<span class="_ _23"></span>分属性，</div><div class="t m0 x3 h6 y3ef ff1 fs2 fc0 sc0 ls0 ws0">即<span class="_ _d"> </span><span class="ffd">a</span></div><div class="t m0 xe1 ha y3f0 ffb fs7 fc0 sc0 ls0 ws0">∗</div><div class="t m0 x13 h4 y3ef fff fs2 fc0 sc0 ls0 ws0">=<span class="_ _32"> </span><span class="ff3">arg<span class="_ _31"> </span>min</span></div><div class="t m0 x12c ha y3f1 ffc fs7 fc0 sc0 ls0 ws0">a<span class="ffb">∈</span>A</div><div class="t m0 xb h6 y3ef ff3 fs2 fc0 sc0 ls0 ws0">Gini<span class="_ _d"> </span>index<span class="fff">(<span class="ffd">D<span class="_ _23"></span>,<span class="_ _33"> </span>a</span>)<span class="ff1">。</span></span></div><div class="t m0 x12d h9 y3f2 ff5 fs6 fc0 sc0 ls0 ws0">5.4<span class="_ _24"> </span><span class="ff9">连续值处理</span></div><div class="t m0 x3 h6 y3f3 ff1 fs2 fc0 sc0 ls0 ws0">到目<span class="_ _23"></span>前为止<span class="_ _23"></span>我们仅<span class="_ _23"></span>讨论<span class="_ _23"></span>了基于<span class="_ _23"></span>离散属<span class="_ _23"></span>性来生<span class="_ _23"></span>成决策<span class="_ _23"></span>树。如<span class="_ _23"></span>果决策<span class="_ _23"></span>树遇到<span class="_ _23"></span>连续特<span class="_ _23"></span>征，应<span class="_ _23"></span>该怎么<span class="_ _23"></span>处</div><div class="t m0 x3 h6 y3f4 ff1 fs2 fc0 sc0 ls0 ws0">理呢？<span class="_ _30"></span>一般来说，<span class="_ _29"></span>我们喜欢将复杂的问题转换为简单的问题，<span class="_ _3a"></span>这样就可以将处理简单问题的方法</div><div class="t m0 x3 h6 y3f5 ff1 fs2 fc0 sc0 ls0 ws0">应用到复杂问题上。</div><div class="t m0 x3 h6 y3f6 ff1 fs2 fc0 sc0 ls0 ws0">即使连<span class="_ _23"></span>续属性的可取<span class="_ _23"></span>值数目是无<span class="_ _23"></span>穷的，但我们希<span class="_ _23"></span>望通过<span class="ff4">连续<span class="_ _23"></span>属性离散化<span class="_ _23"></span></span>的技术，基于现<span class="_ _23"></span>有样本，</div><div class="t m0 x3 h6 y3f7 ff1 fs2 fc0 sc0 ls0 ws0">将连续属性的无穷取值离散化为有限个取值。</div><div class="t m0 x3 h6 y3f8 ff1 fs2 fc0 sc0 ls0 ws0">最简<span class="_ _23"></span>单的策略<span class="_ _23"></span>是采用<span class="_ _23"></span><span class="ff4">二分法<span class="_ _3f"> </span><span class="ff6">(bi-partition)<span class="_ _e"> </span></span></span>对<span class="_ _23"></span>连续属性<span class="_ _23"></span>进行处<span class="_ _23"></span>理，这正<span class="_ _23"></span>是<span class="_ _e"> </span><span class="ff3">C4.5<span class="_ _e"> </span></span>决<span class="_ _23"></span>策树算<span class="_ _23"></span>法中</div><div class="t m0 x3 h6 y359 ff1 fs2 fc0 sc0 ls0 ws0">采用的机制<span class="_ _d"> </span><span class="ff3">[Quinlan,<span class="_ _d"> </span>1993]</span>。</div><div class="t m0 x3 h6 y3f9 ff1 fs2 fc0 sc0 ls0 ws0">给定样本集<span class="_ _25"> </span><span class="ffd">D<span class="_ _d"> </span></span>和连续属性<span class="_ _25"> </span><span class="ffd">a,<span class="_ _25"> </span></span>假定<span class="_ _25"> </span><span class="ffd">a<span class="_ _25"> </span></span>在<span class="_ _d"> </span><span class="ffd">D<span class="_ _d"> </span></span>上出现了<span class="_ _25"> </span><span class="ffd">n<span class="_ _25"> </span></span>个不同的取值，<span class="_ _29"></span>将这些值从小到大进行排</div><div class="t m0 x3 h6 y3fa ff1 fs2 fc0 sc0 ls0 ws0">序，记为</div><div class="t m0 x108 hc y3fb ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x12e he y3fa ffd fs2 fc0 sc0 ls0 ws0">a</div><div class="t m0 xf1 ha y3fc ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 x7f he y3fa ffd fs2 fc0 sc0 ls0 ws0">,<span class="_ _31"> </span>a</div><div class="t m0 xe5 ha y3fc ff12 fs7 fc0 sc0 ls0 ws0">2</div><div class="t m0 x92 he y3fa ffd fs2 fc0 sc0 ls0 ws0">,<span class="_ _31"> </span>.<span class="_ _31"> </span>.<span class="_ _31"> </span>.<span class="_ _31"> </span>,<span class="_ _31"> </span>a</div><div class="t m0 x12f hb y3fc ffc fs7 fc0 sc0 ls0 ws0">n</div><div class="t m0 xe6 hc y3fb ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x6c h6 y3fa ff1 fs2 fc0 sc0 ls0 ws0">。基于划分点<span class="_ _d"> </span><span class="ffd">t<span class="_ _d"> </span></span>可将<span class="_ _e"> </span><span class="ffd">D<span class="_ _e"> </span></span>分为子集<span class="_ _d"> </span><span class="ffd">D</span></div><div class="t m0 xcb ha y3fd ffb fs7 fc0 sc0 ls0 ws0">−</div><div class="t m0 xcb hb y3fe ffc fs7 fc0 sc0 ls0 ws0">t</div><div class="t m0 x64 h6 y3fa ff1 fs2 fc0 sc0 ls0 ws0">和<span class="_ _d"> </span><span class="ffd">D</span></div><div class="t m0 x130 ha y3fd ff12 fs7 fc0 sc0 ls0 ws0">+</div><div class="t m0 x130 hb y3fe ffc fs7 fc0 sc0 ls0 ws0">t</div><div class="t m0 x6b h6 y3fa ffd fs2 fc0 sc0 ls0 ws0">,<span class="_ _d"> </span><span class="ff1">其中<span class="_ _d"> </span></span>D</div><div class="t m0 x131 ha y3fd ffb fs7 fc0 sc0 ls0 ws0">−</div><div class="t m0 x131 hb y3fe ffc fs7 fc0 sc0 ls0 ws0">t</div><div class="t m0 xbb h6 y3fa ff1 fs2 fc0 sc0 ls0 ws0">包含那些在属</div><div class="t m0 x3 h6 y18d ff1 fs2 fc0 sc0 ls0 ws0">性<span class="_ _d"> </span><span class="ffd">a<span class="_ _e"> </span></span>上取值不<span class="_ _23"></span>大于<span class="_ _d"> </span><span class="ffd">t<span class="_ _e"> </span></span>的样本<span class="ff3">,<span class="_ _e"> </span></span>而<span class="_ _d"> </span><span class="ffd">D</span></div><div class="t m0 x9b ha y3ff ff12 fs7 fc0 sc0 ls0 ws0">+</div><div class="t m0 x10 hb y400 ffc fs7 fc0 sc0 ls0 ws0">t</div><div class="t m0 xf3 h6 y18d ff1 fs2 fc0 sc0 ls0 ws0">则包含那些<span class="_ _23"></span>在属性<span class="_ _d"> </span><span class="ffd">a<span class="_ _e"> </span></span>上取值大于<span class="_ _e"> </span><span class="ffd">t<span class="_ _e"> </span></span>的样本。显然，对<span class="_ _23"></span>相邻</div><div class="t m0 x3 h6 y18e ff1 fs2 fc0 sc0 ls0 ws0">的属性取值<span class="_ _e"> </span><span class="ffd">a</span></div><div class="t m0 x7f hb y401 ffc fs7 fc0 sc0 ls0 ws0">i</div><div class="t m0 x2c h6 y18e ff1 fs2 fc0 sc0 ls0 ws0">与<span class="_ _d"> </span><span class="ffd">a</span></div><div class="t m0 x3d ha y401 ffc fs7 fc0 sc0 ls0 ws0">i<span class="ff12">+1</span></div><div class="t m0 x12f h6 y18e ff1 fs2 fc0 sc0 ls0 ws0">来说，<span class="ffd">t<span class="_ _d"> </span></span>在<span class="_ _23"></span>区间</div><div class="t m0 x94 hc y402 ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x80 he y18e ffd fs2 fc0 sc0 ls0 ws0">a</div><div class="t m0 x33 hb y401 ffc fs7 fc0 sc0 ls0 ws0">i</div><div class="t m0 x24 he y18e ffd fs2 fc0 sc0 ls0 ws0">,<span class="_ _31"> </span>a</div><div class="t m0 x122 ha y401 ffc fs7 fc0 sc0 ls0 ws0">i<span class="ff12">+1</span></div><div class="t m0 x98 hc y402 ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x76 h6 y18e ff1 fs2 fc0 sc0 ls0 ws0">中取任意值所<span class="_ _23"></span>产生的划分结果相同。因<span class="_ _23"></span>此，对</div><div class="t m0 x3 h6 y20 ff1 fs2 fc0 sc0 ls0 ws0">连续属性<span class="_ _d"> </span><span class="ff3">a</span>，我们可考察包含<span class="_ _d"> </span><span class="ffd">n<span class="_ _37"> </span><span class="ffe">−<span class="_ _37"> </span><span class="fff">1<span class="_ _d"> </span></span></span></span>个元素的候选划分点集合</div><div class="t m0 xbc h4 y3 ff3 fs2 fc0 sc0 ls0 ws0">29</div></div><div class="pi" data-data='{"ctm":[1.500000,0.000000,0.000000,1.500000,0.000000,0.000000]}'></div></div>
<div id="pf24" class="pf w0 h0" data-page-no="24"><div class="pc pc24 w0 h0"><img class="bi x31 y403 wd h2f" alt="" src="bg24.png"/><div class="t m0 x3 h7 y21 ff3 fs5 fc0 sc0 ls0 ws0">5.5<span class="_ _8"> </span><span class="ff7">缺失值处理</span></div><div class="t m0 x9 he y404 ffd fs2 fc0 sc0 ls0 ws0">T</div><div class="t m0 xc1 hb y405 ffc fs7 fc0 sc0 ls0 ws0">a</div><div class="t m0 x5a h4 y404 fff fs2 fc0 sc0 ls0 ws0">=</div><div class="t m0 x72 hc y406 ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x28 he y407 ffd fs2 fc0 sc0 ls0 ws0">a</div><div class="t m0 x16 hb y408 ffc fs7 fc0 sc0 ls0 ws0">i</div><div class="t m0 x5b h4 y407 fff fs2 fc0 sc0 ls0 ws0">+<span class="_ _37"> </span><span class="ffd">a</span></div><div class="t m0 x74 ha y408 ffc fs7 fc0 sc0 ls0 ws0">i<span class="ff12">+1</span></div><div class="t m0 x24 h4 y409 fff fs2 fc0 sc0 ls0 ws0">2</div><div class="t m0 x70 h4 y404 ffe fs2 fc0 sc0 ls0 ws0">|<span class="_ _32"> </span><span class="fff">1<span class="_ _32"> </span><span class="ff1e">⩽<span class="_ _32"> </span><span class="ffd">i<span class="_ _32"> </span></span>⩽<span class="_ _32"> </span><span class="ffd">n<span class="_ _37"> </span></span></span></span>−<span class="_ _37"> </span><span class="fff">1</span></div><div class="t m0 x7b hc y406 ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x3 h6 y40a ff1 fs2 fc0 sc0 ls0 ws0">即把区间</div><div class="t m0 x108 hc y40b ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x10a he y40a ffd fs2 fc0 sc0 ls0 ws0">a</div><div class="t m0 x132 hb y40c ffc fs7 fc0 sc0 ls0 ws0">i</div><div class="t m0 xb3 he y40a ffd fs2 fc0 sc0 ls0 ws0">,<span class="_ _31"> </span>a</div><div class="t m0 x2c ha y40c ffc fs7 fc0 sc0 ls0 ws0">i<span class="ff12">+1</span></div><div class="t m0 xf2 hc y40b ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 xfe h6 y40a ff1 fs2 fc0 sc0 ls0 ws0">的中位点</div><div class="t m0 x31 hb y40d ffc fs7 fc0 sc0 ls0 ws0">a</div><div class="t m0 x133 h10 y40e ff13 fs9 fc0 sc0 ls0 ws0">i</div><div class="t m0 xd8 ha y40d ff12 fs7 fc0 sc0 ls0 ws0">+<span class="ffc">a</span></div><div class="t m0 x4e h1c y40e ff13 fs9 fc0 sc0 ls0 ws0">i<span class="ff16">+1</span></div><div class="t m0 x4d ha y40f ff12 fs7 fc0 sc0 ls0 ws0">2</div><div class="t m0 x9c h6 y40a ff1 fs2 fc0 sc0 ls0 ws0">作为候选划分<span class="_ _23"></span>点。然后，我们就可像离散属<span class="_ _23"></span>性值一样来考</div><div class="t m0 x3 h6 y410 ff1 fs2 fc0 sc0 ls0 ws0">察这些划分点，选取最优的划分点进行样本集合的划分。例如对<span class="_ _d"> </span><span class="ff3">Gain<span class="_ _d"> </span></span>的公式稍加改造<span class="ff3">:</span></div><div class="t m0 x2d h4 y411 ff3 fs2 fc0 sc0 ls0 ws0">Gain<span class="fff">(<span class="ffd">D<span class="_ _23"></span>,<span class="_ _33"> </span>a</span>)<span class="_ _32"> </span>=<span class="_ _32"> </span></span>max</div><div class="t m0 x73 ha y412 ffc fs7 fc0 sc0 ls0 ws0">t<span class="ffb">∈</span>T</div><div class="t m0 x2f h10 y413 ff13 fs9 fc0 sc0 ls0 ws0">a</div><div class="t m0 x52 h4 y411 ff3 fs2 fc0 sc0 ls0 ws0">Gain<span class="fff">(<span class="ffd">D<span class="_ _23"></span>,<span class="_ _33"> </span>a,<span class="_ _31"> </span>t</span>)</span></div><div class="t m0 x4d h4 y414 fff fs2 fc0 sc0 ls0 ws0">=<span class="_ _32"> </span><span class="ff3">max</span></div><div class="t m0 x73 ha y415 ffc fs7 fc0 sc0 ls0 ws0">t<span class="ffb">∈</span>T</div><div class="t m0 x2f h10 y416 ff13 fs9 fc0 sc0 ls0 ws0">a</div><div class="t m0 x52 h4 y414 ff3 fs2 fc0 sc0 ls0 ws0">Ent<span class="fff">(<span class="ffd">D<span class="_ _23"></span></span>)<span class="_ _38"> </span><span class="ffe">−</span></span></div><div class="t m0 xd2 hc y417 ff11 fs2 fc0 sc0 ls0 ws0">X</div><div class="t m0 x128 ha y418 ffc fs7 fc0 sc0 ls0 ws0">λ<span class="ffb">∈{−</span>,<span class="ff12">+<span class="ffb">}</span></span></div><div class="t m0 x112 hc y419 ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x112 hc y41a ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 xea he y41b ffd fs2 fc0 sc0 ls0 ws0">D</div><div class="t m0 xc5 hb y41c ffc fs7 fc0 sc0 ls0 ws0">λ</div><div class="t m0 xc5 hb y41d ffc fs7 fc0 sc0 ls0 ws0">t</div><div class="t m0 xad hc y419 ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 xad hc y41a ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 xea h4 y41e ffe fs2 fc0 sc0 ls0 ws0">|<span class="ffd">D<span class="_ _23"></span></span>|</div><div class="t m0 xe8 h4 y414 ff3 fs2 fc0 sc0 ls0 ws0">Ent</div><div class="t m0 x125 hc y41f ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x130 he y414 ffd fs2 fc0 sc0 ls0 ws0">D</div><div class="t m0 x134 hb y420 ffc fs7 fc0 sc0 ls0 ws0">λ</div><div class="t m0 x134 hb y421 ffc fs7 fc0 sc0 ls0 ws0">t</div><div class="t m0 xdf hc y41f ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x3 h6 y422 ff1 fs2 fc0 sc0 ls0 ws0">其中<span class="_ _37"> </span><span class="ff3">Gain<span class="fff">(<span class="ffd">D<span class="_ _23"></span>,<span class="_ _33"> </span>a,<span class="_ _31"> </span>t</span>)<span class="_ _37"> </span></span></span>是样本集<span class="_ _37"> </span><span class="ffd">D<span class="_ _a"> </span></span>基于划分点<span class="_ _37"> </span><span class="ffd">t<span class="_ _37"> </span></span>二分后的信息增益。<span class="_ _26"></span>于是，<span class="_ _3c"></span>我们就可选择使<span class="_ _38"> </span><span class="ff3">Gain<span class="fff">(<span class="ffd">D<span class="_ _23"></span>,<span class="_ _31"> </span>a,<span class="_ _31"> </span>t</span>)</span></span></div><div class="t m0 x3 h6 y423 ff1 fs2 fc0 sc0 ls0 ws0">最大化的划分点。</div><div class="t m0 x12d h9 y424 ff5 fs6 fc0 sc0 ls0 ws0">5.5<span class="_ _24"> </span><span class="ff9">缺失值处理</span></div><div class="t m0 x3 h6 y425 ff1 fs2 fc0 sc0 ls0 ws0">工业<span class="_ _23"></span>界的训<span class="_ _23"></span>练集往<span class="_ _23"></span>往是<span class="_ _23"></span>存在不<span class="_ _23"></span>少缺失<span class="_ _23"></span>值的，决<span class="_ _23"></span>策树算<span class="_ _23"></span>法遇<span class="_ _23"></span>到有缺<span class="_ _23"></span>失值的<span class="_ _23"></span>样本，需<span class="_ _23"></span>要解<span class="_ _23"></span>决两个<span class="_ _23"></span>问</div><div class="t m0 x3 h6 y426 ff1 fs2 fc0 sc0 ls0 ws0">题：</div><div class="t m0 x15 h6 y427 ff3 fs2 fc0 sc0 ls0 ws0">1.<span class="_ _5"> </span><span class="ff1">如何在属性值缺失的情况下进行划分属性选择？</span></div><div class="t m0 x15 h6 y428 ff3 fs2 fc0 sc0 ls0 ws0">2.<span class="_ _5"> </span><span class="ff1">给定划分属性</span>,<span class="_ _d"> </span><span class="ff1">若样本在该属性上的值缺失</span>,<span class="_ _d"> </span><span class="ff1">如何对样本进行划分</span>?</div><div class="t m0 x3 h6 y429 ff1 fs2 fc0 sc0 ls0 ws0">显然，<span class="_ _30"></span>即使训练集存在缺失值，<span class="_ _30"></span>算法也不应该偏好存在缺失值的样本。<span class="_ _27"></span>因为缺失值越多，<span class="_ _30"></span>对模型</div><div class="t m0 x3 h6 y42a ff1 fs2 fc0 sc0 ls0 ws0">性能的负面影响越大。<span class="_ _30"></span>既然这样，<span class="_ _30"></span>训练过程中就应该尽量使用不存在缺失值的样本。<span class="_ _27"></span>因此，<span class="_ _30"></span><span class="ff3">C4.5</span></div><div class="t m0 x3 h6 y42b ff1 fs2 fc0 sc0 ls0 ws0">决策树算法从整个训练集中挑选出不存在缺失值的子集，<span class="_ _2e"></span>训练时用该子集替代整个训练集，<span class="_ _2a"></span>而该</div><div class="t m0 x3 h6 y42c ff1 fs2 fc0 sc0 ls0 ws0">子集占训练集的比例大小可以作为一种优劣评判准则。</div><div class="t m0 x3 h6 y42d ff1 fs2 fc0 sc0 ls0 ws0">给定训练集<span class="_ _25"> </span><span class="ffd">D<span class="_ _e"> </span></span>和属性<span class="_ _25"> </span><span class="ffd">a,<span class="_ _d"> </span></span>令</div><div class="t m0 x4c h4 y42e fff fs2 fc0 sc0 ls0 ws0">˜</div><div class="t m0 x50 h6 y42d ffd fs2 fc0 sc0 ls0 ws0">D<span class="_ _d"> </span><span class="ff1">表示<span class="_ _d"> </span></span>D<span class="_ _d"> </span><span class="ff1">中在属性<span class="_ _d"> </span></span>a<span class="_ _25"> </span><span class="ff1">上没有缺失值的样本子集。<span class="_ _12"></span>对问题<span class="_ _25"> </span><span class="ff3">(1)</span>，<span class="_ _28"></span>显然</span></div><div class="t m0 x3 h6 y42f ff1 fs2 fc0 sc0 ls0 ws0">我们仅可根据</div><div class="t m0 x2c h4 y430 fff fs2 fc0 sc0 ls0 ws0">˜</div><div class="t m0 xcc h6 y42f ffd fs2 fc0 sc0 ls0 ws0">D<span class="_ _e"> </span><span class="ff1">来判断属性<span class="_ _25"> </span></span>a<span class="_ _d"> </span><span class="ff1">的优劣。假定属性<span class="_ _d"> </span></span>a<span class="_ _d"> </span><span class="ff1">有<span class="_ _25"> </span></span>V<span class="_ _19"> </span><span class="ff1">个可取值</span></div><div class="t m0 x135 hc y431 ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x136 he y42f ffd fs2 fc0 sc0 ls0 ws0">a</div><div class="t m0 x6b ha y432 ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 x7e he y42f ffd fs2 fc0 sc0 ls0 ws0">,<span class="_ _31"> </span>a</div><div class="t m0 x137 ha y432 ff12 fs7 fc0 sc0 ls0 ws0">2</div><div class="t m0 x121 he y42f ffd fs2 fc0 sc0 ls0 ws0">,<span class="_ _31"> </span>.<span class="_ _31"> </span>.<span class="_ _31"> </span>.<span class="_ _31"> </span>,<span class="_ _31"> </span>a</div><div class="t m0 x116 hb y432 ffc fs7 fc0 sc0 ls0 ws0">V</div><div class="t m0 x117 hc y431 ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x138 h6 y42f ff1 fs2 fc0 sc0 ls0 ws0">，令</div><div class="t m0 x139 h4 y430 fff fs2 fc0 sc0 ls0 ws0">˜</div><div class="t m0 x86 he y42f ffd fs2 fc0 sc0 ls0 ws0">D</div><div class="t m0 xc hb y432 ffc fs7 fc0 sc0 ls0 ws0">v</div><div class="t m0 xbc h6 y42f ff1 fs2 fc0 sc0 ls0 ws0">表</div><div class="t m0 x3 h6 y433 ff1 fs2 fc0 sc0 ls0 ws0">示</div><div class="t m0 x13a h4 y434 fff fs2 fc0 sc0 ls0 ws0">˜</div><div class="t m0 x12 h6 y433 ffd fs2 fc0 sc0 ls0 ws0">D<span class="_ _1e"> </span><span class="ff1">中在属性<span class="_ _e"> </span></span>a<span class="_ _e"> </span><span class="ff1">上取值为<span class="_ _e"> </span></span>a</div><div class="t m0 x30 hb y435 ffc fs7 fc0 sc0 ls0 ws0">v</div><div class="t m0 x9a h6 y433 ff1 fs2 fc0 sc0 ls0 ws0">的样本子<span class="_ _23"></span>集，</div><div class="t m0 x75 h4 y434 fff fs2 fc0 sc0 ls0 ws0">˜</div><div class="t m0 xd9 he y433 ffd fs2 fc0 sc0 ls0 ws0">D</div><div class="t m0 x6f hb y436 ffc fs7 fc0 sc0 ls0 ws0">k</div><div class="t m0 x2b h6 y433 ff1 fs2 fc0 sc0 ls0 ws0">表示</div><div class="t m0 x78 h4 y434 fff fs2 fc0 sc0 ls0 ws0">˜</div><div class="t m0 x13b h6 y433 ffd fs2 fc0 sc0 ls0 ws0">D<span class="_ _1e"> </span><span class="ff1">中属于第<span class="_ _e"> </span></span>k<span class="_ _1e"> </span><span class="ff1">类<span class="_ _e"> </span><span class="fff">(</span></span>k<span class="_ _d"> </span><span class="fff">=<span class="_ _d"> </span>1</span>,<span class="_ _31"> </span><span class="fff">2</span>,<span class="_ _31"> </span>.<span class="_ _31"> </span>.<span class="_ _31"> </span>.<span class="_ _31"> </span>,<span class="_ _31"> </span><span class="ffe">|Y<span class="_ _51"></span>|<span class="fff">)<span class="_ _e"> </span><span class="ff1">的样</span></span></span></div><div class="t m0 x3 h6 y437 ff1 fs2 fc0 sc0 ls0 ws0">本子集，则显然有</div><div class="t m0 x55 h4 y438 fff fs2 fc0 sc0 ls0 ws0">˜</div><div class="t m0 x89 h4 y437 ffd fs2 fc0 sc0 ls0 ws0">D<span class="_ _25"> </span><span class="fff">=</span></div><div class="t m0 x3e hc y439 ff11 fs2 fc0 sc0 ls0 ws0">S</div><div class="t m0 x83 ha y43a ffb fs7 fc0 sc0 ls0 ws0">|Y<span class="_ _23"></span>|</div><div class="t m0 x83 ha y43b ffc fs7 fc0 sc0 ls0 ws0">k<span class="ff12">=1</span></div><div class="t m0 x31 h4 y438 fff fs2 fc0 sc0 ls0 ws0">˜</div><div class="t m0 xe7 he y437 ffd fs2 fc0 sc0 ls0 ws0">D</div><div class="t m0 x93 hb y43c ffc fs7 fc0 sc0 ls0 ws0">k</div><div class="t m0 x2 he y437 ffd fs2 fc0 sc0 ls0 ws0">,</div><div class="t m0 x10 h4 y438 fff fs2 fc0 sc0 ls0 ws0">˜</div><div class="t m0 x4e h4 y437 ffd fs2 fc0 sc0 ls0 ws0">D<span class="_ _25"> </span><span class="fff">=</span></div><div class="t m0 x94 hc y439 ff11 fs2 fc0 sc0 ls0 ws0">S</div><div class="t m0 xc7 hb y43d ffc fs7 fc0 sc0 ls0 ws0">V</div><div class="t m0 xc7 ha y43e ffc fs7 fc0 sc0 ls0 ws0">v<span class="_ _23"></span><span class="ff12">=1</span></div><div class="t m0 x123 h4 y438 fff fs2 fc0 sc0 ls0 ws0">˜</div><div class="t m0 x100 he y437 ffd fs2 fc0 sc0 ls0 ws0">D</div><div class="t m0 x5e hb y43f ffc fs7 fc0 sc0 ls0 ws0">v</div><div class="t m0 x13c h6 y437 ff1 fs2 fc0 sc0 ls0 ws0">。假定我们为每个样本<span class="_ _d"> </span><span class="ffd">x<span class="_ _d"> </span></span>赋予一个权重<span class="_ _25"> </span><span class="ffd">w</span></div><div class="t m0 x13d hb y440 ffc fs7 fc0 sc0 ls0 ws0">x</div><div class="t m0 xed h6 y437 ff1 fs2 fc0 sc0 ls0 ws0">，并</div><div class="t m0 x3 h6 y441 ff1 fs2 fc0 sc0 ls0 ws0">定义</div><div class="t m0 x9d h4 y442 ffd fs2 fc0 sc0 ls0 ws0">ρ<span class="_ _32"> </span><span class="fff">=</span></div><div class="t m0 x97 h30 y443 ff1f fs7 fc0 sc0 ls0 ws0">∑</div><div class="t m0 x13c h31 y444 ff20 fs9 fc0 sc0 ls0 ws0">x<span class="ff17">∈</span></div><div class="t m0 x13e h1c y445 ff16 fs9 fc0 sc0 ls0 ws0">˜</div><div class="t m0 x126 h10 y444 ff13 fs9 fc0 sc0 ls0 ws0">D</div><div class="t m0 xcf hb y446 ffc fs7 fc0 sc0 ls0 ws0">w</div><div class="t m0 x13f h31 y447 ff20 fs9 fc0 sc0 ls0 ws0">x</div><div class="t m0 x97 h30 y448 ff1f fs7 fc0 sc0 ls0 ws0">∑</div><div class="t m0 x13c h31 y449 ff20 fs9 fc0 sc0 ls0 ws0">x<span class="ff17">∈<span class="ff13">D</span></span></div><div class="t m0 xcf hb y44a ffc fs7 fc0 sc0 ls0 ws0">w</div><div class="t m0 x13f h31 y44b ff20 fs9 fc0 sc0 ls0 ws0">x</div><div class="t m0 xaf h4 y442 ff3 fs2 fc0 sc0 ls0 ws0">(5.6)</div><div class="t m0 x2 h4 y44c fff fs2 fc0 sc0 ls0 ws0">˜<span class="_ _3c"></span><span class="ffd">p</span></div><div class="t m0 x11c hb y44d ffc fs7 fc0 sc0 ls0 ws0">k</div><div class="t m0 x69 h4 y44c fff fs2 fc0 sc0 ls0 ws0">=</div><div class="t m0 xd6 h30 y44e ff1f fs7 fc0 sc0 ls0 ws0">∑</div><div class="t m0 x4f h31 y44f ff20 fs9 fc0 sc0 ls0 ws0">x<span class="ff17">∈</span></div><div class="t m0 x17 h1c y450 ff16 fs9 fc0 sc0 ls0 ws0">˜</div><div class="t m0 xa9 h10 y44f ff13 fs9 fc0 sc0 ls0 ws0">D</div><div class="t m0 x1 h10 y451 ff13 fs9 fc0 sc0 ls0 ws0">k</div><div class="t m0 x34 hb y452 ffc fs7 fc0 sc0 ls0 ws0">w</div><div class="t m0 x97 h31 y453 ff20 fs9 fc0 sc0 ls0 ws0">x</div><div class="t m0 x2f h30 y454 ff1f fs7 fc0 sc0 ls0 ws0">∑</div><div class="t m0 x5b h31 y455 ff20 fs9 fc0 sc0 ls0 ws0">x<span class="ff17">∈</span></div><div class="t m0 x96 h1c y456 ff16 fs9 fc0 sc0 ls0 ws0">˜</div><div class="t m0 x17 h10 y455 ff13 fs9 fc0 sc0 ls0 ws0">D</div><div class="t m0 x74 hb y457 ffc fs7 fc0 sc0 ls0 ws0">w</div><div class="t m0 x75 h31 y458 ff20 fs9 fc0 sc0 ls0 ws0">x</div><div class="t m0 x76 h4 y44c fff fs2 fc0 sc0 ls0 ws0">(1<span class="_ _32"> </span><span class="ff1e">⩽<span class="_ _32"> </span><span class="ffd">k<span class="_ _25"> </span></span>⩽<span class="_ _32"> </span><span class="ffe">|Y<span class="_ _51"></span>|</span></span>)<span class="_ _53"> </span><span class="ff3">(5.7)</span></div><div class="t m0 x41 h4 y459 fff fs2 fc0 sc0 ls0 ws0">˜<span class="_ _3c"></span><span class="ffd">r</span></div><div class="t m0 xff hb y45a ffc fs7 fc0 sc0 ls0 ws0">v</div><div class="t m0 x22 h4 y459 fff fs2 fc0 sc0 ls0 ws0">=</div><div class="t m0 x2f h30 y45b ff1f fs7 fc0 sc0 ls0 ws0">∑</div><div class="t m0 x5b h31 y45c ff20 fs9 fc0 sc0 ls0 ws0">x<span class="ff17">∈</span></div><div class="t m0 x96 h1c y45d ff16 fs9 fc0 sc0 ls0 ws0">˜</div><div class="t m0 xf4 h10 y45c ff13 fs9 fc0 sc0 ls0 ws0">D</div><div class="t m0 x5c h10 y45e ff13 fs9 fc0 sc0 ls0 ws0">v</div><div class="t m0 x35 hb y45f ffc fs7 fc0 sc0 ls0 ws0">w</div><div class="t m0 xc3 h31 y460 ff20 fs9 fc0 sc0 ls0 ws0">x</div><div class="t m0 xe h30 y461 ff1f fs7 fc0 sc0 ls0 ws0">∑</div><div class="t m0 xc7 h31 y462 ff20 fs9 fc0 sc0 ls0 ws0">x<span class="ff17">∈</span></div><div class="t m0 x4 h1c y463 ff16 fs9 fc0 sc0 ls0 ws0">˜</div><div class="t m0 x5d h10 y462 ff13 fs9 fc0 sc0 ls0 ws0">D</div><div class="t m0 x100 hb y464 ffc fs7 fc0 sc0 ls0 ws0">w</div><div class="t m0 x97 h31 y465 ff20 fs9 fc0 sc0 ls0 ws0">x</div><div class="t m0 x5f h4 y459 fff fs2 fc0 sc0 ls0 ws0">(1<span class="_ _32"> </span><span class="ff1e">⩽<span class="_ _32"> </span><span class="ffd">v<span class="_ _25"> </span></span>⩽<span class="_ _32"> </span><span class="ffd">V<span class="_ _37"> </span></span></span>)<span class="_ _54"> </span><span class="ff3">(5.8)</span></div><div class="t m0 x3 h6 y466 ff1 fs2 fc0 sc0 ls0 ws0">直<span class="_ _23"></span>观地<span class="_ _23"></span>看，<span class="_ _23"></span>对属<span class="_ _23"></span>性<span class="_ _35"> </span><span class="ffd">a</span>，<span class="ffd">ρ<span class="_ _3f"> </span></span>表<span class="_ _23"></span>示无<span class="_ _23"></span>缺<span class="_ _23"></span>失值<span class="_ _23"></span>样<span class="_ _23"></span>本所<span class="_ _23"></span>占的<span class="_ _23"></span>比<span class="_ _23"></span>例，<span class="_ _51"></span><span class="fff">˜<span class="_ _3c"></span><span class="ffd">p</span></span></div><div class="t m0 x62 hb y467 ffc fs7 fc0 sc0 ls0 ws0">k</div><div class="t m0 x140 h6 y466 ff1 fs2 fc0 sc0 ls0 ws0">表<span class="_ _23"></span>示无<span class="_ _23"></span>缺<span class="_ _23"></span>失值<span class="_ _23"></span>样本<span class="_ _23"></span>中<span class="_ _23"></span>第<span class="_ _35"> </span><span class="ffd">k<span class="_ _0"> </span></span>类<span class="_ _23"></span>所占</div><div class="t m0 x3 h6 y468 ff1 fs2 fc0 sc0 ls0 ws0">的比<span class="_ _23"></span>例，<span class="_ _23"></span><span class="fff">˜<span class="_ _3c"></span><span class="ffd">r</span></span></div><div class="t m0 x12c hb y469 ffc fs7 fc0 sc0 ls0 ws0">v</div><div class="t m0 x132 h6 y468 ff1 fs2 fc0 sc0 ls0 ws0">则表<span class="_ _23"></span>示无缺<span class="_ _23"></span>失值样<span class="_ _23"></span>本中<span class="_ _23"></span>在属性<span class="_ _1e"> </span><span class="ffd">a<span class="_ _1e"> </span></span>上<span class="_ _23"></span>取值<span class="_ _1e"> </span><span class="ffd">a</span></div><div class="t m0 x99 hb y46a ffc fs7 fc0 sc0 ls0 ws0">v</div><div class="t m0 x25 h6 y468 ff1 fs2 fc0 sc0 ls0 ws0">的样<span class="_ _23"></span>本所占<span class="_ _23"></span>的比例。<span class="_ _23"></span>显然，</div><div class="t m0 x8f hc y46b ff11 fs2 fc0 sc0 ls0 ws0">P</div><div class="t m0 x1c ha y46c ffb fs7 fc0 sc0 ls0 ws0">|D|</div><div class="t m0 x1c ha y46d ffc fs7 fc0 sc0 ls0 ws0">k<span class="ff12">=1</span></div><div class="t m0 xaf h4 y468 fff fs2 fc0 sc0 ls0 ws0">˜<span class="_ _3c"></span><span class="ffd">p</span></div><div class="t m0 x141 hb y46e ffc fs7 fc0 sc0 ls0 ws0">k</div><div class="t m0 x142 h4 y468 fff fs2 fc0 sc0 ls0 ws0">=</div><div class="t m0 x3 h4 y46f fff fs2 fc0 sc0 ls0 ws0">1<span class="ffd">,</span></div><div class="t m0 x143 hc y470 ff11 fs2 fc0 sc0 ls0 ws0">P</div><div class="t m0 x144 hb y471 ffc fs7 fc0 sc0 ls0 ws0">V</div><div class="t m0 x144 ha y472 ffc fs7 fc0 sc0 ls0 ws0">v<span class="_ _23"></span><span class="ff12">=1</span></div><div class="t m0 xb1 h4 y46f fff fs2 fc0 sc0 ls0 ws0">˜<span class="_ _3c"></span><span class="ffd">r</span></div><div class="t m0 x145 hb y473 ffc fs7 fc0 sc0 ls0 ws0">v</div><div class="t m0 x10a h6 y46f fff fs2 fc0 sc0 ls0 ws0">=<span class="_ _32"> </span>1<span class="ff1">。</span></div><div class="t m0 x3 h6 y474 ff1 fs2 fc0 sc0 ls0 ws0">基于上述定义<span class="ff3">,<span class="_ _d"> </span></span>我们可将信息增益的计算式<span class="ff3">5.2</span>推广为</div><div class="t m0 xcd h4 y475 ff3 fs2 fc0 sc0 ls0 ws0">Gain<span class="fff">(<span class="ffd">D<span class="_ _23"></span>,<span class="_ _33"> </span>a</span>)<span class="_ _32"> </span>=<span class="_ _32"> </span><span class="ffd">ρ<span class="_ _37"> </span><span class="ffe">×<span class="_ _37"> </span></span></span></span>Gain<span class="fff">(</span></div><div class="t m0 x101 h4 y476 fff fs2 fc0 sc0 ls0 ws0">˜</div><div class="t m0 x98 h4 y475 ffd fs2 fc0 sc0 ls0 ws0">D<span class="_ _23"></span>,<span class="_ _33"> </span>a<span class="fff">)</span></div><div class="t m0 x12d h4 y477 fff fs2 fc0 sc0 ls0 ws0">=<span class="_ _32"> </span><span class="ffd">ρ<span class="_ _37"> </span><span class="ffe">×</span></span></div><div class="t m0 x33 hc y478 ff11 fs2 fc0 sc0 ls0 ws0"> </div><div class="t m0 xbd h4 y477 ff3 fs2 fc0 sc0 ls0 ws0">Ent<span class="fff">(</span></div><div class="t m0 x2b h4 y479 fff fs2 fc0 sc0 ls0 ws0">˜</div><div class="t m0 x70 h4 y477 ffd fs2 fc0 sc0 ls0 ws0">D<span class="_ _23"></span><span class="fff">)<span class="_ _38"> </span><span class="ffe">−</span></span></div><div class="t m0 x78 hb y47a ffc fs7 fc0 sc0 ls0 ws0">V</div><div class="t m0 x60 hc y47b ff11 fs2 fc0 sc0 ls0 ws0">X</div><div class="t m0 x60 ha y47c ffc fs7 fc0 sc0 ls0 ws0">v<span class="_ _23"></span><span class="ff12">=1</span></div><div class="t m0 x1f h4 y477 fff fs2 fc0 sc0 ls0 ws0">˜<span class="_ _3c"></span><span class="ffd">r</span></div><div class="t m0 x11d hb y47d ffc fs7 fc0 sc0 ls0 ws0">v</div><div class="t m0 x3a h4 y477 ff3 fs2 fc0 sc0 ls0 ws0">Ent</div><div class="t m0 x64 hc y47e ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x115 h4 y479 fff fs2 fc0 sc0 ls0 ws0">˜</div><div class="t m0 x7c he y477 ffd fs2 fc0 sc0 ls0 ws0">D</div><div class="t m0 xd0 hb y47f ffc fs7 fc0 sc0 ls0 ws0">v</div><div class="t m0 x102 hc y47e ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x146 hc y478 ff11 fs2 fc0 sc0 ls0 ws0">!</div><div class="t m0 xaf h4 y480 ff3 fs2 fc0 sc0 ls0 ws0">(5.9)</div><div class="t m0 x3 h6 y481 ff1 fs2 fc0 sc0 ls0 ws0">其中</div><div class="t m0 x9b h4 y482 ff3 fs2 fc0 sc0 ls0 ws0">Ent<span class="fff">(</span></div><div class="t m0 x4f h4 y483 fff fs2 fc0 sc0 ls0 ws0">˜</div><div class="t m0 x16 h4 y482 ffd fs2 fc0 sc0 ls0 ws0">D<span class="_ _23"></span><span class="fff">)<span class="_ _a"> </span>=<span class="_ _32"> </span><span class="ffe">−</span></span></div><div class="t m0 x70 ha y484 ffb fs7 fc0 sc0 ls0 ws0">|Y<span class="_ _23"></span>|</div><div class="t m0 x81 hc y485 ff11 fs2 fc0 sc0 ls0 ws0">X</div><div class="t m0 x81 ha y216 ffc fs7 fc0 sc0 ls0 ws0">k<span class="ff12">=1</span></div><div class="t m0 xcf h4 y482 fff fs2 fc0 sc0 ls0 ws0">˜<span class="_ _3c"></span><span class="ffd">p</span></div><div class="t m0 xd2 hb y486 ffc fs7 fc0 sc0 ls0 ws0">k</div><div class="t m0 xe0 h4 y482 ff3 fs2 fc0 sc0 ls0 ws0">log</div><div class="t m0 xc8 ha y487 ff12 fs7 fc0 sc0 ls0 ws0">2</div><div class="t m0 x112 h4 y482 fff fs2 fc0 sc0 ls0 ws0">˜<span class="_ _3c"></span><span class="ffd">p</span></div><div class="t m0 x62 hb y486 ffc fs7 fc0 sc0 ls0 ws0">k</div><div class="t m0 x3 h4 y3 ff3 fs2 fc0 sc0 ls0 ws0">30</div><a class="l" href="#pf22" data-dest-detail='[34,"XYZ",70.87,503.24,null]'><div class="d m1" style="border-style:none;position:absolute;left:410.842500px;bottom:251.913000px;width:13.942000px;height:15.458000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.500000,0.000000,0.000000,1.500000,0.000000,0.000000]}'></div></div>
<div id="pf25" class="pf w0 h0" data-page-no="25"><div class="pc pc25 w0 h0"><div class="t m0 x85 h7 y21 ff3 fs5 fc0 sc0 ls0 ws0">5.6<span class="_ _8"> </span><span class="ff7">剪枝</span></div><div class="t m0 x3 h6 y22 ff1 fs2 fc0 sc0 ls0 ws0">对问题<span class="_ _25"> </span><span class="ff3">(2)</span>，<span class="_ _27"></span>若样本<span class="_ _d"> </span><span class="ffd">x<span class="_ _25"> </span></span>在划分属性<span class="_ _25"> </span><span class="ffd">a<span class="_ _d"> </span></span>上的取值己知，<span class="_ _27"></span>则将<span class="_ _25"> </span><span class="ffd">x<span class="_ _d"> </span></span>划入与其取值对应的子结点<span class="ff3">,<span class="_ _25"> </span></span>且样本</div><div class="t m0 x3 h6 y17d ff1 fs2 fc0 sc0 ls0 ws0">权值在子<span class="_ _23"></span>结点中保持为<span class="_ _e"> </span><span class="ffd">w</span></div><div class="t m0 x6c hb y488 ffc fs7 fc0 sc0 ls0 ws0">x</div><div class="t m0 x3f h6 y17d ff1 fs2 fc0 sc0 ls0 ws0">。若样本<span class="_ _e"> </span><span class="ffd">x<span class="_ _e"> </span></span>在<span class="_ _23"></span>划分属性<span class="_ _e"> </span><span class="ffd">a<span class="_ _e"> </span></span>上的取值<span class="_ _23"></span>未知，则将<span class="_ _e"> </span><span class="ff3">x<span class="_ _e"> </span></span>同时划入<span class="_ _23"></span>所有子结</div><div class="t m0 x3 h6 y17e ff1 fs2 fc0 sc0 ls0 ws0">点，且样本权值在与<span class="_ _23"></span>属性值<span class="_ _d"> </span><span class="ffd">a</span></div><div class="t m0 x147 hb y489 ffc fs7 fc0 sc0 ls0 ws0">v</div><div class="t m0 x6d h6 y17e ff1 fs2 fc0 sc0 ls0 ws0">对应的子结点中调<span class="_ _23"></span>整为<span class="_ _e"> </span><span class="fff">˜<span class="_ _26"></span><span class="ffd">r</span></span></div><div class="t m0 x148 hb y48a ffc fs7 fc0 sc0 ls0 ws0">v</div><div class="t m0 x61 h4 y17e ffe fs2 fc0 sc0 ls0 ws0">·<span class="_ _37"> </span><span class="ffd">w</span></div><div class="t m0 x149 hb y48a ffc fs7 fc0 sc0 ls0 ws0">x</div><div class="t m0 xcb h6 y17e ff1 fs2 fc0 sc0 ls0 ws0">。直观地看<span class="ff3">,<span class="_ _e"> </span></span>这就是让同一个样本</div><div class="t m0 x3 h6 y48b ff1 fs2 fc0 sc0 ls0 ws0">以不同的概率划入到不同的子结点中去。</div><div class="t m0 x3 h6 y35c ff1 fs2 fc0 sc0 ls0 ws0">与<span class="_ _32"> </span><span class="ff3">C4.5 </span>决策树不同，<span class="_ _2d"></span><span class="ff3">CAR<span class="_ _28"></span>T <span class="ff1">决策树使用<span class="_ _32"> </span></span>surrogate splits<span class="_ _2e"></span><span class="ff1">（替代划分）<span class="_ _2e"></span>的方式处理缺失值。<span class="_ _2e"></span><span class="ff3">CAR<span class="_ _30"></span>T</span></span></span></div><div class="t m0 x3 h6 y48c ff1 fs2 fc0 sc0 ls0 ws0">会为最佳划分属性计算代替属性，<span class="_ _2e"></span>如果样本在最佳划分属性上缺失值，<span class="_ _2a"></span>那么将使用替代属性对样</div><div class="t m0 x3 h6 y48d ff1 fs2 fc0 sc0 ls0 ws0">本进行划分。<span class="_ _30"></span>如果样本在最佳替代属性上仍缺失值，<span class="_ _30"></span>则使用次佳替代属性，<span class="_ _30"></span>以此类推。<span class="_ _27"></span>寻找替代</div><div class="t m0 x3 h6 y48e ff1 fs2 fc0 sc0 ls0 ws0">属性的原则是使结点划分的效果与最佳划分属性相似，即划分的误差最小。</div><div class="t m0 x3 h6 y48f ff1 fs2 fc0 sc0 ls0 ws0">另一方面，我们也可以使用这种方式去填充缺失值。</div><div class="t m0 x3 h6 y490 ff1 fs2 fc0 sc0 ls0 ws0">因为<span class="_ _d"> </span><span class="ff3">CAR<span class="_ _28"></span>T<span class="_ _d"> </span><span class="ff1">树每<span class="_ _23"></span>一个内部结点都要储<span class="_ _23"></span>存多个划分属性，所以<span class="_ _e"> </span></span>CAR<span class="_ _27"></span>T<span class="_ _e"> </span><span class="ff1">算法的空间复<span class="_ _23"></span>杂度比<span class="_ _d"> </span></span>C4.5</span></div><div class="t m0 x3 h6 y491 ff1 fs2 fc0 sc0 ls0 ws0">大很多。</div><div class="t m0 x52 h9 y492 ff5 fs6 fc0 sc0 ls0 ws0">5.6<span class="_ _24"> </span><span class="ff9">剪枝</span></div><div class="t m0 x3 h6 y493 ff1 fs2 fc0 sc0 ls0 ws0">当一<span class="_ _23"></span>个决策<span class="_ _23"></span>树已经<span class="_ _23"></span>可以<span class="_ _23"></span>把训练<span class="_ _23"></span>样本分<span class="_ _23"></span>类得最<span class="_ _23"></span>准确时，<span class="_ _23"></span>这往<span class="_ _23"></span>往意味<span class="_ _23"></span>着决策<span class="_ _23"></span>树生成<span class="_ _23"></span>的分<span class="_ _23"></span>支过多。<span class="_ _23"></span>如</div><div class="t m0 x3 h6 y494 ff1 fs2 fc0 sc0 ls0 ws0">果预<span class="_ _23"></span>测数据<span class="_ _23"></span>的分布<span class="_ _23"></span>和训<span class="_ _23"></span>练的分<span class="_ _23"></span>布稍微<span class="_ _23"></span>有点不<span class="_ _23"></span>一致，则<span class="_ _23"></span>模型<span class="_ _23"></span>会存在<span class="_ _23"></span>过拟合。<span class="_ _23"></span>通过主<span class="_ _23"></span>动裁<span class="_ _23"></span>掉一些<span class="_ _23"></span>内</div><div class="t m0 x3 h6 y495 ff1 fs2 fc0 sc0 ls0 ws0">部结点，并将其作为新的叶结点，可以降低决策树模型过拟合的风险，这称为剪枝（<span class="ff3">pruning</span>）<span class="_ _26"></span>。</div><div class="t m0 x3 h6 y496 ff1 fs2 fc0 sc0 ls0 ws0">决策树的剪枝策略可以分为“预剪枝”<span class="ff3">(pre-pruning)<span class="_ _d"> </span></span>和“后剪枝”<span class="ff3">(p<span class="_ _23"></span>ost-pruning)</span>。</div><div class="t m0 x15 h6 y497 ff3 fs2 fc0 sc0 ls0 ws0">1.<span class="_ _5"> </span><span class="ff1">预剪枝：在决策树生成过程中，每生成一个内部结点，便对该内部结点应用剪枝策略。</span></div><div class="t m0 x15 h6 y498 ff3 fs2 fc0 sc0 ls0 ws0">2.<span class="_ _5"> </span><span class="ff1">后剪枝：生成一颗完整的决策树之后，再自底向上地对内部结点应用剪枝策略。</span></div><div class="t m0 x3 hd y499 ff5 fs8 fc0 sc0 ls0 ws0">5.6.1<span class="_ _36"> </span><span class="ff9">预剪枝</span></div><div class="t m0 x3 h6 y49a ff1 fs2 fc0 sc0 ls0 ws0">有如下预剪枝策略：</div><div class="t m0 x15 h6 y49b ff3 fs2 fc0 sc0 ls0 ws0">1.<span class="_ _5"> </span><span class="ff1">树到达一定深度</span></div><div class="t m0 x15 h6 y49c ff3 fs2 fc0 sc0 ls0 ws0">2.<span class="_ _5"> </span><span class="ff1">结点下包含的样本点小于一定数目</span></div><div class="t m0 x15 h6 y49d ff3 fs2 fc0 sc0 ls0 ws0">3.<span class="_ _5"> </span>impurit<span class="_ _12"></span>y<span class="ff1">（如信息增益、信息增益比等）小于一定的阈值</span></div><div class="t m0 x15 h6 y49e ff3 fs2 fc0 sc0 ls0 ws0">4.<span class="_ _5"> </span><span class="ff1">生成结点后，决策树的性能没有提高，或者代价函数没有下降</span></div><div class="t m0 x3 hd y49f ff5 fs8 fc0 sc0 ls0 ws0">5.6.2<span class="_ _36"> </span><span class="ff9">后剪枝</span></div><div class="t m0 x3 h6 y4a0 ff1 fs2 fc0 sc0 ls0 ws0">因为在后剪枝时，<span class="_ _2e"></span>已经生成了一颗完整的决策树，<span class="_ _2a"></span>所以通过判断性能或代价函数是否有改善进行</div><div class="t m0 x3 h6 y4a1 ff1 fs2 fc0 sc0 ls0 ws0">剪枝。</div><div class="t m0 x3 h6 y4a2 ff1 fs2 fc0 sc0 ls0 ws0">下面介<span class="_ _23"></span>绍几种（后）剪<span class="_ _23"></span>枝策略，实际<span class="_ _23"></span>上，这些预剪<span class="_ _23"></span>枝也可以使<span class="_ _23"></span>用这些剪枝<span class="_ _23"></span>策略，因为预<span class="_ _23"></span>剪枝时，</div><div class="t m0 x3 h6 y4a3 ff1 fs2 fc0 sc0 ls0 ws0">显然也是可以计算性能评估得分或代价函数的。</div><div class="t m0 x3 h32 y4a4 ff21 fsc fc0 sc0 ls0 ws0">5.6.2.1<span class="_ _16"> </span><span class="ff9">错误率降低剪枝<span class="_ _35"> </span></span>(Reduced-Error<span class="_ _35"> </span>Pruning,<span class="_ _35"> </span>REP)</div><div class="t m0 x3 h6 y2cc ff1 fs2 fc0 sc0 ls0 ws0">先从训练集生成一棵完整的决策树，<span class="_ _2e"></span>然后自底向上地对非叶结点进行考察，<span class="_ _2a"></span>若将该结点对应的子</div><div class="t m0 x3 h6 y86 ff1 fs2 fc0 sc0 ls0 ws0">树替换为叶结点能带来决策树泛化性能提升（或泛化性能不下降）<span class="_ _26"></span>，则将该子树替换为叶结点。</div><div class="t m0 x3 h6 y18e ff3 fs2 fc0 sc0 ls0 ws0">REP<span class="_ _d"> </span><span class="ff1">策略要<span class="_ _23"></span>求将训练数据划分为两份：<span class="_ _23"></span>训练集和验证集。训练集用于<span class="_ _23"></span>生成决策树，验证集用于</span></div><div class="t m0 x3 h6 y20 ff1 fs2 fc0 sc0 ls0 ws0">剪枝时评估泛化性能。</div><div class="t m0 xbc h4 y3 ff3 fs2 fc0 sc0 ls0 ws0">31</div></div><div class="pi" data-data='{"ctm":[1.500000,0.000000,0.000000,1.500000,0.000000,0.000000]}'></div></div>
<div id="pf26" class="pf w0 h0" data-page-no="26"><div class="pc pc26 w0 h0"><img class="bi x3c y4a5 we h33" alt="" src="bg26.png"/><div class="t m0 x3 h7 y21 ff3 fs5 fc0 sc0 ls0 ws0">5.6<span class="_ _8"> </span><span class="ff7">剪枝</span></div><div class="t m0 x3 h6 y22 ff1 fs2 fc0 sc0 ls0 ws0">因为是对泛化性能进行评估，所以训练数据需要被划分为两部分：训练集和验证集。</div><div class="t m0 x3 h6 y5c ff1 fs2 fc0 sc0 ls0 ws0">西瓜书在决策树章节中，<span class="_ _29"></span>介绍的剪枝就是用这种剪枝方法。<span class="_ _29"></span>这个方法的原理是：<span class="_ _29"></span>即使决策树可能</div><div class="t m0 x3 h6 y88 ff1 fs2 fc0 sc0 ls0 ws0">会被训练集中的随机错误和巧合规律所误导，<span class="_ _2e"></span>但验证集合不太可能表现出同样的随机波动，<span class="_ _2a"></span>所以</div><div class="t m0 x3 h6 y89 ff1 fs2 fc0 sc0 ls0 ws0">验证集可以用来纠正决策树。</div><div class="t m0 x3 h6 y8a ff3 fs2 fc0 sc0 ls0 ws0">REP<span class="_ _d"> </span><span class="ff1">剪枝比较简单，不过如果训练数据较少，</span>REP<span class="_ _d"> </span><span class="ff1">策略可能会使决策树偏向于过度修剪。</span></div><div class="t m0 x3 h32 y4a6 ff21 fsc fc0 sc0 ls0 ws0">5.6.2.2<span class="_ _16"> </span><span class="ff9">悲观错误剪枝<span class="_ _35"> </span></span>(P<span class="_ _12"></span>essimistic<span class="_ _35"> </span>Error<span class="_ _1e"> </span>Pruning,<span class="_ _35"> </span>PEP)</div><div class="t m0 x3 h6 y4a7 ff3 fs2 fc0 sc0 ls0 ws0">PEP <span class="ff1">剪枝算法是在<span class="_ _25"> </span></span>C4.5<span class="_ _25"> </span><span class="ff1">决策树算法中提出的，<span class="_ _3a"></span>该方法直接使用训练数据进行误差评估，<span class="_ _2e"></span>不需要</span></div><div class="t m0 x3 h6 y4a8 ff1 fs2 fc0 sc0 ls0 ws0">一个单独的测试数据集。</div><div class="t m0 x3 h6 y4a9 ff1 fs2 fc0 sc0 ls0 ws0">如果直接根据训练集计算错误率，<span class="_ _2e"></span>显然完整的树的错误率是最小的，<span class="_ _2a"></span>因此需要在错误率计算公式</div><div class="t m0 x3 h6 y4aa ff1 fs2 fc0 sc0 ls0 ws0">中添加惩罚因子。</div><div class="t m0 x3 h6 y4ab ff1 fs2 fc0 sc0 ls0 ws0">对于一个叶子结点<span class="_ _d"> </span><span class="ff3">t</span>，其样本总数为<span class="_ _d"> </span><span class="ffd">N</span></div><div class="t m0 x2f hb y4ac ffc fs7 fc0 sc0 ls0 ws0">t</div><div class="t m0 x16 h6 y4ab ff1 fs2 fc0 sc0 ls0 ws0">，分类错误的样本总数为<span class="_ _d"> </span><span class="ffd">E</span></div><div class="t m0 xbe hb y4ac ffc fs7 fc0 sc0 ls0 ws0">t</div><div class="t m0 x125 h6 y4ab ff1 fs2 fc0 sc0 ls0 ws0">，定义其错误率为</div><div class="t m0 x96 h4 y4ad ffd fs2 fc0 sc0 ls0 ws0">r<span class="_ _23"></span><span class="fff">(</span>t<span class="fff">)<span class="_ _a"> </span>=</span></div><div class="t m0 x126 he y4ae ffd fs2 fc0 sc0 ls0 ws0">E</div><div class="t m0 x20 hb y4af ffc fs7 fc0 sc0 ls0 ws0">t</div><div class="t m0 x126 he y4b0 ffd fs2 fc0 sc0 ls0 ws0">N</div><div class="t m0 x20 hb y4b1 ffc fs7 fc0 sc0 ls0 ws0">t</div><div class="t m0 x3 h6 y4b2 ff1 fs2 fc0 sc0 ls0 ws0">修正错误率为（<span class="ff3">0.5<span class="_ _d"> </span></span>为修正因子）</div><div class="t m0 x32 he y4b3 ffd fs2 fc0 sc0 ls0 ws0">r</div><div class="t m0 x23 ha y4b4 ffb fs7 fc0 sc0 ls0 ws0">′</div><div class="t m0 x9d h4 y4b3 fff fs2 fc0 sc0 ls0 ws0">(<span class="ffd">t</span>)<span class="_ _32"> </span>=</div><div class="t m0 x98 he y4b5 ffd fs2 fc0 sc0 ls0 ws0">E</div><div class="t m0 xc9 hb y4b6 ffc fs7 fc0 sc0 ls0 ws0">t</div><div class="t m0 x29 h4 y4b5 fff fs2 fc0 sc0 ls0 ws0">+<span class="_ _37"> </span>0<span class="ffd">.</span>5</div><div class="t m0 x13e he y4b7 ffd fs2 fc0 sc0 ls0 ws0">N</div><div class="t m0 x9e hb y4b8 ffc fs7 fc0 sc0 ls0 ws0">t</div><div class="t m0 x113 h4 y4b9 fff fs2 fc0 sc0 ls0 ws0">˜</div><div class="t m0 x3 h6 y4ba ffd fs2 fc0 sc0 ls0 ws0">T<span class="_ _3f"> </span><span class="ff1">是树<span class="_ _d"> </span><span class="ff3">T<span class="_ _d"> </span></span>的所有叶子结点，<span class="ffe">|</span></span></div><div class="t m0 x31 h4 y4b9 fff fs2 fc0 sc0 ls0 ws0">˜</div><div class="t m0 xe7 h6 y4ba ffd fs2 fc0 sc0 ls0 ws0">T<span class="_ _1e"> </span><span class="ffe">|<span class="_ _d"> </span><span class="ff1">是树<span class="_ _d"> </span><span class="ff3">T<span class="_ _d"> </span></span>的叶子结点总数，树<span class="_ _d"> </span><span class="ff3">T<span class="_ _d"> </span></span>的修正错误率为</span></span></div><div class="t m0 x57 he y4bb ffd fs2 fc0 sc0 ls0 ws0">R</div><div class="t m0 x4b ha y4bc ffb fs7 fc0 sc0 ls0 ws0">′</div><div class="t m0 x83 h4 y4bb fff fs2 fc0 sc0 ls0 ws0">(<span class="ffd">T<span class="_ _33"> </span></span>)<span class="_ _a"> </span>=</div><div class="t m0 x2 hc y4bd ff11 fs2 fc0 sc0 ls0 ws0">P</div><div class="t m0 x12d ha y4be ffc fs7 fc0 sc0 ls0 ws0">t<span class="ffb">∈</span></div><div class="t m0 x48 ha y4bf ff12 fs7 fc0 sc0 ls0 ws0">˜</div><div class="t m0 xf3 hb y4be ffc fs7 fc0 sc0 ls0 ws0">T</div><div class="t m0 x95 h4 y4c0 fff fs2 fc0 sc0 ls0 ws0">(<span class="ffd">E</span></div><div class="t m0 x9d hb y4c1 ffc fs7 fc0 sc0 ls0 ws0">t</div><div class="t m0 x96 h4 y4c0 fff fs2 fc0 sc0 ls0 ws0">+<span class="_ _37"> </span>0<span class="ffd">.</span>5)</div><div class="t m0 x47 hc y4c2 ff11 fs2 fc0 sc0 ls0 ws0">P</div><div class="t m0 xe ha y4c3 ffc fs7 fc0 sc0 ls0 ws0">t<span class="ffb">∈</span></div><div class="t m0 xc7 ha y4c4 ff12 fs7 fc0 sc0 ls0 ws0">˜</div><div class="t m0 x23 hb y4c3 ffc fs7 fc0 sc0 ls0 ws0">T</div><div class="t m0 xf4 he y4c5 ffd fs2 fc0 sc0 ls0 ws0">N</div><div class="t m0 x122 hb y4c6 ffc fs7 fc0 sc0 ls0 ws0">t</div><div class="t m0 xaa h4 y4bb fff fs2 fc0 sc0 ls0 ws0">=</div><div class="t m0 x14a hc y4bd ff11 fs2 fc0 sc0 ls0 ws0">P</div><div class="t m0 x78 ha y4be ffc fs7 fc0 sc0 ls0 ws0">t<span class="ffb">∈</span></div><div class="t m0 xc8 ha y4bf ff12 fs7 fc0 sc0 ls0 ws0">˜</div><div class="t m0 x25 hb y4be ffc fs7 fc0 sc0 ls0 ws0">T</div><div class="t m0 x112 he y4c0 ffd fs2 fc0 sc0 ls0 ws0">E</div><div class="t m0 x127 hb y4c1 ffc fs7 fc0 sc0 ls0 ws0">t</div><div class="t m0 xc5 h4 y4c0 fff fs2 fc0 sc0 ls0 ws0">+<span class="_ _37"> </span>0<span class="ffd">.</span>5<span class="_ _32"> </span><span class="ffe">|</span></div><div class="t m0 x14b h4 y4c7 fff fs2 fc0 sc0 ls0 ws0">˜</div><div class="t m0 xbf h4 y4c0 ffd fs2 fc0 sc0 ls0 ws0">T<span class="_ _1e"> </span><span class="ffe">|</span></div><div class="t m0 x1f hc y4c2 ff11 fs2 fc0 sc0 ls0 ws0">P</div><div class="t m0 x127 ha y4c3 ffc fs7 fc0 sc0 ls0 ws0">t<span class="ffb">∈</span></div><div class="t m0 xc6 ha y4c4 ff12 fs7 fc0 sc0 ls0 ws0">˜</div><div class="t m0 xcb hb y4c3 ffc fs7 fc0 sc0 ls0 ws0">T</div><div class="t m0 xe8 he y4c5 ffd fs2 fc0 sc0 ls0 ws0">N</div><div class="t m0 x7c hb y4c6 ffc fs7 fc0 sc0 ls0 ws0">t</div><div class="t m0 x3 h6 y4c8 ff1 fs2 fc0 sc0 ls0 ws0">之所以<span class="_ _23"></span>叫“悲观”<span class="_ _55"></span>，可能<span class="_ _23"></span>是因为每<span class="_ _23"></span>个叶子结点<span class="_ _23"></span>都会主动<span class="_ _23"></span>加入一个<span class="_ _23"></span>惩罚因子，<span class="_ _55"></span>“悲观”<span class="_ _23"></span>地提高错误</div><div class="t m0 x3 h6 y4c9 ff1 fs2 fc0 sc0 ls0 ws0">率。</div><div class="t m0 x3 h6 y4ca ff1 fs2 fc0 sc0 ls0 ws0">当子树<span class="_ _25"> </span><span class="ffd">T</span></div><div class="t m0 x14c hb y4cb ffc fs7 fc0 sc0 ls0 ws0">t</div><div class="t m0 x12c h6 y4ca ff1 fs2 fc0 sc0 ls0 ws0">的误判数大于<span class="_ _25"> </span><span class="ffd">t<span class="_ _25"> </span></span>结点替换为叶结点时的误判数一个标准差，<span class="_ _3a"></span>便决定剪枝，<span class="_ _29"></span>得到<span class="_ _25"> </span><span class="ffd">T<span class="_ _25"> </span><span class="ffe">−<span class="_ _31"></span></span>T</span></div><div class="t m0 x14d hb y4cb ffc fs7 fc0 sc0 ls0 ws0">t</div><div class="t m0 x14e h6 y4ca ff1 fs2 fc0 sc0 ls0 ws0">。</div><div class="t m0 xe he y4cc ffd fs2 fc0 sc0 ls0 ws0">E</div><div class="t m0 x5b hb y4cd ffc fs7 fc0 sc0 ls0 ws0">T</div><div class="t m0 x33 h10 y4ce ff13 fs9 fc0 sc0 ls0 ws0">t</div><div class="t m0 x5d h4 y4cc ffe fs2 fc0 sc0 ls0 ws0">−<span class="_ _37"> </span><span class="ff3">Var</span></div><div class="t m0 xc9 hb y4cd ffc fs7 fc0 sc0 ls0 ws0">T</div><div class="t m0 x13e h10 y4ce ff13 fs9 fc0 sc0 ls0 ws0">t</div><div class="t m0 x20 he y4cc ffd fs2 fc0 sc0 ls0 ws0">&gt;<span class="_ _32"> </span>E</div><div class="t m0 x14f hb y4cf ffc fs7 fc0 sc0 ls0 ws0">t</div><div class="t m0 x3 h6 y4d0 ff1 fs2 fc0 sc0 ls0 ws0">其中，<span class="ff3">Var</span></div><div class="t m0 x10b hb y4d1 ffc fs7 fc0 sc0 ls0 ws0">T</div><div class="t m0 xe2 h10 y4d2 ff13 fs9 fc0 sc0 ls0 ws0">t</div><div class="t m0 x109 h4 y4d0 fff fs2 fc0 sc0 ls0 ws0">=</div><div class="t m0 xda hc y4d3 ff11 fs2 fc0 sc0 ls0 ws0">p</div><div class="t m0 x3c he y4d0 ffd fs2 fc0 sc0 ls0 ws0">N</div><div class="t m0 x150 hb y4d1 ffc fs7 fc0 sc0 ls0 ws0">T</div><div class="t m0 xdb h10 y4d2 ff13 fs9 fc0 sc0 ls0 ws0">t</div><div class="t m0 xb4 h4 y4d0 ffe fs2 fc0 sc0 ls0 ws0">×<span class="_ _37"> </span><span class="ffd">R</span></div><div class="t m0 x83 ha y4d4 ffb fs7 fc0 sc0 ls0 ws0">′</div><div class="t m0 x3f h4 y4d0 fff fs2 fc0 sc0 ls0 ws0">(<span class="ffd">T</span></div><div class="t m0 x40 hb y4d5 ffc fs7 fc0 sc0 ls0 ws0">t</div><div class="t m0 x147 h4 y4d0 fff fs2 fc0 sc0 ls0 ws0">)<span class="_ _37"> </span><span class="ffe">×<span class="_ _37"> </span></span>(1<span class="_ _37"> </span><span class="ffe">−<span class="_ _37"> </span><span class="ffd">R</span></span></div><div class="t m0 x4f ha y4d4 ffb fs7 fc0 sc0 ls0 ws0">′</div><div class="t m0 x5b h4 y4d0 fff fs2 fc0 sc0 ls0 ws0">(<span class="ffd">T</span></div><div class="t m0 x96 hb y4d5 ffc fs7 fc0 sc0 ls0 ws0">t</div><div class="t m0 xbd h4 y4d0 fff fs2 fc0 sc0 ls0 ws0">))</div><div class="t m0 x3 h6 y4d6 ff1 fs2 fc0 sc0 ls0 ws0">子树<span class="_ _25"> </span><span class="ffd">T</span></div><div class="t m0 x42 hb y4d7 ffc fs7 fc0 sc0 ls0 ws0">t</div><div class="t m0 xf0 h6 y4d6 ff1 fs2 fc0 sc0 ls0 ws0">每次分类一个样本有两种结果，<span class="_ _28"></span>分类正确（记为<span class="_ _25"> </span><span class="ff3">0</span>）<span class="_ _2f"></span>，<span class="_ _28"></span>分类错误<span class="_ _12"></span>（记为<span class="_ _d"> </span><span class="ff3">1</span>）<span class="_ _26"></span>，<span class="_ _12"></span>子树<span class="_ _25"> </span><span class="ffd">T</span></div><div class="t m0 x86 hb y4d7 ffc fs7 fc0 sc0 ls0 ws0">t</div><div class="t m0 xaf h6 y4d6 ff1 fs2 fc0 sc0 ls0 ws0">错误</div><div class="t m0 x3 h6 y4d8 ff1 fs2 fc0 sc0 ls0 ws0">分类某个样本的概率为<span class="_ _25"> </span><span class="ffd">R</span></div><div class="t m0 x4b ha y4d9 ffb fs7 fc0 sc0 ls0 ws0">′</div><div class="t m0 x83 h4 y4d8 fff fs2 fc0 sc0 ls0 ws0">(<span class="ffd">T</span></div><div class="t m0 xd7 hb y4da ffc fs7 fc0 sc0 ls0 ws0">t</div><div class="t m0 x40 h6 y4d8 fff fs2 fc0 sc0 ls0 ws0">)<span class="ff1">。<span class="_ _30"></span>因此，<span class="_ _29"></span>每次对样本进行分类可以看作是一次伯努利试验，<span class="_ _30"></span>对<span class="_ _25"> </span><span class="ffd">N</span></span></div><div class="t m0 x142 hb y4db ffc fs7 fc0 sc0 ls0 ws0">T</div><div class="t m0 x14e h10 y4dc ff13 fs9 fc0 sc0 ls0 ws0">t</div><div class="t m0 x3 h6 y4dd ff1 fs2 fc0 sc0 ls0 ws0">个样本进行分类，<span class="_ _28"></span>则是做了<span class="_ _25"> </span><span class="ffd">N</span></div><div class="t m0 x0 hb y4de ffc fs7 fc0 sc0 ls0 ws0">T</div><div class="t m0 x9a h10 y4df ff13 fs9 fc0 sc0 ls0 ws0">t</div><div class="t m0 xf h6 y4dd ff1 fs2 fc0 sc0 ls0 ws0">次独立的伯努利试验，<span class="_ _28"></span>这服从<span class="_ _25"> </span><span class="ffd">B<span class="_ _23"></span><span class="fff">(</span>N</span></div><div class="t m0 xd0 hb y4e0 ffc fs7 fc0 sc0 ls0 ws0">t</div><div class="t m0 x102 he y4dd ffd fs2 fc0 sc0 ls0 ws0">,<span class="_ _31"> </span>R</div><div class="t m0 x134 ha y4e1 ffb fs7 fc0 sc0 ls0 ws0">′</div><div class="t m0 x11f h4 y4dd fff fs2 fc0 sc0 ls0 ws0">(<span class="ffd">T</span></div><div class="t m0 x137 hb y4e0 ffc fs7 fc0 sc0 ls0 ws0">t</div><div class="t m0 x151 h6 y4dd fff fs2 fc0 sc0 ls0 ws0">))<span class="_ _25"> </span><span class="ff1">二项分布。<span class="_ _28"></span>根据二</span></div><div class="t m0 x3 h6 y4e2 ff1 fs2 fc0 sc0 ls0 ws0">项分布的标准差公式，可以计算出<span class="_ _d"> </span><span class="ff3">Var</span></div><div class="t m0 xe hb y4e3 ffc fs7 fc0 sc0 ls0 ws0">T</div><div class="t m0 x4f h10 y4e4 ff13 fs9 fc0 sc0 ls0 ws0">t</div><div class="t m0 x23 h6 y4e2 ff1 fs2 fc0 sc0 ls0 ws0">。</div><div class="t m0 x3 h32 y4e5 ff21 fsc fc0 sc0 ls0 ws0">5.6.2.3<span class="_ _16"> </span><span class="ff9">代价复杂度剪枝<span class="_ _35"> </span></span>(Cost-Complexit<span class="_ _12"></span>y<span class="_ _35"> </span>Pruning,<span class="_ _1e"> </span>CCP)</div><div class="t m0 x3 h6 ya9 ff3 fs2 fc0 sc0 ls0 ws0">CCP<span class="_ _d"> </span><span class="ff1">剪<span class="_ _23"></span>枝通过极小化决策<span class="_ _23"></span>树的<span class="_ _d"> </span></span>cost-complexity<span class="_ _d"> </span>measure<span class="_ _e"> </span><span class="ff1">实现，这是<span class="_ _e"> </span></span>CAR<span class="_ _27"></span>T<span class="_ _e"> </span><span class="ff1">决策树所使用<span class="_ _23"></span>的剪</span></div><div class="t m0 x3 h6 yab ff1 fs2 fc0 sc0 ls0 ws0">枝算法。</div><div class="t m0 x3 h6 y2cb ff4 fs2 fc0 sc0 ls0 ws0">定义<span class="ff6">5.8<span class="_ _5"> </span><span class="fc1">cost-complexit<span class="_ _28"></span>y<span class="_ _1e"> </span>measure<span class="ff4">：<span class="_ _d"> </span><span class="ff1 fc0">由<span class="_ _d"> </span><span class="ff3">cost<span class="_ _d"> </span>function<span class="_ _d"> </span></span>和<span class="_ _d"> </span><span class="ff3">complexity<span class="_ _25"> </span></span>组成，公式如下：</span></span></span></span></div><div class="t m0 x11 he y4e6 ffd fs2 fc0 sc0 ls0 ws0">C</div><div class="t m0 x28 hb y4e7 ffc fs7 fc0 sc0 ls0 ws0">α</div><div class="t m0 x32 h4 y4e6 fff fs2 fc0 sc0 ls0 ws0">(<span class="ffd">T<span class="_ _33"> </span></span>)<span class="_ _a"> </span>=<span class="_ _32"> </span><span class="ffd">C<span class="_ _51"></span></span>(<span class="ffd">T<span class="_ _33"> </span></span>)<span class="_ _37"> </span>+<span class="_ _37"> </span><span class="ffd">α<span class="ffe">|</span></span></div><div class="t m0 x1e h4 y4e8 fff fs2 fc0 sc0 ls0 ws0">˜</div><div class="t m0 x148 h4 y4e6 ffd fs2 fc0 sc0 ls0 ws0">T<span class="_ _33"> </span><span class="ffe">|</span></div><div class="t m0 x3 h6 y86 ff1 fs2 fc0 sc0 ls0 ws0">其中，<span class="_ _27"></span><span class="ffd">C<span class="_ _51"></span><span class="fff">(</span>T<span class="_ _33"> </span><span class="fff">)<span class="_ _25"> </span><span class="ff1">为代价函数，<span class="_ _27"></span><span class="ffe">|</span></span></span></span></div><div class="t m0 xba h4 y4e9 fff fs2 fc0 sc0 ls0 ws0">˜</div><div class="t m0 xce h6 y86 ffd fs2 fc0 sc0 ls0 ws0">T<span class="_ _33"> </span><span class="ffe">|<span class="_ _25"> </span><span class="ff1">为复杂度<span class="_ _28"></span>（树<span class="_ _25"> </span><span class="ff3">T<span class="_ _d"> </span></span>的叶子结点数量）<span class="_ _26"></span>，<span class="_ _27"></span><span class="ffd">α<span class="_ _d"> </span><span class="ff1">为非负实数，<span class="_ _27"></span>称为复杂度参</span></span></span></span></div><div class="t m0 x3 h6 y87 ff1 fs2 fc0 sc0 ls0 ws0">数<span class="_ _d"> </span><span class="ff3">(complexit<span class="_ _12"></span>y<span class="_ _d"> </span>parameter)<span class="ff1">。</span></span></div><div class="t m0 x3 h6 y20 ff1 fs2 fc0 sc0 ls0 ws0">代价函数<span class="_ _23"></span>有多种不同的定<span class="_ _23"></span>义，可以选择信息<span class="_ _23"></span>熵、信息增益、信<span class="_ _23"></span>息增益率、基尼系<span class="_ _23"></span>数、平方误差、</div><div class="t m0 x3 h4 y3 ff3 fs2 fc0 sc0 ls0 ws0">32</div></div><div class="pi" data-data='{"ctm":[1.500000,0.000000,0.000000,1.500000,0.000000,0.000000]}'></div></div>
<div id="pf27" class="pf w0 h0" data-page-no="27"><div class="pc pc27 w0 h0"><img class="bi x126 y4ea wf h34" alt="" src="bg27.png"/><div class="t m0 x85 h7 y21 ff3 fs5 fc0 sc0 ls0 ws0">5.6<span class="_ _8"> </span><span class="ff7">剪枝</span></div><div class="t m0 x3 h6 y22 ff1 fs2 fc0 sc0 ls0 ws0">误分类概率等。</div><div class="t m0 x3 h6 y5c ff1 fs2 fc0 sc0 ls0 ws0">这里介绍两种：</div><div class="t m0 x15 h6 y5d ff3 fs2 fc0 sc0 ls0 ws0">1.<span class="_ _5"> </span><span class="ff1">信息熵（<span class="_ _26"></span>《统计学习方法》<span class="_ _2f"></span>）</span></div><div class="t m0 x15 h6 y4eb ff3 fs2 fc0 sc0 ls0 ws0">2.<span class="_ _5"> </span><span class="ff1">误分类概率</span></div><div class="t m0 x3 h32 y4ec ff9 fsc fc0 sc0 ls0 ws0">信息熵</div><div class="t m0 x3 h6 y4ed ff1 fs2 fc0 sc0 ls0 ws0">设树<span class="_ _25"> </span><span class="ff3">T<span class="_ _25"> </span></span>的所有叶子结点为</div><div class="t m0 x38 h4 y4ee fff fs2 fc0 sc0 ls0 ws0">˜</div><div class="t m0 x152 h6 y4ed ffd fs2 fc0 sc0 ls0 ws0">T<span class="_ _33"> </span><span class="ff1">，<span class="_ _30"></span>所有叶子结点个数为<span class="_ _25"> </span><span class="ffe">|</span></span></div><div class="t m0 x71 h4 y4ee fff fs2 fc0 sc0 ls0 ws0">˜</div><div class="t m0 x14a h6 y4ed ffd fs2 fc0 sc0 ls0 ws0">T<span class="_ _33"> </span><span class="ffe">|<span class="ff1">，<span class="_ _30"></span>叶结点<span class="_ _25"> </span><span class="ffd">t<span class="_ _d"> </span></span>有<span class="_ _25"> </span><span class="ffd">N</span></span></span></div><div class="t m0 xa3 hb y4ef ffc fs7 fc0 sc0 ls0 ws0">t</div><div class="t m0 xdf h6 y4ed ff1 fs2 fc0 sc0 ls0 ws0">个样本点，<span class="_ _30"></span>其中<span class="_ _25"> </span><span class="ffd">k<span class="_ _e"> </span></span>类的</div><div class="t m0 x3 h6 y4f0 ff1 fs2 fc0 sc0 ls0 ws0">样本点有<span class="_ _d"> </span><span class="ffd">N</span></div><div class="t m0 xb2 hb y4f1 ffc fs7 fc0 sc0 ls0 ws0">k</div><div class="t m0 x7f h6 y4f0 ff1 fs2 fc0 sc0 ls0 ws0">个<span class="ff3">,<span class="_ _d"> </span><span class="ffd">k<span class="_ _25"> </span><span class="fff">=<span class="_ _32"> </span>1</span>,<span class="_ _31"> </span><span class="fff">2</span>,<span class="_ _31"> </span><span class="ffe">·<span class="_ _31"></span>·<span class="_ _31"></span>·<span class="_ _d"> </span></span>,<span class="_ _31"> </span>K<span class="_ _51"></span></span></span>，<span class="ffd">H</span></div><div class="t m0 x111 hb y4f2 ffc fs7 fc0 sc0 ls0 ws0">t</div><div class="t m0 x48 h6 y4f0 fff fs2 fc0 sc0 ls0 ws0">(<span class="ffd">T<span class="_ _33"> </span></span>)<span class="_ _d"> </span><span class="ff1">为叶结点<span class="_ _d"> </span><span class="ffd">t<span class="_ _d"> </span></span>上的经验熵</span></div><div class="t m0 x10 he y4f3 ffd fs2 fc0 sc0 ls0 ws0">H</div><div class="t m0 x47 hb y4f4 ffc fs7 fc0 sc0 ls0 ws0">t</div><div class="t m0 xf3 h4 y4f3 fff fs2 fc0 sc0 ls0 ws0">(<span class="ffd">T<span class="_ _33"> </span></span>)<span class="_ _a"> </span>=<span class="_ _32"> </span><span class="ffe">−</span></div><div class="t m0 x97 hc y4f5 ff11 fs2 fc0 sc0 ls0 ws0">X</div><div class="t m0 xa hb y4f6 ffc fs7 fc0 sc0 ls0 ws0">k</div><div class="t m0 x126 he y4f7 ffd fs2 fc0 sc0 ls0 ws0">N</div><div class="t m0 x2a hb y4f8 ffc fs7 fc0 sc0 ls0 ws0">k</div><div class="t m0 x5f he y4f9 ffd fs2 fc0 sc0 ls0 ws0">N</div><div class="t m0 x9e hb y4fa ffc fs7 fc0 sc0 ls0 ws0">t</div><div class="t m0 x77 h4 y4f3 ff3 fs2 fc0 sc0 ls0 ws0">log</div><div class="t m0 xc8 he y4f7 ffd fs2 fc0 sc0 ls0 ws0">N</div><div class="t m0 x9f hb y4f8 ffc fs7 fc0 sc0 ls0 ws0">ik</div><div class="t m0 x79 he y4f9 ffd fs2 fc0 sc0 ls0 ws0">N</div><div class="t m0 x62 hb y4fa ffc fs7 fc0 sc0 ls0 ws0">t</div><div class="t m0 x3 h6 y4fb ff1 fs2 fc0 sc0 ls0 ws0">树<span class="_ _d"> </span><span class="ff3">T<span class="_ _d"> </span></span>的代价函数为</div><div class="t m0 x4b h4 y4fc ffd fs2 fc0 sc0 ls0 ws0">C<span class="_ _51"></span><span class="fff">(</span>T<span class="_ _33"> </span><span class="fff">)<span class="_ _a"> </span>=</span></div><div class="t m0 x4e ha y4fd ffb fs7 fc0 sc0 ls0 ws0">|</div><div class="t m0 x51 ha y4fe ff12 fs7 fc0 sc0 ls0 ws0">˜</div><div class="t m0 x10 ha y4fd ffc fs7 fc0 sc0 ls0 ws0">T<span class="_ _34"> </span><span class="ffb">|</span></div><div class="t m0 x11c hc y4ff ff11 fs2 fc0 sc0 ls0 ws0">X</div><div class="t m0 x5a ha y500 ffc fs7 fc0 sc0 ls0 ws0">t<span class="ff12">=1</span></div><div class="t m0 x48 he y4fc ffd fs2 fc0 sc0 ls0 ws0">N</div><div class="t m0 x94 hb y501 ffc fs7 fc0 sc0 ls0 ws0">t</div><div class="t m0 x4f he y4fc ffd fs2 fc0 sc0 ls0 ws0">H</div><div class="t m0 xa9 hb y501 ffc fs7 fc0 sc0 ls0 ws0">t</div><div class="t m0 xf4 h4 y4fc fff fs2 fc0 sc0 ls0 ws0">(<span class="ffd">T<span class="_ _33"> </span></span>)<span class="_ _a"> </span>=<span class="_ _25"> </span><span class="ffe">−</span></div><div class="t m0 x2a ha y4fd ffb fs7 fc0 sc0 ls0 ws0">|</div><div class="t m0 xd2 ha y4fe ff12 fs7 fc0 sc0 ls0 ws0">˜</div><div class="t m0 x36 ha y4fd ffc fs7 fc0 sc0 ls0 ws0">T<span class="_ _34"> </span><span class="ffb">|</span></div><div class="t m0 xcf hc y4ff ff11 fs2 fc0 sc0 ls0 ws0">X</div><div class="t m0 xcf ha y500 ffc fs7 fc0 sc0 ls0 ws0">t<span class="ff12">=1</span></div><div class="t m0 x103 hb y502 ffc fs7 fc0 sc0 ls0 ws0">K</div><div class="t m0 x37 hc y4ff ff11 fs2 fc0 sc0 ls0 ws0">X</div><div class="t m0 x37 ha y503 ffc fs7 fc0 sc0 ls0 ws0">k<span class="ff12">=1</span></div><div class="t m0 x11d he y4fc ffd fs2 fc0 sc0 ls0 ws0">N</div><div class="t m0 xc4 hb y504 ffc fs7 fc0 sc0 ls0 ws0">tk</div><div class="t m0 xeb h4 y4fc ff3 fs2 fc0 sc0 ls0 ws0">log</div><div class="t m0 x153 he y505 ffd fs2 fc0 sc0 ls0 ws0">N</div><div class="t m0 x135 hb y506 ffc fs7 fc0 sc0 ls0 ws0">tk</div><div class="t m0 x7d he y507 ffd fs2 fc0 sc0 ls0 ws0">N</div><div class="t m0 xbf hb y508 ffc fs7 fc0 sc0 ls0 ws0">t</div><div class="t m0 x3 h32 y509 ff9 fsc fc0 sc0 ls0 ws0">误分类概率</div><div class="t m0 x3 h6 y50a ff1 fs2 fc0 sc0 ls0 ws0">将误分类概率作为代价函数：</div><div class="t m0 x93 h4 y50b ffd fs2 fc0 sc0 ls0 ws0">C<span class="_ _51"></span><span class="fff">(</span>T<span class="_ _33"> </span><span class="fff">)<span class="_ _a"> </span>=</span></div><div class="t m0 x4f hc y50c ff11 fs2 fc0 sc0 ls0 ws0">X</div><div class="t m0 x4f ha y50d ffc fs7 fc0 sc0 ls0 ws0">t<span class="ffb">∈</span></div><div class="t m0 x24 ha y50e ff12 fs7 fc0 sc0 ls0 ws0">˜</div><div class="t m0 x33 hb y50d ffc fs7 fc0 sc0 ls0 ws0">T</div><div class="t m0 xbd h4 y50b ffd fs2 fc0 sc0 ls0 ws0">r<span class="_ _23"></span><span class="fff">(</span>t<span class="fff">)<span class="_ _38"> </span><span class="ffe">·<span class="_ _37"> </span></span></span>p<span class="fff">(</span>t<span class="fff">)<span class="_ _32"> </span>=</span></div><div class="t m0 x14f hc y50c ff11 fs2 fc0 sc0 ls0 ws0">X</div><div class="t m0 x103 ha y50d ffc fs7 fc0 sc0 ls0 ws0">t<span class="ffb">∈</span></div><div class="t m0 x26 ha y50e ff12 fs7 fc0 sc0 ls0 ws0">˜</div><div class="t m0 x1f hb y50d ffc fs7 fc0 sc0 ls0 ws0">T</div><div class="t m0 x62 h4 y50b ffd fs2 fc0 sc0 ls0 ws0">C<span class="_ _51"></span><span class="fff">(</span>t<span class="fff">)</span></div><div class="t m0 x3 h6 y50f ff1 fs2 fc0 sc0 ls0 ws0">其中</div><div class="t m0 x50 h4 y510 ffd fs2 fc0 sc0 ls0 ws0">r<span class="_ _23"></span><span class="fff">(</span>t<span class="fff">)<span class="_ _a"> </span>=<span class="_ _32"> </span>1<span class="_ _37"> </span><span class="ffe">−<span class="_ _37"> </span><span class="ff3">max</span></span></span></div><div class="t m0 x80 hb y511 ffc fs7 fc0 sc0 ls0 ws0">j</div><div class="t m0 xc2 h4 y510 ffd fs2 fc0 sc0 ls0 ws0">p<span class="fff">(</span>j<span class="_ _d"> </span><span class="ffe">|<span class="_ _32"> </span></span>t<span class="fff">)<span class="_ _32"> </span>=<span class="_ _32"> </span>1<span class="_ _37"> </span><span class="ffe">−<span class="_ _37"> </span></span></span>p<span class="fff">(</span>κ<span class="fff">(</span>t<span class="fff">)<span class="_ _32"> </span><span class="ffe">|<span class="_ _32"> </span></span></span>t<span class="fff">)</span></div><div class="t m0 x72 h4 y512 ffd fs2 fc0 sc0 ls0 ws0">κ<span class="fff">(</span>t<span class="fff">)<span class="_ _32"> </span>=<span class="_ _32"> </span><span class="ff3">arg<span class="_ _31"> </span>max</span></span></div><div class="t m0 x2b hb y513 ffc fs7 fc0 sc0 ls0 ws0">j</div><div class="t m0 x36 h4 y512 ffd fs2 fc0 sc0 ls0 ws0">p<span class="fff">(</span>j<span class="_ _d"> </span><span class="ffe">|<span class="_ _32"> </span></span>t<span class="fff">)</span></div><div class="t m0 x4f h4 y514 ffd fs2 fc0 sc0 ls0 ws0">p<span class="fff">(</span>j<span class="_ _d"> </span><span class="ffe">|<span class="_ _32"> </span></span>t<span class="fff">)<span class="_ _32"> </span>=</span></div><div class="t m0 x5f he y515 ffd fs2 fc0 sc0 ls0 ws0">N</div><div class="t m0 x2a hb y516 ffc fs7 fc0 sc0 ls0 ws0">j</div><div class="t m0 xd2 h4 y515 fff fs2 fc0 sc0 ls0 ws0">(<span class="ffd">t</span>)</div><div class="t m0 x29 h4 y517 ffd fs2 fc0 sc0 ls0 ws0">N<span class="_ _34"></span><span class="fff">(</span>t<span class="fff">)</span></div><div class="t m0 x3 h6 y518 ff1 fs2 fc0 sc0 ls0 ws0">其中，<span class="ffd">j<span class="_ _1e"> </span></span>代表样本类别，<span class="ffd">N</span></div><div class="t m0 x3f hb y519 ffc fs7 fc0 sc0 ls0 ws0">j</div><div class="t m0 x154 h6 y518 fff fs2 fc0 sc0 ls0 ws0">(<span class="ffd">t</span>)<span class="_ _d"> </span><span class="ff1">为叶子结点<span class="_ _d"> </span><span class="ff3">t<span class="_ _d"> </span></span>中属于类<span class="_ _e"> </span><span class="ff3">j<span class="_ _d"> </span></span>的样本总数，<span class="ffd">r<span class="_ _23"></span></span></span>(<span class="ffd">t</span>)<span class="_ _25"> </span><span class="ff1">为叶<span class="_ _23"></span>子结点<span class="_ _25"> </span><span class="ff3">t<span class="_ _d"> </span></span>的误<span class="_ _23"></span>分</span></div><div class="t m0 x3 h6 y51a ff1 fs2 fc0 sc0 ls0 ws0">类概率的再代入估计（</div><div class="t m0 x12f h4 y51b ff3 fs2 fc0 sc0 ls0 ws0">resubstitution<span class="_ _d"> </span>estimate</div><div class="t m0 x97 h6 y51a ff1 fs2 fc0 sc0 ls0 ws0">）<span class="_ _26"></span>。</div><div class="t m0 x3 h32 y51c ff9 fsc fc0 sc0 ls0 ws0">剪枝过程</div><div class="t m0 x3 h6 y51d ff1 fs2 fc0 sc0 ls0 ws0">对于固定的<span class="_ _d"> </span><span class="ffd">α,<span class="_ _d"> </span></span>一定存在使损失函数<span class="_ _d"> </span><span class="ffd">C</span></div><div class="t m0 xd6 hb y51e ffc fs7 fc0 sc0 ls0 ws0">α</div><div class="t m0 x94 h6 y51d fff fs2 fc0 sc0 ls0 ws0">(<span class="ffd">T<span class="_ _33"> </span></span>)<span class="_ _d"> </span><span class="ff1">最小的子树，将其表示为<span class="_ _d"> </span><span class="ffd">T</span></span></div><div class="t m0 x155 hb y51e ffc fs7 fc0 sc0 ls0 ws0">α</div><div class="t m0 x156 h6 y51d ff1 fs2 fc0 sc0 ls0 ws0">，</div><div class="t m0 x9b he y51f ffd fs2 fc0 sc0 ls0 ws0">C</div><div class="t m0 x47 hb y520 ffc fs7 fc0 sc0 ls0 ws0">α</div><div class="t m0 x157 h4 y51f fff fs2 fc0 sc0 ls0 ws0">(<span class="ffd">T<span class="_ _33"> </span></span>(<span class="ffd">α</span>))<span class="_ _32"> </span>=<span class="_ _2"> </span><span class="ff3">min</span></div><div class="t m0 x81 ha y521 ffc fs7 fc0 sc0 ls0 ws0">T<span class="_ _34"> </span><span class="ffb">≤</span>T</div><div class="t m0 x45 h35 y522 ff22 fs9 fc0 sc0 ls0 ws0">nax</div><div class="t m0 x13b he y51f ffd fs2 fc0 sc0 ls0 ws0">C</div><div class="t m0 x14f hb y520 ffc fs7 fc0 sc0 ls0 ws0">α</div><div class="t m0 x158 h4 y51f fff fs2 fc0 sc0 ls0 ws0">(<span class="ffd">T<span class="_ _33"> </span></span>)</div><div class="t m0 x3 h6 y2ca ff1 fs2 fc0 sc0 ls0 ws0">显然，最<span class="_ _23"></span>优子树<span class="_ _e"> </span><span class="ffd">T</span></div><div class="t m0 xd5 hb y523 ffc fs7 fc0 sc0 ls0 ws0">α</div><div class="t m0 x159 h6 y2ca ff1 fs2 fc0 sc0 ls0 ws0">是存在<span class="_ _23"></span>的，因为树<span class="_ _e"> </span><span class="ff3">T<span class="_ _e"> </span></span>的子<span class="_ _23"></span>树只有有限<span class="_ _23"></span>个。容易验证这<span class="_ _23"></span>样的最优子<span class="_ _23"></span>树是唯一</div><div class="t m0 x3 h6 y2cb ff1 fs2 fc0 sc0 ls0 ws0">的。</div><div class="t m0 x3 h6 y35a ff1 fs2 fc0 sc0 ls0 ws0">较大的<span class="_ _d"> </span><span class="ffd">α<span class="_ _d"> </span></span>促使选择较小的树；而较小的<span class="_ _25"> </span><span class="ffd">α<span class="_ _d"> </span></span>促使选择较大的树。极端情况，当<span class="_ _25"> </span><span class="ffd">a<span class="_ _32"> </span><span class="fff">=<span class="_ _32"> </span>0<span class="_ _d"> </span></span></span>时，整体树</div><div class="t m0 x3 h6 y2cc ff1 fs2 fc0 sc0 ls0 ws0">是最优的，而当<span class="_ _d"> </span><span class="ffd">a<span class="_ _32"> </span><span class="ffe">→<span class="_ _32"> </span>∞<span class="_ _d"> </span></span></span>时，单结点树是最优的。</div><div class="t m0 x3 h6 y18d ff3 fs2 fc0 sc0 ls0 ws0">Breiman<span class="_ _d"> </span><span class="ff1">等人证明：可以用递归的方法对树进行剪枝。将<span class="_ _d"> </span><span class="ffd">α<span class="_ _d"> </span></span>从小增大，如<span class="_ _d"> </span><span class="fff">0<span class="_ _32"> </span>=<span class="_ _32"> </span><span class="ffd">α</span></span></span></div><div class="t m0 xfc ha y524 ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 x27 he y18d ffd fs2 fc0 sc0 ls0 ws0">&lt;<span class="_ _32"> </span>α</div><div class="t m0 x15a ha y524 ff12 fs7 fc0 sc0 ls0 ws0">2</div><div class="t m0 x15b he y18d ffd fs2 fc0 sc0 ls0 ws0">&lt;<span class="_ _32"> </span>.<span class="_ _31"> </span>.<span class="_ _31"> </span>.<span class="_ _32"> </span>&lt;</div><div class="t m0 x3 he y18e ffd fs2 fc0 sc0 ls0 ws0">α</div><div class="t m0 x15c hb y525 ffc fs7 fc0 sc0 ls0 ws0">n</div><div class="t m0 x5 h6 y18e ffd fs2 fc0 sc0 ls0 ws0">&lt;<span class="_ _1e"> </span><span class="fff">+<span class="ffe">∞<span class="ff1">，<span class="_ _23"></span>将产生<span class="_ _23"></span>一系<span class="_ _23"></span>列的<span class="_ _23"></span>区间<span class="_ _1e"> </span></span></span>[</span>α</div><div class="t m0 x111 hb y525 ffc fs7 fc0 sc0 ls0 ws0">i</div><div class="t m0 x48 he y18e ffd fs2 fc0 sc0 ls0 ws0">,<span class="_ _31"> </span>α</div><div class="t m0 x4f ha y525 ffc fs7 fc0 sc0 ls0 ws0">i<span class="ff12">+1</span></div><div class="t m0 x5d h6 y18e fff fs2 fc0 sc0 ls0 ws0">)<span class="_ _31"> </span><span class="ffd">,<span class="_ _19"> </span>i<span class="_ _1e"> </span></span>=<span class="_ _35"> </span>1<span class="ffd">,<span class="_ _31"> </span></span>2<span class="ffd">,<span class="_ _31"> </span>.<span class="_ _31"> </span>.<span class="_ _31"> </span>.<span class="_ _31"> </span>,<span class="_ _31"> </span>n<span class="ff1">。剪<span class="_ _23"></span>枝得<span class="_ _23"></span>到的<span class="_ _23"></span>最优<span class="_ _23"></span>子树序<span class="_ _23"></span>列与<span class="_ _23"></span>区间</span></span></div><div class="t m0 x3 h4 y20 fff fs2 fc0 sc0 ls0 ws0">[<span class="ffd">α</span></div><div class="t m0 x143 hb y2cd ffc fs7 fc0 sc0 ls0 ws0">i</div><div class="t m0 x15 he y20 ffd fs2 fc0 sc0 ls0 ws0">,<span class="_ _31"> </span>α</div><div class="t m0 x15d ha y2cd ffc fs7 fc0 sc0 ls0 ws0">i<span class="ff12">+1</span></div><div class="t m0 xb1 h6 y20 fff fs2 fc0 sc0 ls0 ws0">)<span class="_ _a"> </span><span class="ff1">一一对应。<span class="_ _2a"></span><span class="ffe">{<span class="ffd">T</span></span></span></div><div class="t m0 x12f ha y2cd ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 x3e he y20 ffd fs2 fc0 sc0 ls0 ws0">,<span class="_ _31"> </span>T</div><div class="t m0 x3f ha y2cd ff12 fs7 fc0 sc0 ls0 ws0">2</div><div class="t m0 xba he y20 ffd fs2 fc0 sc0 ls0 ws0">,<span class="_ _31"> </span>.<span class="_ _31"> </span>.<span class="_ _31"> </span>.<span class="_ _31"> </span>,<span class="_ _31"> </span>T</div><div class="t m0 x5a hb y2cd ffc fs7 fc0 sc0 ls0 ws0">n</div><div class="t m0 x51 h6 y20 ffe fs2 fc0 sc0 ls0 ws0">}<span class="_ _a"> </span><span class="ff1">序列中的子树是嵌套的，<span class="_ _2c"></span>即<span class="_ _32"> </span><span class="ffd">T</span></span></div><div class="t m0 xec ha y2cd ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 x15e h4 y20 ffe fs2 fc0 sc0 ls0 ws0">⊃<span class="_ _32"> </span><span class="ffd">T</span></div><div class="t m0 x155 ha y2cd ff12 fs7 fc0 sc0 ls0 ws0">2</div><div class="t m0 x15f h4 y20 ffe fs2 fc0 sc0 ls0 ws0">⊃<span class="_ _32"> </span><span class="ffd">.<span class="_ _31"> </span>.<span class="_ _31"> </span>.<span class="_ _32"> </span></span>⊃<span class="_ _32"> </span><span class="ffd">T</span></div><div class="t m0 x27 hb y526 ffc fs7 fc0 sc0 ls0 ws0">k</div><div class="t m0 x1b h4 y20 ffe fs2 fc0 sc0 ls0 ws0">⊃<span class="_ _32"> </span><span class="ffd">.<span class="_ _31"> </span>.<span class="_ _31"> </span>.<span class="_ _32"> </span></span>⊃<span class="_ _32"> </span><span class="ffd">T</span></div><div class="t m0 x160 hb y2cd ffc fs7 fc0 sc0 ls0 ws0">n</div><div class="t m0 x14e h6 y20 ff1 fs2 fc0 sc0 ls0 ws0">。</div><div class="t m0 xbc h4 y3 ff3 fs2 fc0 sc0 ls0 ws0">33</div></div><div class="pi" data-data='{"ctm":[1.500000,0.000000,0.000000,1.500000,0.000000,0.000000]}'></div></div>
<div id="pf28" class="pf w0 h0" data-page-no="28"><div class="pc pc28 w0 h0"><img class="bi x3 y527 w1 h36" alt="" src="bg28.png"/><div class="t m0 x3 h7 y21 ff3 fs5 fc0 sc0 ls0 ws0">5.6<span class="_ _8"> </span><span class="ff7">剪枝</span></div><div class="t m0 x3 h6 y22 ff1 fs2 fc0 sc0 ls0 ws0">尽管<span class="_ _e"> </span><span class="ffd">α<span class="_ _e"> </span></span>的取值无限<span class="_ _23"></span>多，但是可能的最<span class="_ _23"></span>优子树是有限的，<span class="_ _23"></span>因此可以利用最<span class="_ _23"></span>优子树序列中每<span class="_ _23"></span>个子树</div><div class="t m0 x3 h6 y17d ff1 fs2 fc0 sc0 ls0 ws0">与一个<span class="_ _d"> </span><span class="ffd">α<span class="_ _d"> </span></span>有一一对应的关系，以及交叉验证来得到最优的子树<span class="_ _d"> </span><span class="ffd">T</span></div><div class="t m0 xa2 hb y488 ffc fs7 fc0 sc0 ls0 ws0">α</div><div class="t m0 x7d h6 y17d ff1 fs2 fc0 sc0 ls0 ws0">以及对应的剪枝系数<span class="_ _d"> </span><span class="ffd">α</span>。</div><div class="t m0 x3 h6 y88 ff1 fs2 fc0 sc0 ls0 ws0">令<span class="_ _d"> </span><span class="ffd">α</span></div><div class="t m0 x144 ha y528 ff12 fs7 fc0 sc0 ls0 ws0">0</div><div class="t m0 x161 h6 y88 fff fs2 fc0 sc0 ls0 ws0">=<span class="_ _32"> </span>0<span class="ff1">，得到剪枝的起点—<span class="_ _28"></span>—<span class="ffd">T</span></span></div><div class="t m0 x5a ha y528 ff12 fs7 fc0 sc0 ls0 ws0">0</div><div class="t m0 x6e h6 y88 ff1 fs2 fc0 sc0 ls0 ws0">树。</div><div class="t m0 x3 h6 y529 ff1 fs2 fc0 sc0 ls0 ws0">剪枝时，只需要关注当前内部结点<span class="_ _d"> </span><span class="ffd">t<span class="_ _d"> </span></span>和以<span class="_ _d"> </span><span class="ffd">t<span class="_ _d"> </span></span>为根节点的子树<span class="_ _d"> </span><span class="ffd">T</span></div><div class="t m0 xcb hb y52a ffc fs7 fc0 sc0 ls0 ws0">t</div><div class="t m0 x162 h6 y529 ff1 fs2 fc0 sc0 ls0 ws0">即可。</div><div class="t m0 x3 h6 y52b ff1 fs2 fc0 sc0 ls0 ws0">对于<span class="_ _d"> </span><span class="ffd">T</span></div><div class="t m0 x42 ha y52c ff12 fs7 fc0 sc0 ls0 ws0">0</div><div class="t m0 x163 h6 y52b ff1 fs2 fc0 sc0 ls0 ws0">任意内部结点<span class="_ _e"> </span><span class="ffd">t</span>，令其作为<span class="_ _23"></span>叶子结点（剪枝后的情形）<span class="_ _3b"></span>，则对单个叶子结点<span class="_ _e"> </span><span class="ffd">t<span class="_ _d"> </span></span>定<span class="_ _23"></span>义<span class="_ _d"> </span><span class="ff3">cost-</span></div><div class="t m0 x3 h6 y52d ff3 fs2 fc0 sc0 ls0 ws0">complexit<span class="_ _12"></span>y<span class="_ _d"> </span>measure<span class="_ _d"> </span><span class="ff1">如下：</span></div><div class="t m0 xe he y52e ffd fs2 fc0 sc0 ls0 ws0">C</div><div class="t m0 x5b hb y52f ffc fs7 fc0 sc0 ls0 ws0">α</div><div class="t m0 xa9 h4 y52e fff fs2 fc0 sc0 ls0 ws0">(<span class="ffd">t</span>)<span class="_ _32"> </span>=<span class="_ _32"> </span><span class="ffd">C<span class="_ _51"></span></span>(<span class="ffd">t</span>)<span class="_ _37"> </span>+<span class="_ _37"> </span><span class="ffd">α</span></div><div class="t m0 x3 h6 y8e ff1 fs2 fc0 sc0 ls0 ws0">以<span class="_ _d"> </span><span class="ff3">t<span class="_ _d"> </span></span>为根节点的子树<span class="_ _d"> </span><span class="ffd">T</span></div><div class="t m0 x2e hb y360 ffc fs7 fc0 sc0 ls0 ws0">t</div><div class="t m0 x57 h6 y8e ff1 fs2 fc0 sc0 ls0 ws0">（剪枝前的情形）<span class="_ _26"></span>，其<span class="_ _d"> </span><span class="ff3">cost-complexity<span class="_ _25"> </span>measure<span class="_ _d"> </span></span>为：</div><div class="t m0 x72 he y530 ffd fs2 fc0 sc0 ls0 ws0">C</div><div class="t m0 x157 hb y531 ffc fs7 fc0 sc0 ls0 ws0">α</div><div class="t m0 xe h4 y530 fff fs2 fc0 sc0 ls0 ws0">(<span class="ffd">T</span></div><div class="t m0 xc7 hb y531 ffc fs7 fc0 sc0 ls0 ws0">t</div><div class="t m0 xa9 h4 y530 fff fs2 fc0 sc0 ls0 ws0">)<span class="_ _32"> </span>=<span class="_ _32"> </span><span class="ffd">C<span class="_ _51"></span></span>(<span class="ffd">T</span></div><div class="t m0 x5f hb y531 ffc fs7 fc0 sc0 ls0 ws0">t</div><div class="t m0 xd4 h4 y530 fff fs2 fc0 sc0 ls0 ws0">)<span class="_ _37"> </span>+<span class="_ _37"> </span><span class="ffd">α<span class="ffe">|</span></span></div><div class="t m0 xc8 h4 y532 fff fs2 fc0 sc0 ls0 ws0">˜</div><div class="t m0 x25 he y530 ffd fs2 fc0 sc0 ls0 ws0">T</div><div class="t m0 x61 hb y531 ffc fs7 fc0 sc0 ls0 ws0">t</div><div class="t m0 x11d h4 y530 ffe fs2 fc0 sc0 ls0 ws0">|</div><div class="t m0 x3 h6 y533 ff1 fs2 fc0 sc0 ls0 ws0">当<span class="_ _d"> </span><span class="ffd">α<span class="_ _32"> </span><span class="fff">=<span class="_ _32"> </span>0<span class="_ _d"> </span></span></span>及<span class="_ _d"> </span><span class="ffd">α<span class="_ _d"> </span></span>足够小时，以下不等式成立</div><div class="t m0 x4f he y534 ffd fs2 fc0 sc0 ls0 ws0">C</div><div class="t m0 x9d hb y535 ffc fs7 fc0 sc0 ls0 ws0">α</div><div class="t m0 x1 h4 y534 fff fs2 fc0 sc0 ls0 ws0">(<span class="ffd">T</span></div><div class="t m0 x123 hb y535 ffc fs7 fc0 sc0 ls0 ws0">t</div><div class="t m0 x97 h4 y534 fff fs2 fc0 sc0 ls0 ws0">)<span class="_ _32"> </span><span class="ffd">&lt;<span class="_ _32"> </span>C</span></div><div class="t m0 x20 hb y535 ffc fs7 fc0 sc0 ls0 ws0">α</div><div class="t m0 x71 h4 y534 fff fs2 fc0 sc0 ls0 ws0">(<span class="ffd">t</span>)</div><div class="t m0 x3 h6 y536 ff1 fs2 fc0 sc0 ls0 ws0">当<span class="_ _25"> </span><span class="ffd">α<span class="_ _d"> </span></span>增大时<span class="ff3">,<span class="_ _25"> </span></span>在最小<span class="_ _d"> </span><span class="ffd">α<span class="_ _25"> </span></span>处让以下等式成立的结点称为最弱链接<span class="_ _28"></span>（<span class="ff3">weak<span class="_ _28"></span>est<span class="_ _d"> </span>link<span class="ff1">）<span class="_ _26"></span>，<span class="_ _27"></span>因此<span class="_ _d"> </span><span class="ff3">CCP<span class="_ _25"> </span></span>又称</span></span></div><div class="t m0 x3 h6 y537 ff1 fs2 fc0 sc0 ls0 ws0">为<span class="_ _e"> </span><span class="ff3">W<span class="_ _27"></span>eak<span class="_ _12"></span>est-Link<span class="_ _e"> </span>Cutting<span class="ff1">。可能存在<span class="_ _23"></span>多个结点在最<span class="_ _23"></span>小<span class="_ _d"> </span><span class="ffd">α<span class="_ _e"> </span></span>处同时<span class="_ _23"></span>达到相等，因此<span class="_ _23"></span>可能有几个最弱</span></span></div><div class="t m0 x3 h6 y538 ff1 fs2 fc0 sc0 ls0 ws0">链接结点。</div><div class="t m0 x4f he y539 ffd fs2 fc0 sc0 ls0 ws0">C</div><div class="t m0 x9d hb y53a ffc fs7 fc0 sc0 ls0 ws0">α</div><div class="t m0 x1 h4 y539 fff fs2 fc0 sc0 ls0 ws0">(<span class="ffd">T</span></div><div class="t m0 x123 hb y53a ffc fs7 fc0 sc0 ls0 ws0">t</div><div class="t m0 x97 h4 y539 fff fs2 fc0 sc0 ls0 ws0">)<span class="_ _32"> </span>=<span class="_ _32"> </span><span class="ffd">C</span></div><div class="t m0 x20 hb y53a ffc fs7 fc0 sc0 ls0 ws0">α</div><div class="t m0 x71 h4 y539 fff fs2 fc0 sc0 ls0 ws0">(<span class="ffd">t</span>)</div><div class="t m0 x3 h6 y53b ff1 fs2 fc0 sc0 ls0 ws0">当<span class="_ _d"> </span><span class="ffd">α<span class="_ _d"> </span></span>继续增大时，该不等式将反向，即<span class="_ _d"> </span><span class="ffd">C</span></div><div class="t m0 x24 hb y53c ffc fs7 fc0 sc0 ls0 ws0">α</div><div class="t m0 x5c h4 y53b fff fs2 fc0 sc0 ls0 ws0">(<span class="ffd">T</span></div><div class="t m0 x97 hb y53c ffc fs7 fc0 sc0 ls0 ws0">α</div><div class="t m0 xa h4 y53b fff fs2 fc0 sc0 ls0 ws0">)<span class="_ _32"> </span><span class="ffd">&gt;<span class="_ _32"> </span>C</span></div><div class="t m0 x13f hb y53c ffc fs7 fc0 sc0 ls0 ws0">α</div><div class="t m0 x39 h6 y53b fff fs2 fc0 sc0 ls0 ws0">(<span class="ffd">t</span>)<span class="ff1">。</span></div><div class="t m0 x3 h6 y53d ff1 fs2 fc0 sc0 ls0 ws0">只要<span class="_ _25"> </span><span class="ffd">α<span class="_ _32"> </span><span class="fff">=</span></span></div><div class="t m0 x108 ha y53e ffc fs7 fc0 sc0 ls0 ws0">C<span class="_ _23"></span><span class="ff12">(</span>t<span class="ff12">)<span class="ffb">−</span></span>C<span class="_ _23"></span><span class="ff12">(</span>T</div><div class="t m0 xf2 h10 y53f ff13 fs9 fc0 sc0 ls0 ws0">t</div><div class="t m0 xde ha y53e ff12 fs7 fc0 sc0 ls0 ws0">)</div><div class="t m0 x132 ha y540 ffb fs7 fc0 sc0 ls0 ws0">|<span class="ffc">T</span></div><div class="t m0 x114 h10 y541 ff13 fs9 fc0 sc0 ls0 ws0">t</div><div class="t m0 xcc ha y540 ffb fs7 fc0 sc0 ls0 ws0">|−<span class="ff12">1</span></div><div class="t m0 x55 h6 y53d ff1 fs2 fc0 sc0 ls0 ws0">，<span class="_ _29"></span><span class="ffd">T</span></div><div class="t m0 x12f hb y542 ffc fs7 fc0 sc0 ls0 ws0">t</div><div class="t m0 x118 h6 y53d ff1 fs2 fc0 sc0 ls0 ws0">与<span class="_ _25"> </span><span class="ffd">t<span class="_ _25"> </span></span>有相同的<span class="_ _25"> </span><span class="ff3">cost-complexity<span class="_ _25"> </span>measure</span>，<span class="_ _29"></span>而<span class="_ _d"> </span><span class="ffd">t<span class="_ _25"> </span></span>的结点更少，<span class="_ _29"></span>因此<span class="_ _d"> </span><span class="ffd">t<span class="_ _25"> </span></span>比<span class="_ _25"> </span><span class="ffd">T</span></div><div class="t m0 x14e hb y542 ffc fs7 fc0 sc0 ls0 ws0">t</div><div class="t m0 x3 h6 y543 ff1 fs2 fc0 sc0 ls0 ws0">更可取，<span class="_ _28"></span>此时对<span class="_ _25"> </span><span class="ffd">T</span></div><div class="t m0 xf2 hb y544 ffc fs7 fc0 sc0 ls0 ws0">t</div><div class="t m0 x55 h6 y543 ff1 fs2 fc0 sc0 ls0 ws0">进行剪枝，<span class="_ _28"></span>得到<span class="_ _25"> </span><span class="ffd">T</span></div><div class="t m0 x48 ha y544 ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 xe h4 y543 fff fs2 fc0 sc0 ls0 ws0">=<span class="_ _32"> </span><span class="ffd">T</span></div><div class="t m0 x96 ha y544 ff12 fs7 fc0 sc0 ls0 ws0">0</div><div class="t m0 x74 h4 y543 ffe fs2 fc0 sc0 ls0 ws0">−<span class="_ _38"></span><span class="ffd">T</span></div><div class="t m0 x13c hb y544 ffc fs7 fc0 sc0 ls0 ws0">t</div><div class="t m0 x2b h6 y543 ff1 fs2 fc0 sc0 ls0 ws0">。<span class="_ _28"></span>如果存在多个<span class="_ _25"> </span><span class="ff3">weak<span class="_ _12"></span>est<span class="_ _25"> </span>link<span class="ff1">，<span class="_ _28"></span>如<span class="_ _25"> </span><span class="ffd">t<span class="_ _d"> </span></span>和<span class="_ _25"> </span><span class="ffd">t</span></span></span></div><div class="t m0 x164 ha y545 ffb fs7 fc0 sc0 ls0 ws0">′</div><div class="t m0 x165 h6 y543 ff1 fs2 fc0 sc0 ls0 ws0">，<span class="_ _28"></span>则剪</div><div class="t m0 x3 h6 y546 ff1 fs2 fc0 sc0 ls0 ws0">去所有<span class="_ _d"> </span><span class="ff3">w<span class="_ _12"></span>eak<span class="_ _12"></span>est<span class="_ _d"> </span>link<span class="ff1">，即<span class="_ _d"> </span><span class="ffd">T</span></span></span></div><div class="t m0 x3f ha y547 ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 xd7 h4 y546 fff fs2 fc0 sc0 ls0 ws0">=<span class="_ _32"> </span><span class="ffd">T</span></div><div class="t m0 xca ha y547 ff12 fs7 fc0 sc0 ls0 ws0">0</div><div class="t m0 x104 h4 y546 ffe fs2 fc0 sc0 ls0 ws0">−<span class="_ _37"> </span><span class="ffd">T</span></div><div class="t m0 xf3 hb y547 ffc fs7 fc0 sc0 ls0 ws0">t</div><div class="t m0 x28 h4 y546 ffe fs2 fc0 sc0 ls0 ws0">−<span class="_ _37"> </span><span class="ffd">T</span></div><div class="t m0 x166 hb y548 ffc fs7 fc0 sc0 ls0 ws0">t</div><div class="t m0 xf4 h1f y549 ff17 fs9 fc0 sc0 ls0 ws0">′</div><div class="t m0 x4 h6 y546 ff1 fs2 fc0 sc0 ls0 ws0">。</div><div class="t m0 x12 h6 y54a ff1 fs2 fc0 sc0 ls0 ws0">具体来<span class="_ _23"></span>说，<span class="ffd">T</span></div><div class="t m0 xe5 hb y54b ffc fs7 fc0 sc0 ls0 ws0">t</div><div class="t m0 x167 h6 y54a ff1 fs2 fc0 sc0 ls0 ws0">和<span class="_ _e"> </span><span class="ffd">T</span></div><div class="t m0 xb4 hb y54c ffc fs7 fc0 sc0 ls0 ws0">t</div><div class="t m0 x10c h1f y54d ff17 fs9 fc0 sc0 ls0 ws0">′</div><div class="t m0 x3e h6 y54a ff1 fs2 fc0 sc0 ls0 ws0">可能存<span class="_ _23"></span>在嵌套关<span class="_ _23"></span>系，如<span class="_ _e"> </span><span class="ffd">T</span></div><div class="t m0 xaa hb y54c ffc fs7 fc0 sc0 ls0 ws0">t</div><div class="t m0 x13e h1f y54d ff17 fs9 fc0 sc0 ls0 ws0">′</div><div class="t m0 x20 h6 y54a ff1 fs2 fc0 sc0 ls0 ws0">是<span class="_ _e"> </span><span class="ffd">T</span></div><div class="t m0 xab hb y54b ffc fs7 fc0 sc0 ls0 ws0">t</div><div class="t m0 x1f h6 y54a ff1 fs2 fc0 sc0 ls0 ws0">的子树，<span class="_ _23"></span>此时只需<span class="_ _23"></span>要剪掉<span class="_ _e"> </span><span class="ffd">T</span></div><div class="t m0 x84 hb y54b ffc fs7 fc0 sc0 ls0 ws0">t</div><div class="t m0 x67 h6 y54a ff1 fs2 fc0 sc0 ls0 ws0">即可。</div><div class="t m0 x12 he y54e ffd fs2 fc0 sc0 ls0 ws0">T</div><div class="t m0 xe1 hb y54f ffc fs7 fc0 sc0 ls0 ws0">t</div><div class="t m0 x13 h6 y54e ff1 fs2 fc0 sc0 ls0 ws0">和<span class="_ _d"> </span><span class="ffd">T</span></div><div class="t m0 x12c hb y550 ffc fs7 fc0 sc0 ls0 ws0">t</div><div class="t m0 x168 h1f y551 ff17 fs9 fc0 sc0 ls0 ws0">′</div><div class="t m0 x132 h6 y54e ff1 fs2 fc0 sc0 ls0 ws0">也可能是没有公共结点的，此时需要剪掉<span class="_ _d"> </span><span class="ffd">T</span></div><div class="t m0 x14f hb y54f ffc fs7 fc0 sc0 ls0 ws0">t</div><div class="t m0 x79 h6 y54e ff1 fs2 fc0 sc0 ls0 ws0">和<span class="_ _d"> </span><span class="ffd">T</span></div><div class="t m0 x140 hb y550 ffc fs7 fc0 sc0 ls0 ws0">t</div><div class="t m0 xad h1f y551 ff17 fs9 fc0 sc0 ls0 ws0">′</div><div class="t m0 x169 h6 y54e ff1 fs2 fc0 sc0 ls0 ws0">。</div><div class="t m0 x3 h6 y552 ff1 fs2 fc0 sc0 ls0 ws0">定义如下函数<span class="_ _d"> </span><span class="ffd">g</span></div><div class="t m0 xe5 ha y553 ff12 fs7 fc0 sc0 ls0 ws0">0</div><div class="t m0 xdd h6 y552 fff fs2 fc0 sc0 ls0 ws0">(<span class="ffd">t</span>)<span class="ff1">，其中<span class="_ _d"> </span><span class="ffd">t<span class="_ _32"> </span><span class="ffe">∈<span class="_ _32"> </span></span>T</span></span></div><div class="t m0 xd8 ha y553 ff12 fs7 fc0 sc0 ls0 ws0">0</div><div class="t m0 x5a he y554 ffd fs2 fc0 sc0 ls0 ws0">g</div><div class="t m0 x9b ha y555 ff12 fs7 fc0 sc0 ls0 ws0">0</div><div class="t m0 x22 h4 y554 fff fs2 fc0 sc0 ls0 ws0">(<span class="ffd">t</span>)</div><div class="t m0 x95 hc y556 ff11 fs2 fc0 sc0 ls0 ws0">(</div><div class="t m0 x166 ha y557 ffc fs7 fc0 sc0 ls0 ws0">R<span class="ff12">(</span>t<span class="ff12">)<span class="ffb">−</span></span>R<span class="ff12">(</span>T</div><div class="t m0 x5f h10 y558 ff13 fs9 fc0 sc0 ls0 ws0">t</div><div class="t m0 xd4 ha y557 ff12 fs7 fc0 sc0 ls0 ws0">)</div><div class="t m0 xc2 h4 y559 ffe fs2 fc0 sc0 ls0 ws0">|</div><div class="t m0 xd9 ha y55a ff12 fs7 fc0 sc0 ls0 ws0">˜</div><div class="t m0 x100 hb y55b ffc fs7 fc0 sc0 ls0 ws0">T</div><div class="t m0 x65 h10 y55c ff13 fs9 fc0 sc0 ls0 ws0">t</div><div class="t m0 xc3 h4 y559 ffe fs2 fc0 sc0 ls0 ws0">|</div><div class="t m0 xa ha y55b ffb fs7 fc0 sc0 ls0 ws0">−<span class="ff12">1</span></div><div class="t m0 x20 h4 y55d ffd fs2 fc0 sc0 ls0 ws0">,<span class="_ _8"> </span>t<span class="_ _e"> </span><span class="fff">/<span class="_ _56"></span><span class="ffe">∈</span></span></div><div class="t m0 x112 h4 y55e fff fs2 fc0 sc0 ls0 ws0">˜</div><div class="t m0 x61 he y55d ffd fs2 fc0 sc0 ls0 ws0">T</div><div class="t m0 xea ha y55f ff12 fs7 fc0 sc0 ls0 ws0">0</div><div class="t m0 x34 h4 y560 fff fs2 fc0 sc0 ls0 ws0">+<span class="ffe">∞<span class="ffd">,<span class="_ _43"> </span>t<span class="_ _32"> </span></span>∈</span></div><div class="t m0 x112 h4 y561 fff fs2 fc0 sc0 ls0 ws0">˜</div><div class="t m0 x61 he y560 ffd fs2 fc0 sc0 ls0 ws0">T</div><div class="t m0 xea ha y562 ff12 fs7 fc0 sc0 ls0 ws0">0</div><div class="t m0 x3 h6 y563 ff1 fs2 fc0 sc0 ls0 ws0">树<span class="_ _d"> </span><span class="ffd">T</span></div><div class="t m0 xe1 ha y564 ff12 fs7 fc0 sc0 ls0 ws0">0</div><div class="t m0 x161 h6 y563 ff1 fs2 fc0 sc0 ls0 ws0">中的<span class="_ _d"> </span><span class="ff3">w<span class="_ _12"></span>eak<span class="_ _12"></span>est<span class="_ _d"> </span>link<span class="_ _d"> </span><span class="ffd">t</span></span></div><div class="t m0 x4b ha y564 ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 x38 h6 y563 ff1 fs2 fc0 sc0 ls0 ws0">对应的最小<span class="_ _d"> </span><span class="ffd">g</span></div><div class="t m0 x80 ha y564 ff12 fs7 fc0 sc0 ls0 ws0">0</div><div class="t m0 x9d h6 y563 fff fs2 fc0 sc0 ls0 ws0">(<span class="ffd">t</span>)<span class="_ _d"> </span><span class="ff1">值为<span class="_ _d"> </span><span class="ffd">g</span></span></div><div class="t m0 xcf ha y564 ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 x36 h4 y563 fff fs2 fc0 sc0 ls0 ws0">(<span class="ffd">t</span></div><div class="t m0 xe0 ha y564 ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 x37 h4 y563 fff fs2 fc0 sc0 ls0 ws0">)<span class="_ _32"> </span>=<span class="_ _3d"> </span><span class="ff3">min</span></div><div class="t m0 x3a ha y565 ffc fs7 fc0 sc0 ls0 ws0">t<span class="ffb">∈</span>T</div><div class="t m0 xeb h1c y566 ff16 fs9 fc0 sc0 ls0 ws0">0</div><div class="t m0 x11e he y563 ffd fs2 fc0 sc0 ls0 ws0">g</div><div class="t m0 x7c ha y564 ff12 fs7 fc0 sc0 ls0 ws0">0</div><div class="t m0 x16a h6 y563 fff fs2 fc0 sc0 ls0 ws0">(<span class="ffd">t</span>)<span class="ff1">，得到<span class="_ _d"> </span><span class="ffd">α</span></span></div><div class="t m0 x16b ha y564 ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 x16c h4 y563 fff fs2 fc0 sc0 ls0 ws0">=<span class="_ _32"> </span><span class="ffd">g</span></div><div class="t m0 x8e ha y564 ff12 fs7 fc0 sc0 ls0 ws0">0</div><div class="t m0 x18 h4 y563 fff fs2 fc0 sc0 ls0 ws0">(<span class="ffd">t</span></div><div class="t m0 x16d ha y564 ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 x16e h6 y563 fff fs2 fc0 sc0 ls0 ws0">)<span class="ff1">。</span></div><div class="t m0 x3 h6 y567 ff1 fs2 fc0 sc0 ls0 ws0">重复上述步骤，使用<span class="_ _d"> </span><span class="ffd">T</span></div><div class="t m0 x10c ha y568 ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 x118 h6 y567 ff1 fs2 fc0 sc0 ls0 ws0">代替<span class="_ _d"> </span><span class="ffd">T</span></div><div class="t m0 x133 ha y568 ff12 fs7 fc0 sc0 ls0 ws0">0</div><div class="t m0 x2 h6 y567 ff1 fs2 fc0 sc0 ls0 ws0">作为第三轮剪枝的出发点。</div><div class="t m0 x3 h32 y569 ff9 fsc fc0 sc0 ls0 ws0">计算</div><div class="t m0 x3 h6 y56a ff1 fs2 fc0 sc0 ls0 ws0">在计算方面，我们需要为每个节点存储一些值。</div><div class="t m0 x15 h6 y56b ff3 fs2 fc0 sc0 ls0 ws0">•<span class="_ _5"> </span><span class="ffd">C<span class="_ _23"></span><span class="fff">(</span>t<span class="fff">)<span class="ff1">，结点<span class="_ _d"> </span></span></span></span>t<span class="_ _d"> </span><span class="ff1">的<span class="_ _d"> </span></span>resubstitution<span class="_ _d"> </span>error<span class="_ _d"> </span>rate<span class="ff1">，这只需要计算一次。</span></div><div class="t m0 x15 h4 y56c ff3 fs2 fc0 sc0 ls0 ws0">•<span class="_ _5"> </span><span class="ffd">C<span class="_ _23"></span><span class="fff">(</span>T</span></div><div class="t m0 xee hb y56d ffc fs7 fc0 sc0 ls0 ws0">t</div><div class="t m0 x10b h6 y56c fff fs2 fc0 sc0 ls0 ws0">)<span class="ff1">，<span class="_ _2a"></span>以结点<span class="_ _25"> </span><span class="ff3">t </span>为根节点的子树<span class="_ _25"> </span><span class="ffd">T</span></span></div><div class="t m0 x80 hb y56d ffc fs7 fc0 sc0 ls0 ws0">t</div><div class="t m0 x33 h6 y56c ff1 fs2 fc0 sc0 ls0 ws0">的<span class="_ _32"> </span><span class="ff3">resubstitution<span class="_ _25"> </span>error rate</span>。<span class="_ _2e"></span>剪枝后可能需要更新，<span class="_ _2e"></span>因</div><div class="t m0 x13 h6 y56e ff1 fs2 fc0 sc0 ls0 ws0">为剪枝后<span class="_ _d"> </span><span class="ffd">T</span></div><div class="t m0 x54 hb y56f ffc fs7 fc0 sc0 ls0 ws0">t</div><div class="t m0 xd5 h6 y56e ff1 fs2 fc0 sc0 ls0 ws0">可能会改变。</div><div class="t m0 x15 h4 y570 ff3 fs2 fc0 sc0 ls0 ws0">•<span class="_ _5"> </span><span class="ffe">|<span class="ffd">T</span></span></div><div class="t m0 x43 hb y571 ffc fs7 fc0 sc0 ls0 ws0">t</div><div class="t m0 xb1 h6 y570 ffe fs2 fc0 sc0 ls0 ws0">|<span class="ff1">，以结点<span class="_ _d"> </span><span class="ff3">t<span class="_ _d"> </span></span>为根节点的子树<span class="_ _d"> </span><span class="ffd">T</span></span></div><div class="t m0 x95 hb y571 ffc fs7 fc0 sc0 ls0 ws0">t</div><div class="t m0 x80 h6 y570 ff1 fs2 fc0 sc0 ls0 ws0">的叶节点总数。剪枝后可能需要对其进行更新。</div><div class="t m0 x3 h4 y3 ff3 fs2 fc0 sc0 ls0 ws0">34</div></div><div class="pi" data-data='{"ctm":[1.500000,0.000000,0.000000,1.500000,0.000000,0.000000]}'></div></div>
<div id="pf29" class="pf w0 h0" data-page-no="29"><div class="pc pc29 w0 h0"><img class="bi x3 y2a0 w1 h37" alt="" src="bg29.png"/><div class="t m0 x16b h7 y21 ff3 fs5 fc0 sc0 ls0 ws0">5.7<span class="_ _8"> </span><span class="ff7">多变量决策树</span></div><div class="t m0 x3 h32 y572 ff21 fsc fc0 sc0 ls0 ws0">CAR<span class="_ _30"></span>T<span class="_ _35"> </span><span class="ff9">剪枝算法</span></div><div class="t m0 x3 h4 y573 ff6 fs2 fc0 sc0 ls0 ws0">Algorithm<span class="_ _e"> </span>2:<span class="_ _d"> </span><span class="ff3">CAR<span class="_ _28"></span>T<span class="_ _d"> </span>prune</span></div><div class="t m0 x3 h26 y574 ff6 fs5 fc0 sc0 ls0 ws0">Input:<span class="_ _1e"> </span><span class="ff1">基于所有训练数据，使用<span class="_ _25"> </span><span class="ff3">CAR<span class="_ _28"></span>T<span class="_ _32"> </span><span class="ff1">算法生成的完整决策树<span class="_ _25"> </span><span class="ffd">T</span></span></span></span></div><div class="t m0 x149 h27 y575 ff18 fsa fc0 sc0 ls0 ws0">0</div><div class="t m0 x105 h26 y576 ff1a fsb fc0 sc0 ls0 ws0">1<span class="_ _5"> </span><span class="ff1 fs5">设<span class="_ _32"> </span><span class="ffd">k<span class="_ _25"> </span><span class="fff">=<span class="_ _a"> </span>1</span></span>，<span class="ffd">T<span class="_ _e"> </span><span class="fff">=<span class="_ _a"> </span></span>T</span></span></div><div class="t m0 x3b h27 y577 ff18 fsa fc0 sc0 ls0 ws0">1</div><div class="t m0 x105 h26 y578 ff1a fsb fc0 sc0 ls0 ws0">2<span class="_ _5"> </span><span class="ff1 fs5">设<span class="_ _32"> </span><span class="ffd">α<span class="_ _32"> </span><span class="fff">=<span class="_ _a"> </span>+<span class="ffe">∞</span></span></span></span></div><div class="t m0 x105 h26 y579 ff1a fsb fc4 sc0 ls0 ws0">3<span class="_ _5"> </span><span class="ff1 fs5">自下而上<span class="fc0">地对各内部结点<span class="_ _32"> </span><span class="ffd">t<span class="_ _25"> </span></span>计算<span class="_ _25"> </span><span class="ffd">C<span class="_ _37"> </span><span class="fff">(</span>T</span></span></span></div><div class="t m0 x4e h2a y57a ff19 fsa fc0 sc0 ls0 ws0">t</div><div class="t m0 x9b h29 y579 fff fs5 fc0 sc0 ls0 ws0">)<span class="_ _33"> </span><span class="ffd">,<span class="_ _45"> </span><span class="ffe">|</span></span></div><div class="t m0 x4f h29 y57b fff fs5 fc0 sc0 ls0 ws0">˜</div><div class="t m0 x16 h28 y579 ffd fs5 fc0 sc0 ls0 ws0">T</div><div class="t m0 x23 h2a y57a ff19 fsa fc0 sc0 ls0 ws0">t</div><div class="t m0 x33 h26 y579 ffe fs5 fc0 sc0 ls0 ws0">|<span class="_ _25"> </span><span class="ff1">以及</span></div><div class="t m0 x47 h29 y57c ffd fs5 fc0 sc0 ls0 ws0">g<span class="_ _23"></span><span class="fff">(</span>t<span class="fff">)<span class="_ _37"> </span>=</span></div><div class="t m0 x5d h29 y57d ffd fs5 fc0 sc0 ls0 ws0">C<span class="_ _51"></span><span class="fff">(</span>t<span class="fff">)<span class="_ _38"> </span><span class="ffe">−<span class="_ _38"> </span></span></span>C<span class="_ _37"> </span><span class="fff">(</span>T</div><div class="t m0 x60 h2a y57e ff19 fsa fc0 sc0 ls0 ws0">t</div><div class="t m0 x99 h29 y57d fff fs5 fc0 sc0 ls0 ws0">)</div><div class="t m0 x65 h29 y57f ffe fs5 fc0 sc0 ls0 ws0">|</div><div class="t m0 x5e h29 y580 fff fs5 fc0 sc0 ls0 ws0">˜</div><div class="t m0 x53 h28 y57f ffd fs5 fc0 sc0 ls0 ws0">T</div><div class="t m0 x81 h2a y581 ff19 fsa fc0 sc0 ls0 ws0">t</div><div class="t m0 x70 h29 y57f ffe fs5 fc0 sc0 ls0 ws0">|<span class="_ _38"> </span>−<span class="_ _37"> </span><span class="fff">1</span></div><div class="t m0 x2f h29 y582 ffd fs5 fc0 sc0 ls0 ws0">α<span class="_ _a"> </span><span class="fff">=<span class="_ _a"> </span><span class="ff3">min</span>(</span>α,<span class="_ _33"> </span>g<span class="_ _23"></span><span class="fff">(</span>t<span class="fff">))</span></div><div class="t m0 x3 h26 y583 ff1 fs5 fc0 sc0 ls0 ws0">这里，<span class="ffd">T</span></div><div class="t m0 x43 h2a y584 ff19 fsa fc0 sc0 ls0 ws0">t</div><div class="t m0 x14c h26 y583 ff1 fs5 fc0 sc0 ls0 ws0">表示以<span class="_ _25"> </span><span class="ffd">t<span class="_ _25"> </span></span>为根结点的子树，<span class="ffd">C<span class="_ _37"> </span><span class="fff">(</span>T</span></div><div class="t m0 xd6 h2a y584 ff19 fsa fc0 sc0 ls0 ws0">t</div><div class="t m0 x95 h26 y583 fff fs5 fc0 sc0 ls0 ws0">)<span class="_ _25"> </span><span class="ff1">是对训练数据的预测误差，<span class="ffe">|</span></span></div><div class="t m0 x12b h29 y585 fff fs5 fc0 sc0 ls0 ws0">˜</div><div class="t m0 x153 h28 y583 ffd fs5 fc0 sc0 ls0 ws0">T</div><div class="t m0 x15e h2a y584 ff19 fsa fc0 sc0 ls0 ws0">t</div><div class="t m0 x135 h26 y583 ffe fs5 fc0 sc0 ls0 ws0">|<span class="_ _25"> </span><span class="ff1">是<span class="_ _25"> </span><span class="ffd">T</span></span></div><div class="t m0 x16f h2a y584 ff19 fsa fc0 sc0 ls0 ws0">t</div><div class="t m0 x121 h26 y583 ff1 fs5 fc0 sc0 ls0 ws0">的叶结点个数<span class="ff3">.</span></div><div class="t m0 x105 h26 y586 ff1a fsb fc4 sc0 ls0 ws0">4<span class="_ _5"> </span><span class="ff1 fs5">自上而下<span class="fc0">地访问内部结点<span class="_ _32"> </span><span class="ffd">t</span>，如果有<span class="_ _25"> </span><span class="ffd">g<span class="_ _23"></span><span class="fff">(</span>t<span class="fff">)<span class="_ _a"> </span>=<span class="_ _a"> </span></span>α</span>，进行剪枝，并对叶结点<span class="_ _25"> </span><span class="ffd">t<span class="_ _25"> </span></span>以多数表决法决定其类，得</span></span></div><div class="t m0 x3 h26 y587 ff1 fs5 fc0 sc0 ls0 ws0">到树<span class="_ _25"> </span><span class="ff3">T.</span></div><div class="t m0 x105 h26 y588 ff1a fsb fc0 sc0 ls0 ws0">5<span class="_ _5"> </span><span class="ff1 fs5">设<span class="_ _32"> </span><span class="ffd">k<span class="_ _25"> </span><span class="fff">=<span class="_ _a"> </span></span>k<span class="_ _37"> </span><span class="fff">+<span class="_ _38"> </span>1</span>,<span class="_ _45"> </span>α</span></span></div><div class="t m0 xe5 h2a y589 ff19 fsa fc0 sc0 ls0 ws0">k</div><div class="t m0 x167 h29 y588 fff fs5 fc0 sc0 ls0 ws0">=<span class="_ _a"> </span><span class="ffd">α,<span class="_ _45"> </span>T</span></div><div class="t m0 x4b h2a y589 ff19 fsa fc0 sc0 ls0 ws0">k</div><div class="t m0 xce h29 y588 fff fs5 fc0 sc0 ls0 ws0">=<span class="_ _a"> </span><span class="ffd">T</span></div><div class="t m0 x105 h26 y58a ff1a fsb fc0 sc0 ls0 ws0">6<span class="_ _5"> </span><span class="ff1 fs5">如果<span class="_ _32"> </span><span class="ffd">T</span></span></div><div class="t m0 x161 h2a y58b ff19 fsa fc0 sc0 ls0 ws0">k</div><div class="t m0 xb8 h26 y58a ff1 fs5 fc0 sc0 ls0 ws0">不是由根结点及两个叶结点构成的树，则回到步骤<span class="_ _25"> </span><span class="ff3">(2);<span class="_ _25"> </span></span>否则令<span class="_ _25"> </span><span class="ffd">T</span></div><div class="t m0 x7d h2a y58b ff19 fsa fc0 sc0 ls0 ws0">k</div><div class="t m0 x102 h29 y58a fff fs5 fc0 sc0 ls0 ws0">=<span class="_ _a"> </span><span class="ffd">T</span></div><div class="t m0 x11a h2a y58b ff19 fsa fc0 sc0 ls0 ws0">n</div><div class="t m0 x105 h26 y58c ff1a fsb fc0 sc0 ls0 ws0">7<span class="_ _5"> </span><span class="ff1 fs5">采用交叉验证法在子树序列<span class="_ _32"> </span><span class="ffd">T</span></span></div><div class="t m0 xce h27 y58d ff18 fsa fc0 sc0 ls0 ws0">0</div><div class="t m0 x50 h28 y58c ffd fs5 fc0 sc0 ls0 ws0">,<span class="_ _33"> </span>T</div><div class="t m0 x0 h27 y58d ff18 fsa fc0 sc0 ls0 ws0">1</div><div class="t m0 x9a h29 y58c ffd fs5 fc0 sc0 ls0 ws0">,<span class="_ _33"> </span><span class="ffe">·<span class="_ _31"></span>·<span class="_ _33"></span>·<span class="_ _25"> </span></span>,<span class="_ _33"> </span>T</div><div class="t m0 x48 h2a y58d ff19 fsa fc0 sc0 ls0 ws0">n</div><div class="t m0 x94 h26 y58c ff1 fs5 fc0 sc0 ls0 ws0">中选取最优子树<span class="_ _25"> </span><span class="ffd">T</span></div><div class="t m0 x14f h2a y58d ff19 fsa fc0 sc0 ls0 ws0">α</div><div class="t m0 x3 h26 y58e ff6 fs5 fc0 sc0 ls0 ws0">Output:<span class="_ _1e"> </span><span class="ff1">最优决策树<span class="_ _25"> </span><span class="ffd">T</span></span></div><div class="t m0 x2d h2a y58f ff19 fsa fc0 sc0 ls0 ws0">α</div><div class="t m0 x3 h6 y590 ff1 fs2 fc0 sc0 ls0 ws0">在步骤<span class="_ _25"> </span><span class="ff3">3<span class="_ _25"> </span></span>中，<span class="_ _30"></span>自下而上地计算<span class="_ _25"> </span><span class="ffd">g<span class="_ _23"></span><span class="fff">(</span>t<span class="fff">)<span class="_ _25"> </span></span></span>是因为要计算<span class="_ _25"> </span><span class="ffd">T</span></div><div class="t m0 xd4 hb y591 ffc fs7 fc0 sc0 ls0 ws0">t</div><div class="t m0 x36 h6 y590 ff1 fs2 fc0 sc0 ls0 ws0">的叶子结点数</div><div class="t m0 x7d hc y592 ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x7d hc y593 ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x7d hc y594 ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x135 h4 y595 fff fs2 fc0 sc0 ls0 ws0">˜</div><div class="t m0 xd0 he y590 ffd fs2 fc0 sc0 ls0 ws0">T</div><div class="t m0 x14b hb y591 ffc fs7 fc0 sc0 ls0 ws0">t</div><div class="t m0 x170 hc y592 ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x170 hc y593 ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x170 hc y594 ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 xa4 h6 y590 ff1 fs2 fc0 sc0 ls0 ws0">。<span class="_ _30"></span>因为任何内部结点的叶</div><div class="t m0 x3 h6 y596 ff1 fs2 fc0 sc0 ls0 ws0">子结<span class="_ _23"></span>点数等<span class="_ _23"></span>于左子<span class="_ _23"></span>结点的<span class="_ _23"></span>叶节点<span class="_ _23"></span>数加<span class="_ _23"></span>上右子<span class="_ _23"></span>结点的<span class="_ _23"></span>叶节点<span class="_ _23"></span>数，而自<span class="_ _23"></span>底向上<span class="_ _23"></span>地计算<span class="_ _23"></span>可以<span class="_ _23"></span>确保先<span class="_ _23"></span>计</div><div class="t m0 x3 h6 y597 ff1 fs2 fc0 sc0 ls0 ws0">算子结点的叶结点数，再计算父结点的叶结点数。</div><div class="t m0 x3 h6 y598 ff1 fs2 fc0 sc0 ls0 ws0">在步骤<span class="_ _e"> </span><span class="ff3">4<span class="_ _1e"> </span></span>中，自上而<span class="_ _23"></span>下地剪枝<span class="_ _23"></span>是因为可能<span class="_ _23"></span>存在多个<span class="_ _e"> </span><span class="ff3">weak<span class="_ _28"></span>est-link<span class="_ _1e"> </span><span class="ff1">结点，而剪<span class="_ _23"></span>枝后需要<span class="_ _23"></span>得到最小</span></span></div><div class="t m0 x3 h6 y599 ff1 fs2 fc0 sc0 ls0 ws0">的最优子树<span class="_ _d"> </span><span class="ffd">T</span></div><div class="t m0 x7f hb y59a ffc fs7 fc0 sc0 ls0 ws0">α</div><div class="t m0 xe4 h6 y599 ff1 fs2 fc0 sc0 ls0 ws0">，先剪掉最上层的<span class="_ _e"> </span><span class="ff3">w<span class="_ _12"></span>eak<span class="_ _12"></span>est-link<span class="_ _d"> </span><span class="ff1">结点可以保证最<span class="_ _23"></span>少的剪枝次数，以及最优子树是</span></span></div><div class="t m0 x3 h6 y59b ff1 fs2 fc0 sc0 ls0 ws0">最小的。</div><div class="t m0 x3 h4 y59c ffe fs2 fc0 sc0 ls0 ws0">{<span class="ffd">α</span></div><div class="t m0 x171 hb y59d ffc fs7 fc0 sc0 ls0 ws0">k</div><div class="t m0 x13a h6 y59c ffe fs2 fc0 sc0 ls0 ws0">}<span class="_ _25"> </span><span class="ff1">是严格递增的序列，<span class="_ _28"></span>因为在每一轮剪枝中，<span class="_ _28"></span>可以得到更小的<span class="_ _25"> </span><span class="ffd">α<span class="_ _d"> </span></span>值的内部结点已经在上一轮</span></div><div class="t m0 x3 h6 y59e ff1 fs2 fc0 sc0 ls0 ws0">剪枝中被剪掉。</div><div class="t m0 x3 h6 y59f ff1 fs2 fc0 sc0 ls0 ws0">最后一步<span class="_ _23"></span>的交叉验证是对<span class="_ _e"> </span><span class="ffe">{<span class="ffd">α</span></span></div><div class="t m0 x129 hb y5a0 ffc fs7 fc0 sc0 ls0 ws0">k</div><div class="t m0 xe7 h6 y59f ffe fs2 fc0 sc0 ls0 ws0">}<span class="_ _e"> </span><span class="ff1">序列中每一<span class="_ _23"></span>个<span class="_ _d"> </span><span class="ffd">α<span class="_ _e"> </span></span>进行交叉<span class="_ _23"></span>验证，即采用训<span class="_ _23"></span>练集重新生成<span class="_ _e"> </span><span class="ff3">CAR<span class="_ _27"></span>T</span></span></div><div class="t m0 x3 h6 y5a1 ff1 fs2 fc0 sc0 ls0 ws0">树，使用<span class="_ _1e"> </span><span class="ffe">{<span class="ffd">α</span></span></div><div class="t m0 xe3 hb y5a2 ffc fs7 fc0 sc0 ls0 ws0">k</div><div class="t m0 x114 h6 y5a1 ffe fs2 fc0 sc0 ls0 ws0">}<span class="_ _e"> </span><span class="ff1">序<span class="_ _23"></span>列中每一<span class="_ _23"></span>个<span class="_ _e"> </span><span class="ffd">α<span class="_ _e"> </span></span>进<span class="_ _23"></span>行剪枝，得<span class="_ _23"></span>到新的<span class="_ _1e"> </span></span>{<span class="ffd">T</span></div><div class="t m0 x79 ha y5a3 ffb fs7 fc0 sc0 ls0 ws0">′</div><div class="t m0 x158 hb y5a4 ffc fs7 fc0 sc0 ls0 ws0">α</div><div class="t m0 x112 h6 y5a1 ffe fs2 fc0 sc0 ls0 ws0">}<span class="_ _e"> </span><span class="ff1">序<span class="_ _23"></span>列。在验证<span class="_ _23"></span>集上测试<span class="_ _1e"> </span></span>{<span class="ffd">T</span></div><div class="t m0 x67 ha y5a3 ffb fs7 fc0 sc0 ls0 ws0">′</div><div class="t m0 x16e hb y5a4 ffc fs7 fc0 sc0 ls0 ws0">α</div><div class="t m0 x164 h6 y5a1 ffe fs2 fc0 sc0 ls0 ws0">}<span class="_ _e"> </span><span class="ff1">序<span class="_ _23"></span>列，</span></div><div class="t m0 x3 h6 y5a5 ff1 fs2 fc0 sc0 ls0 ws0">最终得到最佳的<span class="_ _d"> </span><span class="ffd">α<span class="_ _d"> </span></span>值，然后返回<span class="_ _d"> </span><span class="ffe">{<span class="ffd">T</span></span></div><div class="t m0 x172 hb y5a6 ffc fs7 fc0 sc0 ls0 ws0">α</div><div class="t m0 x48 h6 y5a5 ffe fs2 fc0 sc0 ls0 ws0">}<span class="_ _d"> </span><span class="ff1">序列选取<span class="_ _d"> </span><span class="ffd">T</span></span></div><div class="t m0 x128 hb y5a6 ffc fs7 fc0 sc0 ls0 ws0">α</div><div class="t m0 xd2 h6 y5a5 ff1 fs2 fc0 sc0 ls0 ws0">树。</div><div class="t m0 x104 h9 y5a7 ff5 fs6 fc0 sc0 ls0 ws0">5.7<span class="_ _24"> </span><span class="ff9">多变量决策树</span></div><div class="t m0 x3 h6 y35a ff1 fs2 fc0 sc0 ls0 ws0">若把每个属性视为坐标<span class="_ _23"></span>空间中的一个坐标轴，则拥有<span class="_ _d"> </span><span class="ff3">d<span class="_ _e"> </span></span>个属性的样本就对应了<span class="_ _e"> </span><span class="ff3">d<span class="_ _d"> </span></span>维空间中的<span class="_ _23"></span>一</div><div class="t m0 x3 h6 y2cc ff1 fs2 fc0 sc0 ls0 ws0">个数据点，对样本分类则意味着在这个坐标空间中寻找不同类样本之间的分类边界。</div><div class="t m0 x3 h6 y18d ff1 fs2 fc0 sc0 ls0 ws0">前面提到的决策树都是单变量决策树<span class="_ _12"></span>（<span class="ff3">univ<span class="_ _28"></span>ariate<span class="_ _d"> </span>decision<span class="_ _d"> </span>tree<span class="ff1">）<span class="_ _26"></span>，<span class="_ _12"></span>即在每个内部结点做判定时都</span></span></div><div class="t m0 x3 h6 y18e ff1 fs2 fc0 sc0 ls0 ws0">只用到一个属性。<span class="_ _2e"></span>单变量决策树所形成的分类边界有一个明显的特点：<span class="_ _2d"></span>轴平行<span class="_ _32"> </span><span class="ff3">(axis-parallel)</span>，<span class="_ _2a"></span>即</div><div class="t m0 x3 h6 y20 ff1 fs2 fc0 sc0 ls0 ws0">它的分类边界由若干个与坐标轴平行的分段组成。如图<span class="ff3">5.2</span>所示。</div><div class="t m0 xbc h4 y3 ff3 fs2 fc0 sc0 ls0 ws0">35</div><a class="l" href="#pf2a" data-dest-detail='[42,"XYZ",70.87,806.14,null]'><div class="d m1" style="border-style:none;position:absolute;left:499.026000px;bottom:59.034000px;width:13.942000px;height:15.458000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.500000,0.000000,0.000000,1.500000,0.000000,0.000000]}'></div></div>
<div id="pf2a" class="pf w0 h0" data-page-no="2a"><div class="pc pc2a w0 h0"><img class="bi x9a y5a8 w10 h38" alt="" src="bg2a.png"/><div class="t m0 x3 h7 y21 ff3 fs5 fc0 sc0 ls0 ws0">5.8<span class="_ _8"> </span><span class="ff7">总结</span></div><div class="t m0 x133 h6 y5a9 ff1 fs2 fc0 sc0 ls0 ws0">图<span class="_ _d"> </span><span class="ff3">5.2:<span class="_ _35"> </span></span>单变量决策树的分类边界</div><div class="t m0 x3 h6 y5aa ff1 fs2 fc0 sc0 ls0 ws0">这相当<span class="_ _23"></span>于假设样本的<span class="_ _23"></span>各属性之间<span class="_ _23"></span>是没有关联<span class="_ _23"></span>的，所以各坐<span class="_ _23"></span>标轴是相互垂<span class="_ _23"></span>直的。这样有<span class="_ _23"></span>一个弊端：</div><div class="t m0 x3 h6 y5ab ff1 fs2 fc0 sc0 ls0 ws0">如果真实分类边界特别复杂，<span class="_ _3a"></span>就需要画出很多超平面，<span class="_ _29"></span>在预测时就需要继续大量的属性测试<span class="_ _30"></span>（遍</div><div class="t m0 x3 h6 y5ac ff1 fs2 fc0 sc0 ls0 ws0">历决策树）才能得到结果，预测时间开销很大。</div><div class="t m0 x3 h6 y5ad ff1 fs2 fc0 sc0 ls0 ws0">若能使<span class="_ _23"></span>用斜的划分<span class="_ _23"></span>边界，即是说<span class="_ _23"></span><span class="ff4">每次划分使<span class="_ _23"></span>用多个属性</span>，<span class="_ _23"></span>如图<span class="ff3">5.3</span>中红色线<span class="_ _23"></span>段所示，则决<span class="_ _23"></span>策树的</div><div class="t m0 x3 h6 y5ae ff1 fs2 fc0 sc0 ls0 ws0">计算量将大为减小。</div><div class="t m0 x133 h6 y5af ff1 fs2 fc0 sc0 ls0 ws0">图<span class="_ _d"> </span><span class="ff3">5.3:<span class="_ _35"> </span></span>多变量决策树的划分边界</div><div class="t m0 x3 h6 y5b0 ff1 fs2 fc0 sc0 ls0 ws0">使用多个属性进行划分结点的决策树称为<span class="ff4">多变量决策树<span class="_ _d"> </span><span class="ff3">(m<span class="_ _12"></span>ultiv<span class="_ _28"></span>ariate<span class="_ _d"> </span>decision<span class="_ _d"> </span>tree)<span class="ff1">。</span></span></span></div><div class="t m0 x3 h6 y5b1 ff1 fs2 fc0 sc0 ls0 ws0">在多变<span class="_ _23"></span>量决策树中，内<span class="_ _23"></span>部结点不再<span class="_ _23"></span>是仅对某个<span class="_ _23"></span>属性，而是对<span class="_ _23"></span>属性的线性组<span class="_ _23"></span>合进行测试。<span class="_ _23"></span>换言之<span class="ff3">,</span></div><div class="t m0 x3 h6 y5b2 ff1 fs2 fc0 sc0 ls0 ws0">每个非叶结点是<span class="_ _23"></span>一个形如</div><div class="t m0 x8d hc y5b3 ff11 fs2 fc0 sc0 ls0 ws0">P</div><div class="t m0 x58 hb y5b4 ffc fs7 fc0 sc0 ls0 ws0">d</div><div class="t m0 x58 ha y5b5 ffc fs7 fc0 sc0 ls0 ws0">i<span class="ff12">=1</span></div><div class="t m0 xca he y5b2 ffd fs2 fc0 sc0 ls0 ws0">w</div><div class="t m0 x104 hb y5b6 ffc fs7 fc0 sc0 ls0 ws0">i</div><div class="t m0 x4e he y5b2 ffd fs2 fc0 sc0 ls0 ws0">a</div><div class="t m0 x69 hb y5b6 ffc fs7 fc0 sc0 ls0 ws0">i</div><div class="t m0 x11 h6 y5b2 fff fs2 fc0 sc0 ls0 ws0">=<span class="_ _25"> </span><span class="ffd">t<span class="_ _d"> </span><span class="ff1">的线性分<span class="_ _23"></span>类器，其中<span class="_ _d"> </span></span>w</span></div><div class="t m0 x64 hb y5b6 ffc fs7 fc0 sc0 ls0 ws0">i</div><div class="t m0 xec h6 y5b2 ff1 fs2 fc0 sc0 ls0 ws0">是属性<span class="_ _d"> </span><span class="ffd">a</span></div><div class="t m0 xf8 hb y5b6 ffc fs7 fc0 sc0 ls0 ws0">i</div><div class="t m0 xa7 h6 y5b2 ff1 fs2 fc0 sc0 ls0 ws0">的权重，<span class="ffd">w</span></div><div class="t m0 x16e hb y5b6 ffc fs7 fc0 sc0 ls0 ws0">i</div><div class="t m0 x68 h6 y5b2 ff1 fs2 fc0 sc0 ls0 ws0">和<span class="_ _d"> </span><span class="ffd">t<span class="_ _e"> </span></span>可</div><div class="t m0 x3 h6 y5b7 ff1 fs2 fc0 sc0 ls0 ws0">在该结点所含的样本集和属性集上学得。</div><div class="t m0 x3 h6 y5b8 ff1 fs2 fc0 sc0 ls0 ws0">于是<span class="ff3">,<span class="_ _d"> </span></span>与传统的“单变量决策树”不同，<span class="_ _12"></span>在多变量决策树的学习过程中，不是为每个非叶结点寻</div><div class="t m0 x3 h6 y5b9 ff1 fs2 fc0 sc0 ls0 ws0">找一个最优划分属性，而是试图建立一个合适的线性分类器。</div><div class="t m0 x52 h9 y5ba ff5 fs6 fc0 sc0 ls0 ws0">5.8<span class="_ _24"> </span><span class="ff9">总结</span></div><div class="t m0 x3 h6 y5bb ff3 fs2 fc0 sc0 ls0 ws0">ID3<span class="_ _25"> </span>(Iterative<span class="_ _25"> </span>Dic<span class="_ _12"></span>hotomizer<span class="_ _25"> </span>3)<span class="_ _d"> </span><span class="ff1">由<span class="_ _25"> </span></span>Ross<span class="_ _d"> </span>Quinlan<span class="_ _25"> </span><span class="ff1">在<span class="_ _d"> </span></span>1986<span class="_ _25"> </span><span class="ff1">年提出。<span class="_ _28"></span><span class="ff3">ID3<span class="_ _d"> </span><span class="ff1">决策树可以是多叉树，<span class="_ _27"></span>不</span></span></span></div><div class="t m0 x3 h6 y5bc ff1 fs2 fc0 sc0 ls0 ws0">能处理数<span class="_ _23"></span>值特征，并且某个属<span class="_ _23"></span>性被选为划分属<span class="_ _23"></span>性后，该属性不能<span class="_ _23"></span>再被后面的分支选<span class="_ _23"></span>为划分属性。</div><div class="t m0 x3 h6 y5bd ff3 fs2 fc0 sc0 ls0 ws0">ID3<span class="_ _d"> </span><span class="ff1">的原始版本不支持剪枝。</span></div><div class="t m0 x3 h6 y5be ff3 fs2 fc0 sc0 ls0 ws0">C4.5<span class="_ _e"> </span><span class="ff1">是<span class="_ _e"> </span></span>Ross<span class="_ _e"> </span>Quinlan<span class="_ _e"> </span><span class="ff1">在<span class="_ _e"> </span></span>1993<span class="_ _e"> </span><span class="ff1">年在<span class="_ _e"> </span></span>ID3<span class="_ _e"> </span><span class="ff1">的基础<span class="_ _23"></span>上改进而提出<span class="_ _23"></span>的。</span>C4.5<span class="_ _d"> </span><span class="ff1">改<span class="_ _23"></span>用信息增益比<span class="_ _23"></span>作为选</span></div><div class="t m0 x3 h6 y5bf ff1 fs2 fc0 sc0 ls0 ws0">择最佳划分属性的准则，并且支持数值特征和剪枝。相比于<span class="_ _d"> </span><span class="ff3">ID3</span>，<span class="ff3">C4.5<span class="_ _d"> </span></span>的计算复杂度更低。</div><div class="t m0 x3 h6 y5c0 ff1 fs2 fc0 sc0 ls0 ws0">决策树算法优点</div><div class="t m0 x15 h6 y5c1 ff3 fs2 fc0 sc0 ls0 ws0">1.<span class="_ _5"> </span><span class="ff1">决策树可解释度高，可以可视化分析，容易提取出规则。</span></div><div class="t m0 x15 h6 y20 ff3 fs2 fc0 sc0 ls0 ws0">2.<span class="_ _5"> </span><span class="ff1">数据不需要归一化或标准化，可以处理缺失值。</span></div><div class="t m0 x3 h4 y3 ff3 fs2 fc0 sc0 ls0 ws0">36</div><a class="l" href="#pf2a" data-dest-detail='[42,"XYZ",70.87,540.32,null]'><div class="d m1" style="border-style:none;position:absolute;left:551.448000px;bottom:839.314500px;width:13.942000px;height:15.458000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.500000,0.000000,0.000000,1.500000,0.000000,0.000000]}'></div></div>
<div id="pf2b" class="pf w0 h0" data-page-no="2b"><div class="pc pc2b w0 h0"><div class="t m0 x173 h7 y21 ff3 fs5 fc0 sc0 ls0 ws0">5.9<span class="_ _8"> </span>PYTHON<span class="_ _32"> </span><span class="ff7">代码</span></div><div class="t m0 x15 h6 y22 ff3 fs2 fc0 sc0 ls0 ws0">3.<span class="_ _5"> </span><span class="ff1">预测数据时，计算复杂度为<span class="_ _d"> </span></span>O(log<span class="_ _25"> </span>n)<span class="_ _23"></span><span class="ff1">，</span>n<span class="_ _25"> </span><span class="ff1">为样本数。</span></div><div class="t m0 x15 h6 y5c2 ff3 fs2 fc0 sc0 ls0 ws0">4.<span class="_ _5"> </span><span class="ff1">既可以处理类别型数据也可以处理数值型数据。</span></div><div class="t m0 x15 h6 y5c3 ff3 fs2 fc0 sc0 ls0 ws0">5.<span class="_ _5"> </span><span class="ff1">能够处理和预测目标不相关的特征。</span></div><div class="t m0 x15 h6 y5c4 ff3 fs2 fc0 sc0 ls0 ws0">6.<span class="_ _5"> </span><span class="ff1">对于异常点不敏感。</span></div><div class="t m0 x3 h6 y5c5 ff1 fs2 fc0 sc0 ls0 ws0">决策树算法缺点</div><div class="t m0 x15 h6 y5c6 ff3 fs2 fc0 sc0 ls0 ws0">1.<span class="_ _5"> </span><span class="ff1">决策树容易过拟合。</span></div><div class="t m0 x15 h6 y5c7 ff3 fs2 fc0 sc0 ls0 ws0">2.<span class="_ _5"> </span><span class="ff1">决策树具有高方差，树结构不稳定，相关变量的随机波动可能生成完全不一样的树。</span></div><div class="t m0 x15 h6 y5c8 ff3 fs2 fc0 sc0 ls0 ws0">3.<span class="_ _5"> </span><span class="ff1">寻找最优决策树是<span class="_ _d"> </span></span>NP<span class="_ _d"> </span><span class="ff1">难问题，使用启发式方法寻找最佳划分，容易陷入局部最优。</span></div><div class="t m0 x15 h6 y5c9 ff3 fs2 fc0 sc0 ls0 ws0">4.<span class="_ _5"> </span><span class="ff1">决策树不能简单地表示一些比较复杂的问题，如异或。</span></div><div class="t m0 x15 h6 y5ca ff3 fs2 fc0 sc0 ls0 ws0">5.<span class="_ _5"> </span><span class="ff1">单调树会忽略特征的相关性。</span></div><div class="t m0 x15 h6 y5cb ff3 fs2 fc0 sc0 ls0 ws0">6.<span class="_ _5"> </span><span class="ff1">树模型是分步函数，而不是连续函数。</span></div><div class="t m0 x104 h9 y5cc ff5 fs6 fc0 sc0 ls0 ws0">5.9<span class="_ _24"> </span>Python<span class="_ _18"> </span><span class="ff9">代码</span></div><div class="t m0 x3 h39 y5cd ff23 fs2 fc6 sc0 ls0 ws0">import <span class="fc7">matplotlib.pylab </span>as <span class="fc7">plt</span></div><div class="t m0 x3 h39 y5ce ff23 fs2 fc6 sc0 ls0 ws0">import <span class="fc7">numpy </span>as <span class="fc7">np</span></div><div class="t m0 x3 h3a y5cf ff23 fs2 fc6 sc0 ls0 ws0">def <span class="ff1c fc7">ent<span class="fc0">(prob_list: <span class="fc6">list</span>):</span></span></div><div class="t m0 x174 h3a y5d0 ff23 fs2 fc6 sc0 ls0 ws0">return <span class="ff1c fc8">‐<span class="fc0">np</span>.<span class="fc0">sum(np</span>.<span class="fc0">log2(prob_list) </span>* <span class="fc0">prob_list)</span></span></div><div class="t m0 x3 h3a y5d1 ff1c fs2 fc0 sc0 ls0 ws0">p_range <span class="fc8">= </span>np<span class="fc8">.</span>arange(<span class="fc8">0.01</span>, <span class="fc8">1</span>, <span class="fc8">0.01</span>)</div><div class="t m0 x3 h3a y5d2 ff1c fs2 fc0 sc0 ls0 ws0">ent_result <span class="fc8">= </span>[]</div><div class="t m0 x3 h3a y5d3 ff23 fs2 fc6 sc0 ls0 ws0">for <span class="ff1c fc0">p </span><span class="fc9">in <span class="ff1c fc0">p_range:</span></span></div><div class="t m0 x174 h3a y5d4 ff1c fs2 fc0 sc0 ls0 ws0">prob <span class="fc8">= </span>[p, <span class="fc8">1 ‐ </span>p]</div><div class="t m0 x174 h3a y5d5 ff1c fs2 fc0 sc0 ls0 ws0">ent_result<span class="fc8">.</span>append(ent(prob))</div><div class="t m0 x3 h3a y5d6 ff1c fs2 fc0 sc0 ls0 ws0">plt<span class="fc8">.</span>title(<span class="fca">&quot;Entropy of Binomial‐Type Distributions&quot;</span>, fontsize<span class="fc8">=19</span>)</div><div class="t m0 x3 h3a y5d7 ff1c fs2 fc0 sc0 ls0 ws0">plt<span class="fc8">.</span>xlabel(<span class="fca">&quot;Probability&quot;</span>, fontdict<span class="fc8">=</span>{<span class="fca">&quot;fontsize&quot;</span>: <span class="fc8">18</span>})</div><div class="t m0 x3 h3a y5d8 ff1c fs2 fc0 sc0 ls0 ws0">plt<span class="fc8">.</span>ylabel(<span class="fca">&quot;Entropy&quot;</span>, fontdict<span class="fc8">=</span>{<span class="fca">&quot;fontsize&quot;</span>: <span class="fc8">18</span>})</div><div class="t m0 x3 h3a y5d9 ff1c fs2 fc0 sc0 ls0 ws0">plt<span class="fc8">.</span>xticks(fontsize<span class="fc8">=16</span>)</div><div class="t m0 x3 h3a y5da ff1c fs2 fc0 sc0 ls0 ws0">plt<span class="fc8">.</span>yticks(fontsize<span class="fc8">=16</span>)</div><div class="t m0 x3 h3a y5db ff1c fs2 fc0 sc0 ls0 ws0">ax <span class="fc8">= </span>plt<span class="fc8">.</span>gca()</div><div class="t m0 x3 h3a y5dc ff1c fs2 fc0 sc0 ls0 ws0">ax<span class="fc8">.</span>spines[<span class="fca">&apos;top&apos;</span>]<span class="fc8">.</span>set_color(<span class="fca">&apos;none&apos;</span>)</div><div class="t m0 x3 h3a y5dd ff1c fs2 fc0 sc0 ls0 ws0">ax<span class="fc8">.</span>spines[<span class="fca">&apos;right&apos;</span>]<span class="fc8">.</span>set_color(<span class="fca">&apos;none&apos;</span>)</div><div class="t m0 x3 h3a y5de ff1c fs2 fc0 sc0 ls0 ws0">plt<span class="fc8">.</span>plot(p_range, ent_result, lw<span class="fc8">=3</span>)</div><div class="t m0 x3 h3a y5df ff1c fs2 fc0 sc0 ls0 ws0">plt<span class="fc8">.</span>grid()</div><div class="t m0 x3 h3a y5e0 ff1c fs2 fc0 sc0 ls0 ws0">plt<span class="fc8">.</span>savefig(<span class="fca">&apos;./py_plot/entropy_of_binomial.pdf&apos;</span>, bbox_inches<span class="fc8">=<span class="fca">&apos;tight&apos;</span></span>)</div><div class="t m0 xbc h4 y3 ff3 fs2 fc0 sc0 ls0 ws0">37</div></div><div class="pi" data-data='{"ctm":[1.500000,0.000000,0.000000,1.500000,0.000000,0.000000]}'></div></div>
<div id="pf2c" class="pf w0 h0" data-page-no="2c"><div class="pc pc2c w0 h0"><div class="t m0 x3 h7 y21 ff3 fs5 fc0 sc0 ls0 ws0">5.9<span class="_ _8"> </span>PYTHON<span class="_ _32"> </span><span class="ff7">代码</span></div><div class="t m0 x3 h4 y3 ff3 fs2 fc0 sc0 ls0 ws0">38</div></div><div class="pi" data-data='{"ctm":[1.500000,0.000000,0.000000,1.500000,0.000000,0.000000]}'></div></div>
<div id="pf2d" class="pf w0 h0" data-page-no="2d"><div class="pc pc2d w0 h0"><img class="bi x3 y5e1 w1 h3b" alt="" src="bg2d.png"/><div class="t m0 x38 h5 y4 ff4 fs3 fc0 sc0 ls0 ws0">第六章 <span class="ff5">P<span class="_ _28"></span>erceptron</span></div><div class="t m0 x3 h6 y1ce ff3 fs2 fc0 sc0 ls0 ws0">P<span class="_ _12"></span>erceptron<span class="_ _e"> </span><span class="ff1">由<span class="_ _e"> </span></span>Rosenblatt<span class="_ _e"> </span><span class="ff1">于<span class="_ _e"> </span></span>1957<span class="_ _e"> </span><span class="ff1">年<span class="_ _23"></span>提出，是一种<span class="_ _23"></span>简单的线<span class="_ _23"></span>性二分类<span class="_ _23"></span>模型。感知机<span class="_ _23"></span>是支持向<span class="_ _23"></span>量</span></div><div class="t m0 x3 h6 y1cf ff1 fs2 fc0 sc0 ls0 ws0">机和神经网络的基础。<span class="_ _29"></span>可以认为，<span class="_ _3a"></span>感知机是最简单的神经网络。<span class="_ _30"></span>感知机可以在输入空间划出一条</div><div class="t m0 x3 h6 y5e2 ff1 fs2 fc0 sc0 ls0 ws0">直线，<span class="_ _30"></span>或者一个平面、<span class="_ _27"></span>超平面，<span class="_ _30"></span>如果训练集是线性可分的，<span class="_ _30"></span>那么两类样本则分别位于超平面的两</div><div class="t m0 x3 h6 y5e3 ff1 fs2 fc0 sc0 ls0 ws0">侧。</div><div class="t m0 x3 h6 y5e4 ff1 fs2 fc0 sc0 ls0 ws0">以下图的感知机为例子：</div><div class="t m0 x119 h6 y5e5 ff1 fs2 fc0 sc0 ls0 ws0">图<span class="_ _d"> </span><span class="ff3">6.1:<span class="_ _35"> </span></span>两个输入神经元的感知机结构示意图</div><div class="t m0 x140 h6 y5e6 ff1 fs2 fc0 sc0 ls0 ws0">图<span class="_ _d"> </span><span class="ff3">6.2:<span class="_ _35"> </span>sgn<span class="_ _d"> </span></span>激活函数</div><div class="t m0 x3 h6 y5e7 ff1 fs2 fc0 sc0 ls0 ws0">假设输入空间<span class="_ _e"> </span><span class="ff3">(</span>特征向量<span class="ff3">)<span class="_ _d"> </span></span>为<span class="_ _e"> </span><span class="ff10">X<span class="_ _e"> </span><span class="ffe">⊆<span class="_ _25"> </span><span class="ffd">R</span></span></span></div><div class="t m0 x111 ha y5e8 ff12 fs7 fc0 sc0 ls0 ws0">2</div><div class="t m0 xd3 h6 y5e7 ff1 fs2 fc0 sc0 ls0 ws0">，输出空间为<span class="_ _e"> </span><span class="ffd">Y<span class="_ _5"> </span><span class="fff">=<span class="_ _25"> </span><span class="ffe">{−</span>1</span>,<span class="_ _31"> </span><span class="fff">+1<span class="ffe">}</span></span></span>。输入<span class="_ _d"> </span><span class="ff10">x</span></div><div class="t m0 xf9 ha y5e8 ff24 fs7 fc0 sc0 ls0 ws0">(</div><div class="t m0 x173 h21 y5e9 ff10 fs7 fc0 sc0 ls0 ws0">i</div><div class="t m0 xfa ha y5e8 ff24 fs7 fc0 sc0 ls0 ws0">)</div><div class="t m0 xc0 h6 y5e7 ffe fs2 fc0 sc0 ls0 ws0">∈<span class="_ _32"> </span><span class="ffd">X<span class="_ _35"> </span><span class="ff1">表示<span class="_ _23"></span>第<span class="_ _d"> </span></span>i<span class="_ _d"> </span><span class="ff1">个</span></span></div><div class="t m0 x3 h6 y5ea ff1 fs2 fc0 sc0 ls0 ws0">样本的特征向量。输出<span class="_ _d"> </span><span class="ffd">y</span></div><div class="t m0 x49 ha y5eb ff12 fs7 fc0 sc0 ls0 ws0">(<span class="ffc">i</span>)</div><div class="t m0 x154 h6 y5ea ffe fs2 fc0 sc0 ls0 ws0">∈<span class="_ _32"> </span><span class="ffd">Y<span class="_ _18"> </span><span class="ff1">表示第<span class="_ _d"> </span></span>i<span class="_ _d"> </span><span class="ff1">个样本的类别。显然这个感知机要寻找的直线为：</span></span></div><div class="t m0 x48 he y5ec ffd fs2 fc0 sc0 ls0 ws0">w</div><div class="t m0 xe ha y5ed ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 x4f he y5ec ffd fs2 fc0 sc0 ls0 ws0">x</div><div class="t m0 x9d ha y5ed ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 x96 h4 y5ec fff fs2 fc0 sc0 ls0 ws0">+<span class="_ _37"> </span><span class="ffd">w</span></div><div class="t m0 x6f ha y5ed ff12 fs7 fc0 sc0 ls0 ws0">2</div><div class="t m0 x81 he y5ec ffd fs2 fc0 sc0 ls0 ws0">x</div><div class="t m0 xc9 ha y5ed ff12 fs7 fc0 sc0 ls0 ws0">2</div><div class="t m0 x128 h4 y5ec fff fs2 fc0 sc0 ls0 ws0">+<span class="_ _37"> </span><span class="ffd">b<span class="_ _32"> </span></span>=<span class="_ _32"> </span>0</div><div class="t m0 x12 h6 y5ee ff1 fs2 fc0 sc0 ls0 ws0">这里的<span class="_ _d"> </span><span class="ffd">x</span></div><div class="t m0 xb2 ha y5ef ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 x7f h6 y5ee ff1 fs2 fc0 sc0 ls0 ws0">和<span class="_ _d"> </span><span class="ffd">x</span></div><div class="t m0 xf2 ha y5ef ff12 fs7 fc0 sc0 ls0 ws0">2</div><div class="t m0 x150 h6 y5ee ff1 fs2 fc0 sc0 ls0 ws0">并不来自输入空间。</div><div class="t m0 x3 h6 y5f0 ff1 fs2 fc0 sc0 ls0 ws0">而输入空间到输出空间的决策函数为：</div><div class="t m0 x93 h4 y5f1 fff fs2 fc0 sc0 ls0 ws0">ˆ<span class="_ _3c"></span><span class="ffd">y<span class="_ _25"> </span><span class="fff">=<span class="_ _32"> </span><span class="ff3">sgn<span class="_ _31"> </span></span>(</span>f<span class="_ _34"> </span><span class="fff">(<span class="ff10">x</span>))<span class="_ _32"> </span>=<span class="_ _32"> </span><span class="ff3">sgn</span></span></span></div><div class="t m0 xd2 hc y5f2 ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 xe0 hf y5f1 ff10 fs2 fc0 sc0 ls0 ws0">w</div><div class="t m0 x103 ha y5f3 ffb fs7 fc0 sc0 ls0 ws0">⊤</div><div class="t m0 x79 h4 y5f1 ff10 fs2 fc0 sc0 ls0 ws0">x<span class="_ _37"> </span><span class="fff">+<span class="_ _37"> </span><span class="ffd">b</span></span></div><div class="t m0 xeb hc y5f2 ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x3 h6 y5f4 ff1 fs2 fc0 sc0 ls0 ws0">可以看到，一个感知机主要由如下两部分组成：</div><div class="t m0 x15 h6 y5f5 ff3 fs2 fc0 sc0 ls0 ws0">•<span class="_ _5"> </span><span class="ff1">输入权值和偏置：<span class="ff10">w<span class="_ _d"> </span></span>和<span class="_ _d"> </span><span class="ffd">b</span>，<span class="ff10 fc2">w<span class="_ _e"> </span><span class="ff1">实际上就是感知机划分直线的法向量。</span></span></span></div><div class="t m0 x15 h6 y5f6 ff3 fs2 fc0 sc0 ls0 ws0">•<span class="_ _5"> </span><span class="ff1">激活函<span class="_ _23"></span>数：感知机<span class="_ _23"></span>的激活<span class="_ _23"></span>函数可以<span class="_ _23"></span>有很多<span class="_ _23"></span>选择，比如<span class="_ _23"></span>这里选<span class="_ _23"></span>择的激活<span class="_ _23"></span>函数是<span class="_ _1e"> </span><span class="ffd">sig<span class="_ _23"></span>n<span class="_ _e"> </span></span>符<span class="_ _23"></span>号函</span></div><div class="t m0 x13 h6 y5f7 ff1 fs2 fc0 sc0 ls0 ws0">数。</div><div class="t m0 x3 h6 y5f8 ff1 fs2 fc0 sc0 ls0 ws0">因为感<span class="_ _23"></span>知机只有一个<span class="_ _23"></span>输出层神经<span class="_ _23"></span>元，其学习能<span class="_ _23"></span>力是非常有<span class="_ _23"></span>限的，只能处理<span class="_ _23"></span>线性可分问<span class="_ _23"></span>题。因此，</div><div class="t m0 x3 h6 y5f9 ff1 fs2 fc0 sc0 ls0 ws0">感知机被诟病最多的就是其不能处理非线性可分问题。</div><div class="t m0 x3 h6 y5fa ff1 fs2 fc0 sc0 ls0 ws0">如图<span class="ff3">10.3</span>所示，<span class="_ _26"></span>“与、或、非”都是线性问题，而<span class="_ _12"></span>“异或”是非线性可分问题，感知机无法处理。</div><div class="t m0 xc3 h4 y3 ff3 fs2 fc0 sc0 ls0 ws0">39</div><a class="l" href="#pf44" data-dest-detail='[68,"XYZ",70.87,806.14,null]'><div class="d m1" style="border-style:none;position:absolute;left:139.026000px;bottom:186.763500px;width:19.397000px;height:15.458000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.500000,0.000000,0.000000,1.500000,0.000000,0.000000]}'></div></div>
<div id="pf2e" class="pf w0 h0" data-page-no="2e"><div class="pc pc2e w0 h0"><img class="bi xdd y5fb w11 h3c" alt="" src="bg2e.png"/><div class="t m0 x3 h7 y21 ff3 fs5 fc0 sc0 ls0 ws0">6.1<span class="_ _8"> </span><span class="ff7">损失函数</span></div><div class="t m0 x175 h6 y5fc ff1 fs2 fc0 sc0 ls0 ws0">图<span class="_ _d"> </span><span class="ff3">6.3:<span class="_ _35"> </span></span>线性可分的“与”<span class="_ _2f"></span>“或”<span class="_ _26"></span>“非”问题与非线性可分的“异或”问题</div><div class="t m0 x11 h9 y5fd ff5 fs6 fc0 sc0 ls0 ws0">6.1<span class="_ _24"> </span><span class="ff9">损失函数</span></div><div class="t m0 x3 h6 y5fe ff1 fs2 fc0 sc0 ls0 ws0">感知<span class="_ _23"></span>机的学<span class="_ _23"></span>习策略<span class="_ _23"></span>是最<span class="_ _23"></span>小化损<span class="_ _23"></span>失函数。<span class="_ _23"></span>损失函<span class="_ _23"></span>数的选<span class="_ _23"></span>择有<span class="_ _23"></span>多种，这<span class="_ _23"></span>里我们<span class="_ _23"></span>采用的<span class="_ _23"></span>是误<span class="_ _23"></span>分类点<span class="_ _23"></span>到</div><div class="t m0 x3 h6 y5ff ff1 fs2 fc0 sc0 ls0 ws0">超平面的距离，如下：</div><div class="t m0 x96 h4 y600 fff fs2 fc0 sc0 ls0 ws0">1</div><div class="t m0 x5b h4 y601 ffe fs2 fc0 sc0 ls0 ws0">∥<span class="_ _32"> </span><span class="ff10">w<span class="_ _25"> </span></span>∥</div><div class="t m0 xc3 h4 y602 ffe fs2 fc0 sc0 ls0 ws0">|<span class="ff10">w<span class="_ _23"></span>x<span class="_ _38"> </span><span class="fff">+<span class="_ _37"> </span><span class="ffd">b</span></span></span>|</div><div class="t m0 x3 h6 y603 ff1 fs2 fc0 sc0 ls0 ws0">其中<span class="_ _d"> </span><span class="ffe">||<span class="ff10">w<span class="_ _23"></span></span>||<span class="_ _25"> </span></span>是<span class="_ _d"> </span><span class="ffd">L</span></div><div class="t m0 x3b ha y604 ff12 fs7 fc0 sc0 ls0 ws0">2</div><div class="t m0 x54 h6 y603 ff1 fs2 fc0 sc0 ls0 ws0">范数，即是<span class="_ _d"> </span><span class="ff10">w<span class="_ _e"> </span></span>向量的模。</div><div class="t m0 x3 h6 y605 ff1 fs2 fc0 sc0 ls0 ws0">对于正确分类的样本点<span class="_ _d"> </span><span class="fff">(<span class="ff10">x</span></span></div><div class="t m0 x8d ha y606 ff24 fs7 fc0 sc0 ls0 ws0">(<span class="ff10">i</span>)</div><div class="t m0 x58 he y605 ffd fs2 fc0 sc0 ls0 ws0">,<span class="_ _31"> </span>y</div><div class="t m0 x9 ha y606 ff12 fs7 fc0 sc0 ls0 ws0">(<span class="ffc">i</span>)</div><div class="t m0 x2 h6 y605 fff fs2 fc0 sc0 ls0 ws0">)<span class="_ _d"> </span><span class="ff1">而言：</span></div><div class="t m0 xd6 he y607 ffd fs2 fc0 sc0 ls0 ws0">y</div><div class="t m0 x16 ha y608 ff12 fs7 fc0 sc0 ls0 ws0">(<span class="ffc">i</span>)</div><div class="t m0 x9d h4 y607 fff fs2 fc0 sc0 ls0 ws0">(<span class="ff10">w<span class="_ _23"></span>x</span></div><div class="t m0 x97 ha y608 ff24 fs7 fc0 sc0 ls0 ws0">(<span class="ff10">i</span>)</div><div class="t m0 x2b h4 y607 fff fs2 fc0 sc0 ls0 ws0">+<span class="_ _37"> </span><span class="ffd">b</span>)<span class="_ _32"> </span><span class="ffd">&gt;<span class="_ _32"> </span></span>0</div><div class="t m0 x3 h6 y609 ff1 fs2 fc0 sc0 ls0 ws0">所以，对于误分类点<span class="_ _d"> </span><span class="fff">(<span class="ffd">x</span></span></div><div class="t m0 x57 hb y60a ffc fs7 fc0 sc0 ls0 ws0">i</div><div class="t m0 xe6 he y609 ffd fs2 fc0 sc0 ls0 ws0">,<span class="_ _31"> </span>y</div><div class="t m0 x3f hb y60a ffc fs7 fc0 sc0 ls0 ws0">i</div><div class="t m0 x38 h6 y609 fff fs2 fc0 sc0 ls0 ws0">)<span class="_ _d"> </span><span class="ff1">来说：</span></div><div class="t m0 xd6 he y60b ffd fs2 fc0 sc0 ls0 ws0">y</div><div class="t m0 x16 ha y60c ff12 fs7 fc0 sc0 ls0 ws0">(<span class="ffc">i</span>)</div><div class="t m0 x9d h4 y60b fff fs2 fc0 sc0 ls0 ws0">(<span class="ff10">w<span class="_ _23"></span>x</span></div><div class="t m0 x97 ha y60c ff24 fs7 fc0 sc0 ls0 ws0">(<span class="ff10">i</span>)</div><div class="t m0 x2b h4 y60b fff fs2 fc0 sc0 ls0 ws0">+<span class="_ _37"> </span><span class="ffd">b</span>)<span class="_ _32"> </span><span class="ffd">&lt;<span class="_ _32"> </span></span>0</div><div class="t m0 x3 h6 y60d ff1 fs2 fc0 sc0 ls0 ws0">误分类点<span class="_ _d"> </span><span class="ff10">x</span></div><div class="t m0 x176 ha y60e ff24 fs7 fc0 sc0 ls0 ws0">(<span class="ff10">i</span>)</div><div class="t m0 xcc h6 y60d ff1 fs2 fc0 sc0 ls0 ws0">到超平面的距离为：</div><div class="t m0 x47 h4 y60f ffe fs2 fc0 sc0 ls0 ws0">−</div><div class="t m0 x5b h4 y610 fff fs2 fc0 sc0 ls0 ws0">1</div><div class="t m0 x2f h4 y611 ffe fs2 fc0 sc0 ls0 ws0">∥<span class="_ _32"> </span><span class="ffd">w<span class="_ _25"> </span></span>∥</div><div class="t m0 xc2 he y60f ffd fs2 fc0 sc0 ls0 ws0">y</div><div class="t m0 x123 ha y612 ff12 fs7 fc0 sc0 ls0 ws0">(<span class="ffc">i</span>)</div><div class="t m0 x98 h4 y60f fff fs2 fc0 sc0 ls0 ws0">(<span class="ff10">w<span class="_ _23"></span>x</span></div><div class="t m0 x2a ha y612 ff24 fs7 fc0 sc0 ls0 ws0">(<span class="ff10">i</span>)</div><div class="t m0 x78 h4 y60f fff fs2 fc0 sc0 ls0 ws0">+<span class="_ _37"> </span><span class="ffd">b</span>)</div><div class="t m0 x3 h6 y613 ff1 fs2 fc0 sc0 ls0 ws0">那么，所有误分类的点到超平面的总距离为：</div><div class="t m0 x4d h4 y614 ffe fs2 fc0 sc0 ls0 ws0">−</div><div class="t m0 x48 h4 y615 fff fs2 fc0 sc0 ls0 ws0">1</div><div class="t m0 x12d h4 y616 ffe fs2 fc0 sc0 ls0 ws0">∥<span class="_ _32"> </span><span class="ff10">w<span class="_ _25"> </span></span>∥</div><div class="t m0 xf4 hc y617 ff11 fs2 fc0 sc0 ls0 ws0">X</div><div class="t m0 x9d h21 y618 ff10 fs7 fc0 sc0 ls0 ws0">x</div><div class="t m0 x17 h1c y619 ff25 fs9 fc0 sc0 ls0 ws0">(<span class="ff20">i</span>)</div><div class="t m0 x34 hb y618 ffc fs7 fc0 sc0 ls0 ws0">ϵM</div><div class="t m0 x98 he y614 ffd fs2 fc0 sc0 ls0 ws0">y</div><div class="t m0 x2b ha y61a ff12 fs7 fc0 sc0 ls0 ws0">(<span class="ffc">i</span>)</div><div class="t m0 xd4 h4 y614 fff fs2 fc0 sc0 ls0 ws0">(<span class="ff10">w<span class="_ _23"></span>x</span></div><div class="t m0 x66 ha y61a ff24 fs7 fc0 sc0 ls0 ws0">(<span class="ff10">i</span>)</div><div class="t m0 x26 h4 y614 fff fs2 fc0 sc0 ls0 ws0">+<span class="_ _37"> </span><span class="ffd">b</span>)</div><div class="t m0 x3 h6 y61b ff1 fs2 fc0 sc0 ls0 ws0">由于极值计算不受常量的影响，因此不考虑</div><div class="t m0 x65 ha y61c ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 x34 ha y61d ffb fs7 fc0 sc0 ls0 ws0">||<span class="ffc">w</span>||</div><div class="t m0 x70 h6 y61b ff1 fs2 fc0 sc0 ls0 ws0">，由此得到感知机的损失函数如下：</div><div class="t m0 x9a h4 y61e ffd fs2 fc0 sc0 ls0 ws0">L<span class="fff">(<span class="ff10">w<span class="_ _23"></span></span></span>,<span class="_ _33"> </span>b<span class="fff">)<span class="_ _32"> </span>=<span class="_ _32"> </span><span class="ffe">−</span></span></div><div class="t m0 x100 hc y61f ff11 fs2 fc0 sc0 ls0 ws0">X</div><div class="t m0 xbd h21 y620 ff10 fs7 fc0 sc0 ls0 ws0">x</div><div class="t m0 x34 h1c y621 ff25 fs9 fc0 sc0 ls0 ws0">(<span class="ff20">i</span>)</div><div class="t m0 x5e hb y620 ffc fs7 fc0 sc0 ls0 ws0">ϵM</div><div class="t m0 xaa he y61e ffd fs2 fc0 sc0 ls0 ws0">y</div><div class="t m0 xd4 ha y622 ff12 fs7 fc0 sc0 ls0 ws0">(<span class="ffc">i</span>)</div><div class="t m0 x71 h4 y61e fff fs2 fc0 sc0 ls0 ws0">(<span class="ff10">w<span class="_ _23"></span>x</span></div><div class="t m0 x79 ha y622 ff24 fs7 fc0 sc0 ls0 ws0">(<span class="ff10">i</span>)</div><div class="t m0 x127 h4 y61e fff fs2 fc0 sc0 ls0 ws0">+<span class="_ _37"> </span><span class="ffd">b</span>)</div><div class="t m0 x3 h6 y2cc ff1 fs2 fc0 sc0 ls0 ws0">其中<span class="_ _d"> </span><span class="ffd">M<span class="_ _35"> </span></span>为误分类的集合。</div><div class="t m0 x3 h6 y18d ff1 fs2 fc0 sc0 ls0 ws0">可以看出，<span class="_ _12"></span>随时函数<span class="_ _d"> </span><span class="ffd">L<span class="fff">(</span>w,<span class="_ _31"> </span>b<span class="fff">)<span class="_ _d"> </span></span></span>是非负的。<span class="ff4">如果没有误分类点，<span class="_ _12"></span>则损失函数的值为<span class="_ _e"> </span><span class="ff6">0</span>，而且误分类</span></div><div class="t m0 x3 h6 y18e ff4 fs2 fc0 sc0 ls0 ws0">点越少，<span class="_ _28"></span>误分类点距离超平面就越近，损失函数值就越小。<span class="_ _28"></span><span class="ff1">同时，<span class="_ _12"></span>损失函数<span class="_ _25"> </span><span class="ffd">L<span class="fff">(</span>w<span class="_ _23"></span>,<span class="_ _31"> </span>b<span class="fff">)<span class="_ _d"> </span></span></span>是连续可导</span></div><div class="t m0 x3 h6 y20 ff1 fs2 fc0 sc0 ls0 ws0">函数<span class="_ _d"> </span><span class="ff3">s</span>。</div><div class="t m0 x3 h4 y3 ff3 fs2 fc0 sc0 ls0 ws0">40</div></div><div class="pi" data-data='{"ctm":[1.500000,0.000000,0.000000,1.500000,0.000000,0.000000]}'></div></div>
<div id="pf2f" class="pf w0 h0" data-page-no="2f"><div class="pc pc2f w0 h0"><img class="bi x3 y142 w1 h3d" alt="" src="bg2f.png"/><div class="t m0 x27 h7 y21 ff3 fs5 fc0 sc0 ls0 ws0">6.2<span class="_ _8"> </span><span class="ff7">参数更新</span></div><div class="t m0 x11 h9 y324 ff5 fs6 fc0 sc0 ls0 ws0">6.2<span class="_ _24"> </span><span class="ff9">参数更新</span></div><div class="t m0 x3 h6 y623 ff1 fs2 fc0 sc0 ls0 ws0">感知<span class="_ _23"></span>器的学习<span class="_ _23"></span>算法是<span class="_ _23"></span>一种<span class="ff4">错误<span class="_ _23"></span>驱动</span>的<span class="_ _23"></span><span class="ff4">在线学<span class="_ _23"></span>习</span>算法<span class="_ _1e"> </span><span class="ff3">[Rosen<span class="_ _12"></span>blatt,<span class="_ _1e"> </span>1958].<span class="_ _b"> </span><span class="ff1">先初<span class="_ _23"></span>始化一<span class="_ _23"></span>个权重向<span class="_ _23"></span>量</span></span></div><div class="t m0 x3 h6 y624 ff10 fs2 fc0 sc0 ls0 ws0">w<span class="_ _25"> </span><span class="ffe">←<span class="_ _32"> </span><span class="fff">0<span class="_ _25"> </span><span class="ff3">(<span class="ff1">通常是全零向量</span>)<span class="ff1">，<span class="_ _27"></span>然后每次分错一个样本<span class="_ _25"> </span><span class="fff">(<span class="ff10">x<span class="ffd">,<span class="_ _31"> </span>y<span class="_ _23"></span></span></span>)<span class="_ _25"> </span></span>时，<span class="_ _27"></span>即<span class="_ _25"> </span><span class="ffd">y<span class="_ _23"></span><span class="ff10">w</span></span></span></span></span></span></div><div class="t m0 x125 ha y625 ffb fs7 fc0 sc0 ls0 ws0">⊤</div><div class="t m0 x6a h6 y624 ff10 fs2 fc0 sc0 ls0 ws0">x<span class="_ _32"> </span><span class="ffd">&lt;<span class="_ _32"> </span><span class="fff">0<span class="ff1">，<span class="_ _30"></span>就用这个样本来更</span></span></span></div><div class="t m0 x3 h6 y626 ff1 fs2 fc0 sc0 ls0 ws0">新权重。</div><div class="t m0 xc7 h4 y627 ff10 fs2 fc0 sc0 ls0 ws0">w<span class="_ _25"> </span><span class="ffe">←<span class="_ _32"> </span></span>w<span class="_ _a"> </span><span class="fff">+<span class="_ _37"> </span><span class="ffd">y<span class="_ _23"></span></span></span>x</div><div class="t m0 x3 h6 y628 ff1 fs2 fc0 sc0 ls0 ws0">实际上，这就是<span class="ff4">随机梯度下降</span>的策略，其每次更新的梯度为</div><div class="t m0 xba h4 y629 ffd fs2 fc0 sc0 ls0 ws0">∂<span class="_ _23"></span><span class="ffe">L<span class="fff">(<span class="ff10">w<span class="_ _23"></span></span>;<span class="_ _31"> </span><span class="ff10">x</span></span></span>,<span class="_ _31"> </span>y<span class="_ _23"></span><span class="fff">)</span></div><div class="t m0 x6d he y62a ffd fs2 fc0 sc0 ls0 ws0">∂<span class="_ _23"></span><span class="ff10">w</span></div><div class="t m0 x32 h4 y62b fff fs2 fc0 sc0 ls0 ws0">=</div><div class="t m0 x166 hc y62c ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 xd9 h4 y62d fff fs2 fc0 sc0 ls0 ws0">0<span class="_ _4c"> </span><span class="ff3">if<span class="_ _57"> </span><span class="ffd">y<span class="_ _23"></span><span class="ff10">w</span></span></span></div><div class="t m0 x3a ha y62e ffb fs7 fc0 sc0 ls0 ws0">⊤</div><div class="t m0 xc5 h4 y62d ff10 fs2 fc0 sc0 ls0 ws0">x<span class="_ _32"> </span><span class="ffd">&gt;<span class="_ _32"> </span><span class="fff">0</span></span></div><div class="t m0 xd9 h4 y62f ffe fs2 fc0 sc0 ls0 ws0">−<span class="ffd">y<span class="_ _23"></span><span class="ff10">x<span class="_ _58"> </span><span class="ff3">if<span class="_ _57"> </span></span></span>y<span class="_ _23"></span><span class="ff10">w</span></span></div><div class="t m0 x3a ha y630 ffb fs7 fc0 sc0 ls0 ws0">⊤</div><div class="t m0 xc5 h4 y62f ff10 fs2 fc0 sc0 ls0 ws0">x<span class="_ _32"> </span><span class="ffd">&lt;<span class="_ _32"> </span><span class="fff">0</span></span></div><div class="t m0 x3 h6 y631 ff1 fs2 fc0 sc0 ls0 ws0">极小<span class="_ _23"></span>化过程<span class="_ _23"></span>不是一<span class="_ _23"></span>次所<span class="_ _23"></span>有误分<span class="_ _23"></span>类点的<span class="_ _23"></span>梯度下<span class="_ _23"></span>降，选取<span class="_ _23"></span>当前<span class="_ _23"></span>误分类<span class="_ _23"></span>点使其<span class="_ _23"></span>梯度下<span class="_ _23"></span>降。使<span class="_ _23"></span>用的规<span class="_ _23"></span>则</div><div class="t m0 x3 h6 y632 ff1 fs2 fc0 sc0 ls0 ws0">为<span class="_ _25"> </span><span class="ffd">θ<span class="_ _25"> </span><span class="fff">:=<span class="_ _32"> </span></span>θ<span class="_ _38"> </span><span class="ffe">−<span class="_ _38"></span></span>η<span class="_ _23"></span><span class="ffe">∇</span></span></div><div class="t m0 xe4 hb y633 ffc fs7 fc0 sc0 ls0 ws0">θ</div><div class="t m0 xe5 h6 y632 ffd fs2 fc0 sc0 ls0 ws0">ℓ<span class="fff">(</span>θ<span class="_ _23"></span><span class="fff">)<span class="ff1">，<span class="_ _29"></span>其中<span class="_ _25"> </span><span class="ffd">η<span class="_ _d"> </span></span>是步长，<span class="_ _30"></span>即学习率，<span class="_ _29"></span><span class="ffe">∇</span></span></span></div><div class="t m0 xd4 hb y633 ffc fs7 fc0 sc0 ls0 ws0">θ</div><div class="t m0 x2a h6 y632 ffd fs2 fc0 sc0 ls0 ws0">ℓ<span class="fff">(</span>θ<span class="_ _23"></span><span class="fff">)<span class="_ _32"> </span><span class="ff1">是梯度。<span class="_ _30"></span>因此，<span class="_ _30"></span>每次更新权重的公式为：</span></span></div><div class="t m0 x5b h4 y634 ff10 fs2 fc0 sc0 ls0 ws0">w<span class="_ _25"> </span><span class="ffe">←<span class="_ _32"> </span></span>w<span class="_ _a"> </span><span class="fff">+<span class="_ _37"> </span><span class="ffd">η<span class="_ _23"></span>y<span class="_ _23"></span></span></span>x</div><div class="t m0 x24 h4 y635 ffd fs2 fc0 sc0 ls0 ws0">b<span class="_ _32"> </span><span class="ffe">←<span class="_ _32"> </span></span>b<span class="_ _37"> </span><span class="fff">+<span class="_ _37"> </span></span>η<span class="_ _23"></span>y</div><div class="t m0 x3 h6 y636 ff1 fs2 fc0 sc0 ls0 ws0">我们可以从几何的角度去理解这个更新过程，在此之前，我们可能需要一点点先验知识。</div><div class="t m0 x12 hf y637 ff10 fs2 fc0 sc0 ls0 ws0">w</div><div class="t m0 x174 ha y638 ffb fs7 fc0 sc0 ls0 ws0">⊤</div><div class="t m0 xb9 h6 y637 ff10 fs2 fc0 sc0 ls0 ws0">x<span class="_ _d"> </span><span class="ff1">是一个内积，在欧几里得空间，点积可以被定义为：</span></div><div class="t m0 xd6 hf y639 ff10 fs2 fc0 sc0 ls0 ws0">w</div><div class="t m0 x52 ha y63a ffb fs7 fc0 sc0 ls0 ws0">⊤</div><div class="t m0 x33 h4 y639 ff10 fs2 fc0 sc0 ls0 ws0">x<span class="_ _32"> </span><span class="fff">=<span class="_ _32"> </span><span class="ffe">|</span></span>w<span class="_ _23"></span><span class="ffe">||</span>x<span class="ffe">|<span class="_ _33"></span><span class="ff3">cos<span class="_ _31"> </span><span class="ffd">θ</span></span></span></div><div class="t m0 x12 h6 y63b ff10 fs2 fc0 sc0 ls0 ws0">w<span class="_ _1e"> </span><span class="ff1">是<span class="_ _23"></span>划分直<span class="_ _23"></span>线的法<span class="_ _23"></span>向量，但<span class="_ _23"></span>我们知道<span class="_ _23"></span>直线的<span class="_ _23"></span>法向量<span class="_ _23"></span>是可以<span class="_ _23"></span>有两个<span class="_ _23"></span>方向的，<span class="_ _23"></span>即向左或<span class="_ _23"></span>向右，</span></div><div class="t m0 x12 h6 y63c ff1 fs2 fc0 sc0 ls0 ws0">那么<span class="_ _25"> </span><span class="ff10">w<span class="_ _d"> </span></span>到底是指哪个方向的法向量呢？<span class="_ _30"></span>从前面的决策函数<span class="_ _30"></span>（即分类规则）<span class="_ _30"></span>可以看出，<span class="_ _29"></span>法向</div><div class="t m0 x12 h6 y63d ff1 fs2 fc0 sc0 ls0 ws0">量<span class="_ _d"> </span><span class="ff10">w<span class="_ _e"> </span></span>指向正类（<span class="ff3">+1</span>）所在的方向。</div><div class="t m0 x12 h6 y63e ff1 fs2 fc0 sc0 ls0 ws0">为了方<span class="_ _23"></span>便讨论，我们<span class="_ _23"></span>将<span class="_ _e"> </span><span class="ff10">w</span></div><div class="t m0 x40 ha y63f ffb fs7 fc0 sc0 ls0 ws0">⊤</div><div class="t m0 x59 h6 y63e ff10 fs2 fc0 sc0 ls0 ws0">x<span class="_ _a"> </span><span class="fff">+<span class="_ _37"> </span><span class="ffd">b<span class="_ _e"> </span><span class="ff1">改<span class="_ _23"></span>写为<span class="_ _e"> </span></span></span></span>w</div><div class="t m0 xc3 ha y63f ffb fs7 fc0 sc0 ls0 ws0">⊤</div><div class="t m0 x13c h6 y63e ff10 fs2 fc0 sc0 ls0 ws0">x<span class="ff1">，这是<span class="_ _23"></span>完全没有问<span class="_ _23"></span>题的，只需要<span class="_ _23"></span>将<span class="_ _e"> </span></span>w<span class="_ _1e"> </span><span class="ff1">和<span class="_ _e"> </span></span>x</div><div class="t m0 x12 h6 y640 ff1 fs2 fc0 sc0 ls0 ws0">各自增加一个维度即<span class="_ _23"></span>可。这种写法的好处是，我们可以直接从<span class="_ _e"> </span><span class="ff10">w<span class="_ _e"> </span></span>和<span class="_ _d"> </span><span class="ff10">x<span class="_ _e"> </span></span>的内积的符号去判</div><div class="t m0 x12 h6 y641 ff1 fs2 fc0 sc0 ls0 ws0">断分类结果，</div><div class="t m0 x3 h6 y642 ff1 fs2 fc0 sc0 ls0 ws0">如果一<span class="_ _23"></span>个正类的<span class="_ _23"></span>点被误分<span class="_ _23"></span>为负类，即</div><div class="t m0 x157 hf y643 ff10 fs2 fc0 sc0 ls0 ws0">w</div><div class="t m0 x4f h12 y644 ff26 fs7 fc0 sc0 ls0 ws0">⊤</div><div class="t m0 x9d hf y642 ff10 fs2 fc0 sc0 ls0 ws0">x</div><div class="t m0 x5c he y643 ffd fs2 fc0 sc0 ls0 ws0">&lt;</div><div class="t m0 x53 h4 y642 fff fs2 fc0 sc0 ls0 ws0">0</div><div class="t m0 x98 h6 y643 ff1 fs2 fc0 sc0 ls0 ws0">，那表<span class="_ _23"></span>示</div><div class="t m0 x1f hf y642 ff10 fs2 fc0 sc0 ls0 ws0">w</div><div class="t m0 xa0 h6 y643 ff1 fs2 fc0 sc0 ls0 ws0">和</div><div class="t m0 xe8 hf y642 ff10 fs2 fc0 sc0 ls0 ws0">x</div><div class="t m0 xe9 h6 y643 ff1 fs2 fc0 sc0 ls0 ws0">夹角大<span class="_ _23"></span>于</div><div class="t m0 xa7 h4 y642 ff3 fs2 fc0 sc0 ls0 ws0">90</div><div class="t m0 x131 h6 y643 ff1 fs2 fc0 sc0 ls0 ws0">度。所以，<span class="_ _23"></span>修正</div><div class="t m0 x3 h6 y645 ff1 fs2 fc0 sc0 ls0 ws0">的<span class="_ _23"></span>方法<span class="_ _23"></span>就是<span class="_ _23"></span>使<span class="_ _1e"> </span><span class="ffd">w<span class="_ _0"> </span></span>和<span class="_ _35"> </span><span class="ffd">x<span class="_ _35"> </span></span>夹<span class="_ _23"></span>角小<span class="_ _23"></span>于<span class="_ _1e"> </span><span class="ff3">90<span class="_ _3f"> </span></span>度，从<span class="_ _23"></span>而<span class="_ _23"></span>让法<span class="_ _23"></span>向量<span class="_ _23"></span>指向<span class="_ _23"></span>该正<span class="_ _23"></span>类点<span class="_ _23"></span>所<span class="_ _23"></span>在的<span class="_ _23"></span>一侧，<span class="_ _23"></span>通常<span class="_ _23"></span>做法<span class="_ _23"></span>是</div><div class="t m0 x3 h6 y646 ff10 fs2 fc0 sc0 ls0 ws0">w<span class="_ _25"> </span><span class="ffe">←<span class="_ _32"> </span></span>w<span class="_ _32"> </span><span class="fff">+<span class="_ _37"> </span><span class="ffd">y<span class="_ _23"></span></span></span>x<span class="ffd">,<span class="_ _33"> </span>y<span class="_ _d"> </span><span class="fff">=<span class="_ _25"> </span>1<span class="ff1">，如下图所示。根据向量加法的平行四边形<span class="_ _23"></span>法则，一次更新，就可以使得新</span></span></span></div><div class="t m0 x3 h6 y647 ff1 fs2 fc0 sc0 ls0 ws0">的法向量<span class="_ _d"> </span><span class="ff10">w<span class="_ _32"> </span><span class="fff">+<span class="_ _37"> </span></span>x<span class="_ _d"> </span></span>与<span class="_ _e"> </span><span class="ff10">x<span class="_ _d"> </span></span>的夹角<span class="_ _23"></span>小于<span class="_ _d"> </span><span class="ff3">90<span class="_ _d"> </span></span>度，这就对该<span class="_ _23"></span>误分类点完成了修正。但是由于学<span class="_ _23"></span>习率的存</div><div class="t m0 x3 h6 y648 ff1 fs2 fc0 sc0 ls0 ws0">在，实际上更新后的法向量为<span class="_ _25"> </span><span class="ff10">w<span class="_ _a"> </span><span class="fff">+<span class="_ _37"> </span><span class="ffd">η<span class="_ _23"></span></span></span>x</span>，因此一次更新可能不会让法向量和误分类点的夹角小于</div><div class="t m0 x3 h6 y649 ff3 fs2 fc0 sc0 ls0 ws0">90<span class="_ _d"> </span><span class="ff1">度，需要多次更新才能达到目的。</span></div><div class="t m0 x3 h6 y64a ff1 fs2 fc0 sc0 ls0 ws0">同理，<span class="_ _28"></span>如果一个负类点被误分为正类，<span class="_ _28"></span>即<span class="_ _25"> </span><span class="ff10">w</span></div><div class="t m0 x5c h12 y64b ff26 fs7 fc0 sc0 ls0 ws0">⊤</div><div class="t m0 x123 h6 y64a ff10 fs2 fc0 sc0 ls0 ws0">x<span class="_ _32"> </span><span class="ffd">&gt;<span class="_ _32"> </span><span class="fff">0<span class="ff1">，<span class="_ _28"></span>那表示<span class="_ _25"> </span><span class="ff10">w<span class="_ _e"> </span></span>和<span class="_ _25"> </span><span class="ff10">x<span class="_ _d"> </span></span>夹角小于<span class="_ _d"> </span><span class="ff3">90<span class="_ _25"> </span></span>度。<span class="_ _28"></span>修正的方</span></span></span></div><div class="t m0 x3 h6 y64c ff1 fs2 fc0 sc0 ls0 ws0">法就是使<span class="_ _e"> </span><span class="ffd">w<span class="_ _e"> </span></span>和<span class="_ _d"> </span><span class="ffd">x<span class="_ _e"> </span></span>夹角小大于<span class="_ _e"> </span><span class="ff3">90<span class="_ _d"> </span></span>度。<span class="_ _23"></span>通常做法是<span class="_ _d"> </span><span class="ff10">w<span class="_ _d"> </span><span class="ffe">←<span class="_ _25"> </span></span>w<span class="_ _32"> </span><span class="fff">+<span class="_ _37"> </span><span class="ffd">y<span class="_ _23"></span></span></span>x<span class="ffd">,<span class="_ _31"> </span>y<span class="_ _d"> </span><span class="fff">=<span class="_ _25"> </span><span class="ffe">−</span>1<span class="_ _e"> </span></span></span></span>。如下图所示。根<span class="_ _23"></span>据向</div><div class="t m0 x3 h6 y64d ff1 fs2 fc0 sc0 ls0 ws0">量减法的三角形法<span class="_ _23"></span>则，一次更新，就可以使得新的法向<span class="_ _23"></span>量<span class="_ _d"> </span><span class="ff10">w<span class="_ _a"> </span><span class="ffe">−<span class="_ _37"> </span></span>x<span class="_ _d"> </span></span>与<span class="_ _e"> </span><span class="ff10">x<span class="_ _d"> </span></span>的夹角<span class="_ _23"></span>大于<span class="_ _d"> </span><span class="ff3">90<span class="_ _d"> </span></span>度，这就</div><div class="t m0 x3 h6 y64e ff1 fs2 fc0 sc0 ls0 ws0">对该误分类点完成了修正。同样由于学习率的存在，实际上可能需要多次更新才能达到目的。</div><div class="t m0 xbc h4 y3 ff3 fs2 fc0 sc0 ls0 ws0">41</div></div><div class="pi" data-data='{"ctm":[1.500000,0.000000,0.000000,1.500000,0.000000,0.000000]}'></div></div>
<div id="pf30" class="pf w0 h0" data-page-no="30"><div class="pc pc30 w0 h0"><img class="bi x177 y64f w12 h3e" alt="" src="bg30.png"/><div class="t m0 x3 h7 y21 ff3 fs5 fc0 sc0 ls0 ws0">6.2<span class="_ _8"> </span><span class="ff7">参数更新</span></div><div class="t m0 x3 h6 y22 ff1 fs2 fc0 sc0 ls0 ws0">我们<span class="_ _23"></span>可以证<span class="_ _23"></span>明，当学<span class="_ _23"></span>习率<span class="_ _23"></span>足够小<span class="_ _23"></span>的时候，<span class="_ _23"></span>划分直<span class="_ _23"></span>线与误<span class="_ _23"></span>分类<span class="_ _23"></span>点的距<span class="_ _23"></span>离在参<span class="_ _23"></span>数更新<span class="_ _23"></span>后会<span class="_ _23"></span>变得更<span class="_ _23"></span>小</div><div class="t m0 x14 h6 y17d ff1 fs2 fc0 sc0 ls0 ws0">（这里不在意参数更新后，<span class="_ _29"></span>误分类点是否被正确分类）<span class="_ _2f"></span>。<span class="_ _30"></span>这是感知机参数更新的性质，<span class="_ _29"></span>具体证明过</div><div class="t m0 x3 h6 y17e ff1 fs2 fc0 sc0 ls0 ws0">程如下：</div><div class="t m0 x3 h6 y89 ff1 fs2 fc0 sc0 ls0 ws0">对于某个误分类点</div><div class="t m0 x89 hc y650 ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 xfe h4 y651 ffe fs2 fc0 sc0 ls0 ws0">−<span class="_ _59"></span>→</div><div class="t m0 xdb h3f y89 ff15 fs2 fc0 sc0 ls0 ws0">x</div><div class="t m0 x8a hb y652 ffc fs7 fc0 sc0 ls0 ws0">i</div><div class="t m0 x12f h4 y89 ffd fs2 fc0 sc0 ls0 ws0">,<span class="_ _37"> </span><span class="fff">˜<span class="_ _3c"></span><span class="ffd">y</span></span></div><div class="t m0 x4b hb y652 ffc fs7 fc0 sc0 ls0 ws0">i</div><div class="t m0 x83 hc y650 ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 xba h6 y89 ffd fs2 fc0 sc0 ls0 ws0">,<span class="_ _d"> </span><span class="ff1">假设它被选中用于更新参数。</span></div><div class="t m0 x3 h6 y8a ff3 fs2 fc0 sc0 ls0 ws0">1.<span class="_ _35"> </span><span class="ff1">假设迭代之前，分类超平面为<span class="_ _d"> </span><span class="ffd">S<span class="_ _51"></span></span></span>,<span class="_ _d"> </span><span class="ff1">该误分类点距超平面的距离为<span class="_ _d"> </span><span class="ffd">d</span></span></div><div class="t m0 x3 h6 y52d ff3 fs2 fc0 sc0 ls0 ws0">2.<span class="_ _35"> </span><span class="ff1">假设迭代之后，分类超平面为<span class="_ _d"> </span><span class="ffd">S</span></span></div><div class="t m0 x9b ha y653 ffb fs7 fc0 sc0 ls0 ws0">′</div><div class="t m0 x6e h6 y52d ffd fs2 fc0 sc0 ls0 ws0">,<span class="_ _d"> </span><span class="ff1">该误分类点距超平面的距离为<span class="_ _d"> </span></span>d</div><div class="t m0 xf7 ha y653 ffb fs7 fc0 sc0 ls0 ws0">′</div><div class="t m0 x3 h6 y654 ff1 fs2 fc0 sc0 ls0 ws0">则：</div><div class="t m0 x3d h4 y655 fff fs2 fc0 sc0 ls0 ws0">∆<span class="ffd">d<span class="_ _32"> </span></span>=<span class="_ _32"> </span><span class="ffd">d</span></div><div class="t m0 x3f ha y656 ffb fs7 fc0 sc0 ls0 ws0">′</div><div class="t m0 x8 h4 y655 ffe fs2 fc0 sc0 ls0 ws0">−<span class="_ _37"> </span><span class="ffd">d<span class="_ _32"> </span><span class="fff">=</span></span></div><div class="t m0 x111 h4 y657 fff fs2 fc0 sc0 ls0 ws0">1</div><div class="t m0 x5a hc y658 ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x5a hc y659 ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x12d h4 y65a ffe fs2 fc0 sc0 ls0 ws0">−<span class="_ _59"></span>→</div><div class="t m0 x6e h3f y65b ff15 fs2 fc0 sc0 ls0 ws0">w</div><div class="t m0 xd3 ha y65c ffb fs7 fc0 sc0 ls0 ws0">′</div><div class="t m0 xd6 hc y658 ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 xd6 hc y659 ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x94 ha y65d ff12 fs7 fc0 sc0 ls0 ws0">2</div><div class="t m0 xc7 hc y65e ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 xc7 hc y65f ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 xa9 h4 y660 ffe fs2 fc0 sc0 ls0 ws0">−<span class="_ _59"></span>→</div><div class="t m0 x166 h3f y655 ff15 fs2 fc0 sc0 ls0 ws0">w</div><div class="t m0 xc2 ha y656 ffb fs7 fc0 sc0 ls0 ws0">′</div><div class="t m0 x35 h4 y655 ffe fs2 fc0 sc0 ls0 ws0">·</div><div class="t m0 x53 h4 y660 ffe fs2 fc0 sc0 ls0 ws0">−<span class="_ _59"></span>→</div><div class="t m0 x6f h3f y655 ff15 fs2 fc0 sc0 ls0 ws0">x</div><div class="t m0 x2b hb y661 ffc fs7 fc0 sc0 ls0 ws0">i</div><div class="t m0 x126 h4 y655 fff fs2 fc0 sc0 ls0 ws0">+<span class="_ _37"> </span><span class="ffd">b</span></div><div class="t m0 x71 ha y656 ffb fs7 fc0 sc0 ls0 ws0">′</div><div class="t m0 x60 hc y65e ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x60 hc y65f ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x37 h4 y655 ffe fs2 fc0 sc0 ls0 ws0">−</div><div class="t m0 x3a h4 y657 fff fs2 fc0 sc0 ls0 ws0">1</div><div class="t m0 x1f h4 y662 ffe fs2 fc0 sc0 ls0 ws0">∥</div><div class="t m0 x11d h4 y663 ffe fs2 fc0 sc0 ls0 ws0">−<span class="_ _59"></span>→</div><div class="t m0 x178 h4 y662 ff15 fs2 fc0 sc0 ls0 ws0">w<span class="_ _33"> </span><span class="ffe">∥</span></div><div class="t m0 xc6 ha y664 ff12 fs7 fc0 sc0 ls0 ws0">2</div><div class="t m0 xe8 hc y65e ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 xe8 hc y65f ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 xf6 h4 y660 ffe fs2 fc0 sc0 ls0 ws0">−<span class="_ _59"></span>→</div><div class="t m0 xa2 h4 y655 ff15 fs2 fc0 sc0 ls0 ws0">w<span class="_ _e"> </span><span class="ffe">·</span></div><div class="t m0 xbf h4 y660 ffe fs2 fc0 sc0 ls0 ws0">−<span class="_ _59"></span>→</div><div class="t m0 x14b h3f y655 ff15 fs2 fc0 sc0 ls0 ws0">x</div><div class="t m0 xa3 hb y661 ffc fs7 fc0 sc0 ls0 ws0">i</div><div class="t m0 x11a h4 y655 fff fs2 fc0 sc0 ls0 ws0">+<span class="_ _37"> </span><span class="ffd">b</span></div><div class="t m0 xa6 hc y65e ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 xa6 hc y65f ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x10c h4 y665 fff fs2 fc0 sc0 ls0 ws0">=<span class="_ _32"> </span><span class="ffe">−</span></div><div class="t m0 x147 h4 y666 fff fs2 fc0 sc0 ls0 ws0">1</div><div class="t m0 xce hc y667 ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 xce hc y668 ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 xd7 h4 y669 ffe fs2 fc0 sc0 ls0 ws0">−<span class="_ _59"></span>→</div><div class="t m0 x4c h3f y66a ff15 fs2 fc0 sc0 ls0 ws0">w</div><div class="t m0 x59 ha y66b ffb fs7 fc0 sc0 ls0 ws0">′</div><div class="t m0 x133 hc y667 ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x133 hc y668 ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 xf ha y66c ff12 fs7 fc0 sc0 ls0 ws0">2</div><div class="t m0 x5a h4 y665 fff fs2 fc0 sc0 ls0 ws0">˜<span class="_ _3c"></span><span class="ffd">y</span></div><div class="t m0 x9b hb y66d ffc fs7 fc0 sc0 ls0 ws0">i</div><div class="t m0 x22 hc y66e ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x11 h4 y66f ffe fs2 fc0 sc0 ls0 ws0">−<span class="_ _59"></span>→</div><div class="t m0 x48 h3f y665 ff15 fs2 fc0 sc0 ls0 ws0">w</div><div class="t m0 x94 ha y670 ffb fs7 fc0 sc0 ls0 ws0">′</div><div class="t m0 x80 h4 y665 ffe fs2 fc0 sc0 ls0 ws0">·</div><div class="t m0 x9d h4 y66f ffe fs2 fc0 sc0 ls0 ws0">−<span class="_ _59"></span>→</div><div class="t m0 x166 h3f y665 ff15 fs2 fc0 sc0 ls0 ws0">x</div><div class="t m0 x5c hb y66d ffc fs7 fc0 sc0 ls0 ws0">i</div><div class="t m0 xd9 h4 y665 fff fs2 fc0 sc0 ls0 ws0">+<span class="_ _37"> </span><span class="ffd">b</span></div><div class="t m0 x70 ha y670 ffb fs7 fc0 sc0 ls0 ws0">′</div><div class="t m0 xc9 hc y66e ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x128 h4 y665 fff fs2 fc0 sc0 ls0 ws0">+</div><div class="t m0 x66 h4 y666 fff fs2 fc0 sc0 ls0 ws0">1</div><div class="t m0 x71 h4 y671 ffe fs2 fc0 sc0 ls0 ws0">∥</div><div class="t m0 x13b h4 y672 ffe fs2 fc0 sc0 ls0 ws0">−<span class="_ _59"></span>→</div><div class="t m0 x99 h4 y671 ff15 fs2 fc0 sc0 ls0 ws0">w<span class="_ _33"> </span><span class="ffe">∥</span></div><div class="t m0 x1f ha y673 ff12 fs7 fc0 sc0 ls0 ws0">2</div><div class="t m0 x178 h4 y665 fff fs2 fc0 sc0 ls0 ws0">˜<span class="_ _3c"></span><span class="ffd">y</span></div><div class="t m0 x3a hb y66d ffc fs7 fc0 sc0 ls0 ws0">i</div><div class="t m0 xc5 hc y66e ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 xc6 h4 y66f ffe fs2 fc0 sc0 ls0 ws0">−<span class="_ _59"></span>→</div><div class="t m0 xad h4 y665 ff15 fs2 fc0 sc0 ls0 ws0">w<span class="_ _e"> </span><span class="ffe">·</span></div><div class="t m0 xe9 h4 y66f ffe fs2 fc0 sc0 ls0 ws0">−<span class="_ _59"></span>→</div><div class="t m0 x12b h3f y665 ff15 fs2 fc0 sc0 ls0 ws0">x</div><div class="t m0 x102 hb y66d ffc fs7 fc0 sc0 ls0 ws0">i</div><div class="t m0 x170 h4 y665 fff fs2 fc0 sc0 ls0 ws0">+<span class="_ _37"> </span><span class="ffd">b</span></div><div class="t m0 x11b hc y66e ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x46 h4 y674 ffe fs2 fc0 sc0 ls0 ws0">≃<span class="_ _32"> </span>−</div><div class="t m0 x22 h4 y675 fff fs2 fc0 sc0 ls0 ws0">˜<span class="_ _3c"></span><span class="ffd">y</span></div><div class="t m0 x11 hb y676 ffc fs7 fc0 sc0 ls0 ws0">i</div><div class="t m0 x5a h4 y677 ffe fs2 fc0 sc0 ls0 ws0">∥</div><div class="t m0 x51 h4 y678 ffe fs2 fc0 sc0 ls0 ws0">−<span class="_ _59"></span>→</div><div class="t m0 x69 h4 y677 ff15 fs2 fc0 sc0 ls0 ws0">w<span class="_ _33"> </span><span class="ffe">∥</span></div><div class="t m0 x2f ha y679 ff12 fs7 fc0 sc0 ls0 ws0">2</div><div class="t m0 x52 hc y67a ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x24 h4 y67b ffe fs2 fc0 sc0 ls0 ws0">−<span class="_ _59"></span>→</div><div class="t m0 xf4 h3f y674 ff15 fs2 fc0 sc0 ls0 ws0">w</div><div class="t m0 x122 ha y67c ffb fs7 fc0 sc0 ls0 ws0">′</div><div class="t m0 x75 h4 y674 ffe fs2 fc0 sc0 ls0 ws0">−</div><div class="t m0 x13c h4 y67b ffe fs2 fc0 sc0 ls0 ws0">−<span class="_ _59"></span>→</div><div class="t m0 x70 h3f y674 ff15 fs2 fc0 sc0 ls0 ws0">w</div><div class="t m0 x13e hc y67a ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x2a h4 y674 ffe fs2 fc0 sc0 ls0 ws0">·</div><div class="t m0 x71 h4 y67b ffe fs2 fc0 sc0 ls0 ws0">−<span class="_ _59"></span>→</div><div class="t m0 x77 h3f y674 ff15 fs2 fc0 sc0 ls0 ws0">x</div><div class="t m0 x66 hb y67d ffc fs7 fc0 sc0 ls0 ws0">i</div><div class="t m0 x148 h4 y674 fff fs2 fc0 sc0 ls0 ws0">+</div><div class="t m0 x11d hc y67a ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x3a he y674 ffd fs2 fc0 sc0 ls0 ws0">b</div><div class="t m0 x149 ha y67c ffb fs7 fc0 sc0 ls0 ws0">′</div><div class="t m0 xcb h4 y674 ffe fs2 fc0 sc0 ls0 ws0">−<span class="_ _37"> </span><span class="ffd">b</span></div><div class="t m0 x179 hc y67a ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 xff h4 y67e fff fs2 fc0 sc0 ls0 ws0">=<span class="_ _32"> </span><span class="ffe">−</span></div><div class="t m0 x80 h4 y67f fff fs2 fc0 sc0 ls0 ws0">˜<span class="_ _3c"></span><span class="ffd">y</span></div><div class="t m0 x9d hb y680 ffc fs7 fc0 sc0 ls0 ws0">i</div><div class="t m0 x95 h4 y681 ffe fs2 fc0 sc0 ls0 ws0">∥</div><div class="t m0 x4f h4 y682 ffe fs2 fc0 sc0 ls0 ws0">−<span class="_ _59"></span>→</div><div class="t m0 x80 h4 y681 ff15 fs2 fc0 sc0 ls0 ws0">w<span class="_ _33"> </span><span class="ffe">∥</span></div><div class="t m0 xc2 hc y683 ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 xd9 h4 y67e ffd fs2 fc0 sc0 ls0 ws0">η<span class="_ _34"></span><span class="fff">˜<span class="_ _3c"></span><span class="ffd">y</span></span></div><div class="t m0 x98 hb y684 ffc fs7 fc0 sc0 ls0 ws0">i</div><div class="t m0 x101 h4 y685 ffe fs2 fc0 sc0 ls0 ws0">−<span class="_ _59"></span>→</div><div class="t m0 x2b h3f y67e ff15 fs2 fc0 sc0 ls0 ws0">x</div><div class="t m0 x29 hb y684 ffc fs7 fc0 sc0 ls0 ws0">i</div><div class="t m0 x20 h4 y67e ffe fs2 fc0 sc0 ls0 ws0">·</div><div class="t m0 x13f h4 y685 ffe fs2 fc0 sc0 ls0 ws0">−<span class="_ _59"></span>→</div><div class="t m0 x21 h3f y67e ff15 fs2 fc0 sc0 ls0 ws0">x</div><div class="t m0 x37 hb y684 ffc fs7 fc0 sc0 ls0 ws0">i</div><div class="t m0 x148 h4 y67e fff fs2 fc0 sc0 ls0 ws0">+<span class="_ _37"> </span><span class="ffd">η<span class="_ _34"></span></span>˜<span class="_ _3c"></span><span class="ffd">y</span></div><div class="t m0 xb6 hb y684 ffc fs7 fc0 sc0 ls0 ws0">i</div><div class="t m0 x140 hc y683 ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 xca h4 y686 fff fs2 fc0 sc0 ls0 ws0">=<span class="_ _37"> </span><span class="ffe">−</span></div><div class="t m0 x2f h4 y687 fff fs2 fc0 sc0 ls0 ws0">˜<span class="_ _3c"></span><span class="ffd">y</span></div><div class="t m0 x32 ha y688 ff12 fs7 fc0 sc0 ls0 ws0">2</div><div class="t m0 x16 hb y689 ffc fs7 fc0 sc0 ls0 ws0">i</div><div class="t m0 x11 h4 y68a ffe fs2 fc0 sc0 ls0 ws0">∥</div><div class="t m0 x9c h4 y68b ffe fs2 fc0 sc0 ls0 ws0">−<span class="_ _59"></span>→</div><div class="t m0 xd6 h4 y68a ff15 fs2 fc0 sc0 ls0 ws0">w<span class="_ _33"> </span><span class="ffe">∥</span></div><div class="t m0 x9d ha y68c ff12 fs7 fc0 sc0 ls0 ws0">2</div><div class="t m0 x5d hc y68d ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 xc2 he y686 ffd fs2 fc0 sc0 ls0 ws0">η</div><div class="t m0 x123 h4 y68e ffe fs2 fc0 sc0 ls0 ws0">−<span class="_ _59"></span>→</div><div class="t m0 x65 h3f y686 ff15 fs2 fc0 sc0 ls0 ws0">x</div><div class="t m0 x81 hb y68f ffc fs7 fc0 sc0 ls0 ws0">i</div><div class="t m0 x2b h4 y686 ffe fs2 fc0 sc0 ls0 ws0">·</div><div class="t m0 x5f h4 y68e ffe fs2 fc0 sc0 ls0 ws0">−<span class="_ _59"></span>→</div><div class="t m0 x128 h3f y686 ff15 fs2 fc0 sc0 ls0 ws0">x</div><div class="t m0 x36 hb y68f ffc fs7 fc0 sc0 ls0 ws0">i</div><div class="t m0 x77 h4 y686 fff fs2 fc0 sc0 ls0 ws0">+<span class="_ _37"> </span>1</div><div class="t m0 xc8 hc y68d ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x11d h4 y686 ffd fs2 fc0 sc0 ls0 ws0">&lt;<span class="_ _32"> </span><span class="fff">0</span></div><div class="t m0 x3 h6 y690 ff1 fs2 fc0 sc0 ls0 ws0">因此有<span class="_ _d"> </span><span class="ffd">d</span></div><div class="t m0 x6 ha y691 ffb fs7 fc0 sc0 ls0 ws0">′</div><div class="t m0 x108 h6 y690 ffd fs2 fc0 sc0 ls0 ws0">&lt;<span class="_ _32"> </span>d<span class="_ _d"> </span><span class="ff1">这里要求</span></div><div class="t m0 xe6 h4 y692 ffe fs2 fc0 sc0 ls0 ws0">−<span class="_ _59"></span>→</div><div class="t m0 x8c h3f y690 ff15 fs2 fc0 sc0 ls0 ws0">w</div><div class="t m0 x3f ha y691 ffb fs7 fc0 sc0 ls0 ws0">′</div><div class="t m0 x50 h4 y690 ffe fs2 fc0 sc0 ls0 ws0">≃</div><div class="t m0 x31 h4 y692 ffe fs2 fc0 sc0 ls0 ws0">−<span class="_ _59"></span>→</div><div class="t m0 x17a h6 y690 ff15 fs2 fc0 sc0 ls0 ws0">w<span class="_ _33"> </span><span class="ffd">,<span class="_ _d"> </span><span class="ff1">因此步长<span class="_ _d"> </span></span>η<span class="_ _e"> </span><span class="ff1">要相当小。</span></span></div><div class="t m0 x3 h6 y693 ff1 fs2 fc0 sc0 ls0 ws0">具体的感知器参数学习策略如下图所示（摘自邱锡鹏的《神经网络与深度学习》<span class="_ _26"></span>）<span class="_ _2f"></span>：</div><div class="t m0 x40 h6 y694 ff1 fs2 fc0 sc0 ls0 ws0">图<span class="_ _d"> </span><span class="ff3">6.4:<span class="_ _35"> </span></span>二分类感知器的参数学习算法</div><div class="t m0 x3 h6 y359 ff1 fs2 fc0 sc0 ls0 ws0">在有的文章中（例如周志华的《机器学习》<span class="_ _26"></span>）<span class="_ _2f"></span>，最后得到的更新公式为：</div><div class="t m0 x4f h4 y695 ff10 fs2 fc0 sc0 ls0 ws0">w<span class="_ _25"> </span><span class="ffe">←<span class="_ _32"> </span></span>w<span class="_ _a"> </span><span class="fff">+<span class="_ _37"> </span><span class="ffd">α</span>∆</span>w</div><div class="t m0 x166 h4 y696 ffd fs2 fc0 sc0 ls0 ws0">b<span class="_ _32"> </span><span class="ffe">←<span class="_ _32"> </span></span>b<span class="_ _37"> </span><span class="fff">+<span class="_ _37"> </span>∆</span>b</div><div class="t m0 x3 h6 y20 ff1 fs2 fc0 sc0 ls0 ws0">其中，<span class="fff">∆<span class="ff10">w<span class="_ _25"> </span></span>=<span class="_ _32"> </span><span class="ffd">α</span>(<span class="ffd">y<span class="_ _a"> </span><span class="ffe">−<span class="_ _25"> </span></span></span>ˆ<span class="_ _3c"></span><span class="ffd">y<span class="_ _23"></span><span class="fff">)<span class="ff10">x<span class="ff1">，</span></span>∆</span>b<span class="_ _a"> </span><span class="fff">=<span class="_ _32"> </span></span>α<span class="fff">(</span>y<span class="_ _32"> </span><span class="ffe">−<span class="_ _32"> </span><span class="fff">ˆ<span class="_ _3c"></span><span class="ffd">y<span class="_ _23"></span><span class="fff">)<span class="ff1">。</span></span></span></span></span></span></span></div><div class="t m0 x3 h4 y3 ff3 fs2 fc0 sc0 ls0 ws0">42</div></div><div class="pi" data-data='{"ctm":[1.500000,0.000000,0.000000,1.500000,0.000000,0.000000]}'></div></div>
<div id="pf31" class="pf w0 h0" data-page-no="31"><div class="pc pc31 w0 h0"><img class="bi x3 y697 w1 h40" alt="" src="bg31.png"/><div class="t m0 x16b h7 y21 ff3 fs5 fc0 sc0 ls0 ws0">6.3<span class="_ _8"> </span><span class="ff7">感知器收敛性</span></div><div class="t m0 x3 h6 y22 ff1 fs2 fc0 sc0 ls0 ws0">这是<span class="_ _23"></span>因为它将<span class="_ _23"></span>样本的<span class="_ _23"></span>类别映射<span class="_ _23"></span>为<span class="_ _e"> </span><span class="ff3">0<span class="_ _1e"> </span></span>和<span class="_ _e"> </span><span class="ff3">1</span>，<span class="_ _23"></span>同时采取<span class="_ _23"></span>平方和<span class="_ _23"></span>损失函数，<span class="_ _23"></span>所以权<span class="_ _23"></span>值更新的<span class="_ _23"></span>公式不<span class="_ _23"></span>一</div><div class="t m0 x3 h6 y17d ff1 fs2 fc0 sc0 ls0 ws0">样，<span class="_ _30"></span>不过思想都是一样的。<span class="_ _28"></span>这种情况下的更新公式推导可以参考这篇文章<span class="_ _27"></span><span class="fc5">《机器学习<span class="_ _d"> </span><span class="ff3">_<span class="_ _25"> </span></span>感知机》</span></div><div class="t m0 x3 h6 y17e ff1 fs2 fc0 sc0 ls0 ws0">。</div><div class="t m0 x104 h9 y698 ff5 fs6 fc0 sc0 ls0 ws0">6.3<span class="_ _24"> </span><span class="ff9">感知器收敛性</span></div><div class="t m0 x3 h6 y699 ff1 fs2 fc0 sc0 ls0 ws0">感知机的迭代一定会停下来吗？<span class="_ _27"></span>由感知机算法的定义，<span class="_ _30"></span>可以知道，<span class="_ _30"></span>当找到一条直线，<span class="_ _30"></span>能将平面上</div><div class="t m0 x3 h6 y69a ff1 fs2 fc0 sc0 ls0 ws0">的点都分类正确，<span class="_ _2e"></span>那么感知机就会停止。<span class="_ _3a"></span>显然，<span class="_ _2e"></span>要达到这个终止条件，<span class="_ _2e"></span>训练集必须是线性可分的。</div><div class="t m0 x3 h6 y69b ff1 fs2 fc0 sc0 ls0 ws0">如果训练集不是线性可分的，那么上述的感知机算法永远不会停止。</div><div class="t m0 x3 h6 y69c ff3 fs2 fc0 sc0 ls0 ws0">[No<span class="_ _12"></span>vik<span class="_ _12"></span>o,<span class="_ _1e"> </span>1963]<span class="_ _e"> </span><span class="ff1">证明<span class="_ _23"></span>了对于<span class="_ _23"></span>两类问题，<span class="_ _23"></span>如果训<span class="_ _23"></span>练集是线<span class="_ _23"></span>性可分的，<span class="_ _23"></span>那么感知<span class="_ _23"></span>器算法<span class="_ _23"></span>可以在有<span class="_ _23"></span>限</span></div><div class="t m0 x3 h6 y69d ff1 fs2 fc0 sc0 ls0 ws0">次迭代后收敛。然而，如果训练集不是线性可分的，那么这个算法则不能确保会收敛。</div><div class="t m0 x3 h6 y69e ff1 fs2 fc0 sc0 ls0 ws0">当数据集是两类线性可分时<span class="ff3">, </span>对于训练集<span class="_ _25"> </span><span class="ffe">D<span class="_ _25"> </span><span class="fff">=</span></span></div><div class="t m0 x97 hc y69f ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x70 hf y69e ff10 fs2 fc0 sc0 ls0 ws0">x</div><div class="t m0 x126 ha y6a0 ff12 fs7 fc0 sc0 ls0 ws0">(<span class="ffc">n</span>)</div><div class="t m0 x14a he y69e ffd fs2 fc0 sc0 ls0 ws0">,<span class="_ _31"> </span>y</div><div class="t m0 x99 ha y6a0 ff12 fs7 fc0 sc0 ls0 ws0">(<span class="ffc">n</span>)</div><div class="t m0 x158 hc y69f ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x7a hb y6a1 ffc fs7 fc0 sc0 ls0 ws0">N</div><div class="t m0 x7a ha y6a2 ffc fs7 fc0 sc0 ls0 ws0">n<span class="ff12">=1</span></div><div class="t m0 x162 h6 y69e ffd fs2 fc0 sc0 ls0 ws0">,<span class="_ _32"> </span><span class="ff1">其中<span class="_ _25"> </span><span class="ff10">x</span></span></div><div class="t m0 x7e ha y6a0 ff12 fs7 fc0 sc0 ls0 ws0">(<span class="ffc">n</span>)</div><div class="t m0 x151 h6 y69e ff1 fs2 fc0 sc0 ls0 ws0">为样本的增广特征向</div><div class="t m0 x3 h6 y588 ff1 fs2 fc0 sc0 ls0 ws0">量<span class="ff3">,<span class="_ _e"> </span><span class="ffd">y</span></span></div><div class="t m0 x174 ha y6a3 ff12 fs7 fc0 sc0 ls0 ws0">(<span class="ffc">n</span>)</div><div class="t m0 xb1 h6 y588 ffe fs2 fc0 sc0 ls0 ws0">∈<span class="_ _25"> </span>{−<span class="fff">1<span class="ffd">,<span class="_ _31"> </span></span>1</span>}<span class="ff3">,<span class="_ _e"> </span><span class="ff1">那么<span class="_ _23"></span>存在一个正的常<span class="_ _23"></span>数<span class="_ _d"> </span><span class="ffd">γ<span class="_ _51"></span><span class="fff">(</span>γ<span class="_ _e"> </span>&gt;<span class="_ _25"> </span><span class="fff">0)<span class="_ _e"> </span></span></span>和权<span class="_ _23"></span>重向量<span class="_ _d"> </span><span class="ff10">w</span></span></span></div><div class="t m0 x15e ha y6a3 ffb fs7 fc0 sc0 ls0 ws0">∗</div><div class="t m0 x102 h6 y588 ffd fs2 fc0 sc0 ls0 ws0">,<span class="_ _e"> </span><span class="ff1">并且<span class="_ _e"> </span><span class="ffe">∥<span class="ff10">w</span></span></span></div><div class="t m0 x17b ha y6a3 ffb fs7 fc0 sc0 ls0 ws0">∗</div><div class="t m0 x131 h6 y588 ffe fs2 fc0 sc0 ls0 ws0">∥<span class="_ _25"> </span><span class="fff">=<span class="_ _d"> </span>1<span class="ffd">,<span class="_ _e"> </span><span class="ff1">对所有<span class="_ _e"> </span></span>n</span></span></div><div class="t m0 x3 h6 y6a4 ff1 fs2 fc0 sc0 ls0 ws0">都满足<span class="_ _d"> </span><span class="fff">(<span class="ff10">w</span></span></div><div class="t m0 x10b ha y6a5 ffb fs7 fc0 sc0 ls0 ws0">∗</div><div class="t m0 x176 h4 y6a4 fff fs2 fc0 sc0 ls0 ws0">)</div><div class="t m0 xf1 ha y6a6 ffb fs7 fc0 sc0 ls0 ws0">⊤</div><div class="t m0 xdc hc y6a7 ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x3b he y6a4 ffd fs2 fc0 sc0 ls0 ws0">y</div><div class="t m0 xdd ha y6a5 ff12 fs7 fc0 sc0 ls0 ws0">(<span class="ffc">n</span>)</div><div class="t m0 x89 hf y6a4 ff10 fs2 fc0 sc0 ls0 ws0">x</div><div class="t m0 xdb ha y6a5 ff12 fs7 fc0 sc0 ls0 ws0">(<span class="ffc">n</span>)</div><div class="t m0 x12f hc y6a7 ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x49 h6 y6a4 ffe fs2 fc0 sc0 ls0 ws0">≥<span class="_ _32"> </span><span class="ffd">γ<span class="_ _23"></span>.<span class="_ _d"> </span><span class="ff1">我们可以证明如下定理<span class="ff3">.</span></span></span></div><div class="t m0 x174 h41 y6a8 ff27 fs2 fcb sc0 ls0 ws0">定理<span class="_ _e"> </span><span class="ff28">6.1.<span class="_ _e"> </span></span>感知器收敛性</div><div class="t m0 x17c h6 y6a9 ff1 fs2 fc0 sc0 ls0 ws0">给定训练集<span class="_ _d"> </span><span class="ffe">D<span class="_ _25"> </span><span class="fff">=</span></span></div><div class="t m0 x159 hc y6aa ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x2e hf y6a9 ff10 fs2 fc0 sc0 ls0 ws0">x</div><div class="t m0 xe6 ha y6ab ff12 fs7 fc0 sc0 ls0 ws0">(<span class="ffc">n</span>)</div><div class="t m0 x152 he y6a9 ffd fs2 fc0 sc0 ls0 ws0">,<span class="_ _31"> </span>y</div><div class="t m0 x40 ha y6ab ff12 fs7 fc0 sc0 ls0 ws0">(<span class="ffc">n</span>)</div><div class="t m0 x93 hc y6aa ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x4e hb y6ac ffc fs7 fc0 sc0 ls0 ws0">N</div><div class="t m0 x4e ha y6ad ffc fs7 fc0 sc0 ls0 ws0">n<span class="ff12">=1</span></div><div class="t m0 x157 h6 y6a9 ffd fs2 fc0 sc0 ls0 ws0">,<span class="_ _d"> </span><span class="ff1">令<span class="_ _d"> </span></span>R<span class="_ _d"> </span><span class="ff1">是训练集中最大的特征向量的模，即</span></div><div class="t m0 x32 h4 y6ae ffd fs2 fc0 sc0 ls0 ws0">R<span class="_ _32"> </span><span class="fff">=<span class="_ _32"> </span><span class="ff3">max</span></span></div><div class="t m0 x53 hb y6af ffc fs7 fc0 sc0 ls0 ws0">n</div><div class="t m0 x12a hc y6b0 ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x12a hc y6b1 ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x12a hc y6b2 ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x128 he y6ae ffd fs2 fc0 sc0 ls0 ws0">x</div><div class="t m0 x2a ha y6b3 ff12 fs7 fc0 sc0 ls0 ws0">(<span class="ffc">n</span>)</div><div class="t m0 x99 hc y6b0 ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x99 hc y6b1 ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x99 hc y6b2 ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x17c h6 y6b4 ff1 fs2 fc0 sc0 ls0 ws0">如果训练集<span class="_ _d"> </span><span class="ff3">D<span class="_ _d"> </span></span>线性可分，两类感知器的参数学习算法<span class="_ _d"> </span><span class="ff3">3.1<span class="_ _d"> </span></span>的权重更新次数不超过</div><div class="t m0 x84 hb y6b5 ffc fs7 fc0 sc0 ls0 ws0">R</div><div class="t m0 x17d h1c y6b6 ff16 fs9 fc0 sc0 ls0 ws0">2</div><div class="t m0 x17e hb y6b7 ffc fs7 fc0 sc0 ls0 ws0">γ</div><div class="t m0 x1c h1c y6b8 ff16 fs9 fc0 sc0 ls0 ws0">2</div><div class="t m0 x3 h6 y6b9 ff1 fs2 fc0 sc0 ls0 ws0">详细的证明过程参考邱锡鹏的《神经网络与深度学习》第<span class="_ _d"> </span><span class="ff3">3.4.2<span class="_ _d"> </span></span>节（感知器的收敛性）<span class="_ _26"></span>。</div><div class="t m0 x104 h9 y6ba ff5 fs6 fc0 sc0 ls0 ws0">6.4<span class="_ _24"> </span><span class="ff9">感知机的缺陷</span></div><div class="t m0 x3 h6 y6bb ff1 fs2 fc0 sc0 ls0 ws0">虽然感知器在线性可分的数据上可以保证收敛，但其存在以下不足：</div><div class="t m0 x14 h6 y6bc ff1 fs2 fc0 sc0 ls0 ws0">（<span class="ff3">1</span>）<span class="_ _30"></span>在数据集线性可分时，<span class="_ _30"></span>感知器虽然可以找到一个超平面把两类数据分开，<span class="_ _29"></span>但并不能保证其泛</div><div class="t m0 x3 h6 y6bd ff1 fs2 fc0 sc0 ls0 ws0">化能力。</div><div class="t m0 x14 h6 y6be ff1 fs2 fc0 sc0 ls0 ws0">（<span class="ff3">2</span>）感知器对样本顺序比较敏感．每次迭代的顺序不一致时，找到的分割超平面也往往不一致。</div><div class="t m0 x14 h6 y6bf ff1 fs2 fc0 sc0 ls0 ws0">（<span class="ff3">3</span>）如果训练集不是线性可分的，就永远不会收敛。</div><div class="t m0 xbc h4 y3 ff3 fs2 fc0 sc0 ls0 ws0">43</div><a class="l" href="https://ff120.github.io/2017/05/19/机器学习专题/机器学习_感知机/"><div class="d m1" style="border-style:none;position:absolute;left:625.855500px;bottom:1157.547000px;width:113.240000px;height:15.459000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.500000,0.000000,0.000000,1.500000,0.000000,0.000000]}'></div></div>
<div id="pf32" class="pf w0 h0" data-page-no="32"><div class="pc pc32 w0 h0"><div class="t m0 x3 h7 y21 ff3 fs5 fc0 sc0 ls0 ws0">6.4<span class="_ _8"> </span><span class="ff7">感知机的缺陷</span></div><div class="t m0 x3 h4 y3 ff3 fs2 fc0 sc0 ls0 ws0">44</div></div><div class="pi" data-data='{"ctm":[1.500000,0.000000,0.000000,1.500000,0.000000,0.000000]}'></div></div>
<div id="pf33" class="pf w0 h0" data-page-no="33"><div class="pc pc33 w0 h0"><div class="t m0 xe h5 y315 ff4 fs3 fc0 sc0 ls0 ws0">第三部分</div><div class="t m0 x10 h5 y316 ff4 fs3 fc0 sc0 ls0 ws0">机器学习高阶</div><div class="t m0 x80 h3 y317 ff8 fs1 fc0 sc0 ls0 ws0">优化方法</div><div class="t m0 xc3 h4 y3 ff3 fs2 fc0 sc0 ls0 ws0">45</div></div><div class="pi" data-data='{"ctm":[1.500000,0.000000,0.000000,1.500000,0.000000,0.000000]}'></div></div>
<div id="pf34" class="pf w0 h0" data-page-no="34"><div class="pc pc34 w0 h0"></div><div class="pi" data-data='{"ctm":[1.500000,0.000000,0.000000,1.500000,0.000000,0.000000]}'></div></div>
<div id="pf35" class="pf w0 h0" data-page-no="35"><div class="pc pc35 w0 h0"><img class="bi x3 y142 w1 h42" alt="" src="bg35.png"/><div class="t m0 xcd h5 y4 ff4 fs3 fc0 sc0 ls0 ws0">第七章 凸优化基础概念</div><div class="t m0 x52 h9 y66 ff5 fs6 fc0 sc0 ls0 ws0">7.1<span class="_ _24"> </span><span class="ff9">凸集</span></div><div class="t m0 x3 h6 y6c0 ff4 fs2 fc0 sc0 ls0 ws0">定义<span class="ff6">7.1<span class="_ _5"> </span></span><span class="fc1">直线和线段：<span class="_ _d"> </span></span><span class="ff1">设<span class="_ _d"> </span><span class="ffd">x</span></span></div><div class="t m0 x50 ha y6c1 ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 x147 h4 y6c0 ffe fs2 fc0 sc0 ls0 ws0"≯<span class="fff">=<span class="_ _32"> </span><span class="ffd">x</span></span></div><div class="t m0 x41 ha y6c1 ff12 fs7 fc0 sc0 ls0 ws0">2</div><div class="t m0 x51 h6 y6c0 ff1 fs2 fc0 sc0 ls0 ws0">为<span class="_ _d"> </span><span class="ff15">R</span></div><div class="t m0 x4f hb y6c2 ffc fs7 fc0 sc0 ls0 ws0">n</div><div class="t m0 xa9 h6 y6c0 ff1 fs2 fc0 sc0 ls0 ws0">空间中的两个点，那么具有下列形式的点</div><div class="t m0 x41 h4 y6c3 ffd fs2 fc0 sc0 ls0 ws0">y<span class="_ _25"> </span><span class="fff">=<span class="_ _32"> </span></span>θ<span class="_ _23"></span>x</div><div class="t m0 x4f ha y6c4 ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 x33 h4 y6c3 fff fs2 fc0 sc0 ls0 ws0">+<span class="_ _37"> </span>(1<span class="_ _37"> </span><span class="ffe">−<span class="_ _37"> </span><span class="ffd">θ<span class="_ _23"></span></span></span>)<span class="ffd">x</span></div><div class="t m0 x9e ha y6c4 ff12 fs7 fc0 sc0 ls0 ws0">2</div><div class="t m0 x71 h4 y6c3 ffd fs2 fc0 sc0 ls0 ws0">,<span class="_ _7"> </span>θ<span class="_ _d"> </span><span class="ffe">∈<span class="_ _a"> </span><span class="ff15">R</span></span></div><div class="t m0 x41 h4 y6c5 ffd fs2 fc0 sc0 ls0 ws0">y<span class="_ _25"> </span><span class="fff">=<span class="_ _32"> </span></span>x</div><div class="t m0 x95 ha y6c6 ff12 fs7 fc0 sc0 ls0 ws0">2</div><div class="t m0 x80 h4 y6c5 fff fs2 fc0 sc0 ls0 ws0">+<span class="_ _37"> </span><span class="ffd">θ<span class="_ _38"> </span></span>(<span class="ffd">x</span></div><div class="t m0 xc3 ha y6c6 ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 x101 h4 y6c5 ffe fs2 fc0 sc0 ls0 ws0">−<span class="_ _37"> </span><span class="ffd">x</span></div><div class="t m0 x20 ha y6c6 ff12 fs7 fc0 sc0 ls0 ws0">2</div><div class="t m0 xd2 h4 y6c5 fff fs2 fc0 sc0 ls0 ws0">)</div><div class="t m0 x3 h6 y6c7 ff1 fs2 fc0 sc0 ls0 ws0">组成一条穿<span class="_ _23"></span>越<span class="_ _d"> </span><span class="ffd">x</span></div><div class="t m0 xb ha y6c8 ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 x3c h6 y6c7 ff1 fs2 fc0 sc0 ls0 ws0">和<span class="_ _d"> </span><span class="ffd">x</span></div><div class="t m0 x17f ha y6c8 ff12 fs7 fc0 sc0 ls0 ws0">2</div><div class="t m0 x3e h6 y6c7 ff1 fs2 fc0 sc0 ls0 ws0">的直线。如果<span class="_ _23"></span>参数<span class="_ _d"> </span><span class="ffd">θ<span class="_ _1e"> </span></span>的值在<span class="_ _e"> </span><span class="ff3">0<span class="_ _d"> </span></span>和<span class="_ _e"> </span><span class="ff3">1<span class="_ _d"> </span></span>之<span class="_ _23"></span>间变动，则构成<span class="_ _e"> </span><span class="ffd">x</span></div><div class="t m0 x180 ha y6c8 ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 x27 h6 y6c7 ff1 fs2 fc0 sc0 ls0 ws0">和<span class="_ _d"> </span><span class="ffd">x</span></div><div class="t m0 x1c ha y6c8 ff12 fs7 fc0 sc0 ls0 ws0">2</div><div class="t m0 x68 h6 y6c7 ff1 fs2 fc0 sc0 ls0 ws0">之间的</div><div class="t m0 x3 h6 y6c9 ff1 fs2 fc0 sc0 ls0 ws0">线段。</div><div class="t m0 x3 h6 y6ca ff4 fs2 fc0 sc0 ls0 ws0">定义<span class="ff6">7.2<span class="_ _5"> </span></span><span class="fc1">仿射<span class="_ _23"></span>集合：<span class="_ _e"> </span></span><span class="ff1">如<span class="_ _23"></span>果通过<span class="_ _23"></span>集合<span class="_ _e"> </span><span class="ffd">C<span class="_ _3f"> </span><span class="ffe">⊆<span class="_ _e"> </span></span>R</span></span></div><div class="t m0 x4 hb y6cb ffc fs7 fc0 sc0 ls0 ws0">n</div><div class="t m0 x75 h6 y6ca ff1 fs2 fc0 sc0 ls0 ws0">中任<span class="_ _23"></span>意两个不<span class="_ _23"></span>同点的<span class="_ _23"></span>直线仍然<span class="_ _23"></span>在集合<span class="_ _1e"> </span><span class="ffd">C<span class="_ _3f"> </span></span>中，那<span class="_ _23"></span>么</div><div class="t m0 x3 h6 y6cc ff1 fs2 fc0 sc0 ls0 ws0">称集<span class="_ _23"></span>合<span class="_ _e"> </span><span class="ffd">C<span class="_ _3f"> </span></span>是仿<span class="_ _23"></span>射的。也<span class="_ _23"></span>就是说，<span class="ffd">C<span class="_ _35"> </span><span class="ffe">⊆<span class="_ _e"> </span></span>R</span></div><div class="t m0 x5b hb y6cd ffc fs7 fc0 sc0 ls0 ws0">n</div><div class="t m0 x96 h6 y6cc ff1 fs2 fc0 sc0 ls0 ws0">是仿<span class="_ _23"></span>射的等价<span class="_ _23"></span>于：对于<span class="_ _23"></span>任意<span class="_ _e"> </span><span class="ffd">x</span></div><div class="t m0 x15f ha y6ce ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 x137 he y6cc ffd fs2 fc0 sc0 ls0 ws0">,<span class="_ _31"> </span>x</div><div class="t m0 xa7 ha y6ce ff12 fs7 fc0 sc0 ls0 ws0">2</div><div class="t m0 x181 h6 y6cc ffe fs2 fc0 sc0 ls0 ws0">∈<span class="_ _e"> </span><span class="ffd">C<span class="_ _3f"> </span><span class="ff1">及<span class="_ _e"> </span></span>θ<span class="_ _1e"> </span></span>∈<span class="_ _e"> </span><span class="ff15">R<span class="_ _1e"> </span><span class="ff1">有</span></span></div><div class="t m0 x3 he y6cf ffd fs2 fc0 sc0 ls0 ws0">θ<span class="_ _23"></span>x</div><div class="t m0 x182 ha y6d0 ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 x183 h4 y6cf fff fs2 fc0 sc0 ls0 ws0">+<span class="_ _37"> </span>(1<span class="_ _37"> </span><span class="ffe">−<span class="_ _37"> </span><span class="ffd">θ<span class="_ _23"></span></span></span>)<span class="ffd">x</span></div><div class="t m0 xcc ha y6d0 ff12 fs7 fc0 sc0 ls0 ws0">2</div><div class="t m0 xb h6 y6cf ffe fs2 fc0 sc0 ls0 ws0">∈<span class="_ _32"> </span><span class="ffd">C<span class="_ _1e"> </span><span class="ff1">。换而言之，</span>C<span class="_ _1e"> </span><span class="ff1">包含了<span class="_ _d"> </span></span>C<span class="_ _35"> </span><span class="ff1">中任意两点的系数之和为<span class="_ _d"> </span><span class="ff3">1<span class="_ _d"> </span></span>的线性组合。</span></span></div><div class="t m0 x3 h6 y6d1 ff4 fs2 fc0 sc0 ls0 ws0">定义<span class="ff6">7.3<span class="_ _5"> </span></span><span class="fc1">仿射组合：<span class="_ _51"></span></span><span class="ff1">如果<span class="_ _25"> </span><span class="ffd">θ</span></span></div><div class="t m0 x38 ha y6d2 ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 x58 h4 y6d1 fff fs2 fc0 sc0 ls0 ws0">+<span class="_ _33"> </span><span class="ffe">·<span class="_ _31"></span>·<span class="_ _31"></span>·<span class="_ _33"></span></span>+<span class="_ _33"> </span><span class="ffd">θ</span></div><div class="t m0 x111 hb y6d3 ffc fs7 fc0 sc0 ls0 ws0">k</div><div class="t m0 x28 h6 y6d1 fff fs2 fc0 sc0 ls0 ws0">=<span class="_ _32"> </span>1<span class="ff1">，<span class="_ _2a"></span>我们称具有<span class="_ _25"> </span><span class="ffd">θ</span></span></div><div class="t m0 xc8 ha y6d2 ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 x26 he y6d1 ffd fs2 fc0 sc0 ls0 ws0">x</div><div class="t m0 x62 ha y6d2 ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 xa0 h4 y6d1 fff fs2 fc0 sc0 ls0 ws0">+<span class="_ _32"> </span><span class="ffe">·<span class="_ _31"></span>·<span class="_ _31"></span>·<span class="_ _33"></span></span>+<span class="_ _33"> </span><span class="ffd">θ</span></div><div class="t m0 x14b hb y6d3 ffc fs7 fc0 sc0 ls0 ws0">k</div><div class="t m0 x184 he y6d1 ffd fs2 fc0 sc0 ls0 ws0">x</div><div class="t m0 x10e hb y6d3 ffc fs7 fc0 sc0 ls0 ws0">k</div><div class="t m0 x11b h6 y6d1 ff1 fs2 fc0 sc0 ls0 ws0">形式的点为<span class="_ _32"> </span><span class="ffd">x</span></div><div class="t m0 x85 ha y6d2 ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 x1d h4 y6d1 ffd fs2 fc0 sc0 ls0 ws0">,<span class="_ _31"> </span><span class="ffe">·<span class="_ _31"></span>·<span class="_ _31"></span>·<span class="_ _d"> </span></span>,<span class="_ _31"> </span>x</div><div class="t m0 xd hb y6d3 ffc fs7 fc0 sc0 ls0 ws0">k</div><div class="t m0 x3 h6 y6d4 ff1 fs2 fc0 sc0 ls0 ws0">的仿射组合。</div><div class="t m0 x3 h6 y6d5 ff1 fs2 fc0 sc0 ls0 ws0">因此，仿射集合又可以被定义如下。</div><div class="t m0 x3 h6 y6d6 ff4 fs2 fc0 sc0 ls0 ws0">定义<span class="ff6">7.4<span class="_ _5"> </span></span><span class="fc1">仿射集合：<span class="_ _d"> </span></span><span class="ff1">仿射集合包含其中任意两点的仿射组合。</span></div><div class="t m0 x3 h6 y6d7 ff1 fs2 fc0 sc0 ls0 ws0">根据定义<span class="ff3">7.4</span>，我们可以归纳出以下结论：</div><div class="t m0 x3 h6 y6d8 ff1 fs2 fc0 sc0 ls0 ws0">一个<span class="_ _23"></span>仿射<span class="_ _23"></span>集合<span class="_ _23"></span>包含<span class="_ _23"></span>其中<span class="_ _23"></span>任意<span class="_ _23"></span>点的<span class="_ _23"></span>仿射<span class="_ _23"></span>组合，<span class="_ _23"></span>即如<span class="_ _23"></span>果<span class="_ _35"> </span><span class="ffd">C<span class="_ _0"> </span></span>是<span class="_ _23"></span>一个<span class="_ _23"></span>仿射<span class="_ _23"></span>集合，<span class="ffd">x</span></div><div class="t m0 x185 ha y6d9 ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 xa7 h4 y6d8 ffd fs2 fc0 sc0 ls0 ws0">,<span class="_ _31"> </span><span class="ffe">·<span class="_ _31"></span>·<span class="_ _31"></span>·<span class="_ _d"> </span></span>,<span class="_ _31"> </span>x</div><div class="t m0 x1a hb y6da ffc fs7 fc0 sc0 ls0 ws0">k</div><div class="t m0 x186 h6 y6d8 ffe fs2 fc0 sc0 ls0 ws0">∈<span class="_ _35"> </span><span class="ffd">C,<span class="_ _35"> </span><span class="ff1">并<span class="_ _23"></span>且</span></span></div><div class="t m0 x3 he y6db ffd fs2 fc0 sc0 ls0 ws0">θ</div><div class="t m0 x187 ha y6dc ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 x182 h4 y6db fff fs2 fc0 sc0 ls0 ws0">+<span class="_ _37"> </span><span class="ffe">·<span class="_ _31"></span>·<span class="_ _31"></span>·<span class="_ _37"> </span></span>+<span class="_ _37"> </span><span class="ffd">θ</span></div><div class="t m0 x12e hb y6dd ffc fs7 fc0 sc0 ls0 ws0">k</div><div class="t m0 x109 h6 y6db fff fs2 fc0 sc0 ls0 ws0">=<span class="_ _32"> </span>1<span class="ff3">,<span class="_ _d"> </span><span class="ff1">那么<span class="_ _d"> </span><span class="ffd">θ</span></span></span></div><div class="t m0 x118 ha y6dc ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 x6c he y6db ffd fs2 fc0 sc0 ls0 ws0">x</div><div class="t m0 x152 ha y6dc ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 xd7 h4 y6db fff fs2 fc0 sc0 ls0 ws0">+<span class="_ _37"> </span><span class="ffe">·<span class="_ _31"></span>·<span class="_ _31"></span>·<span class="_ _37"> </span></span>+<span class="_ _37"> </span><span class="ffd">θ</span></div><div class="t m0 xf3 hb y6dd ffc fs7 fc0 sc0 ls0 ws0">k</div><div class="t m0 x28 he y6db ffd fs2 fc0 sc0 ls0 ws0">x</div><div class="t m0 x16 hb y6dd ffc fs7 fc0 sc0 ls0 ws0">k</div><div class="t m0 x9d h6 y6db ff1 fs2 fc0 sc0 ls0 ws0">仍然在<span class="_ _d"> </span><span class="ffd">C<span class="_ _1e"> </span></span>中。</div><div class="t m0 x3 h6 y6de ff4 fs2 fc0 sc0 ls0 ws0">定义<span class="ff6">7.5<span class="_ _5"> </span></span><span class="fc1">仿射包：<span class="_ _a"> </span></span><span class="ff1">我们称由集合<span class="_ _25"> </span><span class="ffd">C<span class="_ _e"> </span><span class="ffe">⊆<span class="_ _a"> </span><span class="ff3">R</span></span></span></span></div><div class="t m0 x4f hb y6df ffc fs7 fc0 sc0 ls0 ws0">n</div><div class="t m0 xa9 h6 y6de ff1 fs2 fc0 sc0 ls0 ws0">中的点的所有仿射组合组成的集合为<span class="_ _25"> </span><span class="ffd">C<span class="_ _1e"> </span></span>的仿射包，<span class="_ _27"></span>记</div><div class="t m0 x3 h6 y6e0 ff1 fs2 fc0 sc0 ls0 ws0">为<span class="_ _d"> </span><span class="ff3">aff<span class="_ _5"> </span><span class="ffd">C</span></span></div><div class="t m0 xdd h4 y6e1 ff3 fs2 fc0 sc0 ls0 ws0">aff<span class="_ _5"> </span><span class="ffd">C<span class="_ _d"> </span><span class="fff">=<span class="_ _32"> </span><span class="ffe">{</span></span>θ</span></div><div class="t m0 xba ha y6e2 ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 xd7 he y6e1 ffd fs2 fc0 sc0 ls0 ws0">x</div><div class="t m0 x147 ha y6e2 ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 x9a h4 y6e1 fff fs2 fc0 sc0 ls0 ws0">+<span class="_ _37"> </span><span class="ffe">·<span class="_ _31"></span>·<span class="_ _31"></span>·<span class="_ _37"> </span></span>+<span class="_ _37"> </span><span class="ffd">θ</span></div><div class="t m0 x4f hb y6e3 ffc fs7 fc0 sc0 ls0 ws0">k</div><div class="t m0 xc7 he y6e1 ffd fs2 fc0 sc0 ls0 ws0">x</div><div class="t m0 x17 hb y6e3 ffc fs7 fc0 sc0 ls0 ws0">k</div><div class="t m0 xc2 h4 y6e1 ffe fs2 fc0 sc0 ls0 ws0">|<span class="_ _32"> </span><span class="ffd">x</span></div><div class="t m0 x5e ha y6e2 ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 x81 h4 y6e1 ffd fs2 fc0 sc0 ls0 ws0">,<span class="_ _31"> </span><span class="ffe">·<span class="_ _31"></span>·<span class="_ _31"></span>·<span class="_ _d"> </span></span>,<span class="_ _31"> </span>x</div><div class="t m0 x99 hb y6e3 ffc fs7 fc0 sc0 ls0 ws0">k</div><div class="t m0 xab h4 y6e1 ffe fs2 fc0 sc0 ls0 ws0">∈<span class="_ _32"> </span><span class="ffd">C,<span class="_ _31"> </span>θ</span></div><div class="t m0 xc6 ha y6e2 ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 xe8 h4 y6e1 fff fs2 fc0 sc0 ls0 ws0">+<span class="_ _37"> </span><span class="ffe">·<span class="_ _31"></span>·<span class="_ _31"></span>·<span class="_ _37"> </span></span>+<span class="_ _37"> </span><span class="ffd">θ</span></div><div class="t m0 xdf hb y6e3 ffc fs7 fc0 sc0 ls0 ws0">k</div><div class="t m0 xa5 h4 y6e1 fff fs2 fc0 sc0 ls0 ws0">=<span class="_ _32"> </span>1<span class="ffe">}</span></div><div class="t m0 x3 h6 y6e4 ff1 fs2 fc0 sc0 ls0 ws0">仿射包是包含<span class="_ _d"> </span><span class="ffd">C<span class="_ _1e"> </span></span>的最小的仿射集合。</div><div class="t m0 x3 h6 y6e5 ff4 fs2 fc0 sc0 ls0 ws0">定义<span class="ff6">7.6<span class="_ _5"> </span></span><span class="fc1">凸集：<span class="_ _d"> </span></span><span class="ff1">设集合<span class="_ _d"> </span><span class="ffd">S<span class="_ _d"> </span><span class="ffe">⊂<span class="_ _a"> </span></span>R</span></span></div><div class="t m0 x17a hb y6e6 ffc fs7 fc0 sc0 ls0 ws0">n</div><div class="t m0 xca h6 y6e5 ff1 fs2 fc0 sc0 ls0 ws0">，如果对任意<span class="_ _d"> </span><span class="ffd">x</span></div><div class="t m0 x13c ha y6e7 ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 x2b he y6e5 ffd fs2 fc0 sc0 ls0 ws0">,<span class="_ _31"> </span>x</div><div class="t m0 x45 ha y6e7 ff12 fs7 fc0 sc0 ls0 ws0">2</div><div class="t m0 x13f h6 y6e5 ffe fs2 fc0 sc0 ls0 ws0">∈<span class="_ _32"> </span><span class="ffd">S,<span class="_ _d"> </span><span class="ff1">有</span></span></div><div class="t m0 x6d he y6e8 ffd fs2 fc0 sc0 ls0 ws0">θ<span class="_ _23"></span>x</div><div class="t m0 x11c ha y6e9 ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 x12d h4 y6e8 fff fs2 fc0 sc0 ls0 ws0">+<span class="_ _37"> </span>(1<span class="_ _37"> </span><span class="ffe">−<span class="_ _37"> </span><span class="ffd">θ<span class="_ _23"></span></span></span>)<span class="ffd">x</span></div><div class="t m0 x65 ha y6e9 ff12 fs7 fc0 sc0 ls0 ws0">2</div><div class="t m0 x98 h4 y6e8 ffe fs2 fc0 sc0 ls0 ws0">∈<span class="_ _32"> </span><span class="ffd">S,<span class="_ _11"> </span></span>∀<span class="ffd">θ<span class="_ _25"> </span></span>∈<span class="_ _32"> </span><span class="fff">[0<span class="ffd">,<span class="_ _31"> </span></span>1]</span></div><div class="t m0 x3 h6 y6ea ff1 fs2 fc0 sc0 ls0 ws0">则称<span class="_ _d"> </span><span class="ffd">S<span class="_ _1e"> </span></span>是凸集。</div><div class="t m0 x12 h6 y6eb ff1 fs2 fc0 sc0 ls0 ws0">换而言之，<span class="_ _29"></span>对于<span class="_ _d"> </span><span class="ffd">n<span class="_ _25"> </span></span>维欧氏空间<span class="_ _25"> </span><span class="ffa">R</span></div><div class="t m0 x69 hb y6ec ffc fs7 fc0 sc0 ls0 ws0">n</div><div class="t m0 xf3 h6 y6eb ff1 fs2 fc0 sc0 ls0 ws0">中一个集合<span class="_ _25"> </span><span class="ffd">S<span class="_ _23"></span></span>，<span class="_ _30"></span>若对<span class="_ _25"> </span><span class="ffd">S<span class="_ _e"> </span></span>中任意两点，<span class="_ _30"></span>联结它们的线段仍</div><div class="t m0 x12 h6 y6ed ff1 fs2 fc0 sc0 ls0 ws0">属于<span class="_ _d"> </span><span class="ffd">S<span class="_ _23"></span></span>，则<span class="_ _d"> </span><span class="ffd">S<span class="_ _1e"> </span></span>是凸集。</div><div class="t m0 xc3 h4 y3 ff3 fs2 fc0 sc0 ls0 ws0">47</div><a class="l" href="#pf35" data-dest-detail='[53,"XYZ",92.68,400.08,null]'><div class="d m1" style="border-style:none;position:absolute;left:171.753000px;bottom:541.630500px;width:13.942000px;height:15.458000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.500000,0.000000,0.000000,1.500000,0.000000,0.000000]}'></div></div>
<div id="pf36" class="pf w0 h0" data-page-no="36"><div class="pc pc36 w0 h0"><img class="bi x3 y6ee w1 h43" alt="" src="bg36.png"/><div class="t m0 x3 h7 y21 ff3 fs5 fc0 sc0 ls0 ws0">7.2<span class="_ _8"> </span><span class="ff7">重要的凸集</span></div><div class="t m0 x12 h6 y143 ff3 fs2 fc0 sc0 ls0 ws0">a<span class="_ _d"> </span><span class="ff1">是凸集，</span>b<span class="_ _d"> </span><span class="ff1">是非凸集。</span></div><div class="t m0 x3 h6 y6ef ff4 fs2 fc0 sc0 ls0 ws0">定义<span class="ff6">7.7<span class="_ _5"> </span></span><span class="fc1">凸组合：<span class="_ _37"> </span></span><span class="ff1">如果<span class="_ _25"> </span><span class="ffd">θ</span></span></div><div class="t m0 xb0 ha y6f0 ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 x3f h4 y6ef fff fs2 fc0 sc0 ls0 ws0">+<span class="_ _31"> </span><span class="ffe">·<span class="_ _31"></span>·<span class="_ _31"></span>·<span class="_ _38"></span></span>+<span class="_ _38"> </span><span class="ffd">θ</span></div><div class="t m0 x12d hb y6f1 ffc fs7 fc0 sc0 ls0 ws0">k</div><div class="t m0 x11 h6 y6ef fff fs2 fc0 sc0 ls0 ws0">=<span class="_ _32"> </span>1<span class="ff1">，<span class="_ _30"></span>并且<span class="_ _25"> </span><span class="ffd">θ</span></span></div><div class="t m0 xc9 hb y6f0 ffc fs7 fc0 sc0 ls0 ws0">i</div><div class="t m0 x29 h6 y6ef ff1e fs2 fc0 sc0 ls0 ws0">⩾<span class="_ _32"> </span><span class="fff">0<span class="ffd">,<span class="_ _31"> </span>i<span class="_ _32"> </span></span>=<span class="_ _32"> </span>1<span class="ffd">,<span class="_ _31"> </span><span class="ffe">·<span class="_ _31"></span>·<span class="_ _31"></span>·<span class="_ _d"> </span></span>,<span class="_ _31"> </span>k<span class="_ _23"></span><span class="ff1">，<span class="_ _30"></span>我们称点<span class="_ _25"> </span><span class="ffd">θ</span></span></span></span></div><div class="t m0 x16c ha y6f0 ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 xfc he y6ef ffd fs2 fc0 sc0 ls0 ws0">x</div><div class="t m0 x188 ha y6f0 ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 x8e h4 y6ef fff fs2 fc0 sc0 ls0 ws0">+<span class="_ _31"> </span><span class="ffe">·<span class="_ _31"></span>·<span class="_ _31"></span>·<span class="_ _38"></span></span>+<span class="_ _38"> </span><span class="ffd">θ</span></div><div class="t m0 x189 hb y6f1 ffc fs7 fc0 sc0 ls0 ws0">k</div><div class="t m0 xbc he y6ef ffd fs2 fc0 sc0 ls0 ws0">x</div><div class="t m0 xd hb y6f1 ffc fs7 fc0 sc0 ls0 ws0">k</div><div class="t m0 x3 h6 y38f ff1 fs2 fc0 sc0 ls0 ws0">为点<span class="_ _d"> </span><span class="ffd">x</span></div><div class="t m0 x42 ha y6f2 ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 x43 h4 y38f ffd fs2 fc0 sc0 ls0 ws0">,<span class="_ _31"> </span><span class="ffe">·<span class="_ _31"></span>·<span class="_ _31"></span>·<span class="_ _d"> </span></span>,<span class="_ _31"> </span>x</div><div class="t m0 xcc hb y6f3 ffc fs7 fc0 sc0 ls0 ws0">k</div><div class="t m0 x88 h6 y38f ff1 fs2 fc0 sc0 ls0 ws0">的一个凸组合。</div><div class="t m0 x3 h6 y6f4 ff1 fs2 fc0 sc0 ls0 ws0">显然，从统计学的角度看，点的凸组合可以看作它们的加权平均（期望）<span class="_ _26"></span>。</div><div class="t m0 x3 h6 y6f5 ff1 fs2 fc0 sc0 ls0 ws0">与仿射集合类似，一个集合是凸集等价于集合包含其中所有点的凸组合。</div><div class="t m0 x3 h6 y6f6 ff4 fs2 fc0 sc0 ls0 ws0">定义<span class="ff6">7.8<span class="_ _5"> </span></span><span class="fc1">凸包：<span class="_ _d"> </span></span><span class="ff1">我们称集合<span class="_ _d"> </span><span class="ffd">C<span class="_ _1e"> </span></span>中所有点的凸组合的集合为其凸包，记为<span class="_ _d"> </span><span class="ff3">conv<span class="_ _31"> </span><span class="ffd">C<span class="_ _51"></span></span>:</span></span></div><div class="t m0 x108 h4 y6f7 ff3 fs2 fc0 sc0 ls0 ws0">conv<span class="_ _31"> </span><span class="ffd">C<span class="_ _d"> </span><span class="fff">=<span class="_ _32"> </span><span class="ffe">{</span></span>θ</span></div><div class="t m0 x17f ha y6f8 ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 x12f he y6f7 ffd fs2 fc0 sc0 ls0 ws0">x</div><div class="t m0 x118 ha y6f8 ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 x83 h4 y6f7 fff fs2 fc0 sc0 ls0 ws0">+<span class="_ _37"> </span><span class="ffe">·<span class="_ _31"></span>·<span class="_ _31"></span>·<span class="_ _37"> </span></span>+<span class="_ _37"> </span><span class="ffd">θ</span></div><div class="t m0 x9b hb y6f9 ffc fs7 fc0 sc0 ls0 ws0">k</div><div class="t m0 x73 he y6f7 ffd fs2 fc0 sc0 ls0 ws0">x</div><div class="t m0 xf3 hb y6f9 ffc fs7 fc0 sc0 ls0 ws0">k</div><div class="t m0 x95 h4 y6f7 ffe fs2 fc0 sc0 ls0 ws0">|<span class="_ _32"> </span><span class="ffd">x</span></div><div class="t m0 x9d hb y6f8 ffc fs7 fc0 sc0 ls0 ws0">i</div><div class="t m0 x96 h4 y6f7 ffe fs2 fc0 sc0 ls0 ws0">∈<span class="_ _32"> </span><span class="ffd">C,<span class="_ _31"> </span>θ</span></div><div class="t m0 x18a hb y6f8 ffc fs7 fc0 sc0 ls0 ws0">i</div><div class="t m0 x13e h4 y6f7 ff1e fs2 fc0 sc0 ls0 ws0">⩾<span class="_ _32"> </span><span class="fff">0<span class="ffd">,<span class="_ _31"> </span>i<span class="_ _32"> </span></span>=<span class="_ _32"> </span>1<span class="ffd">,<span class="_ _31"> </span><span class="ffe">·<span class="_ _31"></span>·<span class="_ _31"></span>·<span class="_ _d"> </span></span>,<span class="_ _31"> </span>k<span class="_ _23"></span>,<span class="_ _33"> </span>θ</span></span></div><div class="t m0 xbf ha y6f8 ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 x184 h4 y6f7 fff fs2 fc0 sc0 ls0 ws0">+<span class="_ _37"> </span><span class="ffe">·<span class="_ _31"></span>·<span class="_ _31"></span>·<span class="_ _37"> </span></span>+<span class="_ _37"> </span><span class="ffd">θ</span></div><div class="t m0 x10f hb y6f9 ffc fs7 fc0 sc0 ls0 ws0">k</div><div class="t m0 xfc h4 y6f7 fff fs2 fc0 sc0 ls0 ws0">=<span class="_ _32"> </span>1<span class="ffe">}</span></div><div class="t m0 x3 h6 y6fa ff1 fs2 fc0 sc0 ls0 ws0">顾名思义，凸包<span class="_ _d"> </span><span class="ff3">conv<span class="_ _31"> </span><span class="ffd">C<span class="_ _1e"> </span></span></span>总是凸的。它是包含<span class="_ _d"> </span><span class="ffd">C<span class="_ _1e"> </span></span>的最小的凸集。</div><div class="t m0 x3 h6 y6fb ff4 fs2 fc0 sc0 ls0 ws0">定义<span class="ff6">7.9<span class="_ _5"> </span></span><span class="fc1">锥：<span class="_ _d"> </span></span><span class="ff1">如果对于任意<span class="_ _d"> </span><span class="ffd">x<span class="_ _a"> </span><span class="ffe">∈<span class="_ _32"> </span></span>C<span class="_ _35"> </span></span>和<span class="_ _d"> </span><span class="ffd">θ<span class="_ _25"> </span><span class="ff1e">⩾<span class="_ _32"> </span><span class="fff">0<span class="_ _d"> </span></span></span></span>都有<span class="_ _d"> </span><span class="ffd">θ<span class="_ _23"></span>x<span class="_ _a"> </span><span class="ffe">∈<span class="_ _32"> </span></span>C<span class="_ _51"></span><span class="ff3">,<span class="_ _d"> </span></span></span>我们称集合<span class="_ _d"> </span><span class="ffd">C<span class="_ _1e"> </span></span>是锥或者非负齐次。</span></div><div class="t m0 x3 h6 y6fc ff4 fs2 fc0 sc0 ls0 ws0">定义<span class="ff6">7.10<span class="_ _5"> </span></span><span class="fc1">凸锥：<span class="_ _1e"> </span></span><span class="ff1">如果集<span class="_ _23"></span>合<span class="_ _e"> </span><span class="ffd">C<span class="_ _35"> </span></span>是<span class="_ _23"></span>锥，并且是<span class="_ _23"></span>凸的，则称<span class="_ _1e"> </span><span class="ffd">C<span class="_ _35"> </span></span>为<span class="_ _23"></span>凸锥，即对<span class="_ _23"></span>于任意<span class="_ _1e"> </span><span class="ffd">x</span></span></div><div class="t m0 x18b ha y6fd ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 x138 he y6fc ffd fs2 fc0 sc0 ls0 ws0">,<span class="_ _31"> </span>x</div><div class="t m0 x15a ha y6fd ff12 fs7 fc0 sc0 ls0 ws0">2</div><div class="t m0 x164 h6 y6fc ffe fs2 fc0 sc0 ls0 ws0">∈<span class="_ _d"> </span><span class="ffd">C<span class="_ _3f"> </span><span class="ff1">和</span></span></div><div class="t m0 x3 he y6fe ffd fs2 fc0 sc0 ls0 ws0">θ</div><div class="t m0 x187 ha y6ff ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 x143 he y6fe ffd fs2 fc0 sc0 ls0 ws0">,<span class="_ _31"> </span>θ</div><div class="t m0 x18c ha y6ff ff12 fs7 fc0 sc0 ls0 ws0">2</div><div class="t m0 x13 h6 y6fe ff1e fs2 fc0 sc0 ls0 ws0">⩾<span class="_ _32"> </span><span class="fff">0<span class="_ _d"> </span><span class="ff1">都有</span></span></div><div class="t m0 x16 he y700 ffd fs2 fc0 sc0 ls0 ws0">θ</div><div class="t m0 x5b ha y701 ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 x33 he y700 ffd fs2 fc0 sc0 ls0 ws0">x</div><div class="t m0 x5d ha y701 ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 x122 h4 y700 fff fs2 fc0 sc0 ls0 ws0">+<span class="_ _37"> </span><span class="ffd">θ</span></div><div class="t m0 x13c ha y701 ff12 fs7 fc0 sc0 ls0 ws0">2</div><div class="t m0 x18a he y700 ffd fs2 fc0 sc0 ls0 ws0">x</div><div class="t m0 x13e ha y701 ff12 fs7 fc0 sc0 ls0 ws0">2</div><div class="t m0 x2a h4 y700 ffe fs2 fc0 sc0 ls0 ws0">∈<span class="_ _32"> </span><span class="ffd">C</span></div><div class="t m0 x3 h6 y702 ff1 fs2 fc0 sc0 ls0 ws0">在几何<span class="_ _23"></span>上，具有此类形<span class="_ _23"></span>式的点构成<span class="_ _23"></span>了二维的扇<span class="_ _23"></span>形，这个扇形<span class="_ _23"></span>以<span class="_ _d"> </span><span class="ff3">0<span class="_ _e"> </span></span>为<span class="_ _23"></span>顶点，边通过<span class="_ _e"> </span><span class="ffd">x</span></div><div class="t m0 x18d ha y703 ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 x84 h6 y702 ff1 fs2 fc0 sc0 ls0 ws0">和<span class="_ _e"> </span><span class="ffd">x</span></div><div class="t m0 x13d ha y703 ff12 fs7 fc0 sc0 ls0 ws0">2</div><div class="t m0 xaf h6 y702 ff1 fs2 fc0 sc0 ls0 ws0">（如</div><div class="t m0 x3 h6 y704 ff1 fs2 fc0 sc0 ls0 ws0">图<span class="ff3">7.1</span>所示）<span class="_ _26"></span>。</div><div class="t m0 x94 h6 y705 ff1 fs2 fc0 sc0 ls0 ws0">图<span class="_ _d"> </span><span class="ff3">7.1:<span class="_ _35"> </span></span>二维凸锥</div><div class="t m0 x3 h6 y706 ff4 fs2 fc0 sc0 ls0 ws0">定义<span class="ff6">7.11<span class="_ _5"> </span></span><span class="fc1">锥<span class="_ _23"></span>组合：<span class="_ _1e"> </span></span><span class="ff1">具有<span class="_ _1e"> </span><span class="ffd">θ</span></span></div><div class="t m0 x38 ha y707 ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 xd7 he y706 ffd fs2 fc0 sc0 ls0 ws0">x</div><div class="t m0 x46 ha y707 ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 x133 h4 y706 fff fs2 fc0 sc0 ls0 ws0">+<span class="_ _a"> </span><span class="ffe">·<span class="_ _31"></span>·<span class="_ _31"></span>·<span class="_ _32"> </span></span>+<span class="_ _a"> </span><span class="ffd">θ</span></div><div class="t m0 x80 hb y708 ffc fs7 fc0 sc0 ls0 ws0">k</div><div class="t m0 x9d he y706 ffd fs2 fc0 sc0 ls0 ws0">x</div><div class="t m0 x96 hb y708 ffc fs7 fc0 sc0 ls0 ws0">k</div><div class="t m0 x5c he y706 ffd fs2 fc0 sc0 ls0 ws0">,<span class="_ _31"> </span>θ</div><div class="t m0 x97 ha y707 ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 x6f h4 y706 ffd fs2 fc0 sc0 ls0 ws0">,<span class="_ _31"> </span><span class="ffe">·<span class="_ _31"></span>·<span class="_ _31"></span>·<span class="_ _d"> </span></span>,<span class="_ _31"> </span>θ</div><div class="t m0 x77 hb y708 ffc fs7 fc0 sc0 ls0 ws0">k</div><div class="t m0 x124 h6 y706 ff1e fs2 fc0 sc0 ls0 ws0">⩾<span class="_ _1e"> </span><span class="fff">0<span class="_ _1e"> </span><span class="ff1">形式<span class="_ _23"></span>的点称<span class="_ _23"></span>为<span class="_ _1e"> </span><span class="ffd">x</span></span></span></div><div class="t m0 x173 ha y707 ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 xa8 h4 y706 ffd fs2 fc0 sc0 ls0 ws0">,<span class="_ _31"> </span><span class="ffe">·<span class="_ _31"></span>·<span class="_ _31"></span>·<span class="_ _d"> </span></span>,<span class="_ _31"> </span>x</div><div class="t m0 x138 hb y708 ffc fs7 fc0 sc0 ls0 ws0">k</div><div class="t m0 x15a h6 y706 ff1 fs2 fc0 sc0 ls0 ws0">的锥<span class="_ _23"></span>组合</div><div class="t m0 x14 h6 y709 ff1 fs2 fc0 sc0 ls0 ws0">（或非负线性组合）<span class="_ _26"></span>。</div><div class="t m0 x3 h6 y70a ff1 fs2 fc0 sc0 ls0 ws0">如果<span class="_ _25"> </span><span class="ffd">x</span></div><div class="t m0 x42 hb y70b ffc fs7 fc0 sc0 ls0 ws0">i</div><div class="t m0 xf0 h6 y70a ff1 fs2 fc0 sc0 ls0 ws0">均属于凸锥<span class="_ _25"> </span><span class="ffd">C<span class="_ _51"></span></span>，<span class="_ _12"></span>那么，<span class="_ _12"></span><span class="ffd">x</span></div><div class="t m0 xf hb y70b ffc fs7 fc0 sc0 ls0 ws0">i</div><div class="t m0 x5a h6 y70a ff1 fs2 fc0 sc0 ls0 ws0">的每一个锥组合也在<span class="_ _25"> </span><span class="ffd">C<span class="_ _35"> </span></span>中。<span class="_ _28"></span>反言之，集合<span class="_ _25"> </span><span class="ffd">C<span class="_ _1e"> </span></span>是凸雉的充要条</div><div class="t m0 x3 h6 y70c ff1 fs2 fc0 sc0 ls0 ws0">件是它包含其元素的所有雉组合。</div><div class="t m0 x3 h6 y70d ff4 fs2 fc0 sc0 ls0 ws0">定义<span class="ff6">7.12<span class="_ _5"> </span></span><span class="fc1">锥包：<span class="_ _d"> </span></span><span class="ff1">集合<span class="_ _d"> </span><span class="ffd">C<span class="_ _1e"> </span></span>的锥包是<span class="_ _d"> </span><span class="ffd">C<span class="_ _1e"> </span></span>中元素的所有雉组合的集合，即</span></div><div class="t m0 xcd h4 y70e ffe fs2 fc0 sc0 ls0 ws0">{<span class="ffd">θ</span></div><div class="t m0 x83 ha y70f ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 xce he y70e ffd fs2 fc0 sc0 ls0 ws0">x</div><div class="t m0 xd7 ha y70f ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 xe7 h4 y70e fff fs2 fc0 sc0 ls0 ws0">+<span class="_ _37"> </span><span class="ffe">·<span class="_ _31"></span>·<span class="_ _31"></span>·<span class="_ _37"> </span></span>+<span class="_ _37"> </span><span class="ffd">θ</span></div><div class="t m0 x95 hb y710 ffc fs7 fc0 sc0 ls0 ws0">k</div><div class="t m0 x32 he y70e ffd fs2 fc0 sc0 ls0 ws0">x</div><div class="t m0 xc7 hb y710 ffc fs7 fc0 sc0 ls0 ws0">k</div><div class="t m0 x96 h4 y70e ffe fs2 fc0 sc0 ls0 ws0">|<span class="_ _32"> </span><span class="ffd">x</span></div><div class="t m0 x75 hb y70f ffc fs7 fc0 sc0 ls0 ws0">i</div><div class="t m0 x6f h4 y70e ffe fs2 fc0 sc0 ls0 ws0">∈<span class="_ _32"> </span><span class="ffd">C,<span class="_ _31"> </span>θ</span></div><div class="t m0 x13f hb y70f ffc fs7 fc0 sc0 ls0 ws0">i</div><div class="t m0 x39 h4 y70e ff1e fs2 fc0 sc0 ls0 ws0">⩾<span class="_ _32"> </span><span class="fff">0<span class="ffd">,<span class="_ _31"> </span>i<span class="_ _32"> </span></span>=<span class="_ _32"> </span>1<span class="ffd">,<span class="_ _31"> </span><span class="ffe">·<span class="_ _31"></span>·<span class="_ _31"></span>·<span class="_ _d"> </span></span>,<span class="_ _31"> </span>k<span class="_ _23"></span><span class="ffe">}</span></span></span></div><div class="t m0 x3 h6 y711 ff1 fs2 fc0 sc0 ls0 ws0">它是包含<span class="_ _d"> </span><span class="ffd">C<span class="_ _1e"> </span></span>的最小的凸锥。</div><div class="t m0 x12d h9 y712 ff5 fs6 fc0 sc0 ls0 ws0">7.2<span class="_ _24"> </span><span class="ff9">重要的凸集</span></div><div class="t m0 x3 h6 y713 ff4 fs2 fc0 sc0 ls0 ws0">命题<span class="ff6">1<span class="_ _2"> </span><span class="ff1">射线<span class="_ _d"> </span><span class="ffd">S<span class="_ _d"> </span><span class="fff">=<span class="_ _32"> </span><span class="ffe">{</span></span>x<span class="_ _32"> </span><span class="ffe">|<span class="_ _32"> </span></span>x</span></span></span></div><div class="t m0 x8b ha y714 ff12 fs7 fc0 sc0 ls0 ws0">0</div><div class="t m0 x49 h6 y713 fff fs2 fc0 sc0 ls0 ws0">+<span class="_ _37"> </span><span class="ffd">λd,<span class="_ _31"> </span>λ<span class="_ _32"> </span><span class="ff1e">⩾<span class="_ _32"> </span></span></span>0<span class="ffe">}<span class="_ _25"> </span><span class="ff1">是凸集，<span class="_ _28"></span>其中，<span class="_ _28"></span><span class="ffd">d<span class="_ _d"> </span><span class="ff1">是给定的非零向量，<span class="_ _28"></span><span class="ffd">x</span></span></span></span></span></div><div class="t m0 x18e ha y714 ff12 fs7 fc0 sc0 ls0 ws0">0</div><div class="t m0 x131 h6 y713 ff1 fs2 fc0 sc0 ls0 ws0">为定点<span class="_ _28"></span>（射线的</div><div class="t m0 x3 h6 y715 ff1 fs2 fc0 sc0 ls0 ws0">顶点）<span class="_ _26"></span>。</div><div class="t m0 x3 h6 y2cc ff7 fs2 fc0 sc0 ls0 ws0">证明<span class="ff29">.<span class="_ _5"> </span><span class="ff1">对任意<span class="_ _d"> </span><span class="ffd">x</span></span></span></div><div class="t m0 x3b ha y716 ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 x88 he y2cc ffd fs2 fc0 sc0 ls0 ws0">,<span class="_ _31"> </span>x</div><div class="t m0 xde ha y716 ff12 fs7 fc0 sc0 ls0 ws0">2</div><div class="t m0 x159 h6 y2cc ffe fs2 fc0 sc0 ls0 ws0">∈<span class="_ _32"> </span><span class="ffd">S<span class="_ _1e"> </span><span class="ff1">和每一个数<span class="_ _d"> </span></span>λ<span class="_ _a"> </span></span>∈<span class="_ _32"> </span><span class="fff">[0<span class="ffd">,<span class="_ _31"> </span></span>1]<span class="ffd">,<span class="_ _d"> </span><span class="ff1">有</span></span></span></div><div class="t m0 xca he y696 ffd fs2 fc0 sc0 ls0 ws0">x</div><div class="t m0 x41 ha y717 ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 x51 h4 y696 fff fs2 fc0 sc0 ls0 ws0">=<span class="_ _32"> </span><span class="ffd">x</span></div><div class="t m0 x2f ha y717 ff12 fs7 fc0 sc0 ls0 ws0">0</div><div class="t m0 x52 h4 y696 fff fs2 fc0 sc0 ls0 ws0">+<span class="_ _37"> </span><span class="ffd">λ</span></div><div class="t m0 x5c ha y717 ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 xd9 he y696 ffd fs2 fc0 sc0 ls0 ws0">d,<span class="_ _7"> </span>x</div><div class="t m0 xd4 ha y717 ff12 fs7 fc0 sc0 ls0 ws0">2</div><div class="t m0 x36 h4 y696 fff fs2 fc0 sc0 ls0 ws0">=<span class="_ _32"> </span><span class="ffd">x</span></div><div class="t m0 xab ha y717 ff12 fs7 fc0 sc0 ls0 ws0">0</div><div class="t m0 x1f h4 y696 fff fs2 fc0 sc0 ls0 ws0">+<span class="_ _37"> </span><span class="ffd">λ</span></div><div class="t m0 xc5 ha y717 ff12 fs7 fc0 sc0 ls0 ws0">2</div><div class="t m0 xc6 he y696 ffd fs2 fc0 sc0 ls0 ws0">d</div><div class="t m0 x3 h6 y20 ff1 fs2 fc0 sc0 ls0 ws0">其中<span class="_ _d"> </span><span class="ffd">λ</span></div><div class="t m0 x42 hb y2cd ffc fs7 fc0 sc0 ls0 ws0">i</div><div class="t m0 x18f he y20 ffd fs2 fc0 sc0 ls0 ws0">,<span class="_ _31"> </span>λ</div><div class="t m0 xee ha y2cd ff12 fs7 fc0 sc0 ls0 ws0">2</div><div class="t m0 x12e h6 y20 ffe fs2 fc0 sc0 ls0 ws0">∈<span class="_ _32"> </span><span class="fff">[0<span class="ffd">,<span class="_ _31"> </span></span>1]<span class="ff1">，因而</span></span></div><div class="t m0 x3 h4 y3 ff3 fs2 fc0 sc0 ls0 ws0">48</div><a class="l" href="#pf36" data-dest-detail='[54,"XYZ",70.87,491.69,null]'><div class="d m1" style="border-style:none;position:absolute;left:122.662500px;bottom:744.064500px;width:13.942000px;height:15.458000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.500000,0.000000,0.000000,1.500000,0.000000,0.000000]}'></div></div>
<div id="pf37" class="pf w0 h0" data-page-no="37"><div class="pc pc37 w0 h0"><img class="bi x3 y718 w1 h44" alt="" src="bg37.png"/><div class="t m0 x190 h7 y21 ff3 fs5 fc0 sc0 ls0 ws0">7.3<span class="_ _8"> </span><span class="ff7">保持凸性的运算</span></div><div class="t m0 x2d he y719 ffd fs2 fc0 sc0 ls0 ws0">λx</div><div class="t m0 x118 ha y71a ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 x83 h4 y719 fff fs2 fc0 sc0 ls0 ws0">+<span class="_ _37"> </span>(1<span class="_ _37"> </span><span class="ffe">−<span class="_ _37"> </span><span class="ffd">λ</span></span>)<span class="ffd">x</span></div><div class="t m0 x111 ha y71a ff12 fs7 fc0 sc0 ls0 ws0">2</div><div class="t m0 x28 h4 y719 fff fs2 fc0 sc0 ls0 ws0">=<span class="_ _32"> </span><span class="ffd">λ<span class="_ _31"> </span></span>(<span class="ffd">x</span></div><div class="t m0 x34 ha y71a ff12 fs7 fc0 sc0 ls0 ws0">0</div><div class="t m0 x53 h4 y719 fff fs2 fc0 sc0 ls0 ws0">+<span class="_ _37"> </span><span class="ffd">λ</span></div><div class="t m0 x126 ha y71a ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 xd4 h4 y719 ffd fs2 fc0 sc0 ls0 ws0">d<span class="fff">)<span class="_ _37"> </span>+<span class="_ _37"> </span>(1<span class="_ _37"> </span><span class="ffe">−<span class="_ _37"> </span></span></span>λ<span class="fff">)<span class="_ _31"> </span>(</span>x</div><div class="t m0 x7c ha y71a ff12 fs7 fc0 sc0 ls0 ws0">0</div><div class="t m0 x7d h4 y719 fff fs2 fc0 sc0 ls0 ws0">+<span class="_ _37"> </span><span class="ffd">λ</span></div><div class="t m0 x6b ha y71a ff12 fs7 fc0 sc0 ls0 ws0">2</div><div class="t m0 x7e h4 y719 ffd fs2 fc0 sc0 ls0 ws0">d<span class="fff">)</span></div><div class="t m0 x28 h4 y71b fff fs2 fc0 sc0 ls0 ws0">=<span class="_ _32"> </span><span class="ffd">x</span></div><div class="t m0 x166 ha y71c ff12 fs7 fc0 sc0 ls0 ws0">0</div><div class="t m0 xbd h4 y71b fff fs2 fc0 sc0 ls0 ws0">+<span class="_ _37"> </span>[<span class="ffd">λλ</span></div><div class="t m0 x12a ha y71c ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 xd4 h4 y71b fff fs2 fc0 sc0 ls0 ws0">+<span class="_ _37"> </span>(1<span class="_ _37"> </span><span class="ffe">−<span class="_ _37"> </span><span class="ffd">λ</span></span>)<span class="ffd">λ</span></div><div class="t m0 xac ha y71c ff12 fs7 fc0 sc0 ls0 ws0">2</div><div class="t m0 xad h4 y71b fff fs2 fc0 sc0 ls0 ws0">]<span class="_ _31"> </span><span class="ffd">d</span></div><div class="t m0 x3 h6 y71d ff1 fs2 fc0 sc0 ls0 ws0">注意到<span class="_ _d"> </span><span class="ffd">λλ</span></div><div class="t m0 x12c ha y71e ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 x175 h4 y71d fff fs2 fc0 sc0 ls0 ws0">+<span class="_ _37"> </span>(1<span class="_ _37"> </span><span class="ffe">−<span class="_ _37"> </span><span class="ffd">λ</span></span>)<span class="ffd">λ</span></div><div class="t m0 x8a ha y71e ff12 fs7 fc0 sc0 ls0 ws0">2</div><div class="t m0 x191 h6 y71d ff1e fs2 fc0 sc0 ls0 ws0">⩾<span class="_ _32"> </span><span class="fff">0<span class="ffd">,<span class="_ _d"> </span><span class="ff1">故<span class="_ _d"> </span></span>λx</span></span></div><div class="t m0 x9b ha y71e ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 x72 h4 y71d fff fs2 fc0 sc0 ls0 ws0">+<span class="_ _37"> </span>(1<span class="_ _37"> </span><span class="ffe">−<span class="_ _37"> </span><span class="ffd">λ</span></span>)<span class="ffd">x</span></div><div class="t m0 xa ha y71e ff12 fs7 fc0 sc0 ls0 ws0">2</div><div class="t m0 x2b h6 y71d ffe fs2 fc0 sc0 ls0 ws0">∈<span class="_ _32"> </span><span class="ffd">S<span class="_ _23"></span><span class="ff1">。</span></span></div><div class="t m0 x12 h6 y71f ff1 fs2 fc0 sc0 ls0 ws0">一条射线是凸的，<span class="_ _30"></span>但不是仿射的。<span class="_ _27"></span>如果射线的基点<span class="_ _d"> </span><span class="ffd">x</span></div><div class="t m0 x37 ha y720 ff12 fs7 fc0 sc0 ls0 ws0">0</div><div class="t m0 x1e h6 y71f ff1 fs2 fc0 sc0 ls0 ws0">是<span class="_ _25"> </span><span class="ff3">0</span>，<span class="_ _27"></span>则它是凸雉。<span class="_ _27"></span>类似地，<span class="_ _30"></span>一条线</div><div class="t m0 x12 h6 y721 ff1 fs2 fc0 sc0 ls0 ws0">段是凸的，但不是仿射的，也不是凸锥。</div><div class="t m0 x3 h6 y722 ff1 fs2 fc0 sc0 ls0 ws0">若<span class="_ _d"> </span><span class="ffd">A<span class="_ _d"> </span></span>是<span class="_ _d"> </span><span class="ffd">m<span class="_ _37"> </span><span class="ffe">×<span class="_ _37"> </span></span>n<span class="_ _d"> </span></span>矩阵<span class="ff3">,<span class="_ _57"> </span><span class="ffd">b<span class="_ _32"> </span><span class="ffe">∈<span class="_ _32"> </span></span>R</span></span></div><div class="t m0 x46 hb y723 ffc fs7 fc0 sc0 ls0 ws0">n</div><div class="t m0 x59 h6 y722 ffd fs2 fc0 sc0 ls0 ws0">,<span class="_ _d"> </span><span class="ff1">则集合</span></div><div class="t m0 x72 h4 y724 ffd fs2 fc0 sc0 ls0 ws0">S<span class="_ _d"> </span><span class="fff">=<span class="_ _32"> </span><span class="ffe">{</span></span>x<span class="_ _32"> </span><span class="ffe">∈<span class="_ _32"> </span></span>R</div><div class="t m0 x13c hb y725 ffc fs7 fc0 sc0 ls0 ws0">n</div><div class="t m0 xaa h4 y724 ffe fs2 fc0 sc0 ls0 ws0">|<span class="_ _32"> </span><span class="ffd">Ax<span class="_ _32"> </span><span class="fff">=<span class="_ _32"> </span></span>b</span>}</div><div class="t m0 x3 h6 y726 ff1 fs2 fc0 sc0 ls0 ws0">是凸集。</div><div class="t m0 x3 h6 y727 ff4 fs2 fc0 sc0 ls0 ws0">命题<span class="ff6">2<span class="_ _2"> </span><span class="ff1">超平面<span class="_ _d"> </span><span class="ffd">H<span class="_ _e"> </span><span class="fff">=</span></span></span></span></div><div class="t m0 x159 hc y728 ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x2d h4 y727 ffd fs2 fc0 sc0 ls0 ws0">x<span class="_ _32"> </span><span class="ffe">|<span class="_ _32"> </span></span>p</div><div class="t m0 x192 hb y729 ffc fs7 fc0 sc0 ls0 ws0">T</div><div class="t m0 x154 h4 y727 ffd fs2 fc0 sc0 ls0 ws0">x<span class="_ _32"> </span><span class="fff">=<span class="_ _32"> </span></span>α</div><div class="t m0 x104 hc y728 ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x6e h6 y727 ff1 fs2 fc0 sc0 ls0 ws0">是凸集，<span class="_ _27"></span>其中<span class="_ _d"> </span><span class="ffd">p<span class="_ _32"> </span><span class="ffe">∈<span class="_ _32"> </span></span>R</span></div><div class="t m0 x44 hb y729 ffc fs7 fc0 sc0 ls0 ws0">n</div><div class="t m0 x1f h6 y727 ff1 fs2 fc0 sc0 ls0 ws0">是非零向量，<span class="_ _27"></span>称为超平面的法向量，<span class="_ _28"></span><span class="ffd">α</span></div><div class="t m0 x3 h6 y72a ff1 fs2 fc0 sc0 ls0 ws0">为实数。事实上，对任意<span class="_ _d"> </span><span class="ffd">x</span></div><div class="t m0 xba ha y72b ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 xd7 he y72a ffd fs2 fc0 sc0 ls0 ws0">,<span class="_ _31"> </span>x</div><div class="t m0 x17a ha y72b ff12 fs7 fc0 sc0 ls0 ws0">2</div><div class="t m0 xc1 h6 y72a ffe fs2 fc0 sc0 ls0 ws0">∈<span class="_ _32"> </span><span class="ffd">H<span class="_ _1e"> </span><span class="ff1">和每一个<span class="_ _d"> </span></span>θ<span class="_ _25"> </span></span>∈<span class="_ _32"> </span><span class="fff">[0<span class="ffd">,<span class="_ _31"> </span></span>1]<span class="ff1">，有</span></span></div><div class="t m0 x6e he y72c ffd fs2 fc0 sc0 ls0 ws0">p</div><div class="t m0 x111 hb y72d ffc fs7 fc0 sc0 ls0 ws0">T</div><div class="t m0 x2f h4 y72c fff fs2 fc0 sc0 ls0 ws0">[<span class="ffd">θ<span class="_ _23"></span>x</span></div><div class="t m0 x33 ha y72e ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 x1 h4 y72c fff fs2 fc0 sc0 ls0 ws0">+<span class="_ _37"> </span>(1<span class="_ _37"> </span><span class="ffe">−<span class="_ _37"> </span><span class="ffd">θ<span class="_ _23"></span></span></span>)<span class="ffd">x</span></div><div class="t m0 x77 ha y72e ff12 fs7 fc0 sc0 ls0 ws0">2</div><div class="t m0 x193 h4 y72c fff fs2 fc0 sc0 ls0 ws0">]<span class="_ _32"> </span>=<span class="_ _32"> </span><span class="ffd">α</span></div><div class="t m0 x3 h6 y72f ff1 fs2 fc0 sc0 ls0 ws0">故<span class="_ _d"> </span><span class="ffd">θ<span class="_ _23"></span>x</span></div><div class="t m0 x194 ha y730 ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 x195 h4 y72f fff fs2 fc0 sc0 ls0 ws0">+<span class="_ _37"> </span>(1<span class="_ _37"> </span><span class="ffe">−<span class="_ _37"> </span><span class="ffd">θ<span class="_ _23"></span></span></span>)<span class="ffd">x</span></div><div class="t m0 x167 ha y730 ff12 fs7 fc0 sc0 ls0 ws0">2</div><div class="t m0 x89 h4 y72f ffe fs2 fc0 sc0 ls0 ws0">∈<span class="_ _32"> </span><span class="ffd">H</span></div><div class="t m0 x3 h45 y731 ff7 fs2 fc0 sc0 ls0 ws0">证明<span class="ff29">.</span></div><div class="t m0 xb0 he y732 ffd fs2 fc0 sc0 ls0 ws0">p</div><div class="t m0 x192 hb y733 ffc fs7 fc0 sc0 ls0 ws0">T</div><div class="t m0 x50 h4 y732 fff fs2 fc0 sc0 ls0 ws0">[<span class="ffd">θ<span class="_ _23"></span>x</span></div><div class="t m0 x9a ha y734 ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 x196 h4 y732 fff fs2 fc0 sc0 ls0 ws0">+<span class="_ _37"> </span>(1<span class="_ _37"> </span><span class="ffe">−<span class="_ _37"> </span><span class="ffd">θ<span class="_ _23"></span></span></span>)<span class="ffd">x</span></div><div class="t m0 x1 ha y734 ff12 fs7 fc0 sc0 ls0 ws0">2</div><div class="t m0 xc2 h4 y732 fff fs2 fc0 sc0 ls0 ws0">]<span class="_ _32"> </span>=<span class="_ _32"> </span><span class="ffd">θ<span class="_ _23"></span>p</span></div><div class="t m0 x13e hb y733 ffc fs7 fc0 sc0 ls0 ws0">T</div><div class="t m0 xcf he y732 ffd fs2 fc0 sc0 ls0 ws0">x</div><div class="t m0 x13f ha y734 ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 x197 h4 y732 fff fs2 fc0 sc0 ls0 ws0">+<span class="_ _37"> </span><span class="ffd">p</span></div><div class="t m0 x1f hb y733 ffc fs7 fc0 sc0 ls0 ws0">T</div><div class="t m0 xea he y732 ffd fs2 fc0 sc0 ls0 ws0">x</div><div class="t m0 xa0 ha y734 ff12 fs7 fc0 sc0 ls0 ws0">2</div><div class="t m0 x63 h4 y732 ffe fs2 fc0 sc0 ls0 ws0">−<span class="_ _37"> </span><span class="ffd">θ<span class="_ _23"></span>p</span></div><div class="t m0 x12b hb y733 ffc fs7 fc0 sc0 ls0 ws0">T</div><div class="t m0 x135 he y732 ffd fs2 fc0 sc0 ls0 ws0">x</div><div class="t m0 x6a ha y734 ff12 fs7 fc0 sc0 ls0 ws0">2</div><div class="t m0 x198 h4 y735 fff fs2 fc0 sc0 ls0 ws0">=<span class="_ _32"> </span><span class="ffd">θ<span class="_ _23"></span>α<span class="_ _38"> </span></span>+<span class="_ _37"> </span><span class="ffd">α<span class="_ _a"> </span><span class="ffe">−<span class="_ _37"> </span></span>θα</span></div><div class="t m0 x198 h4 y736 fff fs2 fc0 sc0 ls0 ws0">=<span class="_ _32"> </span><span class="ffd">α</span></div><div class="t m0 x3 h6 y737 ff1 fs2 fc0 sc0 ls0 ws0">一个超平面将<span class="_ _d"> </span><span class="ffd">R</span></div><div class="t m0 x88 hb y738 ffc fs7 fc0 sc0 ls0 ws0">n</div><div class="t m0 x199 h6 y737 ff1 fs2 fc0 sc0 ls0 ws0">划分为两个半空间。<span class="ff3">(</span>闭的<span class="ff3">)<span class="_ _d"> </span></span>半空间是具有下列形式的集合，</div><div class="t m0 x5b hc y739 ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 xa9 h4 y73a ffd fs2 fc0 sc0 ls0 ws0">x<span class="_ _32"> </span><span class="ffe">|<span class="_ _32"> </span></span>p</div><div class="t m0 x53 hb y73b ffc fs7 fc0 sc0 ls0 ws0">T</div><div class="t m0 x81 he y73a ffd fs2 fc0 sc0 ls0 ws0">x<span class="_ _32"> </span><span class="ff1e">⩽<span class="_ _32"> </span></span>α</div><div class="t m0 x77 hc y739 ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x3 h6 y73c ff1 fs2 fc0 sc0 ls0 ws0">其中<span class="_ _d"> </span><span class="ffd">p<span class="_ _32"> </span><span class="ffe"≯<span class="fff">=<span class="_ _32"> </span>0</span></span></span>。</div><div class="t m0 x3 h6 y73d ff4 fs2 fc0 sc0 ls0 ws0">命<span class="_ _23"></span>题<span class="ff6">3<span class="_ _4"> </span><span class="ff1">闭<span class="_ _51"></span>半<span class="_ _23"></span>空<span class="_ _23"></span>间<span class="_ _18"> </span><span class="ffd">H</span></span></span></div><div class="t m0 x19a ha y73e ffb fs7 fc0 sc0 ls0 ws0">−</div><div class="t m0 x3e h4 y73d fff fs2 fc0 sc0 ls0 ws0">=</div><div class="t m0 xba hc y73f ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x4c h4 y73d ffd fs2 fc0 sc0 ls0 ws0">x<span class="_ _32"> </span><span class="ffe">|<span class="_ _32"> </span></span>p</div><div class="t m0 x4d hb y73e ffc fs7 fc0 sc0 ls0 ws0">T</div><div class="t m0 x19b he y73d ffd fs2 fc0 sc0 ls0 ws0">x<span class="_ _32"> </span><span class="ff1e">⩽<span class="_ _32"> </span></span>β</div><div class="t m0 x52 hc y73f ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x96 h6 y73d ff1 fs2 fc0 sc0 ls0 ws0">和<span class="_ _18"> </span><span class="ffd">H</span></div><div class="t m0 x19c ha y73e ff12 fs7 fc0 sc0 ls0 ws0">+</div><div class="t m0 xcf h4 y73d fff fs2 fc0 sc0 ls0 ws0">=</div><div class="t m0 x99 hc y73f ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x103 h4 y73d ffd fs2 fc0 sc0 ls0 ws0">x<span class="_ _32"> </span><span class="ffe">|<span class="_ _32"> </span></span>p</div><div class="t m0 x127 hb y73e ffc fs7 fc0 sc0 ls0 ws0">T</div><div class="t m0 x140 h6 y73d ffd fs2 fc0 sc0 ls0 ws0">x<span class="_ _32"> </span><span class="ff1e">⩾<span class="_ _a"> </span></span>β<span class="_ _51"></span><span class="ffe">}<span class="_ _18"> </span><span class="ff1">为<span class="_ _23"></span>凸<span class="_ _23"></span>集。<span class="_ _23"></span>开<span class="_ _23"></span>半<span class="_ _51"></span>空<span class="_ _23"></span>间</span></span></div><div class="t m0 xaf ha y740 ffb fs7 fc0 sc0 ls0 ws0">◦</div><div class="t m0 x19d he y741 ffd fs2 fc0 sc0 ls0 ws0">H</div><div class="t m0 x19e ha y742 ffb fs7 fc0 sc0 ls0 ws0">−</div><div class="t m0 x142 h4 y73d fff fs2 fc0 sc0 ls0 ws0">=</div><div class="t m0 x3 hc y743 ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x15c h4 y744 ff15 fs2 fc0 sc0 ls0 ws0">x <span class="ffe">|<span class="_ _a"> </span><span class="ffd">p</span></span></div><div class="t m0 x194 hb y745 ffc fs7 fc0 sc0 ls0 ws0">T</div><div class="t m0 x195 he y744 ffd fs2 fc0 sc0 ls0 ws0">x<span class="_ _32"> </span>&lt;<span class="_ _32"> </span>β</div><div class="t m0 xb3 hc y743 ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x19f h6 y744 ff1 fs2 fc0 sc0 ls0 ws0">和</div><div class="t m0 x1a0 ha y746 ffb fs7 fc0 sc0 ls0 ws0">◦</div><div class="t m0 xf2 he y747 ffd fs2 fc0 sc0 ls0 ws0">H</div><div class="t m0 xfe ha y748 ff12 fs7 fc0 sc0 ls0 ws0">+</div><div class="t m0 xb5 h4 y744 fff fs2 fc0 sc0 ls0 ws0">=</div><div class="t m0 x3e hc y743 ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x4b h4 y744 ffd fs2 fc0 sc0 ls0 ws0">x<span class="_ _32"> </span><span class="ffe">|<span class="_ _32"> </span></span>p</div><div class="t m0 x147 hb y745 ffc fs7 fc0 sc0 ls0 ws0">T</div><div class="t m0 x9a he y744 ffd fs2 fc0 sc0 ls0 ws0">x<span class="_ _32"> </span>&gt;<span class="_ _32"> </span>β</div><div class="t m0 x11 hc y743 ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 xe h6 y744 ff1 fs2 fc0 sc0 ls0 ws0">为凸集。</div><div class="t m0 x3 h6 y749 ff7 fs2 fc0 sc0 ls0 ws0">证明<span class="ff29">.<span class="_ _5"> </span><span class="ff1">类似于命题<span class="_ _d"> </span><span class="ff3">1</span>。</span></span></div><div class="t m0 xd8 h9 y74a ff5 fs6 fc0 sc0 ls0 ws0">7.3<span class="_ _24"> </span><span class="ff9">保持凸性的运算</span></div><div class="t m0 x3 hd y74b ff5 fs8 fc0 sc0 ls0 ws0">7.3.1<span class="_ _36"> </span><span class="ff9">交集</span></div><div class="t m0 x3 h6 y74c ff1 fs2 fc0 sc0 ls0 ws0">交集运算是<span class="_ _23"></span>保凸的：如果<span class="_ _d"> </span><span class="ffd">S</span></div><div class="t m0 x154 ha y74d ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 x46 h6 y74c ff1 fs2 fc0 sc0 ls0 ws0">和<span class="_ _d"> </span><span class="ffd">S</span></div><div class="t m0 x5a ha y74d ff12 fs7 fc0 sc0 ls0 ws0">2</div><div class="t m0 x73 h6 y74c ff1 fs2 fc0 sc0 ls0 ws0">是凸集，那么<span class="_ _e"> </span><span class="ffd">S</span></div><div class="t m0 x2a ha y74d ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 x21 h4 y74c ffe fs2 fc0 sc0 ls0 ws0">∩<span class="_ _37"> </span><span class="ffd">S</span></div><div class="t m0 x1e ha y74d ff12 fs7 fc0 sc0 ls0 ws0">2</div><div class="t m0 x11d h6 y74c ff1 fs2 fc0 sc0 ls0 ws0">也是凸集。这<span class="_ _23"></span>个性质可以扩展到无<span class="_ _23"></span>穷</div><div class="t m0 x3 h6 y74e ff1 fs2 fc0 sc0 ls0 ws0">个集合的交</div><div class="t m0 x176 h4 y74f ff3 fs2 fc0 sc0 ls0 ws0">:</div><div class="t m0 x1a1 h6 y74e ff1 fs2 fc0 sc0 ls0 ws0">如果对于任意</div><div class="t m0 x154 he y74f ffd fs2 fc0 sc0 ls0 ws0">α</div><div class="t m0 xe7 h4 y74e ffe fs2 fc0 sc0 ls0 ws0">∈<span class="_ _32"> </span>A</div><div class="t m0 x11c he y74f ffd fs2 fc0 sc0 ls0 ws0">,<span class="_ _31"> </span>S</div><div class="t m0 x172 hb y750 ffc fs7 fc0 sc0 ls0 ws0">α</div><div class="t m0 xd6 h6 y74f ff1 fs2 fc0 sc0 ls0 ws0">都是凸的，那么</div><div class="t m0 x37 h4 y74e ffe fs2 fc0 sc0 ls0 ws0">∩</div><div class="t m0 x25 ha y751 ffc fs7 fc0 sc0 ls0 ws0">α<span class="ffb">∈A</span></div><div class="t m0 xa0 he y74f ffd fs2 fc0 sc0 ls0 ws0">S</div><div class="t m0 xcb hb y750 ffc fs7 fc0 sc0 ls0 ws0">α</div><div class="t m0 xa1 h6 y74f ff1 fs2 fc0 sc0 ls0 ws0">也是凸集。</div><div class="t m0 x3 hd y752 ff5 fs8 fc0 sc0 ls0 ws0">7.3.2<span class="_ _36"> </span><span class="ff9">仿射函数</span></div><div class="t m0 x3 h6 y753 ff4 fs2 fc0 sc0 ls0 ws0">定义<span class="ff6">7.13<span class="_ _5"> </span></span><span class="fc1">仿射函数：<span class="_ _34"> </span></span><span class="ff1">函数<span class="_ _25"> </span><span class="ffd">f<span class="_ _1e"> </span><span class="fff">:<span class="_ _32"> </span><span class="ff3">R</span></span></span></span></div><div class="t m0 xf hb y754 ffc fs7 fc0 sc0 ls0 ws0">n</div><div class="t m0 x4e h4 y753 ffe fs2 fc0 sc0 ls0 ws0">→<span class="_ _32"> </span><span class="ff3">R</span></div><div class="t m0 x95 hb y754 ffc fs7 fc0 sc0 ls0 ws0">m</div><div class="t m0 xc7 h6 y753 ff1 fs2 fc0 sc0 ls0 ws0">是仿射的，<span class="_ _2e"></span>如果它是一个线性函数和一个常数的和，<span class="_ _2e"></span>即</div><div class="t m0 x3 h6 y755 ff1 fs2 fc0 sc0 ls0 ws0">具有<span class="_ _d"> </span><span class="ffd">f<span class="_ _34"></span><span class="fff">(</span>x<span class="fff">)<span class="_ _32"> </span>=<span class="_ _32"> </span></span>Ax<span class="_ _37"> </span><span class="fff">+<span class="_ _37"> </span></span>b<span class="_ _d"> </span></span>的形式，其中<span class="_ _d"> </span><span class="ffd">A<span class="_ _32"> </span><span class="ffe">∈<span class="_ _32"> </span><span class="ff15">R</span></span></span></div><div class="t m0 xc7 ha y756 ffc fs7 fc0 sc0 ls0 ws0">m<span class="ffb">×</span>n</div><div class="t m0 x198 h4 y755 ffd fs2 fc0 sc0 ls0 ws0">,<span class="_ _31"> </span>b<span class="_ _32"> </span><span class="ffe">∈<span class="_ _32"> </span><span class="ff15">R</span></span></div><div class="t m0 x9e hb y756 ffc fs7 fc0 sc0 ls0 ws0">m</div><div class="t m0 x197 h6 y755 ff1 fs2 fc0 sc0 ls0 ws0">。</div><div class="t m0 x3 h6 y757 ff1 fs2 fc0 sc0 ls0 ws0">假设</div><div class="t m0 x15d he y758 ffd fs2 fc0 sc0 ls0 ws0">S</div><div class="t m0 x18f h4 y757 ffe fs2 fc0 sc0 ls0 ws0">⊆</div><div class="t m0 x108 h3f y758 ff15 fs2 fc0 sc0 ls0 ws0">R</div><div class="t m0 xe2 hb y759 ffc fs7 fc0 sc0 ls0 ws0">n</div><div class="t m0 x7f h6 y757 ff1 fs2 fc0 sc0 ls0 ws0">是凸的，并且</div><div class="t m0 x50 he y758 ffd fs2 fc0 sc0 ls0 ws0">f</div><div class="t m0 x31 h4 y757 fff fs2 fc0 sc0 ls0 ws0">:</div><div class="t m0 x6d h3f y758 ff15 fs2 fc0 sc0 ls0 ws0">R</div><div class="t m0 x4d hb y759 ffc fs7 fc0 sc0 ls0 ws0">n</div><div class="t m0 x51 h4 y757 ffe fs2 fc0 sc0 ls0 ws0">→</div><div class="t m0 x9c h3f y758 ff15 fs2 fc0 sc0 ls0 ws0">R</div><div class="t m0 x32 hb y759 ffc fs7 fc0 sc0 ls0 ws0">m</div><div class="t m0 x166 h6 y757 ff1 fs2 fc0 sc0 ls0 ws0">是仿射函数。那么，</div><div class="t m0 x7b he y758 ffd fs2 fc0 sc0 ls0 ws0">S</div><div class="t m0 x179 h6 y757 ff1 fs2 fc0 sc0 ls0 ws0">在</div><div class="t m0 x135 he y758 ffd fs2 fc0 sc0 ls0 ws0">f</div><div class="t m0 xa4 h6 y757 ff1 fs2 fc0 sc0 ls0 ws0">下的象</div><div class="t m0 x111 h4 y20 ffd fs2 fc0 sc0 ls0 ws0">f<span class="_ _34"></span><span class="fff">(</span>S<span class="_ _23"></span><span class="fff">)<span class="_ _32"> </span>=<span class="_ _32"> </span><span class="ffe">{</span></span>f<span class="_ _34"> </span><span class="fff">(</span>x<span class="fff">)<span class="_ _32"> </span><span class="ffe">|<span class="_ _32"> </span></span></span>x<span class="_ _32"> </span><span class="ffe">∈<span class="_ _32"> </span></span>S<span class="_ _51"></span><span class="ffe">}</span></div><div class="t m0 xbc h4 y3 ff3 fs2 fc0 sc0 ls0 ws0">49</div></div><div class="pi" data-data='{"ctm":[1.500000,0.000000,0.000000,1.500000,0.000000,0.000000]}'></div></div>
<div id="pf38" class="pf w0 h0" data-page-no="38"><div class="pc pc38 w0 h0"><div class="t m0 x3 h7 y21 ff3 fs5 fc0 sc0 ls0 ws0">7.3<span class="_ _8"> </span><span class="ff7">保持凸性的运算</span></div><div class="t m0 x3 h6 y22 ff1 fs2 fc0 sc0 ls0 ws0">是凸的。</div><div class="t m0 x3 h6 y5c ff1 fs2 fc0 sc0 ls0 ws0">类似地，如果<span class="_ _d"> </span><span class="ffd">f<span class="_ _e"> </span><span class="fff">:<span class="_ _32"> </span><span class="ff15">R</span></span></span></div><div class="t m0 x55 hb y75a ffc fs7 fc0 sc0 ls0 ws0">k</div><div class="t m0 x19a h4 y5c ffe fs2 fc0 sc0 ls0 ws0">→<span class="_ _32"> </span><span class="ff15">R</span></div><div class="t m0 x4a hb y75a ffc fs7 fc0 sc0 ls0 ws0">n</div><div class="t m0 x1a2 h6 y5c ff1 fs2 fc0 sc0 ls0 ws0">是仿射函数<span class="ff3">,<span class="_ _d"> </span></span>那么<span class="_ _d"> </span><span class="ffd">S<span class="_ _1e"> </span></span>在<span class="_ _d"> </span><span class="ffd">f<span class="_ _35"> </span></span>下的原象</div><div class="t m0 x69 he y75b ffd fs2 fc0 sc0 ls0 ws0">f</div><div class="t m0 x11 ha y75c ffb fs7 fc0 sc0 ls0 ws0">−<span class="ff12">1</span></div><div class="t m0 x94 h4 y75b fff fs2 fc0 sc0 ls0 ws0">(<span class="ffd">S<span class="_ _23"></span></span>)<span class="_ _32"> </span>=<span class="_ _32"> </span><span class="ffe">{<span class="ffd">x<span class="_ _32"> </span></span>|<span class="_ _32"> </span><span class="ffd">f<span class="_ _34"> </span></span></span>(<span class="ffd">x</span>)<span class="_ _32"> </span><span class="ffe">∈<span class="_ _32"> </span><span class="ffd">S<span class="_ _51"></span></span>}</span></div><div class="t m0 x3 h6 y8a ff1 fs2 fc0 sc0 ls0 ws0">是凸的。</div><div class="t m0 x3 h6 y52d ff1 fs2 fc0 sc0 ls0 ws0">运用定义<span class="ff3">7.6</span>不难验证余下命题：</div><div class="t m0 x3 h6 y654 ff1 fs2 fc0 sc0 ls0 ws0">设<span class="_ _d"> </span><span class="ffd">S</span></div><div class="t m0 xe1 ha y75d ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 x161 h6 y654 ff1 fs2 fc0 sc0 ls0 ws0">和<span class="_ _d"> </span><span class="ffd">S</span></div><div class="t m0 x10b ha y75d ff12 fs7 fc0 sc0 ls0 ws0">2</div><div class="t m0 xf1 h6 y654 ff1 fs2 fc0 sc0 ls0 ws0">为<span class="_ _d"> </span><span class="ffa">R</span></div><div class="t m0 x54 hb y75e ffc fs7 fc0 sc0 ls0 ws0">n</div><div class="t m0 x89 h6 y654 ff1 fs2 fc0 sc0 ls0 ws0">中两个凸集，<span class="ffd">β<span class="_ _e"> </span></span>是实数，则</div><div class="t m0 x15 h4 y75f ff3 fs2 fc0 sc0 ls0 ws0">1.<span class="_ _5"> </span><span class="ffd">S</span></div><div class="t m0 x195 ha y760 ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 x163 hc y761 ff11 fs2 fc0 sc0 ls0 ws0">T</div><div class="t m0 x168 he y75f ffd fs2 fc0 sc0 ls0 ws0">S</div><div class="t m0 x132 ha y760 ff12 fs7 fc0 sc0 ls0 ws0">2</div><div class="t m0 xfd h6 y75f ff1 fs2 fc0 sc0 ls0 ws0">为凸集</div><div class="t m0 x15 h4 y762 ff3 fs2 fc0 sc0 ls0 ws0">2.<span class="_ _5"> </span><span class="ffd">β<span class="_ _23"></span>S</span></div><div class="t m0 x163 ha y763 ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 x12c h4 y762 fff fs2 fc0 sc0 ls0 ws0">=<span class="_ _32"> </span><span class="ffe">{<span class="ffd">β<span class="_ _23"></span>x<span class="_ _32"> </span></span>|<span class="_ _32"> </span><span class="ffd">x<span class="_ _32"> </span></span>∈<span class="_ _32"> </span><span class="ffd">S</span></span></div><div class="t m0 x3e ha y763 ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 x49 h6 y762 ffe fs2 fc0 sc0 ls0 ws0">}<span class="_ _d"> </span><span class="ff1">为凸集</span></div><div class="t m0 x15 h4 y764 ff3 fs2 fc0 sc0 ls0 ws0">3.<span class="_ _5"> </span><span class="ffd">S</span></div><div class="t m0 x195 ha y765 ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 x163 h4 y764 fff fs2 fc0 sc0 ls0 ws0">+<span class="_ _37"> </span><span class="ffd">S</span></div><div class="t m0 xf1 ha y765 ff12 fs7 fc0 sc0 ls0 ws0">2</div><div class="t m0 xfd h4 y764 fff fs2 fc0 sc0 ls0 ws0">=</div><div class="t m0 x88 hc y766 ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x3c he y764 ffd fs2 fc0 sc0 ls0 ws0">x</div><div class="t m0 x89 ha y767 ff12 fs7 fc0 sc0 ls0 ws0">(1)</div><div class="t m0 xb4 h4 y764 fff fs2 fc0 sc0 ls0 ws0">+<span class="_ _37"> </span><span class="ffd">x</span></div><div class="t m0 x6c ha y767 ff12 fs7 fc0 sc0 ls0 ws0">(2)</div><div class="t m0 x4c h4 y764 ffe fs2 fc0 sc0 ls0 ws0">|<span class="_ _32"> </span><span class="ffd">x</span></div><div class="t m0 x133 ha y767 ff12 fs7 fc0 sc0 ls0 ws0">(1)</div><div class="t m0 x4e h4 y764 ffe fs2 fc0 sc0 ls0 ws0">∈<span class="_ _32"> </span><span class="ffd">S</span></div><div class="t m0 x157 ha y765 ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 x95 he y764 ffd fs2 fc0 sc0 ls0 ws0">,<span class="_ _31"> </span>x</div><div class="t m0 xc7 ha y767 ff12 fs7 fc0 sc0 ls0 ws0">(2)</div><div class="t m0 xc2 h4 y764 ffe fs2 fc0 sc0 ls0 ws0">∈<span class="_ _32"> </span><span class="ffd">S</span></div><div class="t m0 x81 ha y765 ff12 fs7 fc0 sc0 ls0 ws0">2</div><div class="t m0 x2b hc y766 ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 xd4 h6 y764 ff1 fs2 fc0 sc0 ls0 ws0">为凸集</div><div class="t m0 x15 h4 y768 ff3 fs2 fc0 sc0 ls0 ws0">4.<span class="_ _5"> </span><span class="ffd">S</span></div><div class="t m0 x195 ha y769 ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 x163 h4 y768 ffe fs2 fc0 sc0 ls0 ws0">−<span class="_ _37"> </span><span class="ffd">S</span></div><div class="t m0 xf1 ha y769 ff12 fs7 fc0 sc0 ls0 ws0">2</div><div class="t m0 xfd h4 y768 fff fs2 fc0 sc0 ls0 ws0">=</div><div class="t m0 x88 hc y76a ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x3c he y768 ffd fs2 fc0 sc0 ls0 ws0">x</div><div class="t m0 x89 ha y76b ff12 fs7 fc0 sc0 ls0 ws0">(1)</div><div class="t m0 xb4 h4 y768 ffe fs2 fc0 sc0 ls0 ws0">−<span class="_ _37"> </span><span class="ffd">x</span></div><div class="t m0 x6c ha y76b ff12 fs7 fc0 sc0 ls0 ws0">(2)</div><div class="t m0 x4c h4 y768 ffe fs2 fc0 sc0 ls0 ws0">|<span class="_ _32"> </span><span class="ffd">x</span></div><div class="t m0 x133 ha y76b ff12 fs7 fc0 sc0 ls0 ws0">(1)</div><div class="t m0 x4e h4 y768 ffe fs2 fc0 sc0 ls0 ws0">∈<span class="_ _32"> </span><span class="ffd">S</span></div><div class="t m0 x157 ha y769 ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 x95 he y768 ffd fs2 fc0 sc0 ls0 ws0">,<span class="_ _31"> </span>x</div><div class="t m0 xc7 ha y76b ff12 fs7 fc0 sc0 ls0 ws0">(2)</div><div class="t m0 xc2 h4 y768 ffe fs2 fc0 sc0 ls0 ws0">∈<span class="_ _32"> </span><span class="ffd">S</span></div><div class="t m0 x81 ha y769 ff12 fs7 fc0 sc0 ls0 ws0">2</div><div class="t m0 x2b hc y76a ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 xd4 h6 y768 ff1 fs2 fc0 sc0 ls0 ws0">为凸集</div><div class="t m0 x3 h6 y76c ff1 fs2 fc0 sc0 ls0 ws0">在凸集中，比较重要的特殊情形有凸锥和多面集。</div><div class="t m0 x3 h4 y3 ff3 fs2 fc0 sc0 ls0 ws0">50</div><a class="l" href="#pf35" data-dest-detail='[53,"XYZ",92.68,234.5,null]'><div class="d m1" style="border-style:none;position:absolute;left:171.753000px;bottom:1036.980000px;width:13.942000px;height:15.458000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.500000,0.000000,0.000000,1.500000,0.000000,0.000000]}'></div></div>
<div id="pf39" class="pf w0 h0" data-page-no="39"><div class="pc pc39 w0 h0"><img class="bi x114 y76d w8 h46" alt="" src="bg39.png"/><div class="t m0 x31 h5 y4 ff4 fs3 fc0 sc0 ls0 ws0">第八章 梯度下降</div><div class="t m0 x104 h9 y66 ff5 fs6 fc0 sc0 ls0 ws0">8.1<span class="_ _24"> </span><span class="ff9">梯度下降原理</span></div><div class="t m0 x9 h4 y76e ffd fs2 fc0 sc0 ls0 ws0">f<span class="_ _34"></span><span class="fff">(</span>θ<span class="_ _23"></span><span class="fff">)<span class="_ _a"> </span><span class="ffe">≈<span class="_ _32"> </span></span></span>f<span class="_ _34"> </span><span class="fff">(</span>θ</div><div class="t m0 x33 ha y76f ff12 fs7 fc0 sc0 ls0 ws0">0</div><div class="t m0 xf4 h4 y76e fff fs2 fc0 sc0 ls0 ws0">)<span class="_ _37"> </span>+<span class="_ _37"> </span>(<span class="ff10">θ<span class="_ _a"> </span><span class="ffe">−<span class="_ _37"> </span></span>θ</span></div><div class="t m0 xd2 ha y76f ff24 fs7 fc0 sc0 ls0 ws0">0</div><div class="t m0 x60 h4 y76e fff fs2 fc0 sc0 ls0 ws0">)<span class="_ _37"> </span><span class="ffe">·<span class="_ _37"> </span><span class="ff26">∇<span class="ff10">f<span class="_ _34"></span><span class="ff2a">(</span>θ</span></span></span></div><div class="t m0 xad ha y76f ff24 fs7 fc0 sc0 ls0 ws0">0</div><div class="t m0 x162 h4 y76e ff2a fs2 fc0 sc0 ls0 ws0">)</div><div class="t m0 x3 h4 y770 ff10 fs2 fc0 sc0 ls0 ws0">θ<span class="_ _a"> </span><span class="ffe">−<span class="_ _38"></span></span>θ</div><div class="t m0 x15d ha y771 ff24 fs7 fc0 sc0 ls0 ws0">0</div><div class="t m0 xef h6 y770 ff1 fs2 fc0 sc0 ls0 ws0">是微小向量，它的大小就是步进长度，<span class="_ _12"></span>即学习率<span class="_ _25"> </span><span class="ffd">α</span>，<span class="ffd">α<span class="_ _d"> </span></span>是一个标量，而<span class="_ _25"> </span><span class="ff10">θ<span class="_ _a"> </span><span class="ffe">−<span class="_ _37"> </span></span>θ</span></div><div class="t m0 x8f ha y771 ff24 fs7 fc0 sc0 ls0 ws0">0</div><div class="t m0 x15a h6 y770 ff1 fs2 fc0 sc0 ls0 ws0">的单位向</div><div class="t m0 x3 h6 y772 ff1 fs2 fc0 sc0 ls0 ws0">量用<span class="_ _d"> </span><span class="ff10">v<span class="_ _e"> </span></span>表示，因此<span class="_ _d"> </span><span class="ff10">θ<span class="_ _a"> </span><span class="ffe">−<span class="_ _37"> </span></span>θ</span></div><div class="t m0 xb0 ha y773 ff24 fs7 fc0 sc0 ls0 ws0">0</div><div class="t m0 xce h6 y772 ff1 fs2 fc0 sc0 ls0 ws0">可表示为：</div><div class="t m0 x9d h4 y774 ff10 fs2 fc0 sc0 ls0 ws0">θ<span class="_ _a"> </span><span class="ffe">−<span class="_ _37"> </span></span>θ</div><div class="t m0 x6f ha y775 ff24 fs7 fc0 sc0 ls0 ws0">0</div><div class="t m0 x2b h4 y774 fff fs2 fc0 sc0 ls0 ws0">=<span class="_ _32"> </span><span class="ffd">α<span class="ff10">v</span></span></div><div class="t m0 x3 h6 y776 ff1 fs2 fc0 sc0 ls0 ws0">特别需要注意的是，<span class="_ _29"></span><span class="ff10">θ<span class="_ _37"> </span><span class="ffe">−<span class="_ _31"></span></span>θ</span></div><div class="t m0 x6c ha y777 ff24 fs7 fc0 sc0 ls0 ws0">0</div><div class="t m0 xba h6 y776 ff1 fs2 fc0 sc0 ls0 ws0">不能太大，<span class="_ _29"></span>因为太大的话，<span class="_ _30"></span>线性近似就不够准确，<span class="_ _29"></span>一阶泰勒近似也不</div><div class="t m0 x3 h6 y778 ff1 fs2 fc0 sc0 ls0 ws0">成立了，替换之后，<span class="ffd">f<span class="_ _34"></span><span class="fff">(</span>θ<span class="_ _23"></span><span class="fff">)<span class="_ _25"> </span></span></span>的表达式为：</div><div class="t m0 x11c h4 y779 ffd fs2 fc0 sc0 ls0 ws0">f<span class="_ _34"></span><span class="fff">(</span>θ<span class="_ _23"></span><span class="fff">)<span class="_ _a"> </span><span class="ffe">≈<span class="_ _32"> </span></span></span>f<span class="_ _34"> </span><span class="fff">(</span>θ</div><div class="t m0 x74 ha y77a ff12 fs7 fc0 sc0 ls0 ws0">0</div><div class="t m0 x123 h4 y779 fff fs2 fc0 sc0 ls0 ws0">)<span class="_ _37"> </span>+<span class="_ _37"> </span><span class="ffd">α<span class="ff10">v<span class="_ _a"> </span><span class="ffe">·<span class="_ _37"> </span><span class="ff26">∇</span></span>f<span class="_ _34"> </span><span class="ff2a">(</span>θ</span></span></div><div class="t m0 x7a ha y77a ff24 fs7 fc0 sc0 ls0 ws0">0</div><div class="t m0 x149 h4 y779 ff2a fs2 fc0 sc0 ls0 ws0">)</div><div class="t m0 x3 h6 y77b ff1 fs2 fc0 sc0 ls0 ws0">局部<span class="_ _23"></span>下降<span class="_ _23"></span>的目<span class="_ _23"></span>的是<span class="_ _23"></span>希望每<span class="_ _23"></span>次<span class="_ _1e"> </span><span class="ffd">θ<span class="_ _35"> </span></span>更<span class="_ _23"></span>新，都<span class="_ _23"></span>能让<span class="_ _23"></span>函数<span class="_ _23"></span>值<span class="_ _1e"> </span><span class="ffd">f<span class="_ _34"></span><span class="fff">(</span>θ<span class="_ _23"></span><span class="fff">)<span class="_ _1e"> </span></span></span>变小。<span class="_ _23"></span>也就<span class="_ _23"></span>是说，<span class="_ _23"></span>上式<span class="_ _23"></span>中，我们<span class="_ _23"></span>希望</div><div class="t m0 x3 h4 y77c ffd fs2 fc0 sc0 ls0 ws0">f<span class="_ _34"></span><span class="fff">(</span>θ<span class="_ _23"></span><span class="fff">)<span class="_ _a"> </span><span class="ffe">≤<span class="_ _32"> </span></span></span>f<span class="_ _34"> </span><span class="fff">(</span>θ</div><div class="t m0 x10b ha y77d ff12 fs7 fc0 sc0 ls0 ws0">0</div><div class="t m0 xe2 h6 y77c fff fs2 fc0 sc0 ls0 ws0">)<span class="ff1">。则有：</span></div><div class="t m0 x93 h4 y77e ffd fs2 fc0 sc0 ls0 ws0">f<span class="_ _34"></span><span class="fff">(</span>θ<span class="_ _23"></span><span class="fff">)<span class="_ _38"> </span><span class="ffe">−<span class="_ _37"> </span></span></span>f<span class="_ _33"> </span><span class="fff">(</span>θ</div><div class="t m0 x166 ha y77f ff12 fs7 fc0 sc0 ls0 ws0">0</div><div class="t m0 x1 h4 y77e fff fs2 fc0 sc0 ls0 ws0">)<span class="_ _32"> </span><span class="ffe">≈<span class="_ _32"> </span><span class="ffd">α<span class="ff10">v<span class="_ _a"> </span></span></span>·<span class="_ _37"> </span>∇<span class="ff10">f<span class="_ _34"> </span><span class="ff2a">(</span>θ</span></span></div><div class="t m0 x79 ha y77f ff24 fs7 fc0 sc0 ls0 ws0">0</div><div class="t m0 x11d h4 y77e ff2a fs2 fc0 sc0 ls0 ws0">)<span class="_ _32"> </span><span class="ffe">≤<span class="_ _32"> </span><span class="fff">0</span></span></div><div class="t m0 x3 h6 y780 ff1 fs2 fc0 sc0 ls0 ws0">因为<span class="_ _d"> </span><span class="ffd">α<span class="_ _d"> </span></span>为标量，且一般设定为正值，所以可以忽略，不等式变成了：</div><div class="t m0 x5b h4 y781 ff10 fs2 fc0 sc0 ls0 ws0">v<span class="_ _a"> </span><span class="ffe">·<span class="_ _37"> </span>∇<span class="ffd">f<span class="_ _34"></span><span class="fff">(</span>θ</span></span></div><div class="t m0 x18a ha y782 ff12 fs7 fc0 sc0 ls0 ws0">0</div><div class="t m0 x126 h4 y781 fff fs2 fc0 sc0 ls0 ws0">)<span class="_ _32"> </span><span class="ffe">≤<span class="_ _32"> </span></span>0</div><div class="t m0 x3 h6 y783 ff1 fs2 fc0 sc0 ls0 ws0">上面这个不等式非常重要！<span class="_ _27"></span><span class="ff10">v<span class="_ _d"> </span><span class="ff1">和<span class="_ _d"> </span><span class="ff26">∇</span></span>f<span class="_ _34"></span><span class="ff2a">(</span>θ</span></div><div class="t m0 x28 ha y784 ff24 fs7 fc0 sc0 ls0 ws0">0</div><div class="t m0 x16 h6 y783 ff2a fs2 fc0 sc0 ls0 ws0">)<span class="_ _25"> </span><span class="ff1">都是向量，<span class="_ _29"></span><span class="ff26">∇<span class="ff10">f<span class="_ _34"> </span><span class="ff2a">(</span>θ</span></span></span></div><div class="t m0 x11d ha y784 ff24 fs7 fc0 sc0 ls0 ws0">0</div><div class="t m0 x3a h6 y783 ff2a fs2 fc0 sc0 ls0 ws0">)<span class="_ _25"> </span><span class="ff1">是当前位置的梯度方向，<span class="_ _29"></span><span class="ff10">v<span class="_ _e"> </span><span class="ff1">表示下</span></span></span></div><div class="t m0 x3 h6 y785 ff1 fs2 fc0 sc0 ls0 ws0">一步前进的单位向量，是需要我们求解的，有了它，就能根据<span class="_ _d"> </span><span class="ff10">θ<span class="_ _a"> </span><span class="ffe">−<span class="_ _37"> </span></span>θ</span></div><div class="t m0 x135 ha y786 ff24 fs7 fc0 sc0 ls0 ws0">0</div><div class="t m0 x184 h6 y785 fff fs2 fc0 sc0 ls0 ws0">=<span class="_ _32"> </span><span class="ffd">α<span class="ff10">v<span class="_ _e"> </span><span class="ff1">来确定<span class="_ _d"> </span></span>θ<span class="_ _e"> </span><span class="ff1">的值了。</span></span></span></div><div class="t m0 x3 h6 y787 ff1 fs2 fc0 sc0 ls0 ws0">想要两个向量的乘积小于零，我们先来看一下两个向量乘积包含哪几种情况：</div><div class="t m0 x3 h6 y788 ff1 fs2 fc0 sc0 ls0 ws0">上图中，<span class="ff10">A<span class="_ _d"> </span></span>和<span class="_ _d"> </span><span class="ff10">B<span class="_ _e"> </span></span>均为向量，<span class="ffd">α<span class="_ _d"> </span></span>为两个向量之间的夹角。<span class="ff10">A<span class="_ _d"> </span></span>和<span class="_ _d"> </span><span class="ff10">B<span class="_ _1e"> </span></span>的乘积为：</div><div class="t m0 x5a h4 y789 ff10 fs2 fc0 sc0 ls0 ws0">A<span class="_ _37"> </span><span class="ffe">·<span class="_ _37"> </span></span>B<span class="_ _d"> </span><span class="fff">=<span class="_ _a"> </span><span class="ffe">||</span></span>A<span class="ffe">||<span class="_ _37"> </span>·<span class="_ _37"> </span>||</span>B<span class="_ _51"></span><span class="ffe">||<span class="_ _38"></span>·<span class="_ _37"> </span><span class="ffd">cos<span class="fff">(</span>α <span class="fff">)</span></span></span></div><div class="t m0 x3 h6 y78a ffe fs2 fc0 sc0 ls0 ws0">||<span class="ff10">A</span>||<span class="_ _d"> </span><span class="ff1">和<span class="_ _e"> </span></span>||<span class="ff10">B<span class="_ _23"></span></span>||<span class="_ _e"> </span><span class="ff1">均为标量，在<span class="_ _e"> </span></span>||<span class="ff10">A</span>||<span class="_ _e"> </span><span class="ff1">和<span class="_ _d"> </span></span>||<span class="ff10">B<span class="_ _23"></span></span>||<span class="_ _e"> </span><span class="ff1">确定的<span class="_ _23"></span>情况下，只要<span class="_ _d"> </span><span class="ffd">cos<span class="fff">(</span>α<span class="_ _23"></span><span class="fff">)<span class="_ _32"> </span>=<span class="_ _25"> </span></span></span></span>−<span class="fff">1<span class="ff1">，<span class="_ _23"></span>即<span class="_ _d"> </span><span class="ff10">A<span class="_ _e"> </span></span>和<span class="_ _d"> </span><span class="ff10">B<span class="_ _1e"> </span></span>完全</span></span></div><div class="t m0 x3 h6 y78b ff1 fs2 fc0 sc0 ls0 ws0">相反，就能让<span class="_ _d"> </span><span class="ff10">A<span class="_ _d"> </span></span>和<span class="_ _d"> </span><span class="ff10">B<span class="_ _e"> </span></span>的向量乘积最小（负最大值）<span class="_ _2f"></span>。</div><div class="t m0 x3 h6 y78c ff1 fs2 fc0 sc0 ls0 ws0">顾名思义，<span class="_ _2c"></span>当<span class="_ _32"> </span><span class="ff10">v<span class="_ _d"> </span></span>和<span class="_ _32"> </span><span class="ff26">∇<span class="ff10">f<span class="_ _34"> </span><span class="ff2a">(</span>θ</span></span></div><div class="t m0 x8c ha y78d ff24 fs7 fc0 sc0 ls0 ws0">0</div><div class="t m0 x4a h6 y78c ff2a fs2 fc0 sc0 ls0 ws0">)<span class="_ _32"> </span><span class="ff1">互为反向，<span class="_ _2c"></span>即当<span class="_ _25"> </span><span class="ff10">v<span class="_ _25"> </span></span>为当前梯度方向的负方向的时候，<span class="_ _2d"></span>能让<span class="_ _32"> </span><span class="ff10">v<span class="_ _33"> </span><span class="ffe">·<span class="_ _33"></span><span class="ff26">∇</span></span>f<span class="_ _34"></span><span class="ff2a">(</span>θ</span></span></div><div class="t m0 xbc ha y78d ff24 fs7 fc0 sc0 ls0 ws0">0</div><div class="t m0 xd h4 y78c ff2a fs2 fc0 sc0 ls0 ws0">)</div><div class="t m0 x3 h6 y78e ff1 fs2 fc0 sc0 ls0 ws0">最大程度地小，也就保证了<span class="_ _d"> </span><span class="ff10">v<span class="_ _e"> </span></span>的方向是局部下降最快的方向。</div><div class="t m0 x3 h6 y78f ff1 fs2 fc0 sc0 ls0 ws0">知道了<span class="_ _d"> </span><span class="ff10">v<span class="_ _e"> </span></span>是<span class="_ _d"> </span><span class="ff26">∇<span class="ff10">f<span class="_ _34"> </span><span class="ff2a">(</span>θ</span></span></div><div class="t m0 xde ha y790 ff24 fs7 fc0 sc0 ls0 ws0">0</div><div class="t m0 xfe h6 y78f ff2a fs2 fc0 sc0 ls0 ws0">)<span class="_ _d"> </span><span class="ff1">的反方向后，可直接得到：</span></div><div class="t m0 xe h4 y791 ff10 fs2 fc0 sc0 ls0 ws0">v<span class="_ _25"> </span><span class="fff">=<span class="_ _32"> </span><span class="ffe">−</span></span></div><div class="t m0 x5e h4 y792 ff26 fs2 fc0 sc0 ls0 ws0">∇<span class="ff10">f<span class="_ _34"></span><span class="ff2a">(</span>θ</span></div><div class="t m0 x13f ha y793 ff24 fs7 fc0 sc0 ls0 ws0">0</div><div class="t m0 xe0 h4 y792 ff2a fs2 fc0 sc0 ls0 ws0">)</div><div class="t m0 x198 h4 y794 ffe fs2 fc0 sc0 ls0 ws0">||<span class="ff26">∇<span class="ff10">f<span class="_ _34"></span><span class="ff2a">(</span>θ</span></span></div><div class="t m0 x13f ha y216 ff24 fs7 fc0 sc0 ls0 ws0">0</div><div class="t m0 xe0 h4 y794 ff2a fs2 fc0 sc0 ls0 ws0">)<span class="ffe">||</span></div><div class="t m0 xc3 h4 y3 ff3 fs2 fc0 sc0 ls0 ws0">51</div></div><div class="pi" data-data='{"ctm":[1.500000,0.000000,0.000000,1.500000,0.000000,0.000000]}'></div></div>
<div id="pf3a" class="pf w0 h0" data-page-no="3a"><div class="pc pc3a w0 h0"><img class="bi x13c y795 w13 h47" alt="" src="bg3a.png"/><div class="t m0 x3 h7 y21 ff3 fs5 fc0 sc0 ls0 ws0">8.1<span class="_ _8"> </span><span class="ff7">梯度下降原理</span></div><div class="t m0 x3 h6 y22 ff1 fs2 fc0 sc0 ls0 ws0">之所以要除以<span class="_ _d"> </span><span class="ff26">∇<span class="ff10">f<span class="_ _34"></span><span class="ff2a">(</span>θ</span></span></div><div class="t m0 xdb ha y796 ff24 fs7 fc0 sc0 ls0 ws0">0</div><div class="t m0 x2d h6 y22 ff2a fs2 fc0 sc0 ls0 ws0">)<span class="_ _d"> </span><span class="ff1">的模<span class="_ _d"> </span><span class="ffe">||<span class="ff26">∇<span class="ff10">f<span class="_ _34"></span></span></span></span></span>(<span class="ff10">θ</span></div><div class="t m0 x172 ha y796 ff24 fs7 fc0 sc0 ls0 ws0">0</div><div class="t m0 x48 h6 y22 ff2a fs2 fc0 sc0 ls0 ws0">)<span class="ffe">||<span class="ff1">，是因为<span class="_ _d"> </span><span class="ff10">v<span class="_ _e"> </span></span>是单位向量。</span></span></div><div class="t m0 x3 h6 y5c ff1 fs2 fc0 sc0 ls0 ws0">求出最优解<span class="_ _d"> </span><span class="ff10">v<span class="_ _e"> </span></span>之后，带入到<span class="_ _d"> </span><span class="ff10">θ<span class="_ _a"> </span><span class="ffe">−<span class="_ _37"> </span></span>θ</span></div><div class="t m0 xff ha y797 ff24 fs7 fc0 sc0 ls0 ws0">0</div><div class="t m0 x172 h6 y5c fff fs2 fc0 sc0 ls0 ws0">=<span class="_ _32"> </span><span class="ffd">α<span class="ff10">v<span class="_ _e"> </span><span class="ff1">中，得：</span></span></span></div><div class="t m0 x47 h4 y798 ff10 fs2 fc0 sc0 ls0 ws0">θ<span class="_ _25"> </span><span class="fff">=<span class="_ _32"> </span></span>θ</div><div class="t m0 x24 ha y799 ff24 fs7 fc0 sc0 ls0 ws0">0</div><div class="t m0 x5c h4 y798 ffe fs2 fc0 sc0 ls0 ws0">−<span class="_ _37"> </span><span class="ffd">α</span></div><div class="t m0 x12a h4 y79a ff26 fs2 fc0 sc0 ls0 ws0">∇<span class="ff10">f<span class="_ _34"></span><span class="ff2a">(</span>θ</span></div><div class="t m0 x66 ha y79b ff24 fs7 fc0 sc0 ls0 ws0">0</div><div class="t m0 x148 h4 y79a ff2a fs2 fc0 sc0 ls0 ws0">)</div><div class="t m0 x13c h4 y79c ffe fs2 fc0 sc0 ls0 ws0">||<span class="ff26">∇<span class="ff10">f<span class="_ _34"></span><span class="ff2a">(</span>θ</span></span></div><div class="t m0 x66 ha y79d ff24 fs7 fc0 sc0 ls0 ws0">0</div><div class="t m0 x148 h4 y79c ff2a fs2 fc0 sc0 ls0 ws0">)<span class="ffe">||</span></div><div class="t m0 x3 h6 y79e ff1 fs2 fc0 sc0 ls0 ws0">一般的，因为<span class="_ _d"> </span><span class="ffe">||<span class="ff26">∇<span class="ff10">f<span class="_ _34"></span><span class="ff2a">(</span>θ</span></span></span></div><div class="t m0 x2d ha y79f ff24 fs7 fc0 sc0 ls0 ws0">0</div><div class="t m0 x12f h6 y79e ff2a fs2 fc0 sc0 ls0 ws0">)<span class="ffe">||<span class="_ _d"> </span><span class="ff1">是标量，可以并入到学习率<span class="_ _d"> </span><span class="ffd">α<span class="_ _d"> </span></span>中，即简化为：</span></span></div><div class="t m0 x9c h4 y7a0 ff10 fs2 fc0 sc0 ls0 ws0">θ<span class="_ _25"> </span><span class="fff">=<span class="_ _32"> </span></span>θ</div><div class="t m0 x5c ha y7a1 ff24 fs7 fc0 sc0 ls0 ws0">0</div><div class="t m0 x123 h4 y7a0 ffe fs2 fc0 sc0 ls0 ws0">−<span class="_ _37"> </span><span class="ffd">α<span class="ff26">∇<span class="ff10">f<span class="_ _34"> </span><span class="ff2a">(</span>θ</span></span></span></div><div class="t m0 x66 ha y7a1 ff24 fs7 fc0 sc0 ls0 ws0">0</div><div class="t m0 x148 h4 y7a0 ff2a fs2 fc0 sc0 ls0 ws0">)</div><div class="t m0 x3 h6 y7a2 ff1 fs2 fc0 sc0 ls0 ws0">把<span class="_ _d"> </span><span class="ffd">f<span class="_ _34"></span><span class="fff">(</span>θ<span class="_ _23"></span><span class="fff">)<span class="_ _25"> </span></span></span>换为目标函数<span class="_ _d"> </span><span class="ffd">J<span class="_ _34"></span><span class="fff">(</span>θ<span class="_ _23"></span><span class="fff">)</span></span>，就是我们上面的梯度下降公式了：</div><div class="t m0 x40 h4 y7a3 ff10 fs2 fc0 sc0 ls0 ws0">θ<span class="_ _25"> </span><span class="fff">=<span class="_ _32"> </span></span>θ</div><div class="t m0 x9b ha y7a4 ff24 fs7 fc0 sc0 ls0 ws0">0</div><div class="t m0 x47 h4 y7a3 ffe fs2 fc0 sc0 ls0 ws0">−<span class="_ _37"> </span><span class="ffd">α<span class="ff26">∇<span class="ff10">J<span class="_ _34"></span><span class="ff2a">(</span>θ</span></span></span></div><div class="t m0 xc3 ha y7a4 ff24 fs7 fc0 sc0 ls0 ws0">0</div><div class="t m0 x81 h4 y7a3 ff2a fs2 fc0 sc0 ls0 ws0">)<span class="_ _32"> </span><span class="fff">=<span class="_ _32"> </span><span class="ff10">θ</span></span></div><div class="t m0 x71 ha y7a4 ff24 fs7 fc0 sc0 ls0 ws0">0</div><div class="t m0 x99 h4 y7a3 ffe fs2 fc0 sc0 ls0 ws0">−<span class="_ _37"> </span><span class="ffd">α<span class="_ _37"> </span></span>·</div><div class="t m0 x127 h4 y7a5 ffd fs2 fc0 sc0 ls0 ws0">∂<span class="_ _23"></span>J<span class="_ _34"></span><span class="fff">(</span>θ<span class="_ _23"></span><span class="fff">)</span></div><div class="t m0 xcb he y7a6 ffd fs2 fc0 sc0 ls0 ws0">∂<span class="_ _23"></span>θ</div><div class="t m0 x3 h6 y7a7 ff1 fs2 fc5 sc0 ls0 ws0">梯度下降算法总结</div><div class="t m0 x3 h4 y3 ff3 fs2 fc0 sc0 ls0 ws0">52</div><a class="l" href="https://lumingdong.cn/summary-of-gradient-descent-algorithm.html"><div class="d m1" style="border-style:none;position:absolute;left:106.299000px;bottom:899.832000px;width:87.273000px;height:10.909000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.500000,0.000000,0.000000,1.500000,0.000000,0.000000]}'></div></div>
<div id="pf3b" class="pf w0 h0" data-page-no="3b"><div class="pc pc3b w0 h0"><div class="t m0 x56 h5 y4 ff4 fs3 fc0 sc0 ls0 ws0">第九章 <span class="ff5">Bac<span class="_ _28"></span>kpropagation</span></div><div class="t m0 x11 h9 y66 ff5 fs6 fc0 sc0 ls0 ws0">9.1<span class="_ _24"> </span><span class="ff9">神经网络</span></div><div class="t m0 x3 h6 y7a8 ff1 fs2 fc0 sc0 ls0 ws0">神经网络是按照一定规则连接起来的多个神经元。神经网络按照层级来布局神经元。</div><div class="t m0 x15 h6 y7a9 ff3 fs2 fc0 sc0 ls0 ws0">•<span class="_ _5"> </span><span class="ff1">最左边的层叫做输入层（</span>input<span class="_ _25"> </span>lay<span class="_ _12"></span>er<span class="ff1">）<span class="_ _26"></span>，主要负责接收输入数据。</span></div><div class="t m0 x15 h6 y7aa ff3 fs2 fc0 sc0 ls0 ws0">•<span class="_ _5"> </span><span class="ff1">最右边的层叫输出层（</span>output<span class="_ _25"> </span>lay<span class="_ _12"></span>er<span class="ff1">）<span class="_ _26"></span>，可以从这一层获取神经网络输出数据。</span></div><div class="t m0 x15 h6 y7ab ff3 fs2 fc0 sc0 ls0 ws0">•<span class="_ _5"> </span><span class="ff1">输入层与输出层之间的层叫做隐藏<span class="_ _23"></span>层，可以包含多个隐藏层，之所以叫做隐藏层，是<span class="_ _23"></span>因为</span></div><div class="t m0 x13 h6 y7ac ff1 fs2 fc0 sc0 ls0 ws0">它们对于外部来说是不可见的。</div><div class="t m0 x3 h6 y7ad ff1 fs2 fc0 sc0 ls0 ws0">全连接神经网络的特征如下：</div><div class="t m0 x15 h6 y7ae ff3 fs2 fc0 sc0 ls0 ws0">1.<span class="_ _5"> </span><span class="ff1">位于同一层的各个神经元没有任何连接。</span></div><div class="t m0 x15 h6 y7af ff3 fs2 fc0 sc0 ls0 ws0">2.<span class="_ _5"> </span><span class="ff1">位于第<span class="_ _25"> </span></span>N<span class="_ _d"> </span><span class="ff1">层的每个神经元都与第<span class="_ _25"> </span></span>N-1<span class="_ _d"> </span><span class="ff1">层的所有神经元相连，<span class="_ _28"></span>也就是全连接<span class="_ _12"></span>（<span class="ff3">F<span class="_ _27"></span>ull<span class="_ _25"> </span>Connec-</span></span></div><div class="t m0 x13 h6 y7b0 ff3 fs2 fc0 sc0 ls0 ws0">tion<span class="ff1">）<span class="_ _26"></span>，第<span class="_ _d"> </span><span class="ff3">N-1<span class="_ _d"> </span></span>层神经元的输出就是第<span class="_ _d"> </span><span class="ff3">N<span class="_ _d"> </span></span>层神经元的输入。</span></div><div class="t m0 x15 h6 y7b1 ff3 fs2 fc0 sc0 ls0 ws0">3.<span class="_ _5"> </span><span class="ff1">全连接的每个连接都有一个权值。</span></div><div class="t m0 x3 h6 y7b2 ff1 fs2 fc0 sc0 ls0 ws0">事实上还存在很多其它结构的神经网络，<span class="_ _12"></span>比如卷积神经网络<span class="_ _25"> </span><span class="ff3">(CNN)</span>、循环神经网络<span class="_ _25"> </span><span class="ff3">(RNN)</span>，他</div><div class="t m0 x3 h6 y7b3 ff1 fs2 fc0 sc0 ls0 ws0">们都具有不同的连接规则。</div><div class="t m0 x11 h9 y7b4 ff5 fs6 fc0 sc0 ls0 ws0">9.2<span class="_ _24"> </span><span class="ff9">基本函数</span></div><div class="t m0 x3 h6 y7b5 ff1 fs2 fc0 sc0 ls0 ws0">推导<span class="_ _d"> </span><span class="ff3">BP<span class="_ _d"> </span></span>算法的过程中需要注意几个要点：</div><div class="t m0 x15 h6 y7b6 ff3 fs2 fc0 sc0 ls0 ws0">•<span class="_ _5"> </span><span class="ff1">网络函数</span></div><div class="t m0 x15 h6 y7b7 ff3 fs2 fc0 sc0 ls0 ws0">•<span class="_ _5"> </span><span class="ff1">激活函数：</span>sigmoid</div><div class="t m0 x15 h6 y7b8 ff3 fs2 fc0 sc0 ls0 ws0">•<span class="_ _5"> </span><span class="ff1">误差函数：平方误差</span></div><div class="t m0 x15 h6 y7b9 ff3 fs2 fc0 sc0 ls0 ws0">•<span class="_ _5"> </span><span class="ff1">优化方法：梯度下降，降低误差大的网络的权值，增加误差小的网络的权值。</span></div><div class="t m0 x3 h6 y7ba ff1 fs2 fc0 sc0 ls0 ws0">下面先来介绍几个在神经网络反向传播算法的推导过程中用到的几个函数：</div><div class="t m0 x3 h6 y7bb ff6 fs2 fc0 sc0 ls0 ws0">1.Net<span class="_ _12"></span>w<span class="_ _12"></span>ork<span class="_ _e"> </span>function(<span class="ff4">网络函数</span>)</div><div class="t m0 x3 h4 y7bc ff3 fs2 fc0 sc0 ls0 ws0">The netw<span class="_ _28"></span>ork is<span class="_ _25"> </span>a particular<span class="_ _25"> </span>implemen<span class="_ _12"></span>tation of a<span class="_ _25"> </span>comp<span class="_ _23"></span>osite function from input<span class="_ _25"> </span>to output space,</div><div class="t m0 x3 h4 y7bd ff3 fs2 fc0 sc0 ls0 ws0">whic<span class="_ _12"></span>h<span class="_ _d"> </span>w<span class="_ _12"></span>e<span class="_ _d"> </span>call<span class="_ _d"> </span>the<span class="_ _d"> </span>net<span class="_ _12"></span>w<span class="_ _12"></span>ork<span class="_ _d"> </span>function.</div><div class="t m0 x172 h4 y7be ffd fs2 fc0 sc0 ls0 ws0">h<span class="fff">(</span>x<span class="fff">)<span class="_ _32"> </span>=<span class="_ _32"> </span></span>w</div><div class="t m0 x123 hb y7bf ffc fs7 fc0 sc0 ls0 ws0">T</div><div class="t m0 x6f h4 y7be ffd fs2 fc0 sc0 ls0 ws0">x<span class="_ _32"> </span><span class="fff">=</span></div><div class="t m0 x36 hb y7c0 ffc fs7 fc0 sc0 ls0 ws0">n</div><div class="t m0 x45 hc y7c1 ff11 fs2 fc0 sc0 ls0 ws0">X</div><div class="t m0 xcf ha y7c2 ffc fs7 fc0 sc0 ls0 ws0">i<span class="ff12">=1</span></div><div class="t m0 x78 he y7be ffd fs2 fc0 sc0 ls0 ws0">w</div><div class="t m0 x25 hb y7c3 ffc fs7 fc0 sc0 ls0 ws0">i</div><div class="t m0 x158 he y7be ffd fs2 fc0 sc0 ls0 ws0">x</div><div class="t m0 x11d hb y7c3 ffc fs7 fc0 sc0 ls0 ws0">i</div><div class="t m0 x3 h6 y87 ff6 fs2 fc0 sc0 ls0 ws0">2.A<span class="_ _12"></span>ctiv<span class="_ _28"></span>ation<span class="_ _e"> </span>function(<span class="ff4">激活函数</span>)</div><div class="t m0 x3 h6 y20 ff1 fs2 fc0 sc0 ls0 ws0">这里使用的激活函数是<span class="_ _d"> </span><span class="ff3">Sigmoid<span class="_ _d"> </span></span>函数：</div><div class="t m0 xc3 h4 y3 ff3 fs2 fc0 sc0 ls0 ws0">53</div></div><div class="pi" data-data='{"ctm":[1.500000,0.000000,0.000000,1.500000,0.000000,0.000000]}'></div></div>
<div id="pf3c" class="pf w0 h0" data-page-no="3c"><div class="pc pc3c w0 h0"><img class="bi x3 y7c4 w1 h48" alt="" src="bg3c.png"/><div class="t m0 x3 h7 y21 ff3 fs5 fc0 sc0 ls0 ws0">9.3<span class="_ _8"> </span><span class="ff7">前向传播</span></div><div class="t m0 x157 h4 y7c5 ffd fs2 fc0 sc0 ls0 ws0">y<span class="_ _25"> </span><span class="fff">=<span class="_ _32"> </span></span>f<span class="_ _34"> </span><span class="fff">(</span>z<span class="_ _23"></span><span class="fff">)<span class="_ _32"> </span>=</span></div><div class="t m0 x71 h4 y7c6 fff fs2 fc0 sc0 ls0 ws0">1</div><div class="t m0 x126 h4 y7c7 fff fs2 fc0 sc0 ls0 ws0">1<span class="_ _37"> </span>+<span class="_ _37"> </span><span class="ffd">e</span></div><div class="t m0 x78 ha y7c8 ffb fs7 fc0 sc0 ls0 ws0">−<span class="ffc">z</span></div><div class="t m0 x3 h4 y7c9 ff6 fs2 fc0 sc0 ls0 ws0">3.Error<span class="_ _e"> </span>function</div><div class="t m0 x1a0 h6 y7ca ff4 fs2 fc0 sc0 ls0 ws0">（误差函数）</div><div class="t m0 x3 h6 y7cb ff1 fs2 fc0 sc0 ls0 ws0">采用平方误差作为目标函数<span class="ff3">:</span></div><div class="t m0 xd6 h4 y7cc ffd fs2 fc0 sc0 ls0 ws0">E<span class="_ _d"> </span><span class="fff">=</span></div><div class="t m0 x1 h4 y7cd fff fs2 fc0 sc0 ls0 ws0">1</div><div class="t m0 x1 h4 y7ce fff fs2 fc0 sc0 ls0 ws0">2</div><div class="t m0 x53 hb y7cf ffc fs7 fc0 sc0 ls0 ws0">n</div><div class="t m0 x35 hc y7d0 ff11 fs2 fc0 sc0 ls0 ws0">X</div><div class="t m0 x123 ha y7d1 ffc fs7 fc0 sc0 ls0 ws0">i<span class="ff12">=1</span></div><div class="t m0 x2b h4 y7cc fff fs2 fc0 sc0 ls0 ws0">[<span class="ffd">t</span></div><div class="t m0 x29 hb y7d2 ffc fs7 fc0 sc0 ls0 ws0">i</div><div class="t m0 xcf h4 y7cc ffe fs2 fc0 sc0 ls0 ws0">−<span class="_ _37"> </span><span class="ffd">y</span></div><div class="t m0 x78 hb y7d2 ffc fs7 fc0 sc0 ls0 ws0">i</div><div class="t m0 x44 h4 y7cc fff fs2 fc0 sc0 ls0 ws0">]</div><div class="t m0 x148 ha y7d3 ff12 fs7 fc0 sc0 ls0 ws0">2</div><div class="t m0 x3 h6 y7d4 ff1 fs2 fc0 sc0 ls0 ws0">其中<span class="_ _d"> </span><span class="ffd">t</span></div><div class="t m0 x161 hb y7d5 ffc fs7 fc0 sc0 ls0 ws0">i</div><div class="t m0 x43 h6 y7d4 ff1 fs2 fc0 sc0 ls0 ws0">为真实值，<span class="ffd">y</span></div><div class="t m0 x7 hb y7d5 ffc fs7 fc0 sc0 ls0 ws0">i</div><div class="t m0 x2d h6 y7d4 ff1 fs2 fc0 sc0 ls0 ws0">为计算值，等于<span class="_ _d"> </span><span class="ffd">y</span></div><div class="t m0 x32 hb y7d5 ffc fs7 fc0 sc0 ls0 ws0">i</div><div class="t m0 xc7 h4 y7d4 fff fs2 fc0 sc0 ls0 ws0">=<span class="_ _32"> </span><span class="ffd">f<span class="_ _34"></span></span>(<span class="ffd">h</span>(<span class="ffd">x</span></div><div class="t m0 x12a hb y7d5 ffc fs7 fc0 sc0 ls0 ws0">i</div><div class="t m0 x5f h6 y7d4 fff fs2 fc0 sc0 ls0 ws0">))<span class="ff1">。下面对<span class="_ _d"> </span><span class="ff3">BP<span class="_ _d"> </span></span>算法的计算过程进行推导。</span></div><div class="t m0 x11 h9 y7d6 ff5 fs6 fc0 sc0 ls0 ws0">9.3<span class="_ _24"> </span><span class="ff9">前向传播</span></div><div class="t m0 x73 h6 y7d7 ff1 fs2 fc0 sc0 ls0 ws0">图<span class="_ _d"> </span><span class="ff3">9.1:<span class="_ _35"> </span></span>神经网络示意图</div><div class="t m0 x3 h6 y7d8 ff1 fs2 fc0 sc0 ls0 ws0">上图展示的是一个经典的三层神经网络，<span class="_ _27"></span>包括输入层、<span class="_ _27"></span>隐藏层、<span class="_ _27"></span>输出层。<span class="_ _28"></span>为了体现一般性，<span class="_ _27"></span>现在</div><div class="t m0 x3 h6 y7d9 ff1 fs2 fc0 sc0 ls0 ws0">用数学语言进行描述：</div><div class="t m0 x3 h6 y7da ff1 fs2 fc0 sc0 ls0 ws0">给定一个训练集<span class="_ _e"> </span><span class="ffe">{<span class="fff">(<span class="ffd">x</span></span></span></div><div class="t m0 x7 ha y7db ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 x19a he y7da ffd fs2 fc0 sc0 ls0 ws0">,<span class="_ _31"> </span>t</div><div class="t m0 x12f ha y7db ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 x3e h4 y7da fff fs2 fc0 sc0 ls0 ws0">)<span class="_ _31"> </span><span class="ffd">,<span class="_ _31"> </span></span>(<span class="ffd">x</span></div><div class="t m0 x4c ha y7db ff12 fs7 fc0 sc0 ls0 ws0">2</div><div class="t m0 x46 he y7da ffd fs2 fc0 sc0 ls0 ws0">,<span class="_ _31"> </span>t</div><div class="t m0 x6d ha y7db ff12 fs7 fc0 sc0 ls0 ws0">2</div><div class="t m0 xc1 h4 y7da fff fs2 fc0 sc0 ls0 ws0">)<span class="_ _31"> </span><span class="ffd">,<span class="_ _31"> </span>.<span class="_ _31"> </span>.<span class="_ _31"> </span>.<span class="_ _31"> </span>,<span class="_ _31"> </span></span>(<span class="ffd">x</span></div><div class="t m0 x1a3 hb y7db ffc fs7 fc0 sc0 ls0 ws0">n</div><div class="t m0 x24 he y7da ffd fs2 fc0 sc0 ls0 ws0">,<span class="_ _31"> </span>t</div><div class="t m0 xc2 hb y7db ffc fs7 fc0 sc0 ls0 ws0">n</div><div class="t m0 x35 h6 y7da fff fs2 fc0 sc0 ls0 ws0">)<span class="ffe">}<span class="ff1">，目标变量<span class="_ _e"> </span><span class="ffd">t</span></span></span></div><div class="t m0 xa0 hb y7db ffc fs7 fc0 sc0 ls0 ws0">i</div><div class="t m0 xcb h6 y7da ff1 fs2 fc0 sc0 ls0 ws0">的取值可以有多个，<span class="_ _23"></span>其中<span class="_ _d"> </span><span class="ffd">x</span></div><div class="t m0 x1a4 hb y7db ffc fs7 fc0 sc0 ls0 ws0">i</div><div class="t m0 xaf h6 y7da ff1 fs2 fc0 sc0 ls0 ws0">是一</div><div class="t m0 x3 h6 y7dc ff1 fs2 fc0 sc0 ls0 ws0">个<span class="_ _d"> </span><span class="ffd">m<span class="_ _e"> </span></span>维向量<span class="_ _23"></span>（对应输入层的<span class="_ _e"> </span><span class="ffd">m<span class="_ _e"> </span></span>个神经元）<span class="_ _3b"></span>，表达式为<span class="_ _e"> </span><span class="ffd">x</span></div><div class="t m0 x1e hb y7dd ffc fs7 fc0 sc0 ls0 ws0">i</div><div class="t m0 x26 h4 y7dc fff fs2 fc0 sc0 ls0 ws0">=<span class="_ _25"> </span>(<span class="ffd">x</span></div><div class="t m0 x169 ha y7dd ffc fs7 fc0 sc0 ls0 ws0">i<span class="ff12">1</span></div><div class="t m0 xf6 he y7dc ffd fs2 fc0 sc0 ls0 ws0">,<span class="_ _31"> </span>x</div><div class="t m0 x1a5 ha y7dd ffc fs7 fc0 sc0 ls0 ws0">i<span class="ff12">2</span></div><div class="t m0 xbf h4 y7dc ffd fs2 fc0 sc0 ls0 ws0">,<span class="_ _31"> </span><span class="ffe">·<span class="_ _31"></span>·<span class="_ _31"></span>·<span class="_ _d"> </span></span>,<span class="_ _31"> </span>x</div><div class="t m0 x185 hb y7dd ffc fs7 fc0 sc0 ls0 ws0">im</div><div class="t m0 x1a6 h6 y7dc fff fs2 fc0 sc0 ls0 ws0">)<span class="ff1">。我们将输<span class="_ _23"></span>入层、</span></div><div class="t m0 x3 h6 y7de ff1 fs2 fc0 sc0 ls0 ws0">隐藏层、<span class="_ _28"></span>输出层合并在一起，<span class="_ _27"></span>就形成了一个<span class="_ _d"> </span><span class="ff3">netw<span class="_ _28"></span>ork<span class="ff1">。<span class="_ _28"></span>在这个<span class="_ _d"> </span><span class="ff3">net<span class="_ _12"></span>w<span class="_ _12"></span>ork<span class="_ _25"> </span><span class="ff1">里，<span class="_ _28"></span>除输入层外，<span class="_ _27"></span>其他层</span></span></span></span></div><div class="t m0 x3 h6 y7df ff1 fs2 fc0 sc0 ls0 ws0">上的每个神经元都是上一层神经元的全连接，<span class="_ _29"></span>不同的是全连接的权值不一样。<span class="_ _29"></span>现在，<span class="_ _29"></span>我们需要通</div><div class="t m0 x3 h6 y7e0 ff1 fs2 fc0 sc0 ls0 ws0">过训练，来求出各个神经元的权重值，也就是<span class="_ _d"> </span><span class="ffd">w<span class="_ _23"></span></span>。</div><div class="t m0 x3 h6 y7e1 ff1 fs2 fc0 sc0 ls0 ws0">那么现在的问题是，这些权值应该如何计算呢？</div><div class="t m0 x3 h6 y7e2 ff1 fs2 fc0 sc0 ls0 ws0">刚刚说到，<span class="_ _30"></span>除输入层外，<span class="_ _30"></span>其他层上的每个神经元都是上一层神经元的全连接<span class="ff3">,<span class="_ _25"> </span></span>比如隐藏层<span class="_ _d"> </span><span class="ffd">h</span></div><div class="t m0 x19d ha y7e3 ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 xc h6 y7e2 ff1 fs2 fc0 sc0 ls0 ws0">，<span class="_ _30"></span>是</div><div class="t m0 x3 h6 y7e4 ff1 fs2 fc0 sc0 ls0 ws0">隐藏层的第一个神经元，它的输出值是输入层的全连接，即：</div><div class="t m0 x4f he y7e5 ffd fs2 fc0 sc0 ls0 ws0">h</div><div class="t m0 x9d ha y7e6 ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 x5d h4 y7e5 fff fs2 fc0 sc0 ls0 ws0">=<span class="_ _32"> </span><span class="ffd">f</span></div><div class="t m0 xa hc y7e7 ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x70 hf y7e5 ff10 fs2 fc0 sc0 ls0 ws0">w</div><div class="t m0 x13e ha y7e8 ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 x13e ha y7e9 ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 x20 h4 y7e5 ffe fs2 fc0 sc0 ls0 ws0">·<span class="_ _37"> </span><span class="ff10">x</span></div><div class="t m0 x197 hc y7e7 ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 xaf h4 y7e5 ff3 fs2 fc0 sc0 ls0 ws0">(9.1)</div><div class="t m0 x0 he y7ea ffd fs2 fc0 sc0 ls0 ws0">net</div><div class="t m0 x41 ha y7eb ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 x41 ha y7ec ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 x51 h4 y7ea fff fs2 fc0 sc0 ls0 ws0">=<span class="_ _32"> </span><span class="ffd">w</span></div><div class="t m0 xe ha y7eb ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 xe ha y7ec ff12 fs7 fc0 sc0 ls0 ws0">11</div><div class="t m0 x23 he y7ea ffd fs2 fc0 sc0 ls0 ws0">x</div><div class="t m0 x24 ha y7ed ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 x5c h4 y7ea fff fs2 fc0 sc0 ls0 ws0">+<span class="_ _37"> </span><span class="ffd">w</span></div><div class="t m0 x13c ha y7eb ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 x81 ha y7ee ff12 fs7 fc0 sc0 ls0 ws0">12</div><div class="t m0 xaa he y7ea ffd fs2 fc0 sc0 ls0 ws0">x</div><div class="t m0 xf5 ha y7ed ff12 fs7 fc0 sc0 ls0 ws0">2</div><div class="t m0 x14a h4 y7ea fff fs2 fc0 sc0 ls0 ws0">+<span class="_ _37"> </span><span class="ffd">w</span></div><div class="t m0 x148 ha y7eb ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 x148 ha y7ee ff12 fs7 fc0 sc0 ls0 ws0">13</div><div class="t m0 x26 he y7ea ffd fs2 fc0 sc0 ls0 ws0">x</div><div class="t m0 x7a ha y7ed ff12 fs7 fc0 sc0 ls0 ws0">3</div><div class="t m0 xb6 h4 y7ea fff fs2 fc0 sc0 ls0 ws0">+<span class="_ _37"> </span><span class="ffd">b</span></div><div class="t m0 x11e ha y7eb ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 x11e ha y7ee ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 xaf h4 y7ea ff3 fs2 fc0 sc0 ls0 ws0">(9.2)</div><div class="t m0 x12 h6 y7ef ff1 fs2 fc0 sc0 ls0 ws0">行标表示当前层的第几个节点，列标表示上一层的第几个节点，<span class="_ _12"></span>上标表示当前是第几个隐</div><div class="t m0 x12 h6 y7f0 ff1 fs2 fc0 sc0 ls0 ws0">藏层</div><div class="t m0 x3 h6 y7f1 ff1 fs2 fc0 sc0 ls0 ws0">其中<span class="_ _d"> </span><span class="ffd">f<span class="_ _3f"> </span></span>为<span class="_ _d"> </span><span class="ff3">sigmoid<span class="_ _e"> </span></span>函数，<span class="ff10">w</span></div><div class="t m0 x1a2 ha y7f2 ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 x8 hb y7f3 ffc fs7 fc0 sc0 ls0 ws0">ij</div><div class="t m0 x0 h6 y7f1 ff1 fs2 fc0 sc0 ls0 ws0">表示隐藏层的第<span class="_ _d"> </span><span class="ffd">i<span class="_ _e"> </span></span>个节点与输入层的第<span class="_ _e"> </span><span class="ffd">j<span class="_ _1e"> </span></span>个节点的权重值，<span class="ffd">b</span></div><div class="t m0 xc ha y7f2 ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 xc hb y7f3 ffc fs7 fc0 sc0 ls0 ws0">i</div><div class="t m0 xbc h6 y7f1 ff1 fs2 fc0 sc0 ls0 ws0">表</div><div class="t m0 x3 h6 y20 ff1 fs2 fc0 sc0 ls0 ws0">示第<span class="_ _d"> </span><span class="ffd">i<span class="_ _d"> </span></span>个隐藏层全连接中的偏置，<span class="ffd">x</span></div><div class="t m0 x73 hb y2cd ffc fs7 fc0 sc0 ls0 ws0">i</div><div class="t m0 xf3 h6 y20 ff1 fs2 fc0 sc0 ls0 ws0">为输入层的值，即样本的输入值。</div><div class="t m0 x3 h4 y3 ff3 fs2 fc0 sc0 ls0 ws0">54</div></div><div class="pi" data-data='{"ctm":[1.500000,0.000000,0.000000,1.500000,0.000000,0.000000]}'></div></div>
<div id="pf3d" class="pf w0 h0" data-page-no="3d"><div class="pc pc3d w0 h0"><img class="bi x82 y7f4 w2 h49" alt="" src="bg3d.png"/><div class="t m0 x27 h7 y21 ff3 fs5 fc0 sc0 ls0 ws0">9.3<span class="_ _8"> </span><span class="ff7">前向传播</span></div><div class="t m0 x94 h6 y7f5 ff1 fs2 fc0 sc0 ls0 ws0">图<span class="_ _d"> </span><span class="ff3">9.2:<span class="_ _35"> </span></span>前向传播</div><div class="t m0 x3 h6 y7f6 ff1 fs2 fc0 sc0 ls0 ws0">类似的，可以计算出<span class="_ _d"> </span><span class="ffd">h</span></div><div class="t m0 x10c ha y7f7 ff12 fs7 fc0 sc0 ls0 ws0">2</div><div class="t m0 x57 h6 y7f6 ff1 fs2 fc0 sc0 ls0 ws0">、<span class="ffd">h</span></div><div class="t m0 xba ha y7f7 ff12 fs7 fc0 sc0 ls0 ws0">3</div><div class="t m0 xd7 h6 y7f6 ff1 fs2 fc0 sc0 ls0 ws0">、<span class="ffd">h</span></div><div class="t m0 xca ha y7f7 ff12 fs7 fc0 sc0 ls0 ws0">4</div><div class="t m0 x2 h6 y7f6 ff1 fs2 fc0 sc0 ls0 ws0">：</div><div class="t m0 x30 he y7f8 ffd fs2 fc0 sc0 ls0 ws0">h</div><div class="t m0 x59 ha y7f9 ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 xca h4 y7f8 fff fs2 fc0 sc0 ls0 ws0">=<span class="_ _32"> </span><span class="ffd">f</span></div><div class="t m0 x72 hc y7fa ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x48 he y7f8 ffd fs2 fc0 sc0 ls0 ws0">w</div><div class="t m0 xe ha y7fb ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 xe ha y7fc ff12 fs7 fc0 sc0 ls0 ws0">11</div><div class="t m0 x23 he y7f8 ffd fs2 fc0 sc0 ls0 ws0">x</div><div class="t m0 x166 ha y7f9 ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 xbd h4 y7f8 fff fs2 fc0 sc0 ls0 ws0">+<span class="_ _37"> </span><span class="ffd">w</span></div><div class="t m0 x81 ha y7fb ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 x81 ha y7fc ff12 fs7 fc0 sc0 ls0 ws0">12</div><div class="t m0 xaa he y7f8 ffd fs2 fc0 sc0 ls0 ws0">x</div><div class="t m0 xd4 ha y7f9 ff12 fs7 fc0 sc0 ls0 ws0">2</div><div class="t m0 x36 h4 y7f8 fff fs2 fc0 sc0 ls0 ws0">+<span class="_ _37"> </span><span class="ffd">w</span></div><div class="t m0 x148 ha y7fb ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 x148 ha y7fc ff12 fs7 fc0 sc0 ls0 ws0">13</div><div class="t m0 x26 he y7f8 ffd fs2 fc0 sc0 ls0 ws0">x</div><div class="t m0 x62 ha y7f9 ff12 fs7 fc0 sc0 ls0 ws0">3</div><div class="t m0 xb6 h4 y7f8 fff fs2 fc0 sc0 ls0 ws0">+<span class="_ _37"> </span><span class="ffd">b</span></div><div class="t m0 x64 ha y7fb ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 x64 ha y7fc ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 x179 hc y7fa ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x30 he y7fd ffd fs2 fc0 sc0 ls0 ws0">h</div><div class="t m0 x59 ha y7fe ff12 fs7 fc0 sc0 ls0 ws0">2</div><div class="t m0 xca h4 y7fd fff fs2 fc0 sc0 ls0 ws0">=<span class="_ _32"> </span><span class="ffd">f</span></div><div class="t m0 x72 hc y7ff ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x48 he y7fd ffd fs2 fc0 sc0 ls0 ws0">w</div><div class="t m0 xe ha y800 ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 xe ha y801 ff12 fs7 fc0 sc0 ls0 ws0">21</div><div class="t m0 x23 he y7fd ffd fs2 fc0 sc0 ls0 ws0">x</div><div class="t m0 x166 ha y7fe ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 xbd h4 y7fd fff fs2 fc0 sc0 ls0 ws0">+<span class="_ _37"> </span><span class="ffd">w</span></div><div class="t m0 x81 ha y800 ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 x81 ha y801 ff12 fs7 fc0 sc0 ls0 ws0">22</div><div class="t m0 xaa he y7fd ffd fs2 fc0 sc0 ls0 ws0">x</div><div class="t m0 xd4 ha y7fe ff12 fs7 fc0 sc0 ls0 ws0">2</div><div class="t m0 x36 h4 y7fd fff fs2 fc0 sc0 ls0 ws0">+<span class="_ _37"> </span><span class="ffd">w</span></div><div class="t m0 x148 ha y800 ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 x148 ha y801 ff12 fs7 fc0 sc0 ls0 ws0">23</div><div class="t m0 x26 he y7fd ffd fs2 fc0 sc0 ls0 ws0">x</div><div class="t m0 x62 ha y7fe ff12 fs7 fc0 sc0 ls0 ws0">3</div><div class="t m0 xb6 h4 y7fd fff fs2 fc0 sc0 ls0 ws0">+<span class="_ _37"> </span><span class="ffd">b</span></div><div class="t m0 x64 ha y800 ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 x64 ha y801 ff12 fs7 fc0 sc0 ls0 ws0">2</div><div class="t m0 x179 hc y7ff ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x30 he y802 ffd fs2 fc0 sc0 ls0 ws0">h</div><div class="t m0 x59 ha y803 ff12 fs7 fc0 sc0 ls0 ws0">3</div><div class="t m0 xca h4 y802 fff fs2 fc0 sc0 ls0 ws0">=<span class="_ _32"> </span><span class="ffd">f</span></div><div class="t m0 x72 hc y804 ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x48 he y802 ffd fs2 fc0 sc0 ls0 ws0">w</div><div class="t m0 xe ha y805 ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 xe ha y806 ff12 fs7 fc0 sc0 ls0 ws0">31</div><div class="t m0 x23 he y802 ffd fs2 fc0 sc0 ls0 ws0">x</div><div class="t m0 x166 ha y803 ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 xbd h4 y802 fff fs2 fc0 sc0 ls0 ws0">+<span class="_ _37"> </span><span class="ffd">w</span></div><div class="t m0 x81 ha y805 ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 x81 ha y806 ff12 fs7 fc0 sc0 ls0 ws0">32</div><div class="t m0 xaa he y802 ffd fs2 fc0 sc0 ls0 ws0">x</div><div class="t m0 xd4 ha y803 ff12 fs7 fc0 sc0 ls0 ws0">2</div><div class="t m0 x36 h4 y802 fff fs2 fc0 sc0 ls0 ws0">+<span class="_ _37"> </span><span class="ffd">w</span></div><div class="t m0 x148 ha y805 ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 x148 ha y806 ff12 fs7 fc0 sc0 ls0 ws0">33</div><div class="t m0 x26 he y802 ffd fs2 fc0 sc0 ls0 ws0">x</div><div class="t m0 x62 ha y803 ff12 fs7 fc0 sc0 ls0 ws0">3</div><div class="t m0 xb6 h4 y802 fff fs2 fc0 sc0 ls0 ws0">+<span class="_ _37"> </span><span class="ffd">b</span></div><div class="t m0 x64 ha y805 ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 x64 ha y806 ff12 fs7 fc0 sc0 ls0 ws0">3</div><div class="t m0 x179 hc y804 ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x30 he y807 ffd fs2 fc0 sc0 ls0 ws0">h</div><div class="t m0 x59 ha y808 ff12 fs7 fc0 sc0 ls0 ws0">4</div><div class="t m0 xca h4 y807 fff fs2 fc0 sc0 ls0 ws0">=<span class="_ _32"> </span><span class="ffd">f</span></div><div class="t m0 x72 hc y809 ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x48 he y807 ffd fs2 fc0 sc0 ls0 ws0">w</div><div class="t m0 xe ha y80a ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 xe ha y80b ff12 fs7 fc0 sc0 ls0 ws0">41</div><div class="t m0 x23 he y807 ffd fs2 fc0 sc0 ls0 ws0">x</div><div class="t m0 x166 ha y808 ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 xbd h4 y807 fff fs2 fc0 sc0 ls0 ws0">+<span class="_ _37"> </span><span class="ffd">w</span></div><div class="t m0 x81 ha y80a ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 x81 ha y80b ff12 fs7 fc0 sc0 ls0 ws0">42</div><div class="t m0 xaa he y807 ffd fs2 fc0 sc0 ls0 ws0">x</div><div class="t m0 xd4 ha y808 ff12 fs7 fc0 sc0 ls0 ws0">2</div><div class="t m0 x36 h4 y807 fff fs2 fc0 sc0 ls0 ws0">+<span class="_ _37"> </span><span class="ffd">w</span></div><div class="t m0 x148 ha y80a ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 x148 ha y80b ff12 fs7 fc0 sc0 ls0 ws0">43</div><div class="t m0 x26 he y807 ffd fs2 fc0 sc0 ls0 ws0">x</div><div class="t m0 x62 ha y808 ff12 fs7 fc0 sc0 ls0 ws0">3</div><div class="t m0 xb6 h4 y807 fff fs2 fc0 sc0 ls0 ws0">+<span class="_ _37"> </span><span class="ffd">b</span></div><div class="t m0 x64 ha y80a ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 x64 ha y80b ff12 fs7 fc0 sc0 ls0 ws0">4</div><div class="t m0 x179 hc y809 ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 xaf h4 y80c ff3 fs2 fc0 sc0 ls0 ws0">(9.3)</div><div class="t m0 x3 h6 y80d ff1 fs2 fc0 sc0 ls0 ws0">因此，我们可以将隐藏层表示为如下通式：</div><div class="t m0 x9b h4 y80e ff10 fs2 fc0 sc0 ls0 ws0">h<span class="_ _32"> </span><span class="fff">=<span class="_ _32"> </span><span class="ffd">f<span class="_ _34"></span></span>(</span>net</div><div class="t m0 x198 ha y80f ff24 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 x5e h4 y80e fff fs2 fc0 sc0 ls0 ws0">)<span class="_ _32"> </span>=<span class="_ _32"> </span><span class="ffd">f</span></div><div class="t m0 x14a hc y810 ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x77 hf y80e ff10 fs2 fc0 sc0 ls0 ws0">w</div><div class="t m0 x124 ha y80f ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 x66 ha y811 ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 xc8 h4 y80e ffe fs2 fc0 sc0 ls0 ws0">·<span class="_ _37"> </span><span class="ff10">x</span></div><div class="t m0 x7a hc y810 ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 xaf h4 y80e ff3 fs2 fc0 sc0 ls0 ws0">(9.4)</div><div class="t m0 x4c hf y812 ff10 fs2 fc0 sc0 ls0 ws0">w</div><div class="t m0 x17a ha y813 ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 xc1 h4 y812 fff fs2 fc0 sc0 ls0 ws0">=</div><div class="t m0 x10 hc y814 ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x10 hc y815 ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x10 hc y816 ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x10 hc y817 ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x10 hc y818 ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x10 hc y819 ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 xf3 hf y81a ff10 fs2 fc0 sc0 ls0 ws0">w</div><div class="t m0 x94 ha y81b ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 x94 ha y81c ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 xf3 hf y81d ff10 fs2 fc0 sc0 ls0 ws0">w</div><div class="t m0 x94 ha y81e ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 x94 ha y81f ff12 fs7 fc0 sc0 ls0 ws0">2</div><div class="t m0 xf3 hf y820 ff10 fs2 fc0 sc0 ls0 ws0">w</div><div class="t m0 x94 ha y821 ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 x94 ha y822 ff12 fs7 fc0 sc0 ls0 ws0">2</div><div class="t m0 xf3 hf y823 ff10 fs2 fc0 sc0 ls0 ws0">w</div><div class="t m0 x94 ha y824 ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 x94 ha y825 ff12 fs7 fc0 sc0 ls0 ws0">3</div><div class="t m0 xf3 hf y826 ff10 fs2 fc0 sc0 ls0 ws0">w</div><div class="t m0 x94 ha y827 ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 x94 ha y828 ff12 fs7 fc0 sc0 ls0 ws0">4</div><div class="t m0 x9d hc y814 ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x9d hc y815 ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x9d hc y816 ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x9d hc y817 ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x9d hc y818 ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x9d hc y819 ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x4 h4 y812 fff fs2 fc0 sc0 ls0 ws0">=</div><div class="t m0 x97 hc y829 ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x97 hc y816 ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x97 hc y817 ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x97 hc y82a ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x19c he y82b ffd fs2 fc0 sc0 ls0 ws0">w</div><div class="t m0 x13e ha y82c ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 x13e ha y82d ff12 fs7 fc0 sc0 ls0 ws0">11</div><div class="t m0 x9e he y82b ffd fs2 fc0 sc0 ls0 ws0">,<span class="_ _31"> </span>w</div><div class="t m0 x193 ha y82c ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 x193 ha y82d ff12 fs7 fc0 sc0 ls0 ws0">12</div><div class="t m0 x25 he y82b ffd fs2 fc0 sc0 ls0 ws0">,<span class="_ _31"> </span>w</div><div class="t m0 xea ha y82c ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 xea ha y82d ff12 fs7 fc0 sc0 ls0 ws0">13</div><div class="t m0 xc5 he y82b ffd fs2 fc0 sc0 ls0 ws0">,<span class="_ _31"> </span>b</div><div class="t m0 xae ha y82c ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 xae ha y82d ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 x19c he y82e ffd fs2 fc0 sc0 ls0 ws0">w</div><div class="t m0 x13e ha y82f ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 x13e ha y830 ff12 fs7 fc0 sc0 ls0 ws0">21</div><div class="t m0 x9e he y82e ffd fs2 fc0 sc0 ls0 ws0">,<span class="_ _31"> </span>w</div><div class="t m0 x193 ha y82f ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 x193 ha y830 ff12 fs7 fc0 sc0 ls0 ws0">22</div><div class="t m0 x25 he y82e ffd fs2 fc0 sc0 ls0 ws0">,<span class="_ _31"> </span>w</div><div class="t m0 xea ha y82f ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 xea ha y830 ff12 fs7 fc0 sc0 ls0 ws0">23</div><div class="t m0 xc5 he y82e ffd fs2 fc0 sc0 ls0 ws0">,<span class="_ _31"> </span>b</div><div class="t m0 xae ha y82f ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 xae ha y830 ff12 fs7 fc0 sc0 ls0 ws0">2</div><div class="t m0 x19c he y831 ffd fs2 fc0 sc0 ls0 ws0">w</div><div class="t m0 x13e ha y832 ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 x13e ha y833 ff12 fs7 fc0 sc0 ls0 ws0">31</div><div class="t m0 x9e he y831 ffd fs2 fc0 sc0 ls0 ws0">,<span class="_ _31"> </span>w</div><div class="t m0 x193 ha y832 ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 x193 ha y833 ff12 fs7 fc0 sc0 ls0 ws0">32</div><div class="t m0 x25 he y831 ffd fs2 fc0 sc0 ls0 ws0">,<span class="_ _31"> </span>w</div><div class="t m0 xea ha y832 ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 xea ha y833 ff12 fs7 fc0 sc0 ls0 ws0">33</div><div class="t m0 xc5 he y831 ffd fs2 fc0 sc0 ls0 ws0">,<span class="_ _31"> </span>b</div><div class="t m0 xae ha y832 ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 xae ha y833 ff12 fs7 fc0 sc0 ls0 ws0">3</div><div class="t m0 x19c he y834 ffd fs2 fc0 sc0 ls0 ws0">w</div><div class="t m0 x13e ha y835 ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 x13e ha y836 ff12 fs7 fc0 sc0 ls0 ws0">41</div><div class="t m0 x9e he y834 ffd fs2 fc0 sc0 ls0 ws0">,<span class="_ _31"> </span>w</div><div class="t m0 x193 ha y835 ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 x193 ha y836 ff12 fs7 fc0 sc0 ls0 ws0">42</div><div class="t m0 x25 he y834 ffd fs2 fc0 sc0 ls0 ws0">,<span class="_ _31"> </span>w</div><div class="t m0 xea ha y835 ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 xea ha y836 ff12 fs7 fc0 sc0 ls0 ws0">43</div><div class="t m0 xc5 he y834 ffd fs2 fc0 sc0 ls0 ws0">,<span class="_ _31"> </span>b</div><div class="t m0 xae ha y835 ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 xae ha y836 ff12 fs7 fc0 sc0 ls0 ws0">4</div><div class="t m0 x179 hc y829 ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x179 hc y816 ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x179 hc y817 ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x179 hc y82a ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 xaf h4 y812 ff3 fs2 fc0 sc0 ls0 ws0">(9.5)</div><div class="t m0 x3 h6 y837 ff1 fs2 fc0 sc0 ls0 ws0">对于输出层，<span class="_ _30"></span>也是同样的计算方式，<span class="_ _27"></span>只不过对于输出层而言，<span class="_ _30"></span>它们的输入为隐藏层的输出，<span class="_ _27"></span>即<span class="_ _25"> </span><span class="ff10">h</span></div><div class="t m0 x3 h6 y838 ff1 fs2 fc0 sc0 ls0 ws0">，输出层的表达式为：</div><div class="t m0 x32 h4 y839 ff10 fs2 fc0 sc0 ls0 ws0">y<span class="_ _25"> </span><span class="fff">=<span class="_ _32"> </span><span class="ffd">f</span></span></div><div class="t m0 x97 hc y83a ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 xa hf y839 ff10 fs2 fc0 sc0 ls0 ws0">w</div><div class="t m0 xc9 ha y83b ff12 fs7 fc0 sc0 ls0 ws0">(2)</div><div class="t m0 x9e h4 y839 ffe fs2 fc0 sc0 ls0 ws0">·<span class="_ _37"> </span><span class="ff10">h</span></div><div class="t m0 x99 hc y83a ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x8b hf y83c ff10 fs2 fc0 sc0 ls0 ws0">w</div><div class="t m0 x4b ha y83d ff12 fs7 fc0 sc0 ls0 ws0">(2)</div><div class="t m0 x58 h4 y83c fff fs2 fc0 sc0 ls0 ws0">=</div><div class="t m0 x9 hc y83e ff11 fs2 fc0 sc0 ls0 ws0">&quot;</div><div class="t m0 x4d hf y83f ff10 fs2 fc0 sc0 ls0 ws0">w</div><div class="t m0 x12d ha y840 ff24 fs7 fc0 sc0 ls0 ws0">(2)</div><div class="t m0 x51 ha y841 ff24 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 x4d hf y842 ff10 fs2 fc0 sc0 ls0 ws0">w</div><div class="t m0 x12d ha y843 ff24 fs7 fc0 sc0 ls0 ws0">(2)</div><div class="t m0 x51 ha y844 ff24 fs7 fc0 sc0 ls0 ws0">2</div><div class="t m0 xe hc y83e ff11 fs2 fc0 sc0 ls0 ws0">#</div><div class="t m0 x23 h4 y83c fff fs2 fc0 sc0 ls0 ws0">=</div><div class="t m0 x4 hc y83e ff11 fs2 fc0 sc0 ls0 ws0">&quot;</div><div class="t m0 x65 he y83f ffd fs2 fc0 sc0 ls0 ws0">w</div><div class="t m0 x98 ha y845 ff12 fs7 fc0 sc0 ls0 ws0">(2)</div><div class="t m0 x98 ha y841 ff12 fs7 fc0 sc0 ls0 ws0">11</div><div class="t m0 x126 he y83f ffd fs2 fc0 sc0 ls0 ws0">,<span class="_ _31"> </span>w</div><div class="t m0 xd2 ha y845 ff12 fs7 fc0 sc0 ls0 ws0">(2)</div><div class="t m0 xd2 ha y841 ff12 fs7 fc0 sc0 ls0 ws0">12</div><div class="t m0 x37 he y83f ffd fs2 fc0 sc0 ls0 ws0">,<span class="_ _31"> </span>w</div><div class="t m0 x1f ha y845 ff12 fs7 fc0 sc0 ls0 ws0">(2)</div><div class="t m0 x1f ha y841 ff12 fs7 fc0 sc0 ls0 ws0">13</div><div class="t m0 x127 he y83f ffd fs2 fc0 sc0 ls0 ws0">,<span class="_ _31"> </span>w</div><div class="t m0 x7b ha y845 ff12 fs7 fc0 sc0 ls0 ws0">(2)</div><div class="t m0 x7b ha y841 ff12 fs7 fc0 sc0 ls0 ws0">14</div><div class="t m0 x179 he y83f ffd fs2 fc0 sc0 ls0 ws0">,<span class="_ _31"> </span>b</div><div class="t m0 xbe ha y845 ff12 fs7 fc0 sc0 ls0 ws0">(2)</div><div class="t m0 xbe ha y841 ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 x65 he y842 ffd fs2 fc0 sc0 ls0 ws0">w</div><div class="t m0 x98 ha y843 ff12 fs7 fc0 sc0 ls0 ws0">(2)</div><div class="t m0 x98 ha y844 ff12 fs7 fc0 sc0 ls0 ws0">21</div><div class="t m0 x126 he y842 ffd fs2 fc0 sc0 ls0 ws0">,<span class="_ _31"> </span>w</div><div class="t m0 xd2 ha y843 ff12 fs7 fc0 sc0 ls0 ws0">(2)</div><div class="t m0 xd2 ha y844 ff12 fs7 fc0 sc0 ls0 ws0">22</div><div class="t m0 x37 he y842 ffd fs2 fc0 sc0 ls0 ws0">,<span class="_ _31"> </span>w</div><div class="t m0 x1f ha y843 ff12 fs7 fc0 sc0 ls0 ws0">(2)</div><div class="t m0 x1f ha y844 ff12 fs7 fc0 sc0 ls0 ws0">23</div><div class="t m0 x127 he y842 ffd fs2 fc0 sc0 ls0 ws0">,<span class="_ _31"> </span>w</div><div class="t m0 x7b ha y843 ff12 fs7 fc0 sc0 ls0 ws0">(2)</div><div class="t m0 x7b ha y844 ff12 fs7 fc0 sc0 ls0 ws0">24</div><div class="t m0 x179 he y842 ffd fs2 fc0 sc0 ls0 ws0">,<span class="_ _31"> </span>b</div><div class="t m0 xbe ha y843 ff12 fs7 fc0 sc0 ls0 ws0">(2)</div><div class="t m0 xbe ha y844 ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 x6b hc y83e ff11 fs2 fc0 sc0 ls0 ws0">#</div><div class="t m0 x10c he y846 ffd fs2 fc0 sc0 ls0 ws0">y</div><div class="t m0 xcd ha y847 ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 x4b h4 y846 fff fs2 fc0 sc0 ls0 ws0">=<span class="_ _32"> </span><span class="ffd">f</span></div><div class="t m0 x147 hc y848 ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x9a he y846 ffd fs2 fc0 sc0 ls0 ws0">w</div><div class="t m0 x196 ha y849 ff12 fs7 fc0 sc0 ls0 ws0">(2)</div><div class="t m0 x196 ha y84a ff12 fs7 fc0 sc0 ls0 ws0">11</div><div class="t m0 x51 he y846 ffd fs2 fc0 sc0 ls0 ws0">h</div><div class="t m0 x47 ha y847 ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 x9c h4 y846 fff fs2 fc0 sc0 ls0 ws0">+<span class="_ _37"> </span><span class="ffd">w</span></div><div class="t m0 xa9 ha y849 ff12 fs7 fc0 sc0 ls0 ws0">(2)</div><div class="t m0 xa9 ha y84a ff12 fs7 fc0 sc0 ls0 ws0">12</div><div class="t m0 x122 he y846 ffd fs2 fc0 sc0 ls0 ws0">h</div><div class="t m0 x75 ha y847 ff12 fs7 fc0 sc0 ls0 ws0">2</div><div class="t m0 xa h4 y846 fff fs2 fc0 sc0 ls0 ws0">+<span class="_ _37"> </span><span class="ffd">w</span></div><div class="t m0 x45 ha y849 ff12 fs7 fc0 sc0 ls0 ws0">(2)</div><div class="t m0 x45 ha y84a ff12 fs7 fc0 sc0 ls0 ws0">13</div><div class="t m0 x77 he y846 ffd fs2 fc0 sc0 ls0 ws0">h</div><div class="t m0 x78 ha y847 ff12 fs7 fc0 sc0 ls0 ws0">3</div><div class="t m0 x148 h4 y846 fff fs2 fc0 sc0 ls0 ws0">+<span class="_ _37"> </span><span class="ffd">w</span></div><div class="t m0 xa0 ha y849 ff12 fs7 fc0 sc0 ls0 ws0">(2)</div><div class="t m0 xa0 ha y84a ff12 fs7 fc0 sc0 ls0 ws0">13</div><div class="t m0 x7b he y846 ffd fs2 fc0 sc0 ls0 ws0">h</div><div class="t m0 x64 ha y847 ff12 fs7 fc0 sc0 ls0 ws0">4</div><div class="t m0 xec h4 y846 fff fs2 fc0 sc0 ls0 ws0">+<span class="_ _37"> </span><span class="ffd">b</span></div><div class="t m0 x14b ha y849 ff12 fs7 fc0 sc0 ls0 ws0">(2)</div><div class="t m0 x14b ha y84a ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 x134 hc y848 ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x10c he y84b ffd fs2 fc0 sc0 ls0 ws0">y</div><div class="t m0 xcd ha y84c ff12 fs7 fc0 sc0 ls0 ws0">2</div><div class="t m0 x4b h4 y84b fff fs2 fc0 sc0 ls0 ws0">=<span class="_ _32"> </span><span class="ffd">f</span></div><div class="t m0 x147 hc y84d ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x9a he y84b ffd fs2 fc0 sc0 ls0 ws0">w</div><div class="t m0 x196 ha y84e ff12 fs7 fc0 sc0 ls0 ws0">(2)</div><div class="t m0 x196 ha y84f ff12 fs7 fc0 sc0 ls0 ws0">21</div><div class="t m0 x51 he y84b ffd fs2 fc0 sc0 ls0 ws0">h</div><div class="t m0 x47 ha y84c ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 x9c h4 y84b fff fs2 fc0 sc0 ls0 ws0">+<span class="_ _37"> </span><span class="ffd">w</span></div><div class="t m0 xa9 ha y84e ff12 fs7 fc0 sc0 ls0 ws0">(2)</div><div class="t m0 xa9 ha y84f ff12 fs7 fc0 sc0 ls0 ws0">22</div><div class="t m0 x122 he y84b ffd fs2 fc0 sc0 ls0 ws0">h</div><div class="t m0 x75 ha y84c ff12 fs7 fc0 sc0 ls0 ws0">2</div><div class="t m0 xa h4 y84b fff fs2 fc0 sc0 ls0 ws0">+<span class="_ _37"> </span><span class="ffd">w</span></div><div class="t m0 x45 ha y84e ff12 fs7 fc0 sc0 ls0 ws0">(2)</div><div class="t m0 x45 ha y84f ff12 fs7 fc0 sc0 ls0 ws0">23</div><div class="t m0 x77 he y84b ffd fs2 fc0 sc0 ls0 ws0">h</div><div class="t m0 x78 ha y84c ff12 fs7 fc0 sc0 ls0 ws0">3</div><div class="t m0 x148 h4 y84b fff fs2 fc0 sc0 ls0 ws0">+<span class="_ _37"> </span><span class="ffd">w</span></div><div class="t m0 xa0 ha y84e ff12 fs7 fc0 sc0 ls0 ws0">(2)</div><div class="t m0 xa0 ha y84f ff12 fs7 fc0 sc0 ls0 ws0">13</div><div class="t m0 x7b he y84b ffd fs2 fc0 sc0 ls0 ws0">h</div><div class="t m0 x64 ha y84c ff12 fs7 fc0 sc0 ls0 ws0">4</div><div class="t m0 xec h4 y84b fff fs2 fc0 sc0 ls0 ws0">+<span class="_ _37"> </span><span class="ffd">b</span></div><div class="t m0 x14b ha y84e ff12 fs7 fc0 sc0 ls0 ws0">(2)</div><div class="t m0 x14b ha y84f ff12 fs7 fc0 sc0 ls0 ws0">2</div><div class="t m0 x134 hc y84d ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x3 h6 y850 ff1 fs2 fc0 sc0 ls0 ws0">即：</div><div class="t m0 xba hf y851 ff10 fs2 fc0 sc0 ls0 ws0">y</div><div class="t m0 x40 hb y852 ffc fs7 fc0 sc0 ls0 ws0">i</div><div class="t m0 x31 h4 y851 fff fs2 fc0 sc0 ls0 ws0">=<span class="_ _32"> </span><span class="ffd">f</span></div><div class="t m0 x19b hc y853 ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x73 he y851 ffd fs2 fc0 sc0 ls0 ws0">net</div><div class="t m0 xe ha y854 ff12 fs7 fc0 sc0 ls0 ws0">(2)</div><div class="t m0 xe hb y855 ffc fs7 fc0 sc0 ls0 ws0">i</div><div class="t m0 x9d hc y853 ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x4 h4 y851 fff fs2 fc0 sc0 ls0 ws0">=<span class="_ _32"> </span><span class="ffd">f</span></div><div class="t m0 x81 hc y856 ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x81 hc y857 ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 xaa hc y858 ff11 fs2 fc0 sc0 ls0 ws0">X</div><div class="t m0 x126 ha y859 ffc fs7 fc0 sc0 ls0 ws0">j<span class="_ _23"></span><span class="ff12">=1</span></div><div class="t m0 x1a7 he y851 ffd fs2 fc0 sc0 ls0 ws0">w</div><div class="t m0 x37 ha y854 ff12 fs7 fc0 sc0 ls0 ws0">(2)</div><div class="t m0 x37 hb y855 ffc fs7 fc0 sc0 ls0 ws0">ij</div><div class="t m0 x79 he y851 ffd fs2 fc0 sc0 ls0 ws0">h</div><div class="t m0 x9f hb y852 ffc fs7 fc0 sc0 ls0 ws0">j</div><div class="t m0 x127 h4 y851 fff fs2 fc0 sc0 ls0 ws0">+<span class="_ _37"> </span><span class="ffd">b</span></div><div class="t m0 x162 ha y854 ff12 fs7 fc0 sc0 ls0 ws0">(2)</div><div class="t m0 x162 hb y855 ffc fs7 fc0 sc0 ls0 ws0">j</div><div class="t m0 x115 hc y856 ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x115 hc y857 ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 xaf h4 y851 ff3 fs2 fc0 sc0 ls0 ws0">(9.6)</div><div class="t m0 x3 h6 y18e ff1 fs2 fc0 sc0 ls0 ws0">上述部分属于<span class="_ _25"> </span><span class="ff3">feed-forward </span>部分，<span class="_ _30"></span>从前往后依次计算出各个输出层，<span class="_ _27"></span>最后求得<span class="_ _25"> </span><span class="ffd">y<span class="_ _23"></span></span>。<span class="_ _27"></span>但此时这些权</div><div class="t m0 x3 h6 y20 ff1 fs2 fc0 sc0 ls0 ws0">值还未知。</div><div class="t m0 xbc h4 y3 ff3 fs2 fc0 sc0 ls0 ws0">55</div></div><div class="pi" data-data='{"ctm":[1.500000,0.000000,0.000000,1.500000,0.000000,0.000000]}'></div></div>
<div id="pf3e" class="pf w0 h0" data-page-no="3e"><div class="pc pc3e w0 h0"><img class="bi x1a8 y85a w14 h4a" alt="" src="bg3e.png"/><div class="t m0 x3 h7 y21 ff3 fs5 fc0 sc0 ls0 ws0">9.4<span class="_ _8"> </span><span class="ff7">反向传播</span></div><div class="t m0 x11 h9 y324 ff5 fs6 fc0 sc0 ls0 ws0">9.4<span class="_ _24"> </span><span class="ff9">反向传播</span></div><div class="t m0 x3 h6 y85b ff1 fs2 fc0 sc0 ls0 ws0">首先，<span class="_ _2e"></span>对所有的权值<span class="_ _25"> </span><span class="ffd">w<span class="_ _25"> </span></span>给定一个初始值，<span class="_ _2e"></span>然后根据前向传播的方式来计算出输出值<span class="_ _25"> </span><span class="ffd">y<span class="_ _23"></span></span>，<span class="_ _2e"></span>为了评估</div><div class="t m0 x3 h6 y85c ff1 fs2 fc0 sc0 ls0 ws0">此次训<span class="_ _23"></span>练模型是<span class="_ _23"></span>否合理，我<span class="_ _23"></span>们取网络<span class="_ _23"></span>所有输出层<span class="_ _23"></span>节点的误<span class="_ _23"></span>差平方和<span class="_ _23"></span>作为目标<span class="_ _23"></span>函数，对于<span class="_ _23"></span>样本<span class="_ _e"> </span><span class="ffd">k<span class="_ _23"></span></span>，</div><div class="t m0 x3 h6 y85d ff1 fs2 fc0 sc0 ls0 ws0">其误差表达式为：</div><div class="t m0 x172 he y85e ffd fs2 fc0 sc0 ls0 ws0">E</div><div class="t m0 x157 hb y85f ffc fs7 fc0 sc0 ls0 ws0">k</div><div class="t m0 x16 h4 y85e fff fs2 fc0 sc0 ls0 ws0">=</div><div class="t m0 x24 h4 y860 fff fs2 fc0 sc0 ls0 ws0">1</div><div class="t m0 x24 h4 y861 fff fs2 fc0 sc0 ls0 ws0">2</div><div class="t m0 xc2 h12 y862 ff14 fs7 fc0 sc0 ls0 ws0">output</div><div class="t m0 x123 hc y863 ff11 fs2 fc0 sc0 ls0 ws0">X</div><div class="t m0 x198 ha y864 ffc fs7 fc0 sc0 ls0 ws0">j<span class="_ _23"></span><span class="ff12">=1</span></div><div class="t m0 x29 h4 y85e fff fs2 fc0 sc0 ls0 ws0">[<span class="ffd">t</span></div><div class="t m0 x2a hb y865 ffc fs7 fc0 sc0 ls0 ws0">j</div><div class="t m0 x21 h4 y85e ffe fs2 fc0 sc0 ls0 ws0">−<span class="_ _37"> </span><span class="ffd">y</span></div><div class="t m0 x25 hb y865 ffc fs7 fc0 sc0 ls0 ws0">j</div><div class="t m0 x1f h4 y85e fff fs2 fc0 sc0 ls0 ws0">]</div><div class="t m0 x26 ha y866 ff12 fs7 fc0 sc0 ls0 ws0">2</div><div class="t m0 xaf h4 y85e ff3 fs2 fc0 sc0 ls0 ws0">(9.7)</div><div class="t m0 x3 h6 y867 ff1 fs2 fc0 sc0 ls0 ws0">有了目标函数之后，现在我们采用梯度下降来寻找最优解。</div><div class="t m0 x3 hd y868 ff5 fs8 fc0 sc0 ls0 ws0">9.4.1<span class="_ _36"> </span><span class="ff9">输出层</span></div><div class="t m0 x3 h6 y869 ff1 fs2 fc0 sc0 ls0 ws0">对于输出层节点，第<span class="_ _d"> </span><span class="ffd">i<span class="_ _d"> </span></span>个输出节点与第<span class="_ _d"> </span><span class="ffd">j<span class="_ _1e"> </span></span>个隐藏节点的权值更新规则为：</div><div class="t m0 x11 he y86a ffd fs2 fc0 sc0 ls0 ws0">w</div><div class="t m0 x2f ha y86b ff12 fs7 fc0 sc0 ls0 ws0">(2)</div><div class="t m0 x28 hb y86c ffc fs7 fc0 sc0 ls0 ws0">ij</div><div class="t m0 x33 h4 y86a ffe fs2 fc0 sc0 ls0 ws0">←<span class="_ _32"> </span><span class="ffd">w</span></div><div class="t m0 x53 ha y86b ff12 fs7 fc0 sc0 ls0 ws0">(2)</div><div class="t m0 x53 hb y86c ffc fs7 fc0 sc0 ls0 ws0">ij</div><div class="t m0 x12a h4 y86a ffe fs2 fc0 sc0 ls0 ws0">−<span class="_ _37"> </span><span class="ffd">η</span></div><div class="t m0 x77 he y86d ffd fs2 fc0 sc0 ls0 ws0">∂<span class="_ _23"></span>E</div><div class="t m0 x25 hb y86e ffc fs7 fc0 sc0 ls0 ws0">k</div><div class="t m0 x1a9 he y86f ffd fs2 fc0 sc0 ls0 ws0">∂<span class="_ _23"></span>w</div><div class="t m0 x103 ha y870 ff12 fs7 fc0 sc0 ls0 ws0">(2)</div><div class="t m0 x103 hb y871 ffc fs7 fc0 sc0 ls0 ws0">ij</div><div class="t m0 xaf h4 y86a ff3 fs2 fc0 sc0 ls0 ws0">(9.8)</div><div class="t m0 x3 h6 y872 ff1 fs2 fc0 sc0 ls0 ws0">其中<span class="_ _d"> </span><span class="ffd">η<span class="_ _e"> </span></span>为学习率，由于<span class="_ _25"> </span><span class="ffd">E</span></div><div class="t m0 x6c hb y873 ffc fs7 fc0 sc0 ls0 ws0">k</div><div class="t m0 x154 h6 y872 ff1 fs2 fc0 sc0 ls0 ws0">是<span class="_ _d"> </span><span class="ffd">y</span></div><div class="t m0 xd8 hb y874 ffc fs7 fc0 sc0 ls0 ws0">i</div><div class="t m0 x41 h6 y872 ff1 fs2 fc0 sc0 ls0 ws0">的函数，<span class="ffd">y</span></div><div class="t m0 xbd hb y874 ffc fs7 fc0 sc0 ls0 ws0">i</div><div class="t m0 xd9 h6 y872 ff1 fs2 fc0 sc0 ls0 ws0">是<span class="_ _d"> </span><span class="ffd">net</span></div><div class="t m0 xcf ha y875 ff12 fs7 fc0 sc0 ls0 ws0">(2)</div><div class="t m0 x99 h6 y872 ff1 fs2 fc0 sc0 ls0 ws0">的函数，<span class="ffd">net</span></div><div class="t m0 x1a5 ha y875 ff12 fs7 fc0 sc0 ls0 ws0">(2)</div><div class="t m0 x184 h6 y872 ff1 fs2 fc0 sc0 ls0 ws0">是<span class="_ _d"> </span><span class="ffd">w</span></div><div class="t m0 x151 hb y874 ffc fs7 fc0 sc0 ls0 ws0">ij</div><div class="t m0 xfa h6 y872 ff1 fs2 fc0 sc0 ls0 ws0">的函数，根据链式</div><div class="t m0 x3 h6 y876 ff1 fs2 fc0 sc0 ls0 ws0">求导法则，有：</div><div class="t m0 xff he y877 ffd fs2 fc0 sc0 ls0 ws0">∂<span class="_ _23"></span>E</div><div class="t m0 x48 hb y878 ffc fs7 fc0 sc0 ls0 ws0">k</div><div class="t m0 x11c he y879 ffd fs2 fc0 sc0 ls0 ws0">∂<span class="_ _23"></span>w</div><div class="t m0 x111 ha y87a ff12 fs7 fc0 sc0 ls0 ws0">(2)</div><div class="t m0 x111 hb y87b ffc fs7 fc0 sc0 ls0 ws0">ij</div><div class="t m0 x4f h4 y87c fff fs2 fc0 sc0 ls0 ws0">=</div><div class="t m0 xf4 he y877 ffd fs2 fc0 sc0 ls0 ws0">∂<span class="_ _23"></span>E</div><div class="t m0 x75 hb y878 ffc fs7 fc0 sc0 ls0 ws0">k</div><div class="t m0 x1 he y87d ffd fs2 fc0 sc0 ls0 ws0">∂<span class="_ _23"></span>y</div><div class="t m0 x75 hb y87e ffc fs7 fc0 sc0 ls0 ws0">i</div><div class="t m0 x12a he y877 ffd fs2 fc0 sc0 ls0 ws0">∂<span class="_ _23"></span>y</div><div class="t m0 x20 hb y87f ffc fs7 fc0 sc0 ls0 ws0">i</div><div class="t m0 xa he y879 ffd fs2 fc0 sc0 ls0 ws0">∂<span class="_ _23"></span>net</div><div class="t m0 x9e ha y87a ff12 fs7 fc0 sc0 ls0 ws0">(2)</div><div class="t m0 x9e hb y87b ffc fs7 fc0 sc0 ls0 ws0">i</div><div class="t m0 x78 he y880 ffd fs2 fc0 sc0 ls0 ws0">∂<span class="_ _23"></span>net</div><div class="t m0 x62 ha y881 ff12 fs7 fc0 sc0 ls0 ws0">(2)</div><div class="t m0 x62 hb y882 ffc fs7 fc0 sc0 ls0 ws0">i</div><div class="t m0 x44 he y879 ffd fs2 fc0 sc0 ls0 ws0">∂<span class="_ _23"></span>w</div><div class="t m0 x11d ha y87a ff12 fs7 fc0 sc0 ls0 ws0">(2)</div><div class="t m0 x11d hb y87b ffc fs7 fc0 sc0 ls0 ws0">ij</div><div class="t m0 xaf h4 y87c ff3 fs2 fc0 sc0 ls0 ws0">(9.9)</div><div class="t m0 x3 h6 y883 ff1 fs2 fc0 sc0 ls0 ws0">根据上述公式，可以分别求出偏导数：</div><div class="t m0 x55 he y884 ffd fs2 fc2 sc0 ls0 ws0">∂<span class="_ _23"></span>E</div><div class="t m0 x10c hb y885 ffc fs7 fc2 sc0 ls0 ws0">k</div><div class="t m0 xfe he y886 ffd fs2 fc2 sc0 ls0 ws0">∂<span class="_ _23"></span>y</div><div class="t m0 x8a hb y887 ffc fs7 fc2 sc0 ls0 ws0">i</div><div class="t m0 x118 h4 y888 fff fs2 fc0 sc0 ls0 ws0">=</div><div class="t m0 x50 he y884 ffd fs2 fc0 sc0 ls0 ws0">∂</div><div class="t m0 x38 he y886 ffd fs2 fc0 sc0 ls0 ws0">∂<span class="_ _23"></span>y</div><div class="t m0 x147 hb y887 ffc fs7 fc0 sc0 ls0 ws0">i</div><div class="t m0 x9a hc y889 ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x9a hc y88a ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x2 h4 y884 fff fs2 fc0 sc0 ls0 ws0">1</div><div class="t m0 x2 h4 y886 fff fs2 fc0 sc0 ls0 ws0">2</div><div class="t m0 x10 h12 y88b ff14 fs7 fc0 sc0 ls0 ws0">outputs</div><div class="t m0 x172 hc y88c ff11 fs2 fc0 sc0 ls0 ws0">X</div><div class="t m0 x48 hb y88d ffc fs7 fc0 sc0 ls0 ws0">j</div><div class="t m0 x9d h4 y888 fff fs2 fc0 sc0 ls0 ws0">(<span class="ffd">t</span></div><div class="t m0 x1 hb y88e ffc fs7 fc0 sc0 ls0 ws0">j</div><div class="t m0 x100 h4 y888 ffe fs2 fc0 sc0 ls0 ws0">−<span class="_ _37"> </span><span class="ffd">y</span></div><div class="t m0 x70 hb y88e ffc fs7 fc0 sc0 ls0 ws0">j</div><div class="t m0 xc9 h4 y888 fff fs2 fc0 sc0 ls0 ws0">)</div><div class="t m0 x5f ha y88f ff12 fs7 fc0 sc0 ls0 ws0">2</div><div class="t m0 xf5 hc y889 ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 xf5 hc y88a ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x118 h4 y890 fff fs2 fc0 sc0 ls0 ws0">=</div><div class="t m0 x50 he y891 ffd fs2 fc0 sc0 ls0 ws0">∂</div><div class="t m0 x38 he y892 ffd fs2 fc0 sc0 ls0 ws0">∂<span class="_ _23"></span>y</div><div class="t m0 x147 hb y893 ffc fs7 fc0 sc0 ls0 ws0">i</div><div class="t m0 x9a hc y894 ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 xf h4 y891 fff fs2 fc0 sc0 ls0 ws0">1</div><div class="t m0 xf h4 y892 fff fs2 fc0 sc0 ls0 ws0">2</div><div class="t m0 xff h4 y890 fff fs2 fc0 sc0 ls0 ws0">(<span class="ffd">t</span></div><div class="t m0 x22 hb y895 ffc fs7 fc0 sc0 ls0 ws0">j</div><div class="t m0 x48 h4 y890 ffe fs2 fc0 sc0 ls0 ws0">−<span class="_ _37"> </span><span class="ffd">y</span></div><div class="t m0 x23 hb y895 ffc fs7 fc0 sc0 ls0 ws0">j</div><div class="t m0 x33 h4 y890 fff fs2 fc0 sc0 ls0 ws0">)</div><div class="t m0 x96 ha y896 ff12 fs7 fc0 sc0 ls0 ws0">2</div><div class="t m0 xbd hc y894 ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 xd9 ha y897 ffc fs7 fc0 sc0 ls0 ws0">j<span class="_ _23"></span><span class="ff12">=</span>i</div><div class="t m0 x70 h4 y890 fff fs2 fc0 sc0 ls0 ws0">+</div><div class="t m0 x2a he y891 ffd fs2 fc0 sc0 ls0 ws0">∂</div><div class="t m0 xd4 he y892 ffd fs2 fc0 sc0 ls0 ws0">∂<span class="_ _23"></span>y</div><div class="t m0 x21 hb y893 ffc fs7 fc0 sc0 ls0 ws0">i</div><div class="t m0 x193 hc y898 ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x193 hc y899 ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x25 h4 y891 fff fs2 fc0 sc0 ls0 ws0">1</div><div class="t m0 x25 h4 y892 fff fs2 fc0 sc0 ls0 ws0">2</div><div class="t m0 x26 h12 y89a ff14 fs7 fc0 sc0 ls0 ws0">outputs</div><div class="t m0 x3a hc y89b ff11 fs2 fc0 sc0 ls0 ws0">X</div><div class="t m0 xc5 hb y89c ffc fs7 fc0 sc0 ls0 ws0">j</div><div class="t m0 x179 h4 y890 fff fs2 fc0 sc0 ls0 ws0">(<span class="ffd">t</span></div><div class="t m0 x1a5 hb y895 ffc fs7 fc0 sc0 ls0 ws0">j</div><div class="t m0 x102 h4 y890 ffe fs2 fc0 sc0 ls0 ws0">−<span class="_ _37"> </span><span class="ffd">y</span></div><div class="t m0 x11f hb y895 ffc fs7 fc0 sc0 ls0 ws0">j</div><div class="t m0 x15f h4 y890 fff fs2 fc0 sc0 ls0 ws0">)</div><div class="t m0 x16f ha y896 ff12 fs7 fc0 sc0 ls0 ws0">2</div><div class="t m0 xf8 hc y898 ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 xf8 hc y899 ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x190 ha y89d ffc fs7 fc0 sc0 ls0 ws0">j<span class="_ _23"></span><span class="ffb"≯<span class="ff12">=</span></span>i</div><div class="t m0 x118 h4 y89e fff fs2 fc0 sc0 ls0 ws0">=</div><div class="t m0 x50 he y89f ffd fs2 fc0 sc0 ls0 ws0">∂</div><div class="t m0 x38 he y8a0 ffd fs2 fc0 sc0 ls0 ws0">∂<span class="_ _23"></span>y</div><div class="t m0 x147 hb y8a1 ffc fs7 fc0 sc0 ls0 ws0">i</div><div class="t m0 x9a hc y8a2 ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 xf h4 y89f fff fs2 fc0 sc0 ls0 ws0">1</div><div class="t m0 xf h4 y8a0 fff fs2 fc0 sc0 ls0 ws0">2</div><div class="t m0 xff h4 y89e fff fs2 fc0 sc0 ls0 ws0">(<span class="ffd">t</span></div><div class="t m0 x22 hb y8a3 ffc fs7 fc0 sc0 ls0 ws0">i</div><div class="t m0 xf3 h4 y89e ffe fs2 fc0 sc0 ls0 ws0">−<span class="_ _37"> </span><span class="ffd">y</span></div><div class="t m0 x5b hb y8a3 ffc fs7 fc0 sc0 ls0 ws0">i</div><div class="t m0 x9d h4 y89e fff fs2 fc0 sc0 ls0 ws0">)</div><div class="t m0 x24 ha y8a4 ff12 fs7 fc0 sc0 ls0 ws0">2</div><div class="t m0 x1 hc y8a2 ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 xd9 h4 y89e fff fs2 fc0 sc0 ls0 ws0">+<span class="_ _37"> </span>0</div><div class="t m0 x118 h4 y8a5 fff fs2 fc0 sc0 ls0 ws0">=<span class="_ _32"> </span><span class="ffe">−<span class="_ _31"></span></span>(<span class="ffd">t</span></div><div class="t m0 x9 hb y8a6 ffc fs7 fc0 sc0 ls0 ws0">i</div><div class="t m0 xca h4 y8a5 ffe fs2 fc0 sc0 ls0 ws0">−<span class="_ _37"> </span><span class="ffd">y</span></div><div class="t m0 x6e hb y8a6 ffc fs7 fc0 sc0 ls0 ws0">i</div><div class="t m0 x172 h4 y8a5 fff fs2 fc0 sc0 ls0 ws0">)</div><div class="t m0 xd5 he y8a7 ffd fs2 fc2 sc0 ls0 ws0">∂<span class="_ _23"></span>y</div><div class="t m0 x56 hb y8a8 ffc fs7 fc2 sc0 ls0 ws0">i</div><div class="t m0 xdd he y8a9 ffd fs2 fc2 sc0 ls0 ws0">∂<span class="_ _23"></span>net</div><div class="t m0 x19a ha y8aa ff12 fs7 fc2 sc0 ls0 ws0">(2)</div><div class="t m0 x19a hb y8ab ffc fs7 fc2 sc0 ls0 ws0">i</div><div class="t m0 x118 h4 y8ac fff fs2 fc0 sc0 ls0 ws0">=<span class="_ _32"> </span><span class="ffd">y</span></div><div class="t m0 x50 hb y8ad ffc fs7 fc0 sc0 ls0 ws0">i</div><div class="t m0 x30 h4 y8ac fff fs2 fc0 sc0 ls0 ws0">(1<span class="_ _37"> </span><span class="ffe">−<span class="_ _37"> </span><span class="ffd">y</span></span></div><div class="t m0 x51 hb y8ad ffc fs7 fc0 sc0 ls0 ws0">i</div><div class="t m0 x73 h4 y8ac fff fs2 fc0 sc0 ls0 ws0">)</div><div class="t m0 xdd he y8ae ffd fs2 fc2 sc0 ls0 ws0">∂<span class="_ _23"></span>net</div><div class="t m0 x19a ha y8af ff12 fs7 fc2 sc0 ls0 ws0">(2)</div><div class="t m0 x19a hb y8b0 ffc fs7 fc2 sc0 ls0 ws0">i</div><div class="t m0 x91 he y8b1 ffd fs2 fc2 sc0 ls0 ws0">∂<span class="_ _23"></span>w</div><div class="t m0 x159 ha y8b2 ff12 fs7 fc2 sc0 ls0 ws0">(2)</div><div class="t m0 x159 hb y8b3 ffc fs7 fc2 sc0 ls0 ws0">ij</div><div class="t m0 x118 h4 y8b4 fff fs2 fc0 sc0 ls0 ws0">=<span class="_ _32"> </span><span class="ffd">h</span></div><div class="t m0 xd7 hb y8b5 ffc fs7 fc0 sc0 ls0 ws0">j</div><div class="t m0 x86 h4 y8b6 ff3 fs2 fc0 sc0 ls0 ws0">(9.10)</div><div class="t m0 x119 hb y8b7 ffc fs7 fc0 sc0 ls0 ws0">∂<span class="_ _23"></span>y</div><div class="t m0 x13a h10 y8b8 ff13 fs9 fc0 sc0 ls0 ws0">i</div><div class="t m0 x1a8 hb y8b9 ffc fs7 fc0 sc0 ls0 ws0">∂<span class="_ _23"></span>net</div><div class="t m0 x183 h1c y8ba ff16 fs9 fc0 sc0 ls0 ws0">(2)</div><div class="t m0 x183 h10 y8bb ff13 fs9 fc0 sc0 ls0 ws0">i</div><div class="t m0 x195 h6 y8bc ff1 fs2 fc0 sc0 ls0 ws0">就是激活函数求导：</div><div class="t m0 x31 h4 y8bd ffd fs2 fc0 sc0 ls0 ws0">y<span class="_ _25"> </span><span class="fff">=<span class="_ _32"> </span></span>f<span class="_ _34"> </span><span class="fff">(</span>z<span class="_ _23"></span><span class="fff">)<span class="_ _32"> </span>=</span></div><div class="t m0 x198 h4 y8be fff fs2 fc0 sc0 ls0 ws0">1</div><div class="t m0 x24 h4 y8bf fff fs2 fc0 sc0 ls0 ws0">1<span class="_ _37"> </span>+<span class="_ _37"> </span><span class="ffd">e</span></div><div class="t m0 x98 ha y8c0 ffb fs7 fc0 sc0 ls0 ws0">−<span class="ffc">z</span></div><div class="t m0 x4e he y8c1 ffd fs2 fc0 sc0 ls0 ws0">f</div><div class="t m0 x69 ha y8c2 ffb fs7 fc0 sc0 ls0 ws0">′</div><div class="t m0 x22 h4 y8c1 fff fs2 fc0 sc0 ls0 ws0">(<span class="ffd">z<span class="_ _23"></span></span>)<span class="_ _32"> </span>=</div><div class="t m0 x75 he y8c3 ffd fs2 fc0 sc0 ls0 ws0">e</div><div class="t m0 x5e ha y8c4 ffb fs7 fc0 sc0 ls0 ws0">−<span class="ffc">z</span></div><div class="t m0 x24 h4 y8c5 fff fs2 fc0 sc0 ls0 ws0">(<span class="ffd">e</span></div><div class="t m0 x74 ha y8c6 ffb fs7 fc0 sc0 ls0 ws0">−<span class="ffc">z</span></div><div class="t m0 xa h4 y8c5 fff fs2 fc0 sc0 ls0 ws0">+<span class="_ _37"> </span>1)</div><div class="t m0 xcf ha y8c7 ff12 fs7 fc0 sc0 ls0 ws0">2</div><div class="t m0 x16 h4 y8c8 fff fs2 fc0 sc0 ls0 ws0">=</div><div class="t m0 x198 h4 y8c9 fff fs2 fc0 sc0 ls0 ws0">1</div><div class="t m0 x24 h4 y8ca fff fs2 fc0 sc0 ls0 ws0">1<span class="_ _37"> </span>+<span class="_ _37"> </span><span class="ffd">e</span></div><div class="t m0 x98 ha y8cb ffb fs7 fc0 sc0 ls0 ws0">−<span class="ffc">z</span></div><div class="t m0 x128 h4 y8c8 ffe fs2 fc0 sc0 ls0 ws0">−</div><div class="t m0 x13f hc y8cc ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x61 h4 y8c9 fff fs2 fc0 sc0 ls0 ws0">1</div><div class="t m0 x193 h4 y8ca fff fs2 fc0 sc0 ls0 ws0">1<span class="_ _37"> </span>+<span class="_ _37"> </span><span class="ffd">e</span></div><div class="t m0 x1aa ha y8cb ffb fs7 fc0 sc0 ls0 ws0">−<span class="ffc">z</span></div><div class="t m0 xad hc y8cc ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x64 ha y8cd ff12 fs7 fc0 sc0 ls0 ws0">2</div><div class="t m0 x16 h4 y8ce fff fs2 fc0 sc0 ls0 ws0">=<span class="_ _32"> </span><span class="ffd">y<span class="_ _a"> </span><span class="ffe">−<span class="_ _37"> </span></span>y</span></div><div class="t m0 xa ha y8cf ff12 fs7 fc0 sc0 ls0 ws0">2</div><div class="t m0 x86 h4 y8d0 ff3 fs2 fc0 sc0 ls0 ws0">(9.11)</div><div class="t m0 x3 h4 y3 ff3 fs2 fc0 sc0 ls0 ws0">56</div></div><div class="pi" data-data='{"ctm":[1.500000,0.000000,0.000000,1.500000,0.000000,0.000000]}'></div></div>
<div id="pf3f" class="pf w0 h0" data-page-no="3f"><div class="pc pc3f w0 h0"><img class="bi xf0 y8d1 w15 h4b" alt="" src="bg3f.png"/><div class="t m0 x181 h7 y21 ff3 fs5 fc0 sc0 ls0 ws0">9.5<span class="_ _8"> </span><span class="ff7">权值更新归纳</span></div><div class="t m0 x3 h6 y22 ff1 fs2 fc0 sc0 ls0 ws0">由此可得，</div><div class="t m0 x6d he y8d2 ffd fs2 fc0 sc0 ls0 ws0">∂<span class="_ _23"></span>E</div><div class="t m0 xff hb y8d3 ffc fs7 fc0 sc0 ls0 ws0">k</div><div class="t m0 x17a he y8d4 ffd fs2 fc0 sc0 ls0 ws0">∂<span class="_ _23"></span>w</div><div class="t m0 x11c ha y8d5 ff12 fs7 fc0 sc0 ls0 ws0">(2)</div><div class="t m0 x11c hb y8d6 ffc fs7 fc0 sc0 ls0 ws0">ij</div><div class="t m0 xf3 h4 y8d7 fff fs2 fc0 sc0 ls0 ws0">=<span class="_ _32"> </span><span class="ffe">−<span class="_ _31"></span></span>(<span class="ffd">t</span></div><div class="t m0 x4 hb y8d8 ffc fs7 fc0 sc0 ls0 ws0">i</div><div class="t m0 x34 h4 y8d7 ffe fs2 fc0 sc0 ls0 ws0">−<span class="_ _37"> </span><span class="ffd">y</span></div><div class="t m0 x101 hb y8d8 ffc fs7 fc0 sc0 ls0 ws0">i</div><div class="t m0 x2b h4 y8d7 fff fs2 fc0 sc0 ls0 ws0">)<span class="_ _37"> </span><span class="ffe">·<span class="_ _37"> </span><span class="ffd">y</span></span></div><div class="t m0 x14a hb y8d8 ffc fs7 fc0 sc0 ls0 ws0">i</div><div class="t m0 x1a7 h4 y8d7 fff fs2 fc0 sc0 ls0 ws0">(1<span class="_ _37"> </span><span class="ffe">−<span class="_ _37"> </span><span class="ffd">y</span></span></div><div class="t m0 x62 hb y8d8 ffc fs7 fc0 sc0 ls0 ws0">i</div><div class="t m0 x127 h4 y8d7 fff fs2 fc0 sc0 ls0 ws0">)<span class="_ _37"> </span><span class="ffe">·<span class="_ _37"> </span><span class="ffd">h</span></span></div><div class="t m0 x64 hb y8d8 ffc fs7 fc0 sc0 ls0 ws0">j</div><div class="t m0 x86 h4 y8d7 ff3 fs2 fc0 sc0 ls0 ws0">(9.12)</div><div class="t m0 x3 hd y8d9 ff5 fs8 fc0 sc0 ls0 ws0">9.4.2<span class="_ _36"> </span><span class="ff9">隐藏层</span></div><div class="t m0 x3 h6 y8da ff1 fs2 fc0 sc0 ls0 ws0">首先，<span class="_ _30"></span>对于隐藏层的任意一个神经元，<span class="_ _30"></span>输出层的每个神经单元的误差对其都有影响。<span class="_ _27"></span>因此，<span class="_ _30"></span>对于</div><div class="t m0 x3 h6 y8db ff1 fs2 fc0 sc0 ls0 ws0">隐藏层第<span class="_ _d"> </span><span class="ffd">i<span class="_ _d"> </span></span>个神经元，它与输入层的第<span class="_ _d"> </span><span class="ffd">j<span class="_ _1e"> </span></span>个神经元的权值更新规则为：</div><div class="t m0 xf3 he y8dc ffd fs2 fc0 sc0 ls0 ws0">w</div><div class="t m0 xe ha y8dd ff12 fs7 fc0 sc0 ls0 ws0">(1)</div><div class="t m0 xe hb y8de ffc fs7 fc0 sc0 ls0 ws0">ij</div><div class="t m0 x166 h4 y8dc ffe fs2 fc0 sc0 ls0 ws0">←<span class="_ _32"> </span><span class="ffd">w</span></div><div class="t m0 x5e ha y8dd ff12 fs7 fc0 sc0 ls0 ws0">(1)</div><div class="t m0 x5e hb y8de ffc fs7 fc0 sc0 ls0 ws0">ij</div><div class="t m0 xaa h4 y8dc ffe fs2 fc0 sc0 ls0 ws0">−<span class="_ _37"> </span><span class="ffd">η</span></div><div class="t m0 x77 he y8df ffd fs2 fc2 sc0 ls0 ws0">∂<span class="_ _23"></span>E</div><div class="t m0 x25 hb y8e0 ffc fs7 fc2 sc0 ls0 ws0">k</div><div class="t m0 x21 he y8e1 ffd fs2 fc2 sc0 ls0 ws0">∂<span class="_ _23"></span>w</div><div class="t m0 x148 hb y8e2 ffc fs7 fc2 sc0 ls0 ws0">ij</div><div class="t m0 x86 h4 y8dc ff3 fs2 fc0 sc0 ls0 ws0">(9.13)</div><div class="t m0 x3 h6 y8e3 ff1 fs2 fc0 sc0 ls0 ws0">接着由链式法则，我们对上面红色部分进行展开：</div><div class="t m0 x57 he y8e4 ffd fs2 fc0 sc0 ls0 ws0">∂<span class="_ _23"></span>E</div><div class="t m0 x152 hb y8e5 ffc fs7 fc0 sc0 ls0 ws0">k</div><div class="t m0 x12f he y8e6 ffd fs2 fc0 sc0 ls0 ws0">∂<span class="_ _23"></span>w</div><div class="t m0 x83 ha y8e7 ff12 fs7 fc0 sc0 ls0 ws0">(1)</div><div class="t m0 x83 hb y8e8 ffc fs7 fc0 sc0 ls0 ws0">ij</div><div class="t m0 x46 h4 y8e9 fff fs2 fc0 sc0 ls0 ws0">=</div><div class="t m0 x4e he y8e4 ffd fs2 fc0 sc0 ls0 ws0">∂</div><div class="t m0 xca he y8e6 ffd fs2 fc0 sc0 ls0 ws0">∂<span class="_ _23"></span>w</div><div class="t m0 x51 ha y8e7 ff12 fs7 fc0 sc0 ls0 ws0">(1)</div><div class="t m0 x51 hb y8e8 ffc fs7 fc0 sc0 ls0 ws0">ij</div><div class="t m0 xd6 hc y8ea ff11 fs2 fc0 sc0 ls0 ws0"> </div><div class="t m0 x4f hb y8eb ffc fs7 fc0 sc0 ls0 ws0">outputs</div><div class="t m0 xc7 hc y8ec ff11 fs2 fc0 sc0 ls0 ws0">X</div><div class="t m0 x17 hb y8ed ffc fs7 fc0 sc0 ls0 ws0">s</div><div class="t m0 x53 he y8e9 ffd fs2 fc0 sc0 ls0 ws0">E</div><div class="t m0 x101 hb y8ee ffc fs7 fc0 sc0 ls0 ws0">s</div><div class="t m0 x18a hc y8ea ff11 fs2 fc0 sc0 ls0 ws0">!</div><div class="t m0 x46 h4 y8ef fff fs2 fc0 sc0 ls0 ws0">=</div><div class="t m0 xd8 hb y8f0 ffc fs7 fc0 sc0 ls0 ws0">outputs</div><div class="t m0 x4d hc y8f1 ff11 fs2 fc0 sc0 ls0 ws0">X</div><div class="t m0 xff hb y8f2 ffc fs7 fc0 sc0 ls0 ws0">s</div><div class="t m0 x28 he y8f3 ffd fs2 fc0 sc0 ls0 ws0">∂<span class="_ _23"></span>E</div><div class="t m0 x9d hb y8f4 ffc fs7 fc0 sc0 ls0 ws0">s</div><div class="t m0 x2f he y8f5 ffd fs2 fc0 sc0 ls0 ws0">∂<span class="_ _23"></span>y</div><div class="t m0 x1a3 hb y8f6 ffc fs7 fc0 sc0 ls0 ws0">s</div><div class="t m0 x123 he y8f3 ffd fs2 fc0 sc0 ls0 ws0">y</div><div class="t m0 xc3 hb y8f4 ffc fs7 fc0 sc0 ls0 ws0">s</div><div class="t m0 x96 he y8f7 ffd fs2 fc0 sc0 ls0 ws0">∂<span class="_ _23"></span>net</div><div class="t m0 x98 ha y8f8 ff12 fs7 fc0 sc0 ls0 ws0">(2)</div><div class="t m0 x98 hb y8f9 ffc fs7 fc0 sc0 ls0 ws0">s</div><div class="t m0 x29 he y8f3 ffd fs2 fc0 sc0 ls0 ws0">∂<span class="_ _23"></span>net</div><div class="t m0 x37 ha y8fa ff12 fs7 fc0 sc0 ls0 ws0">(2)</div><div class="t m0 x37 hb y8fb ffc fs7 fc0 sc0 ls0 ws0">s</div><div class="t m0 x36 he y8f5 ffd fs2 fc0 sc0 ls0 ws0">∂<span class="_ _23"></span>h</div><div class="t m0 x78 hb y8f6 ffc fs7 fc0 sc0 ls0 ws0">i</div><div class="t m0 x7a he y8f3 ffd fs2 fc0 sc0 ls0 ws0">∂<span class="_ _23"></span>h</div><div class="t m0 xad hb y8f4 ffc fs7 fc0 sc0 ls0 ws0">i</div><div class="t m0 x61 he y8f7 ffd fs2 fc0 sc0 ls0 ws0">∂<span class="_ _23"></span>net</div><div class="t m0 xad ha y8f8 ff12 fs7 fc0 sc0 ls0 ws0">(1)</div><div class="t m0 xad hb y8fc ffc fs7 fc0 sc0 ls0 ws0">i</div><div class="t m0 x7c he y8fd ffd fs2 fc0 sc0 ls0 ws0">∂<span class="_ _23"></span>net</div><div class="t m0 x184 ha y8fe ff12 fs7 fc0 sc0 ls0 ws0">(1)</div><div class="t m0 x184 hb y8ff ffc fs7 fc0 sc0 ls0 ws0">i</div><div class="t m0 x12b he y8f5 ffd fs2 fc0 sc0 ls0 ws0">∂<span class="_ _23"></span>w</div><div class="t m0 x170 hb y8f6 ffc fs7 fc0 sc0 ls0 ws0">ij</div><div class="t m0 x46 h4 y900 fff fs2 fc0 sc0 ls0 ws0">=</div><div class="t m0 xd8 hb y901 ffc fs7 fc0 sc0 ls0 ws0">outputs</div><div class="t m0 x4d hc y902 ff11 fs2 fc0 sc0 ls0 ws0">X</div><div class="t m0 xff hb y903 ffc fs7 fc0 sc0 ls0 ws0">s</div><div class="t m0 xd6 hc y904 ff11 fs2 fc0 sc0 ls0 ws0"> </div><div class="t m0 x4f h4 y900 ffe fs2 fc0 sc0 ls0 ws0">−<span class="ffd">δ</span></div><div class="t m0 x96 hb y905 ffc fs7 fc0 sc0 ls0 ws0">s</div><div class="t m0 x74 h4 y900 ffe fs2 fc0 sc0 ls0 ws0">·</div><div class="t m0 x75 he y906 ffd fs2 fc0 sc0 ls0 ws0">∂<span class="_ _23"></span>net</div><div class="t m0 x13e ha y907 ff12 fs7 fc0 sc0 ls0 ws0">(2)</div><div class="t m0 x13e hb y908 ffc fs7 fc0 sc0 ls0 ws0">i</div><div class="t m0 x98 he y909 ffd fs2 fc0 sc0 ls0 ws0">∂<span class="_ _23"></span>h</div><div class="t m0 x5f hb y90a ffc fs7 fc0 sc0 ls0 ws0">i</div><div class="t m0 x78 he y90b ffd fs2 fc0 sc0 ls0 ws0">∂<span class="_ _23"></span>h</div><div class="t m0 x1f hb y90c ffc fs7 fc0 sc0 ls0 ws0">i</div><div class="t m0 x71 he y90d ffd fs2 fc0 sc0 ls0 ws0">∂<span class="_ _23"></span>net</div><div class="t m0 x1f ha y90e ff12 fs7 fc0 sc0 ls0 ws0">(1)</div><div class="t m0 x1f hb y90f ffc fs7 fc0 sc0 ls0 ws0">i</div><div class="t m0 xc4 he y906 ffd fs2 fc0 sc0 ls0 ws0">∂<span class="_ _23"></span>net</div><div class="t m0 x179 ha y907 ff12 fs7 fc0 sc0 ls0 ws0">(1)</div><div class="t m0 x179 hb y908 ffc fs7 fc0 sc0 ls0 ws0">i</div><div class="t m0 xac he y90d ffd fs2 fc0 sc0 ls0 ws0">∂<span class="_ _23"></span>w</div><div class="t m0 x11e ha y90e ff12 fs7 fc0 sc0 ls0 ws0">(1)</div><div class="t m0 x11e hb y90f ffc fs7 fc0 sc0 ls0 ws0">ij</div><div class="t m0 x125 hc y904 ff11 fs2 fc0 sc0 ls0 ws0">!</div><div class="t m0 x46 h4 y910 fff fs2 fc0 sc0 ls0 ws0">=</div><div class="t m0 xd8 hb y911 ffc fs7 fc0 sc0 ls0 ws0">outputs</div><div class="t m0 x4d hc y912 ff11 fs2 fc0 sc0 ls0 ws0">X</div><div class="t m0 xff hb y913 ffc fs7 fc0 sc0 ls0 ws0">s</div><div class="t m0 xd6 hc y914 ff11 fs2 fc0 sc0 ls0 ws0"> </div><div class="t m0 x4f h4 y910 ffe fs2 fc0 sc0 ls0 ws0">−<span class="ffd">δ</span></div><div class="t m0 x96 hb y915 ffc fs7 fc0 sc0 ls0 ws0">s</div><div class="t m0 x74 h4 y910 ffe fs2 fc0 sc0 ls0 ws0">·<span class="_ _37"> </span><span class="ffd">w</span></div><div class="t m0 xa ha y916 ff12 fs7 fc0 sc0 ls0 ws0">(2)</div><div class="t m0 x6f hb y917 ffc fs7 fc0 sc0 ls0 ws0">si</div><div class="t m0 x5f h4 y910 ffe fs2 fc0 sc0 ls0 ws0">·</div><div class="t m0 x71 he y918 ffd fs2 fc0 sc0 ls0 ws0">∂<span class="_ _23"></span>h</div><div class="t m0 x14f hb y919 ffc fs7 fc0 sc0 ls0 ws0">i</div><div class="t m0 xcf he y91a ffd fs2 fc0 sc0 ls0 ws0">∂<span class="_ _23"></span>net</div><div class="t m0 x103 ha y91b ff12 fs7 fc0 sc0 ls0 ws0">(1)</div><div class="t m0 x103 hb y91c ffc fs7 fc0 sc0 ls0 ws0">i</div><div class="t m0 x9f he y91d ffd fs2 fc0 sc0 ls0 ws0">∂<span class="_ _23"></span>net</div><div class="t m0 x162 ha y91e ff12 fs7 fc0 sc0 ls0 ws0">(1)</div><div class="t m0 x162 hb y91f ffc fs7 fc0 sc0 ls0 ws0">i</div><div class="t m0 x7a he y91a ffd fs2 fc0 sc0 ls0 ws0">∂<span class="_ _23"></span>w</div><div class="t m0 xeb ha y91b ff12 fs7 fc0 sc0 ls0 ws0">(1)</div><div class="t m0 xeb hb y91c ffc fs7 fc0 sc0 ls0 ws0">ij</div><div class="t m0 xe9 hc y914 ff11 fs2 fc0 sc0 ls0 ws0">!</div><div class="t m0 x46 h4 y920 fff fs2 fc0 sc0 ls0 ws0">=</div><div class="t m0 xd8 h12 y921 ff14 fs7 fc0 sc0 ls0 ws0">outputs</div><div class="t m0 x4d hc y922 ff11 fs2 fc0 sc0 ls0 ws0">X</div><div class="t m0 xff hb y923 ffc fs7 fc0 sc0 ls0 ws0">s</div><div class="t m0 xd6 hc y924 ff11 fs2 fc0 sc0 ls0 ws0"> </div><div class="t m0 x4f h4 y920 ffe fs2 fc0 sc0 ls0 ws0">−<span class="ffd">δ</span></div><div class="t m0 x96 hb y925 ffc fs7 fc0 sc0 ls0 ws0">s</div><div class="t m0 x74 h4 y920 ffe fs2 fc0 sc0 ls0 ws0">·<span class="_ _37"> </span><span class="ffd">w</span></div><div class="t m0 xa ha y926 ff12 fs7 fc0 sc0 ls0 ws0">(2)</div><div class="t m0 x6f hb y927 ffc fs7 fc0 sc0 ls0 ws0">si</div><div class="t m0 x5f h4 y920 ffe fs2 fc0 sc0 ls0 ws0">·<span class="_ _37"> </span><span class="ffd">h</span></div><div class="t m0 x14a hb y925 ffc fs7 fc0 sc0 ls0 ws0">i</div><div class="t m0 x77 h4 y920 fff fs2 fc0 sc0 ls0 ws0">(1<span class="_ _37"> </span><span class="ffe">−<span class="_ _37"> </span><span class="ffd">h</span></span></div><div class="t m0 x7a hb y925 ffc fs7 fc0 sc0 ls0 ws0">i</div><div class="t m0 xa0 h4 y920 fff fs2 fc0 sc0 ls0 ws0">)<span class="_ _37"> </span><span class="ffe">·</span></div><div class="t m0 xae he y928 ffd fs2 fc0 sc0 ls0 ws0">∂<span class="_ _23"></span>net</div><div class="t m0 x125 ha y929 ff12 fs7 fc0 sc0 ls0 ws0">(1)</div><div class="t m0 x125 hb y92a ffc fs7 fc0 sc0 ls0 ws0">i</div><div class="t m0 xa1 he y92b ffd fs2 fc0 sc0 ls0 ws0">∂<span class="_ _23"></span>w</div><div class="t m0 x1a5 ha y92c ff12 fs7 fc0 sc0 ls0 ws0">(1)</div><div class="t m0 x1a5 hb y92d ffc fs7 fc0 sc0 ls0 ws0">ij</div><div class="t m0 xa4 hc y924 ff11 fs2 fc0 sc0 ls0 ws0">!</div><div class="t m0 x46 h4 y92e fff fs2 fc0 sc0 ls0 ws0">=</div><div class="t m0 xd8 h12 y92f ff14 fs7 fc0 sc0 ls0 ws0">outputs</div><div class="t m0 x4d hc y930 ff11 fs2 fc0 sc0 ls0 ws0">X</div><div class="t m0 xff hb y931 ffc fs7 fc0 sc0 ls0 ws0">s</div><div class="t m0 xd6 hc y932 ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x16 h4 y92e ffe fs2 fc0 sc0 ls0 ws0">−<span class="ffd">δ</span></div><div class="t m0 x24 hb y933 ffc fs7 fc0 sc0 ls0 ws0">s</div><div class="t m0 x1 he y92e ffd fs2 fc0 sc0 ls0 ws0">w</div><div class="t m0 xd9 ha y934 ff12 fs7 fc0 sc0 ls0 ws0">(2)</div><div class="t m0 xd9 hb y935 ffc fs7 fc0 sc0 ls0 ws0">si</div><div class="t m0 x98 he y92e ffd fs2 fc0 sc0 ls0 ws0">h</div><div class="t m0 x2b hb y933 ffc fs7 fc0 sc0 ls0 ws0">i</div><div class="t m0 xaa h4 y92e fff fs2 fc0 sc0 ls0 ws0">(1<span class="_ _37"> </span><span class="ffe">−<span class="_ _37"> </span><span class="ffd">h</span></span></div><div class="t m0 x103 hb y933 ffc fs7 fc0 sc0 ls0 ws0">i</div><div class="t m0 x25 h4 y92e fff fs2 fc0 sc0 ls0 ws0">)<span class="_ _31"> </span><span class="ffd">x</span></div><div class="t m0 xea hb y933 ffc fs7 fc0 sc0 ls0 ws0">j</div><div class="t m0 x127 hc y932 ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x46 h4 y936 fff fs2 fc0 sc0 ls0 ws0">=<span class="_ _32"> </span><span class="ffe">−<span class="ffd">h</span></span></div><div class="t m0 x9b hb y937 ffc fs7 fc0 sc0 ls0 ws0">i</div><div class="t m0 x22 h4 y936 fff fs2 fc0 sc0 ls0 ws0">(1<span class="_ _37"> </span><span class="ffe">−<span class="_ _37"> </span><span class="ffd">h</span></span></div><div class="t m0 x24 hb y937 ffc fs7 fc0 sc0 ls0 ws0">i</div><div class="t m0 x96 h4 y936 fff fs2 fc0 sc0 ls0 ws0">)</div><div class="t m0 x74 hc y938 ff11 fs2 fc0 sc0 ls0 ws0"> </div><div class="t m0 x97 h12 y939 ff14 fs7 fc0 sc0 ls0 ws0">outputs</div><div class="t m0 x98 hc y93a ff11 fs2 fc0 sc0 ls0 ws0">X</div><div class="t m0 x19c hb y93b ffc fs7 fc0 sc0 ls0 ws0">s</div><div class="t m0 x36 he y936 ffd fs2 fc0 sc0 ls0 ws0">δ</div><div class="t m0 x21 hb y937 ffc fs7 fc0 sc0 ls0 ws0">s</div><div class="t m0 x13b he y936 ffd fs2 fc0 sc0 ls0 ws0">w</div><div class="t m0 x103 ha y93c ff12 fs7 fc0 sc0 ls0 ws0">(2)</div><div class="t m0 x103 hb y93d ffc fs7 fc0 sc0 ls0 ws0">si</div><div class="t m0 x112 hc y938 ff11 fs2 fc0 sc0 ls0 ws0">!</div><div class="t m0 xc4 he y936 ffd fs2 fc0 sc0 ls0 ws0">x</div><div class="t m0 xcb hb y937 ffc fs7 fc0 sc0 ls0 ws0">j</div><div class="t m0 x86 h4 y93e ff3 fs2 fc0 sc0 ls0 ws0">(9.14)</div><div class="t m0 x3 h6 y93f ff1 fs2 fc0 sc0 ls0 ws0">代入到上式，得到隐藏层的权值更新公式：</div><div class="t m0 x4a he y940 ffd fs2 fc0 sc0 ls0 ws0">w</div><div class="t m0 x154 ha y941 ff12 fs7 fc0 sc0 ls0 ws0">(1)</div><div class="t m0 x154 hb y942 ffc fs7 fc0 sc0 ls0 ws0">ij</div><div class="t m0 x17a h4 y940 fff fs2 fc0 sc0 ls0 ws0">=<span class="_ _32"> </span><span class="ffd">w</span></div><div class="t m0 x10 ha y941 ff12 fs7 fc0 sc0 ls0 ws0">(1)</div><div class="t m0 x10 hb y942 ffc fs7 fc0 sc0 ls0 ws0">ij</div><div class="t m0 xd3 h4 y940 fff fs2 fc0 sc0 ls0 ws0">+<span class="_ _37"> </span><span class="ffd">η<span class="_ _23"></span>h</span></div><div class="t m0 xf4 hb y943 ffc fs7 fc0 sc0 ls0 ws0">i</div><div class="t m0 xbd h4 y940 fff fs2 fc0 sc0 ls0 ws0">(1<span class="_ _37"> </span><span class="ffe">−<span class="_ _37"> </span><span class="ffd">h</span></span></div><div class="t m0 x126 hb y943 ffc fs7 fc0 sc0 ls0 ws0">i</div><div class="t m0 x128 h4 y940 fff fs2 fc0 sc0 ls0 ws0">)</div><div class="t m0 x2a hc y944 ff11 fs2 fc0 sc0 ls0 ws0"> </div><div class="t m0 x77 hb y945 ffc fs7 fc0 sc0 ls0 ws0">outputs</div><div class="t m0 x78 hc y946 ff11 fs2 fc0 sc0 ls0 ws0">X</div><div class="t m0 xab hb y947 ffc fs7 fc0 sc0 ls0 ws0">s</div><div class="t m0 x3a he y940 ffd fs2 fc0 sc0 ls0 ws0">δ</div><div class="t m0 xb6 hb y943 ffc fs7 fc0 sc0 ls0 ws0">s</div><div class="t m0 xcb he y940 ffd fs2 fc0 sc0 ls0 ws0">w</div><div class="t m0 x162 hb y943 ffc fs7 fc0 sc0 ls0 ws0">si</div><div class="t m0 x179 hc y944 ff11 fs2 fc0 sc0 ls0 ws0">!</div><div class="t m0 xbe he y940 ffd fs2 fc0 sc0 ls0 ws0">x</div><div class="t m0 xbf hb y943 ffc fs7 fc0 sc0 ls0 ws0">j</div><div class="t m0 x86 h4 y940 ff3 fs2 fc0 sc0 ls0 ws0">(9.15)</div><div class="t m0 x3 h6 y948 ff1 fs2 fc0 sc0 ls0 ws0">令<span class="_ _d"> </span><span class="ffd">δ</span></div><div class="t m0 x183 hb y949 ffc fs7 fc0 sc0 ls0 ws0">i</div><div class="t m0 x15d h4 y948 fff fs2 fc0 sc0 ls0 ws0">=</div><div class="t m0 x163 hb y94a ffc fs7 fc0 sc0 ls0 ws0">∂<span class="_ _23"></span>E</div><div class="t m0 x168 h10 y94b ff13 fs9 fc0 sc0 ls0 ws0">k</div><div class="t m0 xf0 hb y94c ffc fs7 fc0 sc0 ls0 ws0">∂<span class="_ _23"></span>net</div><div class="t m0 xe2 h10 y94d ff13 fs9 fc0 sc0 ls0 ws0">i</div><div class="t m0 x1a1 h4 y948 fff fs2 fc0 sc0 ls0 ws0">=<span class="_ _32"> </span><span class="ffe">−<span class="ffd">h</span></span></div><div class="t m0 x1a0 hb y949 ffc fs7 fc0 sc0 ls0 ws0">i</div><div class="t m0 x55 h4 y948 fff fs2 fc0 sc0 ls0 ws0">(1<span class="_ _37"> </span><span class="ffe">−<span class="_ _37"> </span><span class="ffd">h</span></span></div><div class="t m0 x6c hb y949 ffc fs7 fc0 sc0 ls0 ws0">i</div><div class="t m0 x192 h4 y948 fff fs2 fc0 sc0 ls0 ws0">)<span class="_ _31"> </span>(</div><div class="t m0 x58 hc y94e ff11 fs2 fc0 sc0 ls0 ws0">P</div><div class="t m0 x9a hb y94f ffc fs7 fc0 sc0 ls0 ws0">s</div><div class="t m0 xc1 he y948 ffd fs2 fc0 sc0 ls0 ws0">δ</div><div class="t m0 x4d hb y949 ffc fs7 fc0 sc0 ls0 ws0">s</div><div class="t m0 x4e he y948 ffd fs2 fc0 sc0 ls0 ws0">w</div><div class="t m0 x73 hb y949 ffc fs7 fc0 sc0 ls0 ws0">si</div><div class="t m0 x48 h6 y948 fff fs2 fc0 sc0 ls0 ws0">)<span class="ff1">，则公式简化为：</span></div><div class="t m0 x9c he y950 ffd fs2 fc0 sc0 ls0 ws0">w</div><div class="t m0 x32 ha y951 ff12 fs7 fc0 sc0 ls0 ws0">(1)</div><div class="t m0 x32 hb y952 ffc fs7 fc0 sc0 ls0 ws0">ij</div><div class="t m0 x96 h4 y950 fff fs2 fc0 sc0 ls0 ws0">=<span class="_ _32"> </span><span class="ffd">w</span></div><div class="t m0 x6f ha y951 ff12 fs7 fc0 sc0 ls0 ws0">(1)</div><div class="t m0 x6f hb y952 ffc fs7 fc0 sc0 ls0 ws0">ij</div><div class="t m0 x126 h4 y950 ffe fs2 fc0 sc0 ls0 ws0">−<span class="_ _37"> </span><span class="ffd">η<span class="_ _23"></span>δ</span></div><div class="t m0 x197 hb y953 ffc fs7 fc0 sc0 ls0 ws0">i</div><div class="t m0 x37 he y950 ffd fs2 fc0 sc0 ls0 ws0">x</div><div class="t m0 x148 hb y953 ffc fs7 fc0 sc0 ls0 ws0">j</div><div class="t m0 x86 h4 y950 ff3 fs2 fc0 sc0 ls0 ws0">(9.16)</div><div class="t m0 x104 h9 y954 ff5 fs6 fc0 sc0 ls0 ws0">9.5<span class="_ _24"> </span><span class="ff9">权值更新归纳</span></div><div class="t m0 x3 h6 y955 ff1 fs2 fc0 sc0 ls0 ws0">通过<span class="_ _d"> </span><span class="ff3">BP<span class="_ _e"> </span></span>推导，现在我们知道<span class="_ _23"></span>如何更新权值了，下面来总结<span class="_ _23"></span>一下。假定每个节点的误差项<span class="_ _23"></span>为<span class="_ _d"> </span><span class="ffd">δ</span></div><div class="t m0 x1ab hb y956 ffc fs7 fc0 sc0 ls0 ws0">i</div><div class="t m0 x1ac h6 y955 ff1 fs2 fc0 sc0 ls0 ws0">，</div><div class="t m0 x3 h6 y957 ff1 fs2 fc0 sc0 ls0 ws0">不管是隐藏节点还是输出节点，其输出值统一使用<span class="_ _d"> </span><span class="ffd">x</span></div><div class="t m0 xd2 hb y958 ffc fs7 fc0 sc0 ls0 ws0">j</div><div class="t m0 x13b h6 y957 ff1 fs2 fc0 sc0 ls0 ws0">来表示，那么权值更新规则为：</div><div class="t m0 x95 he y2cc ffd fs2 fc0 sc0 ls0 ws0">w</div><div class="t m0 x80 hb y716 ffc fs7 fc0 sc0 ls0 ws0">ij</div><div class="t m0 xf4 h4 y2cc ffe fs2 fc0 sc0 ls0 ws0">←<span class="_ _32"> </span><span class="ffd">w</span></div><div class="t m0 xa hb y716 ffc fs7 fc0 sc0 ls0 ws0">ij</div><div class="t m0 x12a h4 y2cc ffe fs2 fc0 sc0 ls0 ws0">−<span class="_ _37"> </span><span class="ffd">η<span class="_ _23"></span>δ</span></div><div class="t m0 x60 hb y716 ffc fs7 fc0 sc0 ls0 ws0">i</div><div class="t m0 x197 he y2cc ffd fs2 fc0 sc0 ls0 ws0">x</div><div class="t m0 x14f hb y716 ffc fs7 fc0 sc0 ls0 ws0">j</div><div class="t m0 x86 h4 y2cc ff3 fs2 fc0 sc0 ls0 ws0">(9.17)</div><div class="t m0 x3 h6 y757 ff1 fs2 fc0 sc0 ls0 ws0">当节点为输出层神经元时，</div><div class="t m0 x73 he y20 ffd fs2 fc0 sc0 ls0 ws0">δ</div><div class="t m0 x111 hb y2cd ffc fs7 fc0 sc0 ls0 ws0">i</div><div class="t m0 xd6 h4 y20 fff fs2 fc0 sc0 ls0 ws0">=<span class="_ _32"> </span><span class="ffe">−<span class="ffd">y</span></span></div><div class="t m0 x4 hb y2cd ffc fs7 fc0 sc0 ls0 ws0">i</div><div class="t m0 xc2 h4 y20 fff fs2 fc0 sc0 ls0 ws0">(1<span class="_ _37"> </span><span class="ffe">−<span class="_ _37"> </span><span class="ffd">y</span></span></div><div class="t m0 x13e hb y2cd ffc fs7 fc0 sc0 ls0 ws0">i</div><div class="t m0 xd4 h4 y20 fff fs2 fc0 sc0 ls0 ws0">)(<span class="ffd">t</span></div><div class="t m0 x1a7 hb y2cd ffc fs7 fc0 sc0 ls0 ws0">i</div><div class="t m0 x193 h4 y20 ffe fs2 fc0 sc0 ls0 ws0">−<span class="_ _37"> </span><span class="ffd">y</span></div><div class="t m0 x26 hb y2cd ffc fs7 fc0 sc0 ls0 ws0">i</div><div class="t m0 x9f h4 y20 fff fs2 fc0 sc0 ls0 ws0">)<span class="_ _5a"> </span><span class="ff3">(9.18)</span></div><div class="t m0 xbc h4 y3 ff3 fs2 fc0 sc0 ls0 ws0">57</div></div><div class="pi" data-data='{"ctm":[1.500000,0.000000,0.000000,1.500000,0.000000,0.000000]}'></div></div>
<div id="pf40" class="pf w0 h0" data-page-no="40"><div class="pc pc40 w0 h0"><div class="t m0 x3 h7 y21 ff3 fs5 fc0 sc0 ls0 ws0">9.5<span class="_ _8"> </span><span class="ff7">权值更新归纳</span></div><div class="t m0 x3 h6 y22 ff1 fs2 fc0 sc0 ls0 ws0">当节点为隐藏层神经元时，</div><div class="t m0 x4d he y959 ffd fs2 fc0 sc0 ls0 ws0">δ</div><div class="t m0 x4e hb y95a ffc fs7 fc0 sc0 ls0 ws0">i</div><div class="t m0 x69 h4 y959 fff fs2 fc0 sc0 ls0 ws0">=<span class="_ _32"> </span><span class="ffe">−<span class="ffd">h</span></span></div><div class="t m0 x23 hb y95a ffc fs7 fc0 sc0 ls0 ws0">i</div><div class="t m0 x33 h4 y959 fff fs2 fc0 sc0 ls0 ws0">(1<span class="_ _37"> </span><span class="ffe">−<span class="_ _37"> </span><span class="ffd">h</span></span></div><div class="t m0 x13c hb y95a ffc fs7 fc0 sc0 ls0 ws0">i</div><div class="t m0 x2b h4 y959 fff fs2 fc0 sc0 ls0 ws0">)</div><div class="t m0 x126 hc y95b ff11 fs2 fc0 sc0 ls0 ws0"> </div><div class="t m0 x20 hc y95c ff11 fs2 fc0 sc0 ls0 ws0">X</div><div class="t m0 x1a9 hb y95d ffc fs7 fc0 sc0 ls0 ws0">s</div><div class="t m0 x124 he y959 ffd fs2 fc0 sc0 ls0 ws0">δ</div><div class="t m0 x148 hb y95a ffc fs7 fc0 sc0 ls0 ws0">s</div><div class="t m0 x79 he y959 ffd fs2 fc0 sc0 ls0 ws0">w</div><div class="t m0 x178 hb y95a ffc fs7 fc0 sc0 ls0 ws0">si</div><div class="t m0 xa0 hc y95b ff11 fs2 fc0 sc0 ls0 ws0">!</div><div class="t m0 x86 h4 y959 ff3 fs2 fc0 sc0 ls0 ws0">(9.19)</div><div class="t m0 x3 h6 y95e ff1 fs2 fc0 sc0 ls0 ws0">其中，<span class="ffd">δ</span></div><div class="t m0 xb8 hb y95f ffc fs7 fc0 sc0 ls0 ws0">i</div><div class="t m0 x145 h6 y95e ff1 fs2 fc0 sc0 ls0 ws0">是节点的误差项，<span class="ffd">y</span></div><div class="t m0 x40 hb y95f ffc fs7 fc0 sc0 ls0 ws0">i</div><div class="t m0 x59 h6 y95e ff1 fs2 fc0 sc0 ls0 ws0">是输出节点的输出值，<span class="ffd">t</span></div><div class="t m0 x13b hb y95f ffc fs7 fc0 sc0 ls0 ws0">i</div><div class="t m0 x14f h6 y95e ff1 fs2 fc0 sc0 ls0 ws0">是样本<span class="_ _d"> </span><span class="ffd">i<span class="_ _e"> </span></span>对应的目标值，<span class="ffd">h</span></div><div class="t m0 x1ad hb y95f ffc fs7 fc0 sc0 ls0 ws0">i</div><div class="t m0 x1b h6 y95e ff1 fs2 fc0 sc0 ls0 ws0">为隐藏节点</div><div class="t m0 x3 h6 y960 ff1 fs2 fc0 sc0 ls0 ws0">的输出值。权值更新归纳</div><div class="t m0 x3 h4 y3 ff3 fs2 fc0 sc0 ls0 ws0">58</div></div><div class="pi" data-data='{"ctm":[1.500000,0.000000,0.000000,1.500000,0.000000,0.000000]}'></div></div>
<div id="pf41" class="pf w0 h0" data-page-no="41"><div class="pc pc41 w0 h0"><div class="t m0 xe h5 y63 ff4 fs3 fc0 sc0 ls0 ws0">第四部分</div><div class="t m0 xe h5 y64 ff4 fs3 fc0 sc0 ls0 ws0">神经网络</div><div class="t m0 xc3 h4 y3 ff3 fs2 fc0 sc0 ls0 ws0">59</div></div><div class="pi" data-data='{"ctm":[1.500000,0.000000,0.000000,1.500000,0.000000,0.000000]}'></div></div>
<div id="pf42" class="pf w0 h0" data-page-no="42"><div class="pc pc42 w0 h0"></div><div class="pi" data-data='{"ctm":[1.500000,0.000000,0.000000,1.500000,0.000000,0.000000]}'></div></div>
<div id="pf43" class="pf w0 h0" data-page-no="43"><div class="pc pc43 w0 h0"><img class="bi x3 y5e1 w1 h3b" alt="" src="bg43.png"/><div class="t m0 x38 h5 y4 ff4 fs3 fc0 sc0 ls0 ws0">第十章 <span class="ff5">P<span class="_ _28"></span>erceptron</span></div><div class="t m0 x3 h6 y1ce ff3 fs2 fc0 sc0 ls0 ws0">P<span class="_ _12"></span>erceptron<span class="_ _e"> </span><span class="ff1">由<span class="_ _e"> </span></span>Rosenblatt<span class="_ _e"> </span><span class="ff1">于<span class="_ _e"> </span></span>1957<span class="_ _e"> </span><span class="ff1">年<span class="_ _23"></span>提出，是一种<span class="_ _23"></span>简单的线<span class="_ _23"></span>性二分类<span class="_ _23"></span>模型。感知机<span class="_ _23"></span>是支持向<span class="_ _23"></span>量</span></div><div class="t m0 x3 h6 y1cf ff1 fs2 fc0 sc0 ls0 ws0">机和神经网络的基础。<span class="_ _29"></span>可以认为，<span class="_ _3a"></span>感知机是最简单的神经网络。<span class="_ _30"></span>感知机可以在输入空间划出一条</div><div class="t m0 x3 h6 y5e2 ff1 fs2 fc0 sc0 ls0 ws0">直线，<span class="_ _30"></span>或者一个平面、<span class="_ _27"></span>超平面，<span class="_ _30"></span>如果训练集是线性可分的，<span class="_ _30"></span>那么两类样本则分别位于超平面的两</div><div class="t m0 x3 h6 y5e3 ff1 fs2 fc0 sc0 ls0 ws0">侧。</div><div class="t m0 x3 h6 y5e4 ff1 fs2 fc0 sc0 ls0 ws0">以下图的感知机为例子：</div><div class="t m0 x187 h6 y5e5 ff1 fs2 fc0 sc0 ls0 ws0">图<span class="_ _d"> </span><span class="ff3">10.1:<span class="_ _35"> </span></span>两个输入神经元的感知机结构示意图</div><div class="t m0 xb6 h6 y5e6 ff1 fs2 fc0 sc0 ls0 ws0">图<span class="_ _d"> </span><span class="ff3">10.2:<span class="_ _35"> </span>sgn<span class="_ _d"> </span></span>激活函数</div><div class="t m0 x3 h6 y5e7 ff1 fs2 fc0 sc0 ls0 ws0">假设输入空间<span class="_ _e"> </span><span class="ff3">(</span>特征向量<span class="ff3">)<span class="_ _d"> </span></span>为<span class="_ _e"> </span><span class="ff10">X<span class="_ _e"> </span><span class="ffe">⊆<span class="_ _25"> </span><span class="ffd">R</span></span></span></div><div class="t m0 x111 ha y5e8 ff12 fs7 fc0 sc0 ls0 ws0">2</div><div class="t m0 xd3 h6 y5e7 ff1 fs2 fc0 sc0 ls0 ws0">，输出空间为<span class="_ _e"> </span><span class="ffd">Y<span class="_ _5"> </span><span class="fff">=<span class="_ _25"> </span><span class="ffe">{−</span>1</span>,<span class="_ _31"> </span><span class="fff">+1<span class="ffe">}</span></span></span>。输入<span class="_ _d"> </span><span class="ff10">x</span></div><div class="t m0 xf9 ha y5e8 ff24 fs7 fc0 sc0 ls0 ws0">(</div><div class="t m0 x173 h21 y5e9 ff10 fs7 fc0 sc0 ls0 ws0">i</div><div class="t m0 xfa ha y5e8 ff24 fs7 fc0 sc0 ls0 ws0">)</div><div class="t m0 xc0 h6 y5e7 ffe fs2 fc0 sc0 ls0 ws0">∈<span class="_ _32"> </span><span class="ffd">X<span class="_ _35"> </span><span class="ff1">表示<span class="_ _23"></span>第<span class="_ _d"> </span></span>i<span class="_ _d"> </span><span class="ff1">个</span></span></div><div class="t m0 x3 h6 y5ea ff1 fs2 fc0 sc0 ls0 ws0">样本的特征向量。输出<span class="_ _d"> </span><span class="ffd">y</span></div><div class="t m0 x49 ha y5eb ff12 fs7 fc0 sc0 ls0 ws0">(<span class="ffc">i</span>)</div><div class="t m0 x154 h6 y5ea ffe fs2 fc0 sc0 ls0 ws0">∈<span class="_ _32"> </span><span class="ffd">Y<span class="_ _18"> </span><span class="ff1">表示第<span class="_ _d"> </span></span>i<span class="_ _d"> </span><span class="ff1">个样本的类别。显然这个感知机要寻找的直线为：</span></span></div><div class="t m0 x48 he y5ec ffd fs2 fc0 sc0 ls0 ws0">w</div><div class="t m0 xe ha y5ed ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 x4f he y5ec ffd fs2 fc0 sc0 ls0 ws0">x</div><div class="t m0 x9d ha y5ed ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 x96 h4 y5ec fff fs2 fc0 sc0 ls0 ws0">+<span class="_ _37"> </span><span class="ffd">w</span></div><div class="t m0 x6f ha y5ed ff12 fs7 fc0 sc0 ls0 ws0">2</div><div class="t m0 x81 he y5ec ffd fs2 fc0 sc0 ls0 ws0">x</div><div class="t m0 xc9 ha y5ed ff12 fs7 fc0 sc0 ls0 ws0">2</div><div class="t m0 x128 h4 y5ec fff fs2 fc0 sc0 ls0 ws0">+<span class="_ _37"> </span><span class="ffd">b<span class="_ _32"> </span></span>=<span class="_ _32"> </span>0</div><div class="t m0 x12 h6 y5ee ff1 fs2 fc0 sc0 ls0 ws0">这里的<span class="_ _d"> </span><span class="ffd">x</span></div><div class="t m0 xb2 ha y5ef ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 x7f h6 y5ee ff1 fs2 fc0 sc0 ls0 ws0">和<span class="_ _d"> </span><span class="ffd">x</span></div><div class="t m0 xf2 ha y5ef ff12 fs7 fc0 sc0 ls0 ws0">2</div><div class="t m0 x150 h6 y5ee ff1 fs2 fc0 sc0 ls0 ws0">并不来自输入空间。</div><div class="t m0 x3 h6 y5f0 ff1 fs2 fc0 sc0 ls0 ws0">而输入空间到输出空间的决策函数为：</div><div class="t m0 x93 h4 y5f1 fff fs2 fc0 sc0 ls0 ws0">ˆ<span class="_ _3c"></span><span class="ffd">y<span class="_ _25"> </span><span class="fff">=<span class="_ _32"> </span><span class="ff3">sgn<span class="_ _31"> </span></span>(</span>f<span class="_ _34"> </span><span class="fff">(<span class="ff10">x</span>))<span class="_ _32"> </span>=<span class="_ _32"> </span><span class="ff3">sgn</span></span></span></div><div class="t m0 xd2 hc y5f2 ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 xe0 hf y5f1 ff10 fs2 fc0 sc0 ls0 ws0">w</div><div class="t m0 x103 ha y5f3 ffb fs7 fc0 sc0 ls0 ws0">⊤</div><div class="t m0 x79 h4 y5f1 ff10 fs2 fc0 sc0 ls0 ws0">x<span class="_ _37"> </span><span class="fff">+<span class="_ _37"> </span><span class="ffd">b</span></span></div><div class="t m0 xeb hc y5f2 ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x3 h6 y5f4 ff1 fs2 fc0 sc0 ls0 ws0">可以看到，一个感知机主要由如下两部分组成：</div><div class="t m0 x15 h6 y5f5 ff3 fs2 fc0 sc0 ls0 ws0">•<span class="_ _5"> </span><span class="ff1">输入权值和偏置：<span class="ff10">w<span class="_ _d"> </span></span>和<span class="_ _d"> </span><span class="ffd">b</span>，<span class="ff10 fc2">w<span class="_ _e"> </span><span class="ff1">实际上就是感知机划分直线的法向量。</span></span></span></div><div class="t m0 x15 h6 y5f6 ff3 fs2 fc0 sc0 ls0 ws0">•<span class="_ _5"> </span><span class="ff1">激活函<span class="_ _23"></span>数：感知机<span class="_ _23"></span>的激活<span class="_ _23"></span>函数可以<span class="_ _23"></span>有很多<span class="_ _23"></span>选择，比如<span class="_ _23"></span>这里选<span class="_ _23"></span>择的激活<span class="_ _23"></span>函数是<span class="_ _1e"> </span><span class="ffd">sig<span class="_ _23"></span>n<span class="_ _e"> </span></span>符<span class="_ _23"></span>号函</span></div><div class="t m0 x13 h6 y5f7 ff1 fs2 fc0 sc0 ls0 ws0">数。</div><div class="t m0 x3 h6 y5f8 ff1 fs2 fc0 sc0 ls0 ws0">因为感<span class="_ _23"></span>知机只有一个<span class="_ _23"></span>输出层神经<span class="_ _23"></span>元，其学习能<span class="_ _23"></span>力是非常有<span class="_ _23"></span>限的，只能处理<span class="_ _23"></span>线性可分问<span class="_ _23"></span>题。因此，</div><div class="t m0 x3 h6 y5f9 ff1 fs2 fc0 sc0 ls0 ws0">感知机被诟病最多的就是其不能处理非线性可分问题。</div><div class="t m0 x3 h6 y5fa ff1 fs2 fc0 sc0 ls0 ws0">如图<span class="ff3">10.3</span>所示，<span class="_ _26"></span>“与、或、非”都是线性问题，而<span class="_ _12"></span>“异或”是非线性可分问题，感知机无法处理。</div><div class="t m0 xc3 h4 y3 ff3 fs2 fc0 sc0 ls0 ws0">61</div><a class="l" href="#pf44" data-dest-detail='[68,"XYZ",70.87,806.14,null]'><div class="d m1" style="border-style:none;position:absolute;left:139.026000px;bottom:186.763500px;width:19.397000px;height:15.458000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.500000,0.000000,0.000000,1.500000,0.000000,0.000000]}'></div></div>
<div id="pf44" class="pf w0 h0" data-page-no="44"><div class="pc pc44 w0 h0"><img class="bi xdd y5fb w11 h3c" alt="" src="bg44.png"/><div class="t m0 x3 h7 y21 ff3 fs5 fc0 sc0 ls0 ws0">10.1<span class="_ _8"> </span><span class="ff7">损失函数</span></div><div class="t m0 x10a h6 y5fc ff1 fs2 fc0 sc0 ls0 ws0">图<span class="_ _d"> </span><span class="ff3">10.3:<span class="_ _35"> </span></span>线性可分的“与”<span class="_ _2f"></span>“或”<span class="_ _26"></span>“非”问题与非线性可分的“异或”问题</div><div class="t m0 x22 h9 y5fd ff5 fs6 fc0 sc0 ls0 ws0">10.1<span class="_ _24"> </span><span class="ff9">损失函数</span></div><div class="t m0 x3 h6 y5fe ff1 fs2 fc0 sc0 ls0 ws0">感知<span class="_ _23"></span>机的学<span class="_ _23"></span>习策略<span class="_ _23"></span>是最<span class="_ _23"></span>小化损<span class="_ _23"></span>失函数。<span class="_ _23"></span>损失函<span class="_ _23"></span>数的选<span class="_ _23"></span>择有<span class="_ _23"></span>多种，这<span class="_ _23"></span>里我们<span class="_ _23"></span>采用的<span class="_ _23"></span>是误<span class="_ _23"></span>分类点<span class="_ _23"></span>到</div><div class="t m0 x3 h6 y5ff ff1 fs2 fc0 sc0 ls0 ws0">超平面的距离，如下：</div><div class="t m0 x96 h4 y600 fff fs2 fc0 sc0 ls0 ws0">1</div><div class="t m0 x5b h4 y601 ffe fs2 fc0 sc0 ls0 ws0">∥<span class="_ _32"> </span><span class="ff10">w<span class="_ _25"> </span></span>∥</div><div class="t m0 xc3 h4 y602 ffe fs2 fc0 sc0 ls0 ws0">|<span class="ff10">w<span class="_ _23"></span>x<span class="_ _38"> </span><span class="fff">+<span class="_ _37"> </span><span class="ffd">b</span></span></span>|</div><div class="t m0 x3 h6 y603 ff1 fs2 fc0 sc0 ls0 ws0">其中<span class="_ _d"> </span><span class="ffe">||<span class="ff10">w<span class="_ _23"></span></span>||<span class="_ _25"> </span></span>是<span class="_ _d"> </span><span class="ffd">L</span></div><div class="t m0 x3b ha y604 ff12 fs7 fc0 sc0 ls0 ws0">2</div><div class="t m0 x54 h6 y603 ff1 fs2 fc0 sc0 ls0 ws0">范数，即是<span class="_ _d"> </span><span class="ff10">w<span class="_ _e"> </span></span>向量的模。</div><div class="t m0 x3 h6 y605 ff1 fs2 fc0 sc0 ls0 ws0">对于正确分类的样本点<span class="_ _d"> </span><span class="fff">(<span class="ff10">x</span></span></div><div class="t m0 x8d ha y606 ff24 fs7 fc0 sc0 ls0 ws0">(<span class="ff10">i</span>)</div><div class="t m0 x58 he y605 ffd fs2 fc0 sc0 ls0 ws0">,<span class="_ _31"> </span>y</div><div class="t m0 x17a ha y606 ff12 fs7 fc0 sc0 ls0 ws0">(<span class="ffc">i</span>)</div><div class="t m0 x2 h6 y605 fff fs2 fc0 sc0 ls0 ws0">)<span class="_ _d"> </span><span class="ff1">而言：</span></div><div class="t m0 xd6 he y607 ffd fs2 fc0 sc0 ls0 ws0">y</div><div class="t m0 x16 ha y608 ff12 fs7 fc0 sc0 ls0 ws0">(<span class="ffc">i</span>)</div><div class="t m0 x9d h4 y607 fff fs2 fc0 sc0 ls0 ws0">(<span class="ff10">w<span class="_ _23"></span>x</span></div><div class="t m0 x97 ha y608 ff24 fs7 fc0 sc0 ls0 ws0">(<span class="ff10">i</span>)</div><div class="t m0 x2b h4 y607 fff fs2 fc0 sc0 ls0 ws0">+<span class="_ _37"> </span><span class="ffd">b</span>)<span class="_ _32"> </span><span class="ffd">&gt;<span class="_ _32"> </span></span>0</div><div class="t m0 x3 h6 y609 ff1 fs2 fc0 sc0 ls0 ws0">所以，对于误分类点<span class="_ _d"> </span><span class="fff">(<span class="ffd">x</span></span></div><div class="t m0 x57 hb y60a ffc fs7 fc0 sc0 ls0 ws0">i</div><div class="t m0 xe6 he y609 ffd fs2 fc0 sc0 ls0 ws0">,<span class="_ _31"> </span>y</div><div class="t m0 x3f hb y60a ffc fs7 fc0 sc0 ls0 ws0">i</div><div class="t m0 x38 h6 y609 fff fs2 fc0 sc0 ls0 ws0">)<span class="_ _d"> </span><span class="ff1">来说：</span></div><div class="t m0 xd6 he y60b ffd fs2 fc0 sc0 ls0 ws0">y</div><div class="t m0 x16 ha y60c ff12 fs7 fc0 sc0 ls0 ws0">(<span class="ffc">i</span>)</div><div class="t m0 x9d h4 y60b fff fs2 fc0 sc0 ls0 ws0">(<span class="ff10">w<span class="_ _23"></span>x</span></div><div class="t m0 x97 ha y60c ff24 fs7 fc0 sc0 ls0 ws0">(<span class="ff10">i</span>)</div><div class="t m0 x2b h4 y60b fff fs2 fc0 sc0 ls0 ws0">+<span class="_ _37"> </span><span class="ffd">b</span>)<span class="_ _32"> </span><span class="ffd">&lt;<span class="_ _32"> </span></span>0</div><div class="t m0 x3 h6 y60d ff1 fs2 fc0 sc0 ls0 ws0">误分类点<span class="_ _d"> </span><span class="ff10">x</span></div><div class="t m0 x176 ha y60e ff24 fs7 fc0 sc0 ls0 ws0">(<span class="ff10">i</span>)</div><div class="t m0 xcc h6 y60d ff1 fs2 fc0 sc0 ls0 ws0">到超平面的距离为：</div><div class="t m0 x47 h4 y60f ffe fs2 fc0 sc0 ls0 ws0">−</div><div class="t m0 x5b h4 y610 fff fs2 fc0 sc0 ls0 ws0">1</div><div class="t m0 x2f h4 y611 ffe fs2 fc0 sc0 ls0 ws0">∥<span class="_ _32"> </span><span class="ffd">w<span class="_ _25"> </span></span>∥</div><div class="t m0 xc2 he y60f ffd fs2 fc0 sc0 ls0 ws0">y</div><div class="t m0 x123 ha y612 ff12 fs7 fc0 sc0 ls0 ws0">(<span class="ffc">i</span>)</div><div class="t m0 x98 h4 y60f fff fs2 fc0 sc0 ls0 ws0">(<span class="ff10">w<span class="_ _23"></span>x</span></div><div class="t m0 x2a ha y612 ff24 fs7 fc0 sc0 ls0 ws0">(<span class="ff10">i</span>)</div><div class="t m0 x193 h4 y60f fff fs2 fc0 sc0 ls0 ws0">+<span class="_ _37"> </span><span class="ffd">b</span>)</div><div class="t m0 x3 h6 y613 ff1 fs2 fc0 sc0 ls0 ws0">那么，所有误分类的点到超平面的总距离为：</div><div class="t m0 x4d h4 y614 ffe fs2 fc0 sc0 ls0 ws0">−</div><div class="t m0 x48 h4 y615 fff fs2 fc0 sc0 ls0 ws0">1</div><div class="t m0 x12d h4 y616 ffe fs2 fc0 sc0 ls0 ws0">∥<span class="_ _32"> </span><span class="ff10">w<span class="_ _25"> </span></span>∥</div><div class="t m0 xf4 hc y617 ff11 fs2 fc0 sc0 ls0 ws0">X</div><div class="t m0 x9d h21 y618 ff10 fs7 fc0 sc0 ls0 ws0">x</div><div class="t m0 x17 h1c y619 ff25 fs9 fc0 sc0 ls0 ws0">(<span class="ff20">i</span>)</div><div class="t m0 x34 hb y618 ffc fs7 fc0 sc0 ls0 ws0">ϵM</div><div class="t m0 x98 he y614 ffd fs2 fc0 sc0 ls0 ws0">y</div><div class="t m0 x2b ha y61a ff12 fs7 fc0 sc0 ls0 ws0">(<span class="ffc">i</span>)</div><div class="t m0 xd4 h4 y614 fff fs2 fc0 sc0 ls0 ws0">(<span class="ff10">w<span class="_ _23"></span>x</span></div><div class="t m0 x66 ha y61a ff24 fs7 fc0 sc0 ls0 ws0">(<span class="ff10">i</span>)</div><div class="t m0 x26 h4 y614 fff fs2 fc0 sc0 ls0 ws0">+<span class="_ _37"> </span><span class="ffd">b</span>)</div><div class="t m0 x3 h6 y61b ff1 fs2 fc0 sc0 ls0 ws0">由于极值计算不受常量的影响，因此不考虑</div><div class="t m0 x65 ha y61c ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 x34 ha y61d ffb fs7 fc0 sc0 ls0 ws0">||<span class="ffc">w</span>||</div><div class="t m0 x70 h6 y61b ff1 fs2 fc0 sc0 ls0 ws0">，由此得到感知机的损失函数如下：</div><div class="t m0 x9a h4 y61e ffd fs2 fc0 sc0 ls0 ws0">L<span class="fff">(<span class="ff10">w<span class="_ _23"></span></span></span>,<span class="_ _33"> </span>b<span class="fff">)<span class="_ _32"> </span>=<span class="_ _32"> </span><span class="ffe">−</span></span></div><div class="t m0 x100 hc y61f ff11 fs2 fc0 sc0 ls0 ws0">X</div><div class="t m0 xbd h21 y620 ff10 fs7 fc0 sc0 ls0 ws0">x</div><div class="t m0 x34 h1c y621 ff25 fs9 fc0 sc0 ls0 ws0">(<span class="ff20">i</span>)</div><div class="t m0 x5e hb y620 ffc fs7 fc0 sc0 ls0 ws0">ϵM</div><div class="t m0 xaa he y61e ffd fs2 fc0 sc0 ls0 ws0">y</div><div class="t m0 xd4 ha y622 ff12 fs7 fc0 sc0 ls0 ws0">(<span class="ffc">i</span>)</div><div class="t m0 x1a9 h4 y61e fff fs2 fc0 sc0 ls0 ws0">(<span class="ff10">w<span class="_ _23"></span>x</span></div><div class="t m0 x79 ha y622 ff24 fs7 fc0 sc0 ls0 ws0">(<span class="ff10">i</span>)</div><div class="t m0 x127 h4 y61e fff fs2 fc0 sc0 ls0 ws0">+<span class="_ _37"> </span><span class="ffd">b</span>)</div><div class="t m0 x3 h6 y2cc ff1 fs2 fc0 sc0 ls0 ws0">其中<span class="_ _d"> </span><span class="ffd">M<span class="_ _35"> </span></span>为误分类的集合。</div><div class="t m0 x3 h6 y18d ff1 fs2 fc0 sc0 ls0 ws0">可以看出，<span class="_ _12"></span>随时函数<span class="_ _d"> </span><span class="ffd">L<span class="fff">(</span>w,<span class="_ _31"> </span>b<span class="fff">)<span class="_ _d"> </span></span></span>是非负的。<span class="ff4">如果没有误分类点，<span class="_ _12"></span>则损失函数的值为<span class="_ _e"> </span><span class="ff6">0</span>，而且误分类</span></div><div class="t m0 x3 h6 y18e ff4 fs2 fc0 sc0 ls0 ws0">点越少，<span class="_ _28"></span>误分类点距离超平面就越近，损失函数值就越小。<span class="_ _28"></span><span class="ff1">同时，<span class="_ _12"></span>损失函数<span class="_ _25"> </span><span class="ffd">L<span class="fff">(</span>w<span class="_ _23"></span>,<span class="_ _31"> </span>b<span class="fff">)<span class="_ _d"> </span></span></span>是连续可导</span></div><div class="t m0 x3 h6 y20 ff1 fs2 fc0 sc0 ls0 ws0">函数<span class="_ _d"> </span><span class="ff3">s</span>。</div><div class="t m0 x3 h4 y3 ff3 fs2 fc0 sc0 ls0 ws0">62</div></div><div class="pi" data-data='{"ctm":[1.500000,0.000000,0.000000,1.500000,0.000000,0.000000]}'></div></div>
<div id="pf45" class="pf w0 h0" data-page-no="45"><div class="pc pc45 w0 h0"><img class="bi x3 y142 w1 h3d" alt="" src="bg45.png"/><div class="t m0 x116 h7 y21 ff3 fs5 fc0 sc0 ls0 ws0">10.2<span class="_ _8"> </span><span class="ff7">参数更新</span></div><div class="t m0 x22 h9 y324 ff5 fs6 fc0 sc0 ls0 ws0">10.2<span class="_ _24"> </span><span class="ff9">参数更新</span></div><div class="t m0 x3 h6 y623 ff1 fs2 fc0 sc0 ls0 ws0">感知<span class="_ _23"></span>器的学习<span class="_ _23"></span>算法是<span class="_ _23"></span>一种<span class="ff4">错误<span class="_ _23"></span>驱动</span>的<span class="_ _23"></span><span class="ff4">在线学<span class="_ _23"></span>习</span>算法<span class="_ _1e"> </span><span class="ff3">[Rosen<span class="_ _12"></span>blatt,<span class="_ _1e"> </span>1958].<span class="_ _b"> </span><span class="ff1">先初<span class="_ _23"></span>始化一<span class="_ _23"></span>个权重向<span class="_ _23"></span>量</span></span></div><div class="t m0 x3 h6 y624 ff10 fs2 fc0 sc0 ls0 ws0">w<span class="_ _25"> </span><span class="ffe">←<span class="_ _32"> </span><span class="fff">0<span class="_ _25"> </span><span class="ff3">(<span class="ff1">通常是全零向量</span>)<span class="ff1">，<span class="_ _27"></span>然后每次分错一个样本<span class="_ _25"> </span><span class="fff">(<span class="ff10">x<span class="ffd">,<span class="_ _31"> </span>y<span class="_ _23"></span></span></span>)<span class="_ _25"> </span></span>时，<span class="_ _27"></span>即<span class="_ _25"> </span><span class="ffd">y<span class="_ _23"></span><span class="ff10">w</span></span></span></span></span></span></div><div class="t m0 x125 ha y625 ffb fs7 fc0 sc0 ls0 ws0">⊤</div><div class="t m0 x6a h6 y624 ff10 fs2 fc0 sc0 ls0 ws0">x<span class="_ _32"> </span><span class="ffd">&lt;<span class="_ _32"> </span><span class="fff">0<span class="ff1">，<span class="_ _30"></span>就用这个样本来更</span></span></span></div><div class="t m0 x3 h6 y626 ff1 fs2 fc0 sc0 ls0 ws0">新权重。</div><div class="t m0 xc7 h4 y627 ff10 fs2 fc0 sc0 ls0 ws0">w<span class="_ _25"> </span><span class="ffe">←<span class="_ _32"> </span></span>w<span class="_ _a"> </span><span class="fff">+<span class="_ _37"> </span><span class="ffd">y<span class="_ _23"></span></span></span>x</div><div class="t m0 x3 h6 y628 ff1 fs2 fc0 sc0 ls0 ws0">实际上，这就是<span class="ff4">随机梯度下降</span>的策略，其每次更新的梯度为</div><div class="t m0 xba h4 y629 ffd fs2 fc0 sc0 ls0 ws0">∂<span class="_ _23"></span><span class="ffe">L<span class="fff">(<span class="ff10">w<span class="_ _23"></span></span>;<span class="_ _31"> </span><span class="ff10">x</span></span></span>,<span class="_ _31"> </span>y<span class="_ _23"></span><span class="fff">)</span></div><div class="t m0 x6d he y62a ffd fs2 fc0 sc0 ls0 ws0">∂<span class="_ _23"></span><span class="ff10">w</span></div><div class="t m0 x32 h4 y62b fff fs2 fc0 sc0 ls0 ws0">=</div><div class="t m0 x166 hc y62c ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 xd9 h4 y62d fff fs2 fc0 sc0 ls0 ws0">0<span class="_ _4c"> </span><span class="ff3">if<span class="_ _57"> </span><span class="ffd">y<span class="_ _23"></span><span class="ff10">w</span></span></span></div><div class="t m0 x1aa ha y62e ffb fs7 fc0 sc0 ls0 ws0">⊤</div><div class="t m0 xc5 h4 y62d ff10 fs2 fc0 sc0 ls0 ws0">x<span class="_ _32"> </span><span class="ffd">&gt;<span class="_ _32"> </span><span class="fff">0</span></span></div><div class="t m0 xd9 h4 y62f ffe fs2 fc0 sc0 ls0 ws0">−<span class="ffd">y<span class="_ _23"></span><span class="ff10">x<span class="_ _58"> </span><span class="ff3">if<span class="_ _57"> </span></span></span>y<span class="_ _23"></span><span class="ff10">w</span></span></div><div class="t m0 x1aa ha y630 ffb fs7 fc0 sc0 ls0 ws0">⊤</div><div class="t m0 xc5 h4 y62f ff10 fs2 fc0 sc0 ls0 ws0">x<span class="_ _32"> </span><span class="ffd">&lt;<span class="_ _32"> </span><span class="fff">0</span></span></div><div class="t m0 x3 h6 y631 ff1 fs2 fc0 sc0 ls0 ws0">极小<span class="_ _23"></span>化过程<span class="_ _23"></span>不是一<span class="_ _23"></span>次所<span class="_ _23"></span>有误分<span class="_ _23"></span>类点的<span class="_ _23"></span>梯度下<span class="_ _23"></span>降，选取<span class="_ _23"></span>当前<span class="_ _23"></span>误分类<span class="_ _23"></span>点使其<span class="_ _23"></span>梯度下<span class="_ _23"></span>降。使<span class="_ _23"></span>用的规<span class="_ _23"></span>则</div><div class="t m0 x3 h6 y632 ff1 fs2 fc0 sc0 ls0 ws0">为<span class="_ _25"> </span><span class="ffd">θ<span class="_ _25"> </span><span class="fff">:=<span class="_ _32"> </span></span>θ<span class="_ _38"> </span><span class="ffe">−<span class="_ _38"></span></span>η<span class="_ _23"></span><span class="ffe">∇</span></span></div><div class="t m0 xe4 hb y633 ffc fs7 fc0 sc0 ls0 ws0">θ</div><div class="t m0 xe5 h6 y632 ffd fs2 fc0 sc0 ls0 ws0">ℓ<span class="fff">(</span>θ<span class="_ _23"></span><span class="fff">)<span class="ff1">，<span class="_ _29"></span>其中<span class="_ _25"> </span><span class="ffd">η<span class="_ _d"> </span></span>是步长，<span class="_ _30"></span>即学习率，<span class="_ _29"></span><span class="ffe">∇</span></span></span></div><div class="t m0 xd4 hb y633 ffc fs7 fc0 sc0 ls0 ws0">θ</div><div class="t m0 x2a h6 y632 ffd fs2 fc0 sc0 ls0 ws0">ℓ<span class="fff">(</span>θ<span class="_ _23"></span><span class="fff">)<span class="_ _32"> </span><span class="ff1">是梯度。<span class="_ _30"></span>因此，<span class="_ _30"></span>每次更新权重的公式为：</span></span></div><div class="t m0 x5b h4 y634 ff10 fs2 fc0 sc0 ls0 ws0">w<span class="_ _25"> </span><span class="ffe">←<span class="_ _32"> </span></span>w<span class="_ _a"> </span><span class="fff">+<span class="_ _37"> </span><span class="ffd">η<span class="_ _23"></span>y<span class="_ _23"></span></span></span>x</div><div class="t m0 x24 h4 y635 ffd fs2 fc0 sc0 ls0 ws0">b<span class="_ _32"> </span><span class="ffe">←<span class="_ _32"> </span></span>b<span class="_ _37"> </span><span class="fff">+<span class="_ _37"> </span></span>η<span class="_ _23"></span>y</div><div class="t m0 x3 h6 y636 ff1 fs2 fc0 sc0 ls0 ws0">我们可以从几何的角度去理解这个更新过程，在此之前，我们可能需要一点点先验知识。</div><div class="t m0 x12 hf y637 ff10 fs2 fc0 sc0 ls0 ws0">w</div><div class="t m0 x174 ha y638 ffb fs7 fc0 sc0 ls0 ws0">⊤</div><div class="t m0 xb9 h6 y637 ff10 fs2 fc0 sc0 ls0 ws0">x<span class="_ _d"> </span><span class="ff1">是一个内积，在欧几里得空间，点积可以被定义为：</span></div><div class="t m0 xd6 hf y639 ff10 fs2 fc0 sc0 ls0 ws0">w</div><div class="t m0 x52 ha y63a ffb fs7 fc0 sc0 ls0 ws0">⊤</div><div class="t m0 x33 h4 y639 ff10 fs2 fc0 sc0 ls0 ws0">x<span class="_ _32"> </span><span class="fff">=<span class="_ _32"> </span><span class="ffe">|</span></span>w<span class="_ _23"></span><span class="ffe">||</span>x<span class="ffe">|<span class="_ _33"></span><span class="ff3">cos<span class="_ _31"> </span><span class="ffd">θ</span></span></span></div><div class="t m0 x12 h6 y63b ff10 fs2 fc0 sc0 ls0 ws0">w<span class="_ _1e"> </span><span class="ff1">是<span class="_ _23"></span>划分直<span class="_ _23"></span>线的法<span class="_ _23"></span>向量，但<span class="_ _23"></span>我们知道<span class="_ _23"></span>直线的<span class="_ _23"></span>法向量<span class="_ _23"></span>是可以<span class="_ _23"></span>有两个<span class="_ _23"></span>方向的，<span class="_ _23"></span>即向左或<span class="_ _23"></span>向右，</span></div><div class="t m0 x12 h6 y63c ff1 fs2 fc0 sc0 ls0 ws0">那么<span class="_ _25"> </span><span class="ff10">w<span class="_ _d"> </span></span>到底是指哪个方向的法向量呢？<span class="_ _30"></span>从前面的决策函数<span class="_ _30"></span>（即分类规则）<span class="_ _30"></span>可以看出，<span class="_ _29"></span>法向</div><div class="t m0 x12 h6 y63d ff1 fs2 fc0 sc0 ls0 ws0">量<span class="_ _d"> </span><span class="ff10">w<span class="_ _e"> </span></span>指向正类（<span class="ff3">+1</span>）所在的方向。</div><div class="t m0 x12 h6 y63e ff1 fs2 fc0 sc0 ls0 ws0">为了方<span class="_ _23"></span>便讨论，我们<span class="_ _23"></span>将<span class="_ _e"> </span><span class="ff10">w</span></div><div class="t m0 x40 ha y63f ffb fs7 fc0 sc0 ls0 ws0">⊤</div><div class="t m0 x59 h6 y63e ff10 fs2 fc0 sc0 ls0 ws0">x<span class="_ _a"> </span><span class="fff">+<span class="_ _37"> </span><span class="ffd">b<span class="_ _e"> </span><span class="ff1">改<span class="_ _23"></span>写为<span class="_ _e"> </span></span></span></span>w</div><div class="t m0 xc3 ha y63f ffb fs7 fc0 sc0 ls0 ws0">⊤</div><div class="t m0 x13c h6 y63e ff10 fs2 fc0 sc0 ls0 ws0">x<span class="ff1">，这是<span class="_ _23"></span>完全没有问<span class="_ _23"></span>题的，只需要<span class="_ _23"></span>将<span class="_ _e"> </span></span>w<span class="_ _1e"> </span><span class="ff1">和<span class="_ _e"> </span></span>x</div><div class="t m0 x12 h6 y640 ff1 fs2 fc0 sc0 ls0 ws0">各自增加一个维度即<span class="_ _23"></span>可。这种写法的好处是，我们可以直接从<span class="_ _e"> </span><span class="ff10">w<span class="_ _e"> </span></span>和<span class="_ _d"> </span><span class="ff10">x<span class="_ _e"> </span></span>的内积的符号去判</div><div class="t m0 x12 h6 y641 ff1 fs2 fc0 sc0 ls0 ws0">断分类结果，</div><div class="t m0 x3 h6 y642 ff1 fs2 fc0 sc0 ls0 ws0">如果一<span class="_ _23"></span>个正类的<span class="_ _23"></span>点被误分<span class="_ _23"></span>为负类，即</div><div class="t m0 x157 hf y643 ff10 fs2 fc0 sc0 ls0 ws0">w</div><div class="t m0 x4f h12 y644 ff26 fs7 fc0 sc0 ls0 ws0">⊤</div><div class="t m0 x9d hf y642 ff10 fs2 fc0 sc0 ls0 ws0">x</div><div class="t m0 x5c he y643 ffd fs2 fc0 sc0 ls0 ws0">&lt;</div><div class="t m0 x53 h4 y642 fff fs2 fc0 sc0 ls0 ws0">0</div><div class="t m0 x98 h6 y643 ff1 fs2 fc0 sc0 ls0 ws0">，那表<span class="_ _23"></span>示</div><div class="t m0 x1f hf y642 ff10 fs2 fc0 sc0 ls0 ws0">w</div><div class="t m0 xa0 h6 y643 ff1 fs2 fc0 sc0 ls0 ws0">和</div><div class="t m0 xe8 hf y642 ff10 fs2 fc0 sc0 ls0 ws0">x</div><div class="t m0 xe9 h6 y643 ff1 fs2 fc0 sc0 ls0 ws0">夹角大<span class="_ _23"></span>于</div><div class="t m0 x190 h4 y642 ff3 fs2 fc0 sc0 ls0 ws0">90</div><div class="t m0 x131 h6 y643 ff1 fs2 fc0 sc0 ls0 ws0">度。所以，<span class="_ _23"></span>修正</div><div class="t m0 x3 h6 y645 ff1 fs2 fc0 sc0 ls0 ws0">的<span class="_ _23"></span>方法<span class="_ _23"></span>就是<span class="_ _23"></span>使<span class="_ _1e"> </span><span class="ffd">w<span class="_ _0"> </span></span>和<span class="_ _35"> </span><span class="ffd">x<span class="_ _35"> </span></span>夹<span class="_ _23"></span>角小<span class="_ _23"></span>于<span class="_ _1e"> </span><span class="ff3">90<span class="_ _3f"> </span></span>度，从<span class="_ _23"></span>而<span class="_ _23"></span>让法<span class="_ _23"></span>向量<span class="_ _23"></span>指向<span class="_ _23"></span>该正<span class="_ _23"></span>类点<span class="_ _23"></span>所<span class="_ _23"></span>在的<span class="_ _23"></span>一侧，<span class="_ _23"></span>通常<span class="_ _23"></span>做法<span class="_ _23"></span>是</div><div class="t m0 x3 h6 y646 ff10 fs2 fc0 sc0 ls0 ws0">w<span class="_ _25"> </span><span class="ffe">←<span class="_ _32"> </span></span>w<span class="_ _32"> </span><span class="fff">+<span class="_ _37"> </span><span class="ffd">y<span class="_ _23"></span></span></span>x<span class="ffd">,<span class="_ _33"> </span>y<span class="_ _d"> </span><span class="fff">=<span class="_ _25"> </span>1<span class="ff1">，如下图所示。根据向量加法的平行四边形<span class="_ _23"></span>法则，一次更新，就可以使得新</span></span></span></div><div class="t m0 x3 h6 y647 ff1 fs2 fc0 sc0 ls0 ws0">的法向量<span class="_ _d"> </span><span class="ff10">w<span class="_ _32"> </span><span class="fff">+<span class="_ _37"> </span></span>x<span class="_ _d"> </span></span>与<span class="_ _e"> </span><span class="ff10">x<span class="_ _d"> </span></span>的夹角<span class="_ _23"></span>小于<span class="_ _d"> </span><span class="ff3">90<span class="_ _d"> </span></span>度，这就对该<span class="_ _23"></span>误分类点完成了修正。但是由于学<span class="_ _23"></span>习率的存</div><div class="t m0 x3 h6 y648 ff1 fs2 fc0 sc0 ls0 ws0">在，实际上更新后的法向量为<span class="_ _25"> </span><span class="ff10">w<span class="_ _a"> </span><span class="fff">+<span class="_ _37"> </span><span class="ffd">η<span class="_ _23"></span></span></span>x</span>，因此一次更新可能不会让法向量和误分类点的夹角小于</div><div class="t m0 x3 h6 y649 ff3 fs2 fc0 sc0 ls0 ws0">90<span class="_ _d"> </span><span class="ff1">度，需要多次更新才能达到目的。</span></div><div class="t m0 x3 h6 y64a ff1 fs2 fc0 sc0 ls0 ws0">同理，<span class="_ _28"></span>如果一个负类点被误分为正类，<span class="_ _28"></span>即<span class="_ _25"> </span><span class="ff10">w</span></div><div class="t m0 x5c h12 y64b ff26 fs7 fc0 sc0 ls0 ws0">⊤</div><div class="t m0 x123 h6 y64a ff10 fs2 fc0 sc0 ls0 ws0">x<span class="_ _32"> </span><span class="ffd">&gt;<span class="_ _32"> </span><span class="fff">0<span class="ff1">，<span class="_ _28"></span>那表示<span class="_ _25"> </span><span class="ff10">w<span class="_ _e"> </span></span>和<span class="_ _25"> </span><span class="ff10">x<span class="_ _d"> </span></span>夹角小于<span class="_ _d"> </span><span class="ff3">90<span class="_ _25"> </span></span>度。<span class="_ _28"></span>修正的方</span></span></span></div><div class="t m0 x3 h6 y64c ff1 fs2 fc0 sc0 ls0 ws0">法就是使<span class="_ _e"> </span><span class="ffd">w<span class="_ _e"> </span></span>和<span class="_ _d"> </span><span class="ffd">x<span class="_ _e"> </span></span>夹角小大于<span class="_ _e"> </span><span class="ff3">90<span class="_ _d"> </span></span>度。<span class="_ _23"></span>通常做法是<span class="_ _d"> </span><span class="ff10">w<span class="_ _d"> </span><span class="ffe">←<span class="_ _25"> </span></span>w<span class="_ _32"> </span><span class="fff">+<span class="_ _37"> </span><span class="ffd">y<span class="_ _23"></span></span></span>x<span class="ffd">,<span class="_ _31"> </span>y<span class="_ _d"> </span><span class="fff">=<span class="_ _25"> </span><span class="ffe">−</span>1<span class="_ _e"> </span></span></span></span>。如下图所示。根<span class="_ _23"></span>据向</div><div class="t m0 x3 h6 y64d ff1 fs2 fc0 sc0 ls0 ws0">量减法的三角形法<span class="_ _23"></span>则，一次更新，就可以使得新的法向<span class="_ _23"></span>量<span class="_ _d"> </span><span class="ff10">w<span class="_ _a"> </span><span class="ffe">−<span class="_ _37"> </span></span>x<span class="_ _d"> </span></span>与<span class="_ _e"> </span><span class="ff10">x<span class="_ _d"> </span></span>的夹角<span class="_ _23"></span>大于<span class="_ _d"> </span><span class="ff3">90<span class="_ _d"> </span></span>度，这就</div><div class="t m0 x3 h6 y64e ff1 fs2 fc0 sc0 ls0 ws0">对该误分类点完成了修正。同样由于学习率的存在，实际上可能需要多次更新才能达到目的。</div><div class="t m0 xbc h4 y3 ff3 fs2 fc0 sc0 ls0 ws0">63</div></div><div class="pi" data-data='{"ctm":[1.500000,0.000000,0.000000,1.500000,0.000000,0.000000]}'></div></div>
<div id="pf46" class="pf w0 h0" data-page-no="46"><div class="pc pc46 w0 h0"><img class="bi x177 y64f w12 h3e" alt="" src="bg46.png"/><div class="t m0 x3 h7 y21 ff3 fs5 fc0 sc0 ls0 ws0">10.2<span class="_ _8"> </span><span class="ff7">参数更新</span></div><div class="t m0 x3 h6 y22 ff1 fs2 fc0 sc0 ls0 ws0">我们<span class="_ _23"></span>可以证<span class="_ _23"></span>明，当学<span class="_ _23"></span>习率<span class="_ _23"></span>足够小<span class="_ _23"></span>的时候，<span class="_ _23"></span>划分直<span class="_ _23"></span>线与误<span class="_ _23"></span>分类<span class="_ _23"></span>点的距<span class="_ _23"></span>离在参<span class="_ _23"></span>数更新<span class="_ _23"></span>后会<span class="_ _23"></span>变得更<span class="_ _23"></span>小</div><div class="t m0 x14 h6 y17d ff1 fs2 fc0 sc0 ls0 ws0">（这里不在意参数更新后，<span class="_ _29"></span>误分类点是否被正确分类）<span class="_ _2f"></span>。<span class="_ _30"></span>这是感知机参数更新的性质，<span class="_ _29"></span>具体证明过</div><div class="t m0 x3 h6 y17e ff1 fs2 fc0 sc0 ls0 ws0">程如下：</div><div class="t m0 x3 h6 y89 ff1 fs2 fc0 sc0 ls0 ws0">对于某个误分类点</div><div class="t m0 x89 hc y650 ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 xfe h4 y651 ffe fs2 fc0 sc0 ls0 ws0">−<span class="_ _59"></span>→</div><div class="t m0 xdb h3f y89 ff15 fs2 fc0 sc0 ls0 ws0">x</div><div class="t m0 x8a hb y652 ffc fs7 fc0 sc0 ls0 ws0">i</div><div class="t m0 x12f h4 y89 ffd fs2 fc0 sc0 ls0 ws0">,<span class="_ _37"> </span><span class="fff">˜<span class="_ _3c"></span><span class="ffd">y</span></span></div><div class="t m0 x4b hb y652 ffc fs7 fc0 sc0 ls0 ws0">i</div><div class="t m0 x83 hc y650 ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 xba h6 y89 ffd fs2 fc0 sc0 ls0 ws0">,<span class="_ _d"> </span><span class="ff1">假设它被选中用于更新参数。</span></div><div class="t m0 x3 h6 y8a ff3 fs2 fc0 sc0 ls0 ws0">1.<span class="_ _35"> </span><span class="ff1">假设迭代之前，分类超平面为<span class="_ _d"> </span><span class="ffd">S<span class="_ _51"></span></span></span>,<span class="_ _d"> </span><span class="ff1">该误分类点距超平面的距离为<span class="_ _d"> </span><span class="ffd">d</span></span></div><div class="t m0 x3 h6 y52d ff3 fs2 fc0 sc0 ls0 ws0">2.<span class="_ _35"> </span><span class="ff1">假设迭代之后，分类超平面为<span class="_ _d"> </span><span class="ffd">S</span></span></div><div class="t m0 x9b ha y653 ffb fs7 fc0 sc0 ls0 ws0">′</div><div class="t m0 x6e h6 y52d ffd fs2 fc0 sc0 ls0 ws0">,<span class="_ _d"> </span><span class="ff1">该误分类点距超平面的距离为<span class="_ _d"> </span></span>d</div><div class="t m0 xf7 ha y653 ffb fs7 fc0 sc0 ls0 ws0">′</div><div class="t m0 x3 h6 y654 ff1 fs2 fc0 sc0 ls0 ws0">则：</div><div class="t m0 x3d h4 y655 fff fs2 fc0 sc0 ls0 ws0">∆<span class="ffd">d<span class="_ _32"> </span></span>=<span class="_ _32"> </span><span class="ffd">d</span></div><div class="t m0 x3f ha y656 ffb fs7 fc0 sc0 ls0 ws0">′</div><div class="t m0 x8 h4 y655 ffe fs2 fc0 sc0 ls0 ws0">−<span class="_ _37"> </span><span class="ffd">d<span class="_ _32"> </span><span class="fff">=</span></span></div><div class="t m0 x111 h4 y657 fff fs2 fc0 sc0 ls0 ws0">1</div><div class="t m0 x5a hc y658 ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x5a hc y659 ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x12d h4 y65a ffe fs2 fc0 sc0 ls0 ws0">−<span class="_ _59"></span>→</div><div class="t m0 x6e h3f y65b ff15 fs2 fc0 sc0 ls0 ws0">w</div><div class="t m0 xd3 ha y65c ffb fs7 fc0 sc0 ls0 ws0">′</div><div class="t m0 xd6 hc y658 ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 xd6 hc y659 ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x94 ha y65d ff12 fs7 fc0 sc0 ls0 ws0">2</div><div class="t m0 x1a3 hc y65e ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x1a3 hc y65f ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 xa9 h4 y660 ffe fs2 fc0 sc0 ls0 ws0">−<span class="_ _59"></span>→</div><div class="t m0 x166 h3f y655 ff15 fs2 fc0 sc0 ls0 ws0">w</div><div class="t m0 xc2 ha y656 ffb fs7 fc0 sc0 ls0 ws0">′</div><div class="t m0 x35 h4 y655 ffe fs2 fc0 sc0 ls0 ws0">·</div><div class="t m0 x53 h4 y660 ffe fs2 fc0 sc0 ls0 ws0">−<span class="_ _59"></span>→</div><div class="t m0 x6f h3f y655 ff15 fs2 fc0 sc0 ls0 ws0">x</div><div class="t m0 x2b hb y661 ffc fs7 fc0 sc0 ls0 ws0">i</div><div class="t m0 x126 h4 y655 fff fs2 fc0 sc0 ls0 ws0">+<span class="_ _37"> </span><span class="ffd">b</span></div><div class="t m0 x71 ha y656 ffb fs7 fc0 sc0 ls0 ws0">′</div><div class="t m0 x60 hc y65e ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x60 hc y65f ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x37 h4 y655 ffe fs2 fc0 sc0 ls0 ws0">−</div><div class="t m0 x1aa h4 y657 fff fs2 fc0 sc0 ls0 ws0">1</div><div class="t m0 x1f h4 y662 ffe fs2 fc0 sc0 ls0 ws0">∥</div><div class="t m0 x11d h4 y663 ffe fs2 fc0 sc0 ls0 ws0">−<span class="_ _59"></span>→</div><div class="t m0 x178 h4 y662 ff15 fs2 fc0 sc0 ls0 ws0">w<span class="_ _33"> </span><span class="ffe">∥</span></div><div class="t m0 xc6 ha y664 ff12 fs7 fc0 sc0 ls0 ws0">2</div><div class="t m0 xe8 hc y65e ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 xe8 hc y65f ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 xf6 h4 y660 ffe fs2 fc0 sc0 ls0 ws0">−<span class="_ _59"></span>→</div><div class="t m0 xa2 h4 y655 ff15 fs2 fc0 sc0 ls0 ws0">w<span class="_ _e"> </span><span class="ffe">·</span></div><div class="t m0 xbf h4 y660 ffe fs2 fc0 sc0 ls0 ws0">−<span class="_ _59"></span>→</div><div class="t m0 x14b h3f y655 ff15 fs2 fc0 sc0 ls0 ws0">x</div><div class="t m0 xa3 hb y661 ffc fs7 fc0 sc0 ls0 ws0">i</div><div class="t m0 x11a h4 y655 fff fs2 fc0 sc0 ls0 ws0">+<span class="_ _37"> </span><span class="ffd">b</span></div><div class="t m0 x185 hc y65e ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x185 hc y65f ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x10c h4 y665 fff fs2 fc0 sc0 ls0 ws0">=<span class="_ _32"> </span><span class="ffe">−</span></div><div class="t m0 x147 h4 y666 fff fs2 fc0 sc0 ls0 ws0">1</div><div class="t m0 xce hc y667 ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 xce hc y668 ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 xd7 h4 y669 ffe fs2 fc0 sc0 ls0 ws0">−<span class="_ _59"></span>→</div><div class="t m0 x4c h3f y66a ff15 fs2 fc0 sc0 ls0 ws0">w</div><div class="t m0 x59 ha y66b ffb fs7 fc0 sc0 ls0 ws0">′</div><div class="t m0 x133 hc y667 ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x133 hc y668 ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 xf ha y66c ff12 fs7 fc0 sc0 ls0 ws0">2</div><div class="t m0 x5a h4 y665 fff fs2 fc0 sc0 ls0 ws0">˜<span class="_ _3c"></span><span class="ffd">y</span></div><div class="t m0 x9b hb y66d ffc fs7 fc0 sc0 ls0 ws0">i</div><div class="t m0 x22 hc y66e ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x11 h4 y66f ffe fs2 fc0 sc0 ls0 ws0">−<span class="_ _59"></span>→</div><div class="t m0 x48 h3f y665 ff15 fs2 fc0 sc0 ls0 ws0">w</div><div class="t m0 x94 ha y670 ffb fs7 fc0 sc0 ls0 ws0">′</div><div class="t m0 x80 h4 y665 ffe fs2 fc0 sc0 ls0 ws0">·</div><div class="t m0 x9d h4 y66f ffe fs2 fc0 sc0 ls0 ws0">−<span class="_ _59"></span>→</div><div class="t m0 x166 h3f y665 ff15 fs2 fc0 sc0 ls0 ws0">x</div><div class="t m0 x5c hb y66d ffc fs7 fc0 sc0 ls0 ws0">i</div><div class="t m0 xd9 h4 y665 fff fs2 fc0 sc0 ls0 ws0">+<span class="_ _37"> </span><span class="ffd">b</span></div><div class="t m0 x70 ha y670 ffb fs7 fc0 sc0 ls0 ws0">′</div><div class="t m0 x18a hc y66e ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x128 h4 y665 fff fs2 fc0 sc0 ls0 ws0">+</div><div class="t m0 x66 h4 y666 fff fs2 fc0 sc0 ls0 ws0">1</div><div class="t m0 x71 h4 y671 ffe fs2 fc0 sc0 ls0 ws0">∥</div><div class="t m0 x13b h4 y672 ffe fs2 fc0 sc0 ls0 ws0">−<span class="_ _59"></span>→</div><div class="t m0 x99 h4 y671 ff15 fs2 fc0 sc0 ls0 ws0">w<span class="_ _33"> </span><span class="ffe">∥</span></div><div class="t m0 x1f ha y673 ff12 fs7 fc0 sc0 ls0 ws0">2</div><div class="t m0 x178 h4 y665 fff fs2 fc0 sc0 ls0 ws0">˜<span class="_ _3c"></span><span class="ffd">y</span></div><div class="t m0 x3a hb y66d ffc fs7 fc0 sc0 ls0 ws0">i</div><div class="t m0 xc5 hc y66e ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 xc6 h4 y66f ffe fs2 fc0 sc0 ls0 ws0">−<span class="_ _59"></span>→</div><div class="t m0 xad h4 y665 ff15 fs2 fc0 sc0 ls0 ws0">w<span class="_ _e"> </span><span class="ffe">·</span></div><div class="t m0 xe9 h4 y66f ffe fs2 fc0 sc0 ls0 ws0">−<span class="_ _59"></span>→</div><div class="t m0 x12b h3f y665 ff15 fs2 fc0 sc0 ls0 ws0">x</div><div class="t m0 x102 hb y66d ffc fs7 fc0 sc0 ls0 ws0">i</div><div class="t m0 x170 h4 y665 fff fs2 fc0 sc0 ls0 ws0">+<span class="_ _37"> </span><span class="ffd">b</span></div><div class="t m0 x11b hc y66e ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x46 h4 y674 ffe fs2 fc0 sc0 ls0 ws0">≃<span class="_ _32"> </span>−</div><div class="t m0 x22 h4 y675 fff fs2 fc0 sc0 ls0 ws0">˜<span class="_ _3c"></span><span class="ffd">y</span></div><div class="t m0 x11 hb y676 ffc fs7 fc0 sc0 ls0 ws0">i</div><div class="t m0 x5a h4 y677 ffe fs2 fc0 sc0 ls0 ws0">∥</div><div class="t m0 x51 h4 y678 ffe fs2 fc0 sc0 ls0 ws0">−<span class="_ _59"></span>→</div><div class="t m0 x69 h4 y677 ff15 fs2 fc0 sc0 ls0 ws0">w<span class="_ _33"> </span><span class="ffe">∥</span></div><div class="t m0 x2f ha y679 ff12 fs7 fc0 sc0 ls0 ws0">2</div><div class="t m0 x52 hc y67a ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x24 h4 y67b ffe fs2 fc0 sc0 ls0 ws0">−<span class="_ _59"></span>→</div><div class="t m0 xf4 h3f y674 ff15 fs2 fc0 sc0 ls0 ws0">w</div><div class="t m0 x122 ha y67c ffb fs7 fc0 sc0 ls0 ws0">′</div><div class="t m0 x75 h4 y674 ffe fs2 fc0 sc0 ls0 ws0">−</div><div class="t m0 x13c h4 y67b ffe fs2 fc0 sc0 ls0 ws0">−<span class="_ _59"></span>→</div><div class="t m0 x70 h3f y674 ff15 fs2 fc0 sc0 ls0 ws0">w</div><div class="t m0 x13e hc y67a ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x2a h4 y674 ffe fs2 fc0 sc0 ls0 ws0">·</div><div class="t m0 x1a9 h4 y67b ffe fs2 fc0 sc0 ls0 ws0">−<span class="_ _59"></span>→</div><div class="t m0 x1a7 h3f y674 ff15 fs2 fc0 sc0 ls0 ws0">x</div><div class="t m0 x66 hb y67d ffc fs7 fc0 sc0 ls0 ws0">i</div><div class="t m0 x148 h4 y674 fff fs2 fc0 sc0 ls0 ws0">+</div><div class="t m0 x11d hc y67a ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x1aa he y674 ffd fs2 fc0 sc0 ls0 ws0">b</div><div class="t m0 x149 ha y67c ffb fs7 fc0 sc0 ls0 ws0">′</div><div class="t m0 xcb h4 y674 ffe fs2 fc0 sc0 ls0 ws0">−<span class="_ _37"> </span><span class="ffd">b</span></div><div class="t m0 x179 hc y67a ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 xff h4 y67e fff fs2 fc0 sc0 ls0 ws0">=<span class="_ _32"> </span><span class="ffe">−</span></div><div class="t m0 x80 h4 y67f fff fs2 fc0 sc0 ls0 ws0">˜<span class="_ _3c"></span><span class="ffd">y</span></div><div class="t m0 x9d hb y680 ffc fs7 fc0 sc0 ls0 ws0">i</div><div class="t m0 x95 h4 y681 ffe fs2 fc0 sc0 ls0 ws0">∥</div><div class="t m0 x4f h4 y682 ffe fs2 fc0 sc0 ls0 ws0">−<span class="_ _59"></span>→</div><div class="t m0 x80 h4 y681 ff15 fs2 fc0 sc0 ls0 ws0">w<span class="_ _33"> </span><span class="ffe">∥</span></div><div class="t m0 xc2 hc y683 ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 xd9 h4 y67e ffd fs2 fc0 sc0 ls0 ws0">η<span class="_ _34"></span><span class="fff">˜<span class="_ _3c"></span><span class="ffd">y</span></span></div><div class="t m0 x98 hb y684 ffc fs7 fc0 sc0 ls0 ws0">i</div><div class="t m0 x101 h4 y685 ffe fs2 fc0 sc0 ls0 ws0">−<span class="_ _59"></span>→</div><div class="t m0 x2b h3f y67e ff15 fs2 fc0 sc0 ls0 ws0">x</div><div class="t m0 x29 hb y684 ffc fs7 fc0 sc0 ls0 ws0">i</div><div class="t m0 x20 h4 y67e ffe fs2 fc0 sc0 ls0 ws0">·</div><div class="t m0 x13f h4 y685 ffe fs2 fc0 sc0 ls0 ws0">−<span class="_ _59"></span>→</div><div class="t m0 x21 h3f y67e ff15 fs2 fc0 sc0 ls0 ws0">x</div><div class="t m0 x37 hb y684 ffc fs7 fc0 sc0 ls0 ws0">i</div><div class="t m0 x148 h4 y67e fff fs2 fc0 sc0 ls0 ws0">+<span class="_ _37"> </span><span class="ffd">η<span class="_ _34"></span></span>˜<span class="_ _3c"></span><span class="ffd">y</span></div><div class="t m0 xb6 hb y684 ffc fs7 fc0 sc0 ls0 ws0">i</div><div class="t m0 x140 hc y683 ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 xca h4 y686 fff fs2 fc0 sc0 ls0 ws0">=<span class="_ _37"> </span><span class="ffe">−</span></div><div class="t m0 x2f h4 y687 fff fs2 fc0 sc0 ls0 ws0">˜<span class="_ _3c"></span><span class="ffd">y</span></div><div class="t m0 x32 ha y688 ff12 fs7 fc0 sc0 ls0 ws0">2</div><div class="t m0 x16 hb y689 ffc fs7 fc0 sc0 ls0 ws0">i</div><div class="t m0 x11 h4 y68a ffe fs2 fc0 sc0 ls0 ws0">∥</div><div class="t m0 x9c h4 y68b ffe fs2 fc0 sc0 ls0 ws0">−<span class="_ _59"></span>→</div><div class="t m0 xd6 h4 y68a ff15 fs2 fc0 sc0 ls0 ws0">w<span class="_ _33"> </span><span class="ffe">∥</span></div><div class="t m0 x9d ha y68c ff12 fs7 fc0 sc0 ls0 ws0">2</div><div class="t m0 x5d hc y68d ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 xc2 he y686 ffd fs2 fc0 sc0 ls0 ws0">η</div><div class="t m0 x123 h4 y68e ffe fs2 fc0 sc0 ls0 ws0">−<span class="_ _59"></span>→</div><div class="t m0 x65 h3f y686 ff15 fs2 fc0 sc0 ls0 ws0">x</div><div class="t m0 x81 hb y68f ffc fs7 fc0 sc0 ls0 ws0">i</div><div class="t m0 x2b h4 y686 ffe fs2 fc0 sc0 ls0 ws0">·</div><div class="t m0 x5f h4 y68e ffe fs2 fc0 sc0 ls0 ws0">−<span class="_ _59"></span>→</div><div class="t m0 x128 h3f y686 ff15 fs2 fc0 sc0 ls0 ws0">x</div><div class="t m0 x36 hb y68f ffc fs7 fc0 sc0 ls0 ws0">i</div><div class="t m0 x1a7 h4 y686 fff fs2 fc0 sc0 ls0 ws0">+<span class="_ _37"> </span>1</div><div class="t m0 xc8 hc y68d ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x11d h4 y686 ffd fs2 fc0 sc0 ls0 ws0">&lt;<span class="_ _32"> </span><span class="fff">0</span></div><div class="t m0 x3 h6 y690 ff1 fs2 fc0 sc0 ls0 ws0">因此有<span class="_ _d"> </span><span class="ffd">d</span></div><div class="t m0 x6 ha y691 ffb fs7 fc0 sc0 ls0 ws0">′</div><div class="t m0 x108 h6 y690 ffd fs2 fc0 sc0 ls0 ws0">&lt;<span class="_ _32"> </span>d<span class="_ _d"> </span><span class="ff1">这里要求</span></div><div class="t m0 xe6 h4 y692 ffe fs2 fc0 sc0 ls0 ws0">−<span class="_ _59"></span>→</div><div class="t m0 x8c h3f y690 ff15 fs2 fc0 sc0 ls0 ws0">w</div><div class="t m0 x3f ha y691 ffb fs7 fc0 sc0 ls0 ws0">′</div><div class="t m0 x1a2 h4 y690 ffe fs2 fc0 sc0 ls0 ws0">≃</div><div class="t m0 x31 h4 y692 ffe fs2 fc0 sc0 ls0 ws0">−<span class="_ _59"></span>→</div><div class="t m0 x17a h6 y690 ff15 fs2 fc0 sc0 ls0 ws0">w<span class="_ _33"> </span><span class="ffd">,<span class="_ _d"> </span><span class="ff1">因此步长<span class="_ _d"> </span></span>η<span class="_ _e"> </span><span class="ff1">要相当小。</span></span></div><div class="t m0 x3 h6 y693 ff1 fs2 fc0 sc0 ls0 ws0">具体的感知器参数学习策略如下图所示（摘自邱锡鹏的《神经网络与深度学习》<span class="_ _26"></span>）<span class="_ _2f"></span>：</div><div class="t m0 xd7 h6 y694 ff1 fs2 fc0 sc0 ls0 ws0">图<span class="_ _d"> </span><span class="ff3">10.4:<span class="_ _35"> </span></span>二分类感知器的参数学习算法</div><div class="t m0 x3 h6 y359 ff1 fs2 fc0 sc0 ls0 ws0">在有的文章中（例如周志华的《机器学习》<span class="_ _26"></span>）<span class="_ _2f"></span>，最后得到的更新公式为：</div><div class="t m0 x4f h4 y695 ff10 fs2 fc0 sc0 ls0 ws0">w<span class="_ _25"> </span><span class="ffe">←<span class="_ _32"> </span></span>w<span class="_ _a"> </span><span class="fff">+<span class="_ _37"> </span><span class="ffd">α</span>∆</span>w</div><div class="t m0 x166 h4 y696 ffd fs2 fc0 sc0 ls0 ws0">b<span class="_ _32"> </span><span class="ffe">←<span class="_ _32"> </span></span>b<span class="_ _37"> </span><span class="fff">+<span class="_ _37"> </span>∆</span>b</div><div class="t m0 x3 h6 y20 ff1 fs2 fc0 sc0 ls0 ws0">其中，<span class="fff">∆<span class="ff10">w<span class="_ _25"> </span></span>=<span class="_ _32"> </span><span class="ffd">α</span>(<span class="ffd">y<span class="_ _a"> </span><span class="ffe">−<span class="_ _25"> </span></span></span>ˆ<span class="_ _3c"></span><span class="ffd">y<span class="_ _23"></span><span class="fff">)<span class="ff10">x<span class="ff1">，</span></span>∆</span>b<span class="_ _a"> </span><span class="fff">=<span class="_ _32"> </span></span>α<span class="fff">(</span>y<span class="_ _32"> </span><span class="ffe">−<span class="_ _32"> </span><span class="fff">ˆ<span class="_ _3c"></span><span class="ffd">y<span class="_ _23"></span><span class="fff">)<span class="ff1">。</span></span></span></span></span></span></span></div><div class="t m0 x3 h4 y3 ff3 fs2 fc0 sc0 ls0 ws0">64</div></div><div class="pi" data-data='{"ctm":[1.500000,0.000000,0.000000,1.500000,0.000000,0.000000]}'></div></div>
<div id="pf47" class="pf w0 h0" data-page-no="47"><div class="pc pc47 w0 h0"><img class="bi x3 y697 w1 h40" alt="" src="bg47.png"/><div class="t m0 xfa h7 y21 ff3 fs5 fc0 sc0 ls0 ws0">10.3<span class="_ _8"> </span><span class="ff7">感知器收敛性</span></div><div class="t m0 x3 h6 y22 ff1 fs2 fc0 sc0 ls0 ws0">这是<span class="_ _23"></span>因为它将<span class="_ _23"></span>样本的<span class="_ _23"></span>类别映射<span class="_ _23"></span>为<span class="_ _e"> </span><span class="ff3">0<span class="_ _1e"> </span></span>和<span class="_ _e"> </span><span class="ff3">1</span>，<span class="_ _23"></span>同时采取<span class="_ _23"></span>平方和<span class="_ _23"></span>损失函数，<span class="_ _23"></span>所以权<span class="_ _23"></span>值更新的<span class="_ _23"></span>公式不<span class="_ _23"></span>一</div><div class="t m0 x3 h6 y17d ff1 fs2 fc0 sc0 ls0 ws0">样，<span class="_ _30"></span>不过思想都是一样的。<span class="_ _28"></span>这种情况下的更新公式推导可以参考这篇文章<span class="_ _27"></span><span class="fc5">《机器学习<span class="_ _d"> </span><span class="ff3">_<span class="_ _25"> </span></span>感知机》</span></div><div class="t m0 x3 h6 y17e ff1 fs2 fc0 sc0 ls0 ws0">。</div><div class="t m0 xf h9 y698 ff5 fs6 fc0 sc0 ls0 ws0">10.3<span class="_ _24"> </span><span class="ff9">感知器收敛性</span></div><div class="t m0 x3 h6 y699 ff1 fs2 fc0 sc0 ls0 ws0">感知机的迭代一定会停下来吗？<span class="_ _27"></span>由感知机算法的定义，<span class="_ _30"></span>可以知道，<span class="_ _30"></span>当找到一条直线，<span class="_ _30"></span>能将平面上</div><div class="t m0 x3 h6 y69a ff1 fs2 fc0 sc0 ls0 ws0">的点都分类正确，<span class="_ _2e"></span>那么感知机就会停止。<span class="_ _3a"></span>显然，<span class="_ _2e"></span>要达到这个终止条件，<span class="_ _2e"></span>训练集必须是线性可分的。</div><div class="t m0 x3 h6 y69b ff1 fs2 fc0 sc0 ls0 ws0">如果训练集不是线性可分的，那么上述的感知机算法永远不会停止。</div><div class="t m0 x3 h6 y69c ff3 fs2 fc0 sc0 ls0 ws0">[No<span class="_ _12"></span>vik<span class="_ _12"></span>o,<span class="_ _1e"> </span>1963]<span class="_ _e"> </span><span class="ff1">证明<span class="_ _23"></span>了对于<span class="_ _23"></span>两类问题，<span class="_ _23"></span>如果训<span class="_ _23"></span>练集是线<span class="_ _23"></span>性可分的，<span class="_ _23"></span>那么感知<span class="_ _23"></span>器算法<span class="_ _23"></span>可以在有<span class="_ _23"></span>限</span></div><div class="t m0 x3 h6 y69d ff1 fs2 fc0 sc0 ls0 ws0">次迭代后收敛。然而，如果训练集不是线性可分的，那么这个算法则不能确保会收敛。</div><div class="t m0 x3 h6 y69e ff1 fs2 fc0 sc0 ls0 ws0">当数据集是两类线性可分时<span class="ff3">, </span>对于训练集<span class="_ _25"> </span><span class="ffe">D<span class="_ _25"> </span><span class="fff">=</span></span></div><div class="t m0 x97 hc y69f ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x70 hf y69e ff10 fs2 fc0 sc0 ls0 ws0">x</div><div class="t m0 x126 ha y6a0 ff12 fs7 fc0 sc0 ls0 ws0">(<span class="ffc">n</span>)</div><div class="t m0 x14a he y69e ffd fs2 fc0 sc0 ls0 ws0">,<span class="_ _31"> </span>y</div><div class="t m0 x99 ha y6a0 ff12 fs7 fc0 sc0 ls0 ws0">(<span class="ffc">n</span>)</div><div class="t m0 x158 hc y69f ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x7a hb y6a1 ffc fs7 fc0 sc0 ls0 ws0">N</div><div class="t m0 x7a ha y6a2 ffc fs7 fc0 sc0 ls0 ws0">n<span class="ff12">=1</span></div><div class="t m0 x162 h6 y69e ffd fs2 fc0 sc0 ls0 ws0">,<span class="_ _32"> </span><span class="ff1">其中<span class="_ _25"> </span><span class="ff10">x</span></span></div><div class="t m0 x7e ha y6a0 ff12 fs7 fc0 sc0 ls0 ws0">(<span class="ffc">n</span>)</div><div class="t m0 x151 h6 y69e ff1 fs2 fc0 sc0 ls0 ws0">为样本的增广特征向</div><div class="t m0 x3 h6 y588 ff1 fs2 fc0 sc0 ls0 ws0">量<span class="ff3">,<span class="_ _e"> </span><span class="ffd">y</span></span></div><div class="t m0 x174 ha y6a3 ff12 fs7 fc0 sc0 ls0 ws0">(<span class="ffc">n</span>)</div><div class="t m0 xb1 h6 y588 ffe fs2 fc0 sc0 ls0 ws0">∈<span class="_ _25"> </span>{−<span class="fff">1<span class="ffd">,<span class="_ _31"> </span></span>1</span>}<span class="ff3">,<span class="_ _e"> </span><span class="ff1">那么<span class="_ _23"></span>存在一个正的常<span class="_ _23"></span>数<span class="_ _d"> </span><span class="ffd">γ<span class="_ _51"></span><span class="fff">(</span>γ<span class="_ _e"> </span>&gt;<span class="_ _25"> </span><span class="fff">0)<span class="_ _e"> </span></span></span>和权<span class="_ _23"></span>重向量<span class="_ _d"> </span><span class="ff10">w</span></span></span></div><div class="t m0 x15e ha y6a3 ffb fs7 fc0 sc0 ls0 ws0">∗</div><div class="t m0 x102 h6 y588 ffd fs2 fc0 sc0 ls0 ws0">,<span class="_ _e"> </span><span class="ff1">并且<span class="_ _e"> </span><span class="ffe">∥<span class="ff10">w</span></span></span></div><div class="t m0 x17b ha y6a3 ffb fs7 fc0 sc0 ls0 ws0">∗</div><div class="t m0 x131 h6 y588 ffe fs2 fc0 sc0 ls0 ws0">∥<span class="_ _25"> </span><span class="fff">=<span class="_ _d"> </span>1<span class="ffd">,<span class="_ _e"> </span><span class="ff1">对所有<span class="_ _e"> </span></span>n</span></span></div><div class="t m0 x3 h6 y6a4 ff1 fs2 fc0 sc0 ls0 ws0">都满足<span class="_ _d"> </span><span class="fff">(<span class="ff10">w</span></span></div><div class="t m0 x10b ha y6a5 ffb fs7 fc0 sc0 ls0 ws0">∗</div><div class="t m0 x176 h4 y6a4 fff fs2 fc0 sc0 ls0 ws0">)</div><div class="t m0 xf1 ha y6a6 ffb fs7 fc0 sc0 ls0 ws0">⊤</div><div class="t m0 xdc hc y6a7 ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x3b he y6a4 ffd fs2 fc0 sc0 ls0 ws0">y</div><div class="t m0 xdd ha y6a5 ff12 fs7 fc0 sc0 ls0 ws0">(<span class="ffc">n</span>)</div><div class="t m0 x89 hf y6a4 ff10 fs2 fc0 sc0 ls0 ws0">x</div><div class="t m0 xdb ha y6a5 ff12 fs7 fc0 sc0 ls0 ws0">(<span class="ffc">n</span>)</div><div class="t m0 x12f hc y6a7 ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x49 h6 y6a4 ffe fs2 fc0 sc0 ls0 ws0">≥<span class="_ _32"> </span><span class="ffd">γ<span class="_ _23"></span>.<span class="_ _d"> </span><span class="ff1">我们可以证明如下定理<span class="ff3">.</span></span></span></div><div class="t m0 x174 h41 y6a8 ff27 fs2 fcb sc0 ls0 ws0">定理<span class="_ _e"> </span><span class="ff28">10.1.<span class="_ _e"> </span></span>感知器收敛性</div><div class="t m0 x17c h6 y6a9 ff1 fs2 fc0 sc0 ls0 ws0">给定训练集<span class="_ _d"> </span><span class="ffe">D<span class="_ _25"> </span><span class="fff">=</span></span></div><div class="t m0 x159 hc y6aa ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x2e hf y6a9 ff10 fs2 fc0 sc0 ls0 ws0">x</div><div class="t m0 xe6 ha y6ab ff12 fs7 fc0 sc0 ls0 ws0">(<span class="ffc">n</span>)</div><div class="t m0 x152 he y6a9 ffd fs2 fc0 sc0 ls0 ws0">,<span class="_ _31"> </span>y</div><div class="t m0 x40 ha y6ab ff12 fs7 fc0 sc0 ls0 ws0">(<span class="ffc">n</span>)</div><div class="t m0 x93 hc y6aa ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x4e hb y6ac ffc fs7 fc0 sc0 ls0 ws0">N</div><div class="t m0 x4e ha y6ad ffc fs7 fc0 sc0 ls0 ws0">n<span class="ff12">=1</span></div><div class="t m0 x157 h6 y6a9 ffd fs2 fc0 sc0 ls0 ws0">,<span class="_ _d"> </span><span class="ff1">令<span class="_ _d"> </span></span>R<span class="_ _d"> </span><span class="ff1">是训练集中最大的特征向量的模，即</span></div><div class="t m0 x32 h4 y6ae ffd fs2 fc0 sc0 ls0 ws0">R<span class="_ _32"> </span><span class="fff">=<span class="_ _32"> </span><span class="ff3">max</span></span></div><div class="t m0 x53 hb y6af ffc fs7 fc0 sc0 ls0 ws0">n</div><div class="t m0 x12a hc y6b0 ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x12a hc y6b1 ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x12a hc y6b2 ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x128 he y6ae ffd fs2 fc0 sc0 ls0 ws0">x</div><div class="t m0 x2a ha y6b3 ff12 fs7 fc0 sc0 ls0 ws0">(<span class="ffc">n</span>)</div><div class="t m0 x197 hc y6b0 ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x197 hc y6b1 ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x197 hc y6b2 ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x17c h6 y6b4 ff1 fs2 fc0 sc0 ls0 ws0">如果训练集<span class="_ _d"> </span><span class="ff3">D<span class="_ _d"> </span></span>线性可分，两类感知器的参数学习算法<span class="_ _d"> </span><span class="ff3">3.1<span class="_ _d"> </span></span>的权重更新次数不超过</div><div class="t m0 x84 hb y6b5 ffc fs7 fc0 sc0 ls0 ws0">R</div><div class="t m0 x17d h1c y6b6 ff16 fs9 fc0 sc0 ls0 ws0">2</div><div class="t m0 x17e hb y6b7 ffc fs7 fc0 sc0 ls0 ws0">γ</div><div class="t m0 x1c h1c y6b8 ff16 fs9 fc0 sc0 ls0 ws0">2</div><div class="t m0 x3 h6 y6b9 ff1 fs2 fc0 sc0 ls0 ws0">详细的证明过程参考邱锡鹏的《神经网络与深度学习》第<span class="_ _d"> </span><span class="ff3">3.4.2<span class="_ _d"> </span></span>节（感知器的收敛性）<span class="_ _26"></span>。</div><div class="t m0 xf h9 y6ba ff5 fs6 fc0 sc0 ls0 ws0">10.4<span class="_ _24"> </span><span class="ff9">感知机的缺陷</span></div><div class="t m0 x3 h6 y6bb ff1 fs2 fc0 sc0 ls0 ws0">虽然感知器在线性可分的数据上可以保证收敛，但其存在以下不足：</div><div class="t m0 x14 h6 y6bc ff1 fs2 fc0 sc0 ls0 ws0">（<span class="ff3">1</span>）<span class="_ _30"></span>在数据集线性可分时，<span class="_ _30"></span>感知器虽然可以找到一个超平面把两类数据分开，<span class="_ _29"></span>但并不能保证其泛</div><div class="t m0 x3 h6 y6bd ff1 fs2 fc0 sc0 ls0 ws0">化能力。</div><div class="t m0 x14 h6 y6be ff1 fs2 fc0 sc0 ls0 ws0">（<span class="ff3">2</span>）感知器对样本顺序比较敏感．每次迭代的顺序不一致时，找到的分割超平面也往往不一致。</div><div class="t m0 x14 h6 y6bf ff1 fs2 fc0 sc0 ls0 ws0">（<span class="ff3">3</span>）如果训练集不是线性可分的，就永远不会收敛。</div><div class="t m0 xbc h4 y3 ff3 fs2 fc0 sc0 ls0 ws0">65</div><a class="l" href="https://ff120.github.io/2017/05/19/机器学习专题/机器学习_感知机/"><div class="d m1" style="border-style:none;position:absolute;left:625.855500px;bottom:1157.547000px;width:113.240000px;height:15.459000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.500000,0.000000,0.000000,1.500000,0.000000,0.000000]}'></div></div>
<div id="pf48" class="pf w0 h0" data-page-no="48"><div class="pc pc48 w0 h0"><div class="t m0 x3 h7 y21 ff3 fs5 fc0 sc0 ls0 ws0">10.4<span class="_ _8"> </span><span class="ff7">感知机的缺陷</span></div><div class="t m0 x3 h4 y3 ff3 fs2 fc0 sc0 ls0 ws0">66</div></div><div class="pi" data-data='{"ctm":[1.500000,0.000000,0.000000,1.500000,0.000000,0.000000]}'></div></div>
<div id="pf49" class="pf w0 h0" data-page-no="49"><div class="pc pc49 w0 h0"><img class="bi xdc y961 w16 h4c" alt="" src="bg49.png"/><div class="t m0 x195 h5 y4 ff4 fs3 fc0 sc0 ls0 ws0">第十一章 <span class="ff5">Recurren<span class="_ _28"></span>t<span class="_ _9"> </span>Neural<span class="_ _17"> </span>Net<span class="_ _28"></span>w<span class="_ _28"></span>orks</span></div><div class="t m0 x159 h4d y962 ff5 fs6 fc0 sc0 ls0 ws0">11.1<span class="_ _24"> </span>Simple<span class="_ _18"> </span>Recurren<span class="_ _12"></span>t<span class="_ _18"> </span>Net<span class="_ _28"></span>w<span class="_ _12"></span>ork</div><div class="t m0 x3 hd y963 ff5 fs8 fc0 sc0 ls0 ws0">11.1.1<span class="_ _36"> </span><span class="ff9">前向传播</span></div><div class="t m0 x3 h6 y964 ff1 fs2 fc0 sc0 ls0 ws0">我们熟悉的神经网络可能是这样的：</div><div class="c xdc y965 w17 h4e"><div class="t m0 x1ae h4f y966 ff2b fsd fc0 sc0 ls0 ws0">input</div><div class="t m0 x1ae h4f y967 ff2b fsd fc0 sc0 ls0 ws0">layer</div></div><div class="c x13b y968 w18 h50"><div class="t m0 x1af h51 y969 ff2c fse fc0 sc0 ls0 ws0">input→hidden</div></div><div class="c xdc y965 w17 h4e"><div class="t m0 x143 h4f y966 ff2b fsd fc0 sc0 ls0 ws0">hidden</div><div class="t m0 x15 h4f y967 ff2b fsd fc0 sc0 ls0 ws0">layer</div><div class="t m0 x92 h4f y966 ff2b fsd fc0 sc0 ls0 ws0">output</div><div class="t m0 x54 h4f y967 ff2b fsd fc0 sc0 ls0 ws0">layer</div></div><div class="c x13b y96a w19 h52"><div class="t m0 x1af h51 y96b ff2c fse fc0 sc0 ls0 ws0">hidden→output</div></div><div class="c x13b y96c w1a h53"><div class="t m0 x1af h54 y96d ff2d fsf fc0 sc0 ls0 ws0">Description</div><div class="t m0 x1af h55 y96e ff2e fs10 fc0 sc0 ls0 ws0">Uistheweightmatrixfromthe</div><div class="t m0 x1af h55 y96f ff2e fs10 fc0 sc0 ls0 ws0">inputlayertothehiddenlayer</div><div class="t m0 x1af h55 y970 ff2e fs10 fc0 sc0 ls0 ws0">Vistheweightmatrixfromthe</div><div class="t m0 x1af h55 y971 ff2e fs10 fc0 sc0 ls0 ws0">hiddenlayertotheoutputlayer</div></div><div class="t m0 x2 h6 y972 ff1 fs2 fc0 sc0 ls0 ws0">图<span class="_ _d"> </span><span class="ff3">11.1:<span class="_ _35"> </span></span>三层神经网络示意图</div><div class="t m0 x3 h6 y973 ff1 fs2 fc0 sc0 ls0 ws0">这是一个简单的多层神经网络。它的<span class="_ _23"></span>输入维度是<span class="_ _d"> </span><span class="ff3">5</span>，输出维度是<span class="_ _d"> </span><span class="ff3">2</span>，隐藏层的维度是<span class="_ _e"> </span><span class="ff3">3</span>。用数学</div><div class="t m0 x3 h6 y974 ff1 fs2 fc0 sc0 ls0 ws0">公式表示：</div><div class="t m0 xf h4 y975 ffd fs2 fc0 sc0 ls0 ws0">f<span class="_ _34"></span><span class="fff">(<span class="ff10">U</span></span></div><div class="t m0 x111 ha y976 ff12 fs7 fc0 sc0 ls0 ws0">3<span class="ffb">×</span>5</div><div class="t m0 x4f hf y975 ff10 fs2 fc0 sc0 ls0 ws0">X</div><div class="t m0 x166 ha y976 ff12 fs7 fc0 sc0 ls0 ws0">5<span class="ffb">×</span>1</div><div class="t m0 x65 h4 y975 fff fs2 fc0 sc0 ls0 ws0">+<span class="_ _37"> </span><span class="ff10">B</span></div><div class="t m0 x13e ha y976 ff12 fs7 fc0 sc0 ls0 ws0">3<span class="ffb">×</span>1</div><div class="t m0 x1a7 h4 y975 fff fs2 fc0 sc0 ls0 ws0">)<span class="_ _32"> </span>=<span class="_ _32"> </span><span class="ff10">H</span></div><div class="t m0 x7a ha y976 ff12 fs7 fc0 sc0 ls0 ws0">3<span class="ffb">×</span>1</div><div class="t m0 x160 h4 y975 ff3 fs2 fc0 sc0 ls0 ws0">1</div><div class="t m0 x3 h6 y977 ff1 fs2 fc0 sc0 ls0 ws0">其中，<span class="ffd">f<span class="_ _3f"> </span></span>是隐藏层的<span class="_ _23"></span>激活函数，<span class="ff10">U<span class="_ _3f"> </span></span>是隐藏层的权重<span class="_ _23"></span>矩阵，<span class="ff10">B<span class="_ _e"> </span></span>是隐<span class="_ _23"></span>藏层的偏置向量，当然以下两</div><div class="t m0 x3 h6 y978 ff1 fs2 fc0 sc0 ls0 ws0">种写法在数学上也是等价的：</div><div class="t m0 xf h4 y979 ffd fs2 fc0 sc0 ls0 ws0">f<span class="_ _34"></span><span class="fff">(<span class="ff10">U</span></span></div><div class="t m0 x11 hb y97a ffc fs7 fc0 sc0 ls0 ws0">T</div><div class="t m0 x111 ha y97b ff12 fs7 fc0 sc0 ls0 ws0">5<span class="ffb">×</span>3</div><div class="t m0 x4f hf y979 ff10 fs2 fc0 sc0 ls0 ws0">X</div><div class="t m0 x166 ha y97c ff12 fs7 fc0 sc0 ls0 ws0">5<span class="ffb">×</span>1</div><div class="t m0 x65 h4 y979 fff fs2 fc0 sc0 ls0 ws0">+<span class="_ _37"> </span><span class="ff10">B</span></div><div class="t m0 x13e ha y97c ff12 fs7 fc0 sc0 ls0 ws0">3<span class="ffb">×</span>1</div><div class="t m0 x1a7 h4 y979 fff fs2 fc0 sc0 ls0 ws0">)<span class="_ _32"> </span>=<span class="_ _32"> </span><span class="ff10">H</span></div><div class="t m0 x7a ha y97c ff12 fs7 fc0 sc0 ls0 ws0">3<span class="ffb">×</span>1</div><div class="t m0 x160 h4 y979 ff3 fs2 fc0 sc0 ls0 ws0">2</div><div class="t m0 xf h4 y97d ffd fs2 fc0 sc0 ls0 ws0">f<span class="_ _34"></span><span class="fff">(<span class="ff10">X</span></span></div><div class="t m0 x11 ha y97e ff12 fs7 fc0 sc0 ls0 ws0">1<span class="ffb">×</span>5</div><div class="t m0 x52 hf y97d ff10 fs2 fc0 sc0 ls0 ws0">U</div><div class="t m0 x166 ha y97e ff12 fs7 fc0 sc0 ls0 ws0">5<span class="ffb">×</span>3</div><div class="t m0 x65 h4 y97d fff fs2 fc0 sc0 ls0 ws0">+<span class="_ _37"> </span><span class="ff10">B</span></div><div class="t m0 x13e ha y97e ff12 fs7 fc0 sc0 ls0 ws0">1<span class="ffb">×</span>3</div><div class="t m0 x1a7 h4 y97d fff fs2 fc0 sc0 ls0 ws0">)<span class="_ _32"> </span>=<span class="_ _32"> </span><span class="ff10">H</span></div><div class="t m0 x7a ha y97e ff12 fs7 fc0 sc0 ls0 ws0">1<span class="ffb">×</span>3</div><div class="t m0 x160 h4 y97f ff3 fs2 fc0 sc0 ls0 ws0">3</div><div class="t m0 x3 h6 y980 ff1 fs2 fc0 sc0 ls0 ws0">一般在<span class="_ _23"></span>机器学习<span class="_ _23"></span>的书籍中<span class="_ _23"></span>惯用的写法<span class="_ _23"></span>是<span class="_ _25"> </span><span class="ff3">2<span class="_ _25"> </span></span>。在<span class="_ _23"></span>这里遵循<span class="_ _23"></span>惯例，沿用<span class="_ _25"> </span><span class="ff3">2<span class="_ _d"> </span></span>的写法。<span class="_ _23"></span>那么，从隐<span class="_ _23"></span>藏层</div><div class="t m0 x3 h6 y981 ff1 fs2 fc0 sc0 ls0 ws0">到输出层则表示为：</div><div class="t m0 x2 h4 y982 ffd fs2 fc0 sc0 ls0 ws0">g<span class="_ _23"></span><span class="fff">(<span class="ff10">V</span></span></div><div class="t m0 xf3 hb y983 ffc fs7 fc0 sc0 ls0 ws0">T</div><div class="t m0 x111 ha y984 ff12 fs7 fc0 sc0 ls0 ws0">3<span class="ffb">×</span>2</div><div class="t m0 x4f hf y982 ff10 fs2 fc0 sc0 ls0 ws0">H</div><div class="t m0 x166 ha y985 ff12 fs7 fc0 sc0 ls0 ws0">3<span class="ffb">×</span>1</div><div class="t m0 x97 h4 y982 fff fs2 fc0 sc0 ls0 ws0">+<span class="_ _37"> </span><span class="ff10">C</span></div><div class="t m0 x5f ha y985 ff12 fs7 fc0 sc0 ls0 ws0">2<span class="ffb">×</span>1</div><div class="t m0 x21 h4 y982 fff fs2 fc0 sc0 ls0 ws0">)<span class="_ _32"> </span>=<span class="_ _32"> </span><span class="ff10">O</span></div><div class="t m0 xea ha y985 ff12 fs7 fc0 sc0 ls0 ws0">2<span class="ffb">×</span>1</div><div class="t m0 x3 h6 y986 ff1 fs2 fc0 sc0 ls0 ws0">数据在这样的网络中流动<span class="_ _29"></span>（向前传播）<span class="_ _30"></span>的过程是很容易理解和想象的，<span class="_ _3a"></span>如果将每一层用一个单元</div><div class="t m0 x3 h6 y987 ff1 fs2 fc0 sc0 ls0 ws0">来表示，可以有更简洁的图例：</div><div class="c x89 y988 w1b h56"><div class="t m0 x1b0 h57 y989 ff2f fs11 fc0 sc0 ls0 ws0">X<span class="_ _5b"> </span>H<span class="_ _5c"> </span>O</div><div class="t m0 x1b1 h58 y98a ff30 fs12 fc0 sc0 ls0 ws0">U<span class="_ _5d"> </span>V</div><div class="t m0 x6c h57 y989 ff2f fs11 fc0 sc0 ls0 ws0">L<span class="_ _5e"> </span>Y</div></div><div class="t m0 x1b2 h6 y98b ff1 fs2 fc0 sc0 ls0 ws0">图<span class="_ _d"> </span><span class="ff3">11.2:<span class="_ _35"> </span></span>三层神经网络简要示意图（包括反向传播过程）</div><div class="t m0 xc3 h4 y3 ff3 fs2 fc0 sc0 ls0 ws0">67</div></div><div class="pi" data-data='{"ctm":[1.500000,0.000000,0.000000,1.500000,0.000000,0.000000]}'></div></div>
<div id="pf4a" class="pf w0 h0" data-page-no="4a"><div class="pc pc4a w0 h0"><img class="bi x82 y98c w1c h59" alt="" src="bg4a.png"/><div class="t m0 x3 h29 y21 ff3 fs5 fc0 sc0 ls0 ws0">11.1<span class="_ _8"> </span>SIMPLE<span class="_ _32"> </span>RECURRENT<span class="_ _25"> </span>NETWORK</div><div class="t m0 x3 h6 y22 ff1 fs2 fc0 sc0 ls0 ws0">如果加上<span class="_ _d"> </span><span class="ff3">batc<span class="_ _12"></span>h<span class="_ _d"> </span>size<span class="_ _d"> </span><span class="ff1">的话，是这个样子的：</span></span></div><div class="c x82 y98d w1d h5a"><div class="t m0 x1b3 h5b y98e ff31 fs13 fcc sc0 ls0 ws0">X<span class="_ _5f"> </span>H<span class="_ _60"> </span>O</div><div class="t m0 x1b4 h5c y98f ff32 fs14 fcc sc0 ls0 ws0">U<span class="_ _61"> </span>V</div><div class="t m0 x14a h5b y98e ff31 fs13 fcc sc0 ls0 ws0">Y<span class="_ _62"></span>X<span class="_ _5f"> </span>H<span class="_ _60"> </span>O</div><div class="t m0 x1b4 h5c y98f ff32 fs14 fcc sc0 ls0 ws0">U<span class="_ _61"> </span>V</div><div class="t m0 x14a h5b y98e ff31 fs13 fcc sc0 ls0 ws0">Y</div><div class="t m0 x1b5 h5b y990 ff31 fs13 fcc sc0 ls0 ws0">X<span class="_ _5f"> </span>H<span class="_ _60"> </span>O</div><div class="t m0 x3 h5c y991 ff32 fs14 fcc sc0 ls0 ws0">U<span class="_ _61"> </span>V</div><div class="t m0 x21 h5b y990 ff31 fs13 fcc sc0 ls0 ws0">Y<span class="_ _62"></span>X<span class="_ _5f"> </span>H<span class="_ _60"> </span>O</div><div class="t m0 x3 h5c y991 ff32 fs14 fcc sc0 ls0 ws0">U<span class="_ _61"> </span>V</div><div class="t m0 x21 h5b y990 ff31 fs13 fcc sc0 ls0 ws0">Y</div><div class="t m0 x1b6 h5b y992 ff31 fs13 fcc sc0 ls0 ws0">X<span class="_ _5f"> </span>H<span class="_ _60"> </span>O</div><div class="t m0 x1b7 h5c y993 ff32 fs14 fcc sc0 ls0 ws0">U<span class="_ _61"> </span>V</div><div class="t m0 x13b h5b y992 ff31 fs13 fcc sc0 ls0 ws0">Y<span class="_ _62"></span>X<span class="_ _5f"> </span>H<span class="_ _60"> </span>O</div><div class="t m0 x1b7 h5c y993 ff32 fs14 fcc sc0 ls0 ws0">U<span class="_ _61"> </span>V</div><div class="t m0 x13b h5b y992 ff31 fs13 fcc sc0 ls0 ws0">Y</div><div class="t m0 x1b1 h5b y994 ff31 fs13 fcc sc0 ls0 ws0">X<span class="_ _5f"> </span>H<span class="_ _60"> </span>O</div><div class="t m0 x1b8 h5c y995 ff32 fs14 fcc sc0 ls0 ws0">U<span class="_ _61"> </span>V</div><div class="t m0 x66 h5b y994 ff31 fs13 fcc sc0 ls0 ws0">Y<span class="_ _62"></span>X<span class="_ _5f"> </span>H<span class="_ _60"> </span>O</div><div class="t m0 x1b8 h5c y995 ff32 fs14 fcc sc0 ls0 ws0">U<span class="_ _61"> </span>V</div><div class="t m0 x66 h5b y994 ff31 fs13 fcc sc0 ls0 ws0">Y</div><div class="t m0 x1b9 h5b y996 ff31 fs13 fc0 sc0 ls0 ws0">X<span class="_ _5f"> </span>H<span class="_ _60"> </span>O</div><div class="t m0 x15 h5c y997 ff32 fs14 fc0 sc0 ls0 ws0">U<span class="_ _61"> </span>V</div><div class="t m0 xab h5b y996 ff31 fs13 fc0 sc0 ls0 ws0">Y</div><div class="t m0 x94 h5b y992 ff31 fs13 fc0 sc0 ls0 ws0">L</div><div class="t m2 x1ae h5d y998 ff33 fs15 fc0 sc0 ls0 ws0">batchsize=5</div></div><div class="t m0 x118 h6 y999 ff1 fs2 fc0 sc0 ls0 ws0">图<span class="_ _d"> </span><span class="ff3">11.3:<span class="_ _35"> </span></span>三层神经网络简要示意图<span class="_ _d"> </span><span class="ff3">(batch<span class="_ _25"> </span>size)</span></div><div class="t m0 x3 h6 y99a ff1 fs2 fc0 sc0 ls0 ws0">与<span class="_ _a"> </span><span class="ff3">DNN </span>不同，<span class="_ _2b"></span><span class="ff3">Simple RNN <span class="ff1">是包含循环结构的网络，<span class="_ _2b"></span>几乎没有平面图能很好地展示<span class="_ _a"> </span><span class="ff3">Simple RNN</span></span></span></div><div class="t m0 x3 h6 y99b ff1 fs2 fc0 sc0 ls0 ws0">的循环过程，但我尝试画了一张示意图：</div><div class="t m0 x9 h6 y99c ff1 fs2 fc0 sc0 ls0 ws0">图<span class="_ _d"> </span><span class="ff3">11.4:<span class="_ _35"> </span>Simple<span class="_ _d"> </span>RNN<span class="_ _d"> </span></span>展开示意图</div><div class="t m0 x3 h6 y99d ff1 fs2 fc0 sc0 ls0 ws0">图中，<span class="_ _23"></span>正方形<span class="_ _23"></span>单元<span class="_ _23"></span>存在激<span class="_ _23"></span>活函数，<span class="_ _23"></span>而圆<span class="_ _23"></span>形单元<span class="_ _23"></span>则没<span class="_ _23"></span>有激活<span class="_ _23"></span>函数，因<span class="_ _23"></span>此，圆<span class="_ _23"></span>形单元<span class="_ _23"></span>会将输<span class="_ _23"></span>入值<span class="_ _23"></span>直</div><div class="t m0 x3 h6 y99e ff1 fs2 fc0 sc0 ls0 ws0">接输出，<span class="_ _23"></span>不会对输入<span class="_ _23"></span>的数值作改动。<span class="_ _23"></span>在同一层中，<span class="_ _23"></span>实线和虚线<span class="_ _23"></span>代表着不同<span class="_ _23"></span>的权重矩阵。<span class="_ _23"></span>实际上，</div><div class="t m0 x3 h6 y99f ff1 fs2 fc0 sc0 ls0 ws0">图<span class="ff3">11.4</span>的输入数据只有一个时间步<span class="_ _28"></span>（<span class="ff3">time<span class="_ _d"> </span>step</span>）<span class="_ _26"></span>，<span class="_ _28"></span>这并没有发挥<span class="_ _25"> </span><span class="ff3">RNN<span class="_ _d"> </span></span>的长处。<span class="_ _28"></span><span class="ff3">RNN<span class="_ _d"> </span><span class="ff1">处理的数据</span></span></div><div class="t m0 x3 h6 y9a0 ff1 fs2 fc0 sc0 ls0 ws0">应该是序列数据，并且具有多个时间步，如图<span class="ff3">11.5</span>：</div><div class="t m0 x3 h4 y3 ff3 fs2 fc0 sc0 ls0 ws0">68</div><div class="c x88 y9a1 w1e h5e"><div class="t m0 x192 h5f y9a2 ff34 fs16 fc0 sc0 ls0 ws0">A</div></div><div class="c x167 y9a3 w1f h60"><div class="t m0 x1af h61 y9a4 ff35 fs17 fc0 sc0 ls0 ws0">Description</div><div class="t m0 x1af h62 y9a5 ff36 fs18 fc0 sc0 ls0 ws0">Round units have no activation</div><div class="t m0 x1af h62 y9a6 ff36 fs18 fc0 sc0 ls0 ws0">functions.</div><div class="t m0 x1af h62 y9a7 ff36 fs18 fc0 sc0 ls0 ws0">Square units have activation</div><div class="t m0 x1af h62 y9a8 ff36 fs18 fc0 sc0 ls0 ws0">function.</div><div class="t m0 x1af h63 y9a9 ff37 fs18 fc0 sc0 ls0 ws0">Wistherecurrentweightmatrixof</div><div class="t m0 x1af h63 y9aa ff37 fs18 fc0 sc0 ls0 ws0">thehiddenlayer<span class="_ _12"></span>.</div></div><div class="c x140 y9ab w20 h64"><div class="t m0 x1af h65 y9ac ff38 fs19 fc0 sc0 ls0 ws0">a sample</div><div class="t m0 x1af h65 y9ad ff38 fs19 fc0 sc0 ls0 ws0">input <span class="ff39">→</span> hidden</div><div class="t m0 x1af h65 y9ae ff38 fs19 fc0 sc0 ls0 ws0">hidden <span class="ff39">→</span> output</div></div><div class="c x88 y9a1 w1e h5e"><div class="t m0 x1ba h66 y9af ff3a fs1a fc0 sc0 ls0 ws0">3timesteps</div></div><div class="t m0 x10 h6 y9b0 ff1 fs2 fc0 sc0 ls0 ws0">图<span class="_ _d"> </span><span class="ff3">11.5:<span class="_ _35"> </span>Simple<span class="_ _d"> </span>RNN<span class="_ _d"> </span></span>展开示意图</div><a class="l" href="#pf4a" data-dest-detail='[74,"XYZ",70.87,610.9,null]'><div class="d m1" style="border-style:none;position:absolute;left:122.662500px;bottom:497.014500px;width:19.397000px;height:15.459000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf4a" data-dest-detail='[74,"XYZ",277.98,73.95,null]'><div class="d m1" style="border-style:none;position:absolute;left:433.572000px;bottom:476.691000px;width:19.396000px;height:15.458000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.500000,0.000000,0.000000,1.500000,0.000000,0.000000]}'></div></div>
<div id="pf4b" class="pf w0 h0" data-page-no="4b"><div class="pc pc4b w0 h0"><img class="bi x3 y9b1 w1 h67" alt="" src="bg4b.png"/><div class="t m0 x37 h29 y21 ff3 fs5 fc0 sc0 ls0 ws0">11.1<span class="_ _8"> </span>SIMPLE<span class="_ _32"> </span>RECURRENT<span class="_ _25"> </span>NETWORK</div><div class="t m0 x3 h6 y22 ff1 fs2 fc0 sc0 ls0 ws0">图<span class="ff3">11.5</span>中展示<span class="_ _23"></span>的样本数<span class="_ _23"></span>据有<span class="_ _e"> </span><span class="ff3">3<span class="_ _e"> </span></span>个时<span class="_ _23"></span>间步，每一<span class="_ _23"></span>个时间步<span class="_ _23"></span>的数据都是<span class="_ _1e"> </span><span class="ff3">5<span class="_ _e"> </span></span>维的，<span class="_ _23"></span>也就是说<span class="_ _23"></span>这个样本</div><div class="t m0 x3 h6 y17d ff1 fs2 fc0 sc0 ls0 ws0">是这样的：</div><div class="c x41 y9b2 w21 h68"><div class="t m0 x161 h69 y9b3 ff3b fs1b fc0 sc0 ls0 ws0">3 time steps</div><div class="t m0 x1bb h69 y9b4 ff3b fs1b fc0 sc0 ls0 ws0">dimensions per time step</div></div><div class="t m0 x3 h6 y9b5 ff1 fs2 fc0 sc0 ls0 ws0">各个样本时间步数可能不一样，<span class="_ _29"></span>一般而言，<span class="_ _29"></span>在数据预处理时，<span class="_ _29"></span>我们会将所有样本的时间步处理成</div><div class="t m0 x3 h6 y9b6 ff1 fs2 fc0 sc0 ls0 ws0">等长的。从图<span class="ff3">11.5</span>可<span class="_ _23"></span>以看出隐藏层<span class="_ _e"> </span><span class="ff10">H</span></div><div class="t m0 xf3 h21 y9b7 ff10 fs7 fc0 sc0 ls0 ws0">t</div><div class="t m0 x2f h6 y9b6 ff1 fs2 fc0 sc0 ls0 ws0">不仅由<span class="_ _e"> </span><span class="ff10">x</span></div><div class="t m0 x101 h21 y9b7 ff10 fs7 fc0 sc0 ls0 ws0">t</div><div class="t m0 xaa h6 y9b6 ff1 fs2 fc0 sc0 ls0 ws0">决定，也受到<span class="_ _e"> </span><span class="ff10">H</span></div><div class="t m0 x16a ha y9b7 ff10 fs7 fc0 sc0 ls0 ws0">t<span class="ff26">−<span class="ff24">1</span></span></div><div class="t m0 x6b h6 y9b6 ff1 fs2 fc0 sc0 ls0 ws0">的影响（<span class="ffd">t<span class="_ _e"> </span></span>代表第<span class="_ _e"> </span><span class="ffd">t<span class="_ _e"> </span></span>个时</div><div class="t m0 x3 h6 y9b8 ff1 fs2 fc0 sc0 ls0 ws0">间步）<span class="_ _26"></span>，<span class="_ _27"></span>这是<span class="_ _d"> </span><span class="ff3">RNN<span class="_ _25"> </span></span>和<span class="_ _d"> </span><span class="ff3">DNN<span class="_ _25"> </span></span>的不同点，<span class="_ _27"></span>也正是<span class="_ _d"> </span><span class="ff3">RNN<span class="_ _25"> </span></span>循环思想的体现。<span class="_ _28"></span>而<span class="_ _25"> </span><span class="ff3">RNN<span class="_ _d"> </span></span>的输出层<span class="_ _25"> </span><span class="ff10">O</span></div><div class="t m0 x141 h21 y9b9 ff10 fs7 fc0 sc0 ls0 ws0">t</div><div class="t m0 xbc h6 y9b8 ff1 fs2 fc0 sc0 ls0 ws0">只</div><div class="t m0 x3 h6 y9ba ff1 fs2 fc0 sc0 ls0 ws0">由当前时间步的隐藏层<span class="_ _d"> </span><span class="ff10">H</span></div><div class="t m0 x83 h21 y9bb ff10 fs7 fc0 sc0 ls0 ws0">t</div><div class="t m0 xba h6 y9ba ff1 fs2 fc0 sc0 ls0 ws0">决定，这点和<span class="_ _d"> </span><span class="ff3">DNN<span class="_ _d"> </span></span>是一样的。</div><div class="t m0 x3 h6 y9bc ff1 fs2 fc0 sc0 ls0 ws0">对于任意<span class="_ _d"> </span><span class="ffd">t<span class="_ _d"> </span></span>时刻，从输入层到隐藏层，用数学公式表示如下：</div><div class="t m0 x10 h4 y9bd ffd fs2 fc0 sc0 ls0 ws0">f<span class="_ _34"></span><span class="fff">(<span class="ff10">U</span></span></div><div class="t m0 xe hb y9be ffc fs7 fc0 sc0 ls0 ws0">T</div><div class="t m0 x80 h4 y9bd ff10 fs2 fc0 sc0 ls0 ws0">X<span class="_ _32"> </span><span class="fff">+<span class="_ _37"> </span></span>W<span class="_ _31"> </span>H</div><div class="t m0 xd4 ha y9bf ff10 fs7 fc0 sc0 ls0 ws0">t<span class="ff26">−<span class="ff24">1</span></span></div><div class="t m0 x99 h4 y9bd fff fs2 fc0 sc0 ls0 ws0">+<span class="_ _37"> </span><span class="ff10">B<span class="_ _23"></span></span>)<span class="_ _32"> </span>=<span class="_ _32"> </span><span class="ff10">H</span></div><div class="t m0 x179 hb y9bf ffc fs7 fc0 sc0 ls0 ws0">t</div><div class="t m0 x3f h4 y9c0 ffd fs2 fc0 sc0 ls0 ws0">f<span class="_ _34"></span><span class="fff">(<span class="ff1e">□</span></span></div><div class="t m0 x17a hb y9c1 ffc fs7 fc0 sc0 ls0 ws0">T</div><div class="t m0 x17a ha y9c2 ff12 fs7 fc0 sc0 ls0 ws0">5<span class="ffb">×</span>3</div><div class="t m0 x5a h6a y9c0 ff1e fs2 fc0 sc0 ls0 ws0">□</div><div class="t m0 x73 ha y9c3 ff12 fs7 fc0 sc0 ls0 ws0">5<span class="ffb">×</span>1</div><div class="t m0 x16 h4 y9c0 fff fs2 fc0 sc0 ls0 ws0">+<span class="_ _37"> </span><span class="ff1e">□</span></div><div class="t m0 xbd ha y9c3 ff12 fs7 fc0 sc0 ls0 ws0">3<span class="ffb">×</span>3</div><div class="t m0 x6f h6a y9c0 ff1e fs2 fc0 sc0 ls0 ws0">□</div><div class="t m0 x2b ha y9c3 ff12 fs7 fc0 sc0 ls0 ws0">3<span class="ffb">×</span>1</div><div class="t m0 x14a h4 y9c0 fff fs2 fc0 sc0 ls0 ws0">+<span class="_ _37"> </span><span class="ff1e">□</span></div><div class="t m0 x25 ha y9c3 ff12 fs7 fc0 sc0 ls0 ws0">3<span class="ffb">×</span>1</div><div class="t m0 xa0 h4 y9c0 fff fs2 fc0 sc0 ls0 ws0">=<span class="_ _32"> </span><span class="ff1e">□</span></div><div class="t m0 xf6 ha y9c3 ff12 fs7 fc0 sc0 ls0 ws0">3<span class="ffb">×</span>1</div><div class="t m0 x125 h4 y9c0 fff fs2 fc0 sc0 ls0 ws0">)</div><div class="t m0 x3 h6 y9c4 ff1 fs2 fc0 sc0 ls0 ws0">其中，<span class="_ _27"></span><span class="ff10">U<span class="_ _35"> </span><span class="ff1">是输入层到隐藏层的权重矩阵，<span class="_ _28"></span><span class="ff10">W<span class="_ _3f"> </span><span class="ff1">是隐藏层的循环权重矩阵。<span class="_ _28"></span>隐藏层到输出层的公式</span></span></span></span></div><div class="t m0 x3 h6 y9c5 ff1 fs2 fc0 sc0 ls0 ws0">为：</div><div class="t m0 x32 h4 y9c6 ffd fs2 fc0 sc0 ls0 ws0">g<span class="_ _23"></span><span class="fff">(<span class="ff10">V</span></span></div><div class="t m0 xc2 hb y9c7 ffc fs7 fc0 sc0 ls0 ws0">T</div><div class="t m0 x123 hf y9c6 ff10 fs2 fc0 sc0 ls0 ws0">H</div><div class="t m0 x81 h21 y9c8 ff10 fs7 fc0 sc0 ls0 ws0">t</div><div class="t m0 x18a h4 y9c6 fff fs2 fc0 sc0 ls0 ws0">+<span class="_ _37"> </span><span class="ff10">C<span class="_ _51"></span></span>)<span class="_ _a"> </span>=<span class="_ _32"> </span><span class="ff10">O</span></div><div class="t m0 x178 h21 y9c8 ff10 fs7 fc0 sc0 ls0 ws0">t</div><div class="t m0 x4d h4 y9c9 ffd fs2 fc0 sc0 ls0 ws0">g<span class="_ _23"></span><span class="fff">(<span class="ff1e">□</span></span></div><div class="t m0 x1bc hb y9ca ffc fs7 fc0 sc0 ls0 ws0">T</div><div class="t m0 x1bc ha y9cb ff12 fs7 fc0 sc0 ls0 ws0">3<span class="ffb">×</span>2</div><div class="t m0 x80 h6a y9c9 ff1e fs2 fc0 sc0 ls0 ws0">□</div><div class="t m0 x166 ha y9cc ff12 fs7 fc0 sc0 ls0 ws0">3<span class="ffb">×</span>1</div><div class="t m0 x97 h4 y9c9 fff fs2 fc0 sc0 ls0 ws0">+<span class="_ _37"> </span><span class="ff1e">□</span></div><div class="t m0 x5f ha y9cc ff12 fs7 fc0 sc0 ls0 ws0">2<span class="ffb">×</span>1</div><div class="t m0 x21 h4 y9c9 fff fs2 fc0 sc0 ls0 ws0">)<span class="_ _32"> </span>=<span class="_ _32"> </span><span class="ff1e">□</span></div><div class="t m0 x178 ha y9cc ff12 fs7 fc0 sc0 ls0 ws0">2<span class="ffb">×</span>1</div><div class="t m0 x3 h6 y9cd ff10 fs2 fc0 sc0 ls0 ws0">U<span class="_ _34"> </span><span class="ff1">、</span>W<span class="_ _5"> </span><span class="ff1">和<span class="_ _d"> </span></span>V<span class="_ _19"> </span><span class="ff1">三个权重矩阵和传播过程中是权值共享的。</span></div><div class="t m0 x12 h6 y9ce ff1 fs2 fc0 sc0 ls0 ws0">权值共享是指<span class="_ _25"> </span><span class="ff10">U<span class="_ _34"></span></span>、<span class="_ _29"></span><span class="ff10">W<span class="_ _3f"> </span><span class="ff1">和<span class="_ _25"> </span></span>V<span class="_ _18"> </span><span class="ff1">三个权重矩阵在前向传播的过程中不会改变，<span class="_ _3a"></span>不同时间步所使</span></span></div><div class="t m0 x12 h6 y9cf ff1 fs2 fc0 sc0 ls0 ws0">用的权重矩阵都是一样的。</div><div class="t m0 x3 h6 y9d0 ff1 fs2 fc0 sc0 ls0 ws0">将<span class="_ _d"> </span><span class="ff3">RNN<span class="_ _d"> </span></span>每一层用一个单元表示，并加上<span class="_ _d"> </span><span class="ff3">batc<span class="_ _12"></span>h<span class="_ _d"> </span>size<span class="ff1">，可以得到以下图示：</span></span></div><div class="c x82 y9d1 w22 h6b"><div class="t m0 xd9 h6c y9d2 ff3c fs1c fc0 sc0 ls0 ws0">L</div><div class="t m0 x17c h6c y9d3 ff3c fs1c fcd sc0 ls0 ws0">X</div><div class="t m0 xee h6d y9d4 ff3d fs1d fcd sc0 ls0 ws0">U<span class="_ _63"> </span>V</div><div class="t m0 x21 h6c y9d3 ff3c fs1c fcd sc0 ls0 ws0">Y<span class="_ _64"></span>H<span class="_ _46"> </span>O<span class="_ _65"></span>X<span class="_ _66"></span>X</div><div class="t m0 xe5 h6d y9d5 ff3d fs1d fcd sc0 ls0 ws0">W</div><div class="t m0 x18c h6c y9d6 ff3c fs1c fcd sc0 ls0 ws0">X</div><div class="t m0 x10b h6d y9d7 ff3d fs1d fcd sc0 ls0 ws0">U<span class="_ _63"> </span>V</div><div class="t m0 xe0 h6c y9d6 ff3c fs1c fcd sc0 ls0 ws0">Y<span class="_ _64"></span>H<span class="_ _46"> </span>O<span class="_ _65"></span>X<span class="_ _66"></span>X</div><div class="t m0 x88 h6d y9d8 ff3d fs1d fcd sc0 ls0 ws0">W</div><div class="t m0 x177 h6c y9d9 ff3c fs1c fcd sc0 ls0 ws0">X</div><div class="t m0 x12e h6d y9da ff3d fs1d fcd sc0 ls0 ws0">U<span class="_ _63"> </span>V</div><div class="t m0 x193 h6c y9d9 ff3c fs1c fcd sc0 ls0 ws0">Y<span class="_ _64"></span>H<span class="_ _46"> </span>O<span class="_ _65"></span>X<span class="_ _66"></span>X</div><div class="t m0 x54 h6d y9db ff3d fs1d fcd sc0 ls0 ws0">W</div><div class="t m0 x13 h6c y9dc ff3c fs1c fcd sc0 ls0 ws0">X</div><div class="t m0 x132 h6d y9dd ff3d fs1d fcd sc0 ls0 ws0">U<span class="_ _63"> </span>V</div><div class="t m0 x124 h6c y9dc ff3c fs1c fcd sc0 ls0 ws0">Y<span class="_ _64"></span>H<span class="_ _46"> </span>O<span class="_ _65"></span>X<span class="_ _66"></span>X</div><div class="t m0 xf2 h6d y9de ff3d fs1d fcd sc0 ls0 ws0">W</div><div class="t m0 xb9 h6c y9df ff3c fs1c fcd sc0 ls0 ws0">X</div><div class="t m0 xb3 h6d y9e0 ff3d fs1d fcd sc0 ls0 ws0">U<span class="_ _63"> </span>V</div><div class="t m0 x148 h6c y9df ff3c fs1c fcd sc0 ls0 ws0">Y<span class="_ _64"></span>H<span class="_ _46"> </span>O<span class="_ _65"></span>X<span class="_ _66"></span>X</div><div class="t m0 x1a0 h6d y9e1 ff3d fs1d fcd sc0 ls0 ws0">W</div><div class="t m0 xef h6c y9d2 ff3c fs1c fc0 sc0 ls0 ws0">X</div><div class="t m0 x114 h6d y9e2 ff3d fs1d fc0 sc0 ls0 ws0">U<span class="_ _63"> </span>V</div><div class="t m0 x158 h6c y9d2 ff3c fs1c fc0 sc0 ls0 ws0">Y<span class="_ _64"></span>H<span class="_ _46"> </span>O<span class="_ _67"></span>X<span class="_ _66"></span>X</div><div class="t m0 x55 h6d y9e3 ff3d fs1d fc0 sc0 ls0 ws0">W</div><div class="t m0 x1b1 h6e y9e4 ff3e fs1e fc0 sc0 ls0 ws0">batchsize=5</div></div><div class="t m0 x3 hd y9e5 ff5 fs8 fc0 sc0 ls0 ws0">11.1.2<span class="_ _36"> </span><span class="ff9">反向传播</span></div><div class="t m0 x3 h6 y9e6 ff1 fs2 fc0 sc0 ls0 ws0">与<span class="_ _d"> </span><span class="ff3">DNN<span class="_ _25"> </span></span>一致，<span class="ff3">RNN<span class="_ _25"> </span></span>也是通过梯度下降的方法来寻找<span class="_ _d"> </span><span class="ff3">U</span>、<span class="ff3">V</span>、<span class="_ _12"></span><span class="ff3">W<span class="_ _d"> </span><span class="ff1">这三个参数的最优解，<span class="_ _12"></span>此处我</span></span></div><div class="t m0 x3 h6 y9e7 ff1 fs2 fc0 sc0 ls0 ws0">们考虑较复杂的<span class="_ _25"> </span><span class="ff3">Many to<span class="_ _25"> </span>Many </span>形式，<span class="_ _29"></span>损失函数暂定为<span class="_ _d"> </span><span class="ff3">MSE<span class="_ _25"> </span></span>损失函数，<span class="_ _29"></span>由于序列的每个位置都</div><div class="t m0 x3 h6 y9e8 ff1 fs2 fc0 sc0 ls0 ws0">有损失函数，因此最终损失为：</div><div class="t m0 x17 h4 y9e9 ffd fs2 fc0 sc0 ls0 ws0">L<span class="_ _32"> </span><span class="fff">=</span></div><div class="t m0 x70 hb y9ea ffc fs7 fc0 sc0 ls0 ws0">τ</div><div class="t m0 xa hc y9eb ff11 fs2 fc0 sc0 ls0 ws0">X</div><div class="t m0 x70 ha y9ec ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 xd4 he y9e9 ffd fs2 fc0 sc0 ls0 ws0">L</div><div class="t m0 x36 hb y9ed ffc fs7 fc0 sc0 ls0 ws0">t</div><div class="t m0 x86 h4 y9e9 ff3 fs2 fc0 sc0 ls0 ws0">(11.1)</div><div class="t m0 x3 h6 y9ee ff1 fs2 fc0 sc0 ls0 ws0">假定我们最终的损失函数为<span class="_ _d"> </span><span class="ffd">L</span>，这里假设为<span class="_ _d"> </span><span class="ffd">M<span class="_ _34"></span>S<span class="_ _23"></span>E<span class="_ _51"></span></span>，即：</div><div class="t m0 x72 h4 y9ef ffd fs2 fc0 sc0 ls0 ws0">L<span class="_ _32"> </span><span class="fff">=</span></div><div class="t m0 xc7 h4 y9f0 fff fs2 fc0 sc0 ls0 ws0">1</div><div class="t m0 xc7 h4 y9f1 fff fs2 fc0 sc0 ls0 ws0">2</div><div class="t m0 x5d h12 y9f2 ff14 fs7 fc0 sc0 ls0 ws0">output</div><div class="t m0 x74 hc y9f3 ff11 fs2 fc0 sc0 ls0 ws0">X</div><div class="t m0 x122 ha y9f4 ffc fs7 fc0 sc0 ls0 ws0">j<span class="_ _23"></span><span class="ff12">=1</span></div><div class="t m0 x12a hc y9f5 ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x29 h4 y9ef fff fs2 fc0 sc0 ls0 ws0">ˆ<span class="_ _3c"></span><span class="ffd">y</span></div><div class="t m0 xcf hb y9f6 ffc fs7 fc0 sc0 ls0 ws0">t</div><div class="t m0 xcf hb y9f7 ffc fs7 fc0 sc0 ls0 ws0">j</div><div class="t m0 x13f h4 y9ef ffe fs2 fc0 sc0 ls0 ws0">−<span class="_ _37"> </span><span class="ffd">y</span></div><div class="t m0 x148 hb y9f6 ffc fs7 fc0 sc0 ls0 ws0">t</div><div class="t m0 xab hb y9f7 ffc fs7 fc0 sc0 ls0 ws0">j</div><div class="t m0 x158 hc y9f5 ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x26 ha y9f8 ff12 fs7 fc0 sc0 ls0 ws0">2</div><div class="t m0 xbc h4 y3 ff3 fs2 fc0 sc0 ls0 ws0">69</div><a class="l" href="#pf4a" data-dest-detail='[74,"XYZ",277.98,73.95,null]'><div class="d m1" style="border-style:none;position:absolute;left:122.662500px;bottom:1177.872000px;width:19.397000px;height:15.458000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf4a" data-dest-detail='[74,"XYZ",277.98,73.95,null]'><div class="d m1" style="border-style:none;position:absolute;left:204.819000px;bottom:964.323000px;width:19.397000px;height:15.458000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.500000,0.000000,0.000000,1.500000,0.000000,0.000000]}'></div></div>
<div id="pf4c" class="pf w0 h0" data-page-no="4c"><div class="pc pc4c w0 h0"><img class="bi xdc y9f9 w8 h6f" alt="" src="bg4c.png"/><div class="t m0 x3 h29 y21 ff3 fs5 fc0 sc0 ls0 ws0">11.2<span class="_ _8"> </span>LSTM</div><div class="t m0 x3 h32 y572 ff9 fsc fc0 sc0 ls0 ws0">输出层</div><div class="t m0 x46 he y9fa ffd fs2 fc0 sc0 ls0 ws0">∂<span class="_ _23"></span>L</div><div class="t m0 x30 h4 y9fb ffd fs2 fc0 sc0 ls0 ws0">∂<span class="_ _34"> </span><span class="fff">ˆ<span class="_ _3c"></span><span class="ffd">y</span></span></div><div class="t m0 xd8 hb y9fc ffc fs7 fc0 sc0 ls0 ws0">t</div><div class="t m0 x41 h4 y9fd fff fs2 fc0 sc0 ls0 ws0">=</div><div class="t m0 x47 he y9fa ffd fs2 fc0 sc0 ls0 ws0">∂<span class="_ _23"></span>L</div><div class="t m0 x172 he y9fb ffd fs2 fc0 sc0 ls0 ws0">∂<span class="_ _23"></span>L</div><div class="t m0 xe hb y9fc ffc fs7 fc0 sc0 ls0 ws0">t</div><div class="t m0 x52 he y9fa ffd fs2 fc0 sc0 ls0 ws0">∂<span class="_ _23"></span>L</div><div class="t m0 x1 hb y9fe ffc fs7 fc0 sc0 ls0 ws0">t</div><div class="t m0 x80 h4 y9fb ffd fs2 fc0 sc0 ls0 ws0">∂<span class="_ _34"> </span><span class="fff">ˆ<span class="_ _3c"></span><span class="ffd">y</span></span></div><div class="t m0 x5d hb y9fc ffc fs7 fc0 sc0 ls0 ws0">t</div><div class="t m0 x100 h4 y9fd fff fs2 fc0 sc0 ls0 ws0">=<span class="_ _32"> </span>1<span class="_ _37"> </span><span class="ffe">×</span></div><div class="t m0 xcf he y9fa ffd fs2 fc0 sc0 ls0 ws0">∂<span class="_ _23"></span>L</div><div class="t m0 x13b ha y9fe ff12 fs7 fc0 sc0 ls0 ws0">(<span class="ffc">t</span>)</div><div class="t m0 x20 he y9ff ffd fs2 fc0 sc0 ls0 ws0">∂<span class="_ _23"></span>o</div><div class="t m0 x39 ha ya00 ff12 fs7 fc0 sc0 ls0 ws0">(<span class="ffc">t</span>)</div><div class="t m0 x79 h4 y9fd fff fs2 fc0 sc0 ls0 ws0">=<span class="_ _d"> </span>ˆ<span class="_ _3c"></span><span class="ffd">y</span></div><div class="t m0 xb6 hb ya01 ffc fs7 fc0 sc0 ls0 ws0">t</div><div class="t m0 xc6 h4 y9fd ffe fs2 fc0 sc0 ls0 ws0">−<span class="_ _37"> </span><span class="ffd">y</span></div><div class="t m0 xec hb ya01 ffc fs7 fc0 sc0 ls0 ws0">t</div><div class="t m0 x86 h4 y9fd ff3 fs2 fc0 sc0 ls0 ws0">(11.2)</div><div class="t m0 x3 h6 ya02 ff1 fs2 fc0 sc0 ls0 ws0">关于<span class="_ _d"> </span><span class="ff10">W</span></div><div class="t m0 xb8 h21 ya03 ff10 fs7 fc0 sc0 ls0 ws0">O</div><div class="t m0 x12c h6 ya02 ff1 fs2 fc0 sc0 ls0 ws0">和<span class="_ _d"> </span><span class="ff10">B</span></div><div class="t m0 x2c h21 ya03 ff10 fs7 fc0 sc0 ls0 ws0">O</div><div class="t m0 x167 h6 ya02 ff1 fs2 fc0 sc0 ls0 ws0">的梯度计算如下：</div><div class="t m0 x3 h17 ya04 ff5 fs8 fc0 sc0 ls0 ws0">11.1.3<span class="_ _36"> </span>title</div><div class="t m0 x111 h4d ya05 ff5 fs6 fc0 sc0 ls0 ws0">11.2<span class="_ _24"> </span>LSTM</div><div class="t m0 x3 hd ya06 ff5 fs8 fc0 sc0 ls0 ws0">11.2.1<span class="_ _36"> </span>LSTM<span class="_ _5"> </span><span class="ff9">概述</span></div><div class="t m0 x3 h6 ya07 ff1 fs2 fc0 sc0 ls0 ws0">传统<span class="_ _25"> </span><span class="ff3">RNN<span class="_ _25"> </span></span>模型容易产生梯度消失的问题，<span class="_ _27"></span>难以处理长序列的数据。<span class="_ _27"></span>而造成梯度消失的原因，<span class="_ _27"></span>本</div><div class="t m0 x3 h6 ya08 ff1 fs2 fc0 sc0 ls0 ws0">质<span class="_ _23"></span>上是<span class="_ _23"></span>因<span class="_ _23"></span>为隐<span class="_ _23"></span>藏<span class="_ _23"></span>层状<span class="_ _23"></span>态<span class="_ _35"> </span><span class="ffd">H</span></div><div class="t m0 x3f hb ya09 ffc fs7 fc0 sc0 ls0 ws0">t</div><div class="t m0 xd7 h6 ya08 ff1 fs2 fc0 sc0 ls0 ws0">的<span class="_ _23"></span>计算<span class="_ _23"></span>方<span class="_ _23"></span>式导<span class="_ _23"></span>致<span class="_ _23"></span>梯度<span class="_ _23"></span>被<span class="_ _23"></span>表示<span class="_ _23"></span>为<span class="_ _23"></span>连乘<span class="_ _23"></span>积<span class="_ _23"></span>的形<span class="_ _23"></span>式，<span class="_ _23"></span>因此<span class="_ _3f"> </span><span class="ff3">Ho<span class="_ _23"></span>c<span class="_ _12"></span>hreater<span class="_ _35"> </span><span class="ff1">和</span></span></div><div class="t m0 x3 h6 ya0a ff3 fs2 fc0 sc0 ls0 ws0">Sc<span class="_ _12"></span>hmidh<span class="_ _12"></span>ub<span class="_ _23"></span>er <span class="ff1">在<span class="_ _25"> </span></span>1997<span class="_ _25"> </span><span class="ff1">年提出了长短期记忆网络<span class="_ _25"> </span></span>LSTM<span class="ff1">，<span class="_ _29"></span>通过精心设计的隐藏层神经元缓解了传</span></div><div class="t m0 x3 h6 ya0b ff1 fs2 fc0 sc0 ls0 ws0">统<span class="_ _d"> </span><span class="ff3">RNN<span class="_ _d"> </span></span>的梯度消失问题。</div><div class="t m0 x3 hd ya0c ff5 fs8 fc0 sc0 ls0 ws0">11.2.2<span class="_ _36"> </span>LSTM<span class="_ _5"> </span><span class="ff9">与<span class="_ _5"> </span></span>RNN<span class="_ _18"> </span><span class="ff9">的区别</span></div><div class="t m0 x3 h6 ya0d ff1 fs2 fc0 sc0 ls0 ws0">如果<span class="_ _23"></span>我<span class="_ _23"></span>们略<span class="_ _23"></span>去<span class="_ _1e"> </span><span class="ff3">RNN<span class="_ _35"> </span></span>网<span class="_ _23"></span>络的<span class="_ _23"></span>输<span class="_ _23"></span>出层<span class="_ _23"></span>和损<span class="_ _23"></span>失函<span class="_ _23"></span>数，那<span class="_ _23"></span>么模<span class="_ _23"></span>型<span class="_ _23"></span>可以<span class="_ _23"></span>简化<span class="_ _23"></span>为如<span class="_ _23"></span>图<span class="ff3">11.6</span>的形<span class="_ _23"></span>式（只<span class="_ _23"></span>保留</div><div class="t m0 x3 h6 ya0e ff3 fs2 fc0 sc0 ls0 ws0">RNN<span class="_ _e"> </span><span class="ff1">的隐藏<span class="_ _23"></span>层）<span class="_ _3b"></span>，通过<span class="_ _23"></span>线条指示的<span class="_ _23"></span>路径可以清<span class="_ _23"></span>晰地看出隐<span class="_ _23"></span>藏状态<span class="_ _e"> </span><span class="ff10">H</span></span></div><div class="t m0 x102 hb ya0f ffc fs7 fc0 sc0 ls0 ws0">t</div><div class="t m0 x146 h6 ya0e ff1 fs2 fc0 sc0 ls0 ws0">由<span class="_ _e"> </span><span class="ff10">H</span></div><div class="t m0 x185 ha ya0f ffc fs7 fc0 sc0 ls0 ws0">t<span class="ffb">−<span class="ff12">1</span></span></div><div class="t m0 x1bd h6 ya0e ff1 fs2 fc0 sc0 ls0 ws0">和<span class="_ _e"> </span><span class="ff10">x</span></div><div class="t m0 x1b hb ya0f ffc fs7 fc0 sc0 ls0 ws0">t</div><div class="t m0 x84 h6 ya0e ff1 fs2 fc0 sc0 ls0 ws0">共同决<span class="_ _23"></span>定。</div><div class="t m0 x3 hf ya10 ff10 fs2 fc0 sc0 ls0 ws0">H</div><div class="t m0 x143 hb ya11 ffc fs7 fc0 sc0 ls0 ws0">t</div><div class="t m0 x13a h6 ya10 ff1 fs2 fc0 sc0 ls0 ws0">一方面是<span class="_ _d"> </span><span class="ff3">RNN<span class="_ _d"> </span></span>层当前的输出，另一方面用于计算<span class="_ _d"> </span><span class="ff10">H</span></div><div class="t m0 xc8 ha ya11 ffc fs7 fc0 sc0 ls0 ws0">t<span class="ff12">+1</span></div><div class="t m0 x11 h6 ya12 ff1 fs2 fc0 sc0 ls0 ws0">图<span class="_ _d"> </span><span class="ff3">11.6:<span class="_ _35"> </span>RNN<span class="_ _d"> </span></span>隐藏层</div><div class="t m0 x3 h6 ya13 ff3 fs2 fc0 sc0 ls0 ws0">LSTM<span class="_ _35"> </span><span class="ff1">和<span class="_ _35"> </span></span>RNN<span class="_ _35"> </span><span class="ff1">区别<span class="_ _23"></span>在于<span class="_ _23"></span>隐藏<span class="_ _23"></span>层<span class="_ _23"></span>的不<span class="_ _23"></span>同。虽<span class="_ _23"></span>然<span class="_ _1e"> </span></span>LSTM<span class="_ _35"> </span><span class="ff1">也<span class="_ _23"></span>有这<span class="_ _23"></span>种链<span class="_ _23"></span>状结<span class="_ _23"></span>构，<span class="_ _23"></span>不过<span class="_ _23"></span>其循<span class="_ _23"></span>环结<span class="_ _23"></span>构和</span></div><div class="t m0 x3 h6 ya14 ff3 fs2 fc0 sc0 ls0 ws0">RNN<span class="_ _d"> </span><span class="ff1">不同。</span>LSTM<span class="_ _d"> </span><span class="ff1">的循环结构中有<span class="_ _d"> </span></span>4<span class="_ _d"> </span><span class="ff1">个神经网络层，并且他们之间的交互非常特别。</span></div><div class="t m0 x72 h6 ya15 ff1 fs2 fc0 sc0 ls0 ws0">图<span class="_ _d"> </span><span class="ff3">11.7:<span class="_ _35"> </span>LSTM<span class="_ _d"> </span></span>隐藏层</div><div class="t m0 x3 h6 y18e ff1 fs2 fc0 sc0 ls0 ws0">可以发现，<span class="_ _12"></span><span class="ff3">LSTM<span class="_ _d"> </span><span class="ff1">和<span class="_ _d"> </span></span>RNN<span class="_ _25"> </span><span class="ff1">的隐藏层都只有一个输出，就是<span class="_ _d"> </span><span class="ff10">H</span></span></span></div><div class="t m0 xeb hb y525 ffc fs7 fc0 sc0 ls0 ws0">t</div><div class="t m0 x162 h6 y18e ff1 fs2 fc0 sc0 ls0 ws0">，<span class="_ _12"></span>并且<span class="_ _d"> </span><span class="ff10">H</span></div><div class="t m0 x120 hb y525 ffc fs7 fc0 sc0 ls0 ws0">t</div><div class="t m0 x151 h6 y18e ff1 fs2 fc0 sc0 ls0 ws0">都参与了下一时刻的</div><div class="t m0 x3 h6 y20 ff1 fs2 fc0 sc0 ls0 ws0">前向传播。<span class="_ _28"></span>但除了<span class="_ _25"> </span><span class="ff10">H</span></div><div class="t m0 x19a hb y2cd ffc fs7 fc0 sc0 ls0 ws0">t</div><div class="t m0 xb4 h6 y20 ff1 fs2 fc0 sc0 ls0 ws0">，<span class="_ _27"></span><span class="ff3">LSTM<span class="_ _d"> </span><span class="ff1">还有一个隐藏状态也参与了前向传播，<span class="_ _28"></span>但这个隐藏状态没有被输</span></span></div><div class="t m0 x3 h4 y3 ff3 fs2 fc0 sc0 ls0 ws0">70</div><a class="l" href="#pf4c" data-dest-detail='[76,"XYZ",70.87,422.74,null]'><div class="d m1" style="border-style:none;position:absolute;left:641.109000px;bottom:681.858000px;width:19.396000px;height:15.458000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.500000,0.000000,0.000000,1.500000,0.000000,0.000000]}'></div></div>
<div id="pf4d" class="pf w0 h0" data-page-no="4d"><div class="pc pc4d w0 h0"><img class="bi x1a0 ya16 w3 h70" alt="" src="bg4d.png"/><div class="t m0 x18b h29 y21 ff3 fs5 fc0 sc0 ls0 ws0">11.2<span class="_ _8"> </span>LSTM</div><div class="t m0 x3 h6 y22 ff1 fs2 fc0 sc0 ls0 ws0">出。我们称这个隐藏状态<span class="_ _23"></span>为细胞状态<span class="_ _d"> </span><span class="ff10">C</span></div><div class="t m0 x16 hb y796 ffc fs7 fc0 sc0 ls0 ws0">t</div><div class="t m0 x52 h6 y22 ff3 fs2 fc0 sc0 ls0 ws0">(Cell<span class="_ _d"> </span>State)<span class="ff1">。<span class="ff10">C</span></span></div><div class="t m0 xab hb y796 ffc fs7 fc0 sc0 ls0 ws0">t</div><div class="t m0 x1f h6 y22 ff1 fs2 fc0 sc0 ls0 ws0">在<span class="_ _d"> </span><span class="ff3">LSTM<span class="_ _d"> </span></span>中实<span class="_ _23"></span>质上起到了<span class="_ _d"> </span><span class="ff3">RNN<span class="_ _d"> </span></span>中隐</div><div class="t m0 x3 h6 y17d ff1 fs2 fc0 sc0 ls0 ws0">藏状态<span class="_ _d"> </span><span class="ff10">H</span></div><div class="t m0 x108 hb y488 ffc fs7 fc0 sc0 ls0 ws0">t</div><div class="t m0 x12e h6 y17d ff1 fs2 fc0 sc0 ls0 ws0">的作用。</div><div class="t m0 x3 h6 y88 ff1 fs2 fc0 sc0 ls0 ws0">除了<span class="_ _25"> </span><span class="ff10">H</span></div><div class="t m0 x43 hb y528 ffc fs7 fc0 sc0 ls0 ws0">t</div><div class="t m0 x14c h6 y88 ff1 fs2 fc0 sc0 ls0 ws0">和细胞状态<span class="_ _25"> </span><span class="ff10">C</span></div><div class="t m0 x12f hb y528 ffc fs7 fc0 sc0 ls0 ws0">t</div><div class="t m0 xcd h6 y88 ff1 fs2 fc0 sc0 ls0 ws0">，<span class="_ _28"></span>图中还有三个结构，<span class="_ _27"></span>这些结构一般称之为门控结构<span class="_ _d"> </span><span class="ff3">(Gate)</span>。<span class="_ _28"></span><span class="ff3">LSTM<span class="_ _25"> </span><span class="ff1">的</span></span></div><div class="t m0 x3 h6 y89 ff1 fs2 fc0 sc0 ls0 ws0">门控结构一般包括遗忘门，输入门和输出门三种，这三个门结构都是用来控制<span class="_ _d"> </span><span class="ff10">C</span></div><div class="t m0 xfc hb y652 ffc fs7 fc0 sc0 ls0 ws0">t</div><div class="t m0 x27 h6 y89 ff1 fs2 fc0 sc0 ls0 ws0">的状态。</div><div class="t m0 x95 h6 ya17 ff1 fs2 fc0 sc0 ls0 ws0">图<span class="_ _d"> </span><span class="ff3">11.8:<span class="_ _35"> </span>cell<span class="_ _d"> </span>state</span></div><div class="t m0 x3 h6 ya18 ff3 fs2 fc0 sc0 ls0 ws0">LSTM<span class="_ _25"> </span><span class="ff1">的关键是细胞状态<span class="_ _d"> </span><span class="ff10">C</span></span></div><div class="t m0 x50 hb ya19 ffc fs7 fc0 sc0 ls0 ws0">t</div><div class="t m0 x40 h6 ya18 ff1 fs2 fc0 sc0 ls0 ws0">，<span class="_ _28"></span><span class="ff10">C</span></div><div class="t m0 x2 hb ya19 ffc fs7 fc0 sc0 ls0 ws0">t</div><div class="t m0 x19b h6 ya18 ff1 fs2 fc0 sc0 ls0 ws0">横穿整个<span class="_ _25"> </span><span class="ff3">LSTM<span class="_ _d"> </span></span>单元顶部的水平线。<span class="_ _28"></span><span class="ff3">LSTM<span class="_ _d"> </span><span class="ff1">通过门结构对细</span></span></div><div class="t m0 x3 h6 ya1a ff1 fs2 fc0 sc0 ls0 ws0">胞状态<span class="_ _23"></span>添加或者<span class="_ _23"></span>删除信息。<span class="_ _23"></span>门是一种选<span class="_ _23"></span>择性让信<span class="_ _23"></span>息通过的<span class="_ _23"></span>方法。它们<span class="_ _23"></span>由一个<span class="_ _e"> </span><span class="ff3">Sigmoid<span class="_ _e"> </span></span>神<span class="_ _23"></span>经网络</div><div class="t m0 x3 h6 ya1b ff1 fs2 fc0 sc0 ls0 ws0">层和一个元素级相乘操作组成。</div><div class="t m0 x3 h6 ya1c ff1 fs2 fc0 sc0 ls0 ws0">在开始之介绍<span class="_ _d"> </span><span class="ff3">LSTM<span class="_ _d"> </span></span>各个门结构前，我们先介绍一下将用到的标记。</div><div class="t m0 x3 h6 ya1d ff1 fs2 fc0 sc0 ls0 ws0">在上图中，<span class="_ _29"></span>每条线表示向量的传递，<span class="_ _3a"></span>从一个结点的输出传递到另外结点的输入。<span class="_ _30"></span>粉红圆表示向量</div><div class="t m0 x3 h6 ya1e ff1 fs2 fc0 sc0 ls0 ws0">的元素级操作，<span class="_ _30"></span>比如相加或者相乘。<span class="_ _30"></span>黄色方框表示神经网络的层。<span class="_ _27"></span>线合并表示向量的连接，<span class="_ _30"></span>线分</div><div class="t m0 x3 h6 ya1f ff1 fs2 fc0 sc0 ls0 ws0">叉表示向量复制。接下来按运算顺序介绍<span class="_ _d"> </span><span class="ff3">LSTM<span class="_ _d"> </span></span>的三个门结构。</div><div class="t m0 x3 hd ya20 ff5 fs8 fc0 sc0 ls0 ws0">11.2.3<span class="_ _36"> </span><span class="ff9">遗忘门</span></div><div class="t m0 x3 h6 ya21 ff3 fs2 fc0 sc0 ls0 ws0">LSTM<span class="_ _25"> </span><span class="ff1">的第一步是决定我们将要从细胞状态中扔掉哪些信息。<span class="_ _12"></span>该决定由一个叫做<span class="_ _12"></span>“遗忘门<span class="_ _25"> </span><span class="ff3">(F<span class="_ _28"></span>or-</span></span></div><div class="t m0 x3 h6 ya22 ff3 fs2 fc0 sc0 ls0 ws0">get<span class="_ _25"> </span>Gate)<span class="ff1">”的<span class="_ _25"> </span></span>Sigmoid<span class="_ _d"> </span><span class="ff1">层控制。<span class="_ _12"></span><span class="ff10">H</span></span></div><div class="t m0 x51 ha ya23 ffc fs7 fc0 sc0 ls0 ws0">t<span class="ffb">−<span class="ff12">1</span></span></div><div class="t m0 x2f h6 ya22 ff1 fs2 fc0 sc0 ls0 ws0">和<span class="_ _25"> </span><span class="ff10">x</span></div><div class="t m0 x1 hb ya23 ffc fs7 fc0 sc0 ls0 ws0">t</div><div class="t m0 x100 h6 ya22 ff1 fs2 fc0 sc0 ls0 ws0">被输入遗忘门，<span class="_ _28"></span>经过<span class="_ _d"> </span><span class="ff3">Sigmoid<span class="_ _d"> </span></span>激活函数，<span class="_ _28"></span>输出一个</div><div class="t m0 x3 h6 ya24 ff1 fs2 fc0 sc0 ls0 ws0">向量<span class="_ _d"> </span><span class="ffd">f</span></div><div class="t m0 xb9 hb ya25 ffc fs7 fc0 sc0 ls0 ws0">t</div><div class="t m0 xef h6 ya24 ff1 fs2 fc0 sc0 ls0 ws0">，<span class="ffd">f</span></div><div class="t m0 x10b hb ya25 ffc fs7 fc0 sc0 ls0 ws0">t</div><div class="t m0 x132 h6 ya24 ff1 fs2 fc0 sc0 ls0 ws0">的元素与<span class="_ _d"> </span><span class="ff10">C</span></div><div class="t m0 x3e ha ya25 ffc fs7 fc0 sc0 ls0 ws0">t<span class="ffb">−<span class="ff12">1</span></span></div><div class="t m0 x8 h6 ya24 ff1 fs2 fc0 sc0 ls0 ws0">的元素一一对应，并且<span class="_ _e"> </span><span class="ffd">f</span></div><div class="t m0 x13f hb ya25 ffc fs7 fc0 sc0 ls0 ws0">t</div><div class="t m0 x13b h6 ya24 ff1 fs2 fc0 sc0 ls0 ws0">的元素都是<span class="_ _d"> </span><span class="fff">0<span class="_ _25"> </span><span class="ffe">∼<span class="_ _25"> </span></span>1<span class="_ _d"> </span></span>之间的数，<span class="ff3">1<span class="_ _e"> </span></span>表示“完</div><div class="t m0 x3 h6 ya26 ff1 fs2 fc0 sc0 ls0 ws0">全保留该信息”<span class="_ _26"></span>，<span class="_ _27"></span><span class="ff3">0<span class="_ _25"> </span><span class="ff1">表示<span class="_ _12"></span>“完全丢弃该信息”<span class="_ _26"></span>。<span class="_ _27"></span>即遗忘门以一定的概率控制是否遗忘上一个时刻的</span></span></div><div class="t m0 x3 h6 ya27 ff1 fs2 fc0 sc0 ls0 ws0">细胞状态。</div><div class="t m0 x41 he ya28 ffd fs2 fc0 sc0 ls0 ws0">f</div><div class="t m0 x19b hb ya29 ffc fs7 fc0 sc0 ls0 ws0">t</div><div class="t m0 x73 h4 ya28 fff fs2 fc0 sc0 ls0 ws0">=<span class="_ _32"> </span><span class="ffd">σ<span class="_ _38"> </span></span>(<span class="ffd">W</span></div><div class="t m0 x1 hb ya2a ffc fs7 fc0 sc0 ls0 ws0">f</div><div class="t m0 x74 he ya28 ffd fs2 fc0 sc0 ls0 ws0">h</div><div class="t m0 x75 ha ya29 ffc fs7 fc0 sc0 ls0 ws0">t<span class="ffb">−<span class="ff12">1</span></span></div><div class="t m0 x12a h4 ya28 fff fs2 fc0 sc0 ls0 ws0">+<span class="_ _37"> </span><span class="ffd">U</span></div><div class="t m0 x1a9 hb ya2a ffc fs7 fc0 sc0 ls0 ws0">f</div><div class="t m0 x39 he ya28 ffd fs2 fc0 sc0 ls0 ws0">x</div><div class="t m0 x124 hb ya29 ffc fs7 fc0 sc0 ls0 ws0">t</div><div class="t m0 x1e h4 ya28 fff fs2 fc0 sc0 ls0 ws0">+<span class="_ _37"> </span><span class="ffd">b</span></div><div class="t m0 x3a hb ya2a ffc fs7 fc0 sc0 ls0 ws0">f</div><div class="t m0 xc5 h4 ya28 fff fs2 fc0 sc0 ls0 ws0">)<span class="_ _68"> </span><span class="ff3">(11.3)</span></div><div class="t m0 x3 hd ya2b ff5 fs8 fc0 sc0 ls0 ws0">11.2.4<span class="_ _36"> </span><span class="ff9">输入门</span></div><div class="t m0 x3 h6 y87 ff1 fs2 fc0 sc0 ls0 ws0">第二步是决定我们将会把哪些新信息存储到元胞状态中。这步分为两部分：</div><div class="t m0 x15 h6 y20 ff3 fs2 fc0 sc0 ls0 ws0">•<span class="_ _5"> </span><span class="ff1">首先，有一个叫做“输入门<span class="_ _d"> </span></span>(Input<span class="_ _25"> </span>Gate)<span class="_ _23"></span><span class="ff1">”的<span class="_ _25"> </span></span>Sigmoid<span class="_ _d"> </span><span class="ff1">层决定我们要更新哪些信息。</span></div><div class="t m0 xbc h4 y3 ff3 fs2 fc0 sc0 ls0 ws0">71</div></div><div class="pi" data-data='{"ctm":[1.500000,0.000000,0.000000,1.500000,0.000000,0.000000]}'></div></div>
<div id="pf4e" class="pf w0 h0" data-page-no="4e"><div class="pc pc4e w0 h0"><div class="t m0 x3 h7 y21 ff3 fs5 fc0 sc0 ls0 ws0">11.3<span class="_ _8"> </span><span class="ff7">带窥孔的<span class="_ _32"> </span></span>LSTM</div><div class="t m0 x15 h6 y22 ff3 fs2 fc0 sc0 ls0 ws0">•<span class="_ _5"> </span><span class="ff1">接下来，一个<span class="_ _d"> </span></span>tanh<span class="_ _d"> </span><span class="ff1">层创造了一个新的候选值</span></div><div class="t m0 x36 h4 ya2c fff fs2 fc0 sc0 ls0 ws0">˜</div><div class="t m0 x20 he y22 ffd fs2 fc0 sc0 ls0 ws0">C</div><div class="t m0 x21 hb y796 ffc fs7 fc0 sc0 ls0 ws0">t</div><div class="t m0 x39 h6 y22 ff1 fs2 fc0 sc0 ls0 ws0">，该值可能被加入到元胞状态中。</div><div class="t m0 x3 h6 y5c ff1 fs2 fc0 sc0 ls0 ws0">在第三步中，<span class="ff3">LSTM<span class="_ _d"> </span></span>把这两个值组合起来用于更新元胞状态。</div><div class="t m0 x4e he y75b ffd fs2 fc0 sc0 ls0 ws0">i</div><div class="t m0 x51 hb ya2d ffc fs7 fc0 sc0 ls0 ws0">t</div><div class="t m0 x72 h4 y75b fff fs2 fc0 sc0 ls0 ws0">=<span class="_ _32"> </span><span class="ffd">σ<span class="_ _38"> </span></span>(<span class="ffd">W</span></div><div class="t m0 xbd hb ya2d ffc fs7 fc0 sc0 ls0 ws0">i</div><div class="t m0 x122 he y75b ffd fs2 fc0 sc0 ls0 ws0">h</div><div class="t m0 x75 ha ya2d ffc fs7 fc0 sc0 ls0 ws0">t<span class="ffb">−<span class="ff12">1</span></span></div><div class="t m0 x12a h4 y75b fff fs2 fc0 sc0 ls0 ws0">+<span class="_ _37"> </span><span class="ffd">U</span></div><div class="t m0 x71 hb ya2d ffc fs7 fc0 sc0 ls0 ws0">i</div><div class="t m0 x60 he y75b ffd fs2 fc0 sc0 ls0 ws0">x</div><div class="t m0 x37 hb ya2d ffc fs7 fc0 sc0 ls0 ws0">t</div><div class="t m0 x148 h4 y75b fff fs2 fc0 sc0 ls0 ws0">+<span class="_ _37"> </span><span class="ffd">b</span></div><div class="t m0 x7a hb ya2d ffc fs7 fc0 sc0 ls0 ws0">i</div><div class="t m0 xa0 h4 y75b fff fs2 fc0 sc0 ls0 ws0">)<span class="_ _69"> </span><span class="ff3">(11.4)</span></div><div class="t m0 x93 h4 ya2e fff fs2 fc0 sc0 ls0 ws0">˜</div><div class="t m0 x9a he ya2f ffd fs2 fc0 sc0 ls0 ws0">C</div><div class="t m0 x196 hb ya30 ffc fs7 fc0 sc0 ls0 ws0">t</div><div class="t m0 x5a h4 ya2f fff fs2 fc0 sc0 ls0 ws0">=<span class="_ _32"> </span><span class="ff3">tanh<span class="_ _31"> </span></span>(<span class="ffd">W</span></div><div class="t m0 x122 hb ya31 ffc fs7 fc0 sc0 ls0 ws0">C</div><div class="t m0 x97 he ya2f ffd fs2 fc0 sc0 ls0 ws0">h</div><div class="t m0 x98 ha ya30 ffc fs7 fc0 sc0 ls0 ws0">t<span class="ffb">−<span class="ff12">1</span></span></div><div class="t m0 xd4 h4 ya2f fff fs2 fc0 sc0 ls0 ws0">+<span class="_ _37"> </span><span class="ffd">U</span></div><div class="t m0 x193 hb ya31 ffc fs7 fc0 sc0 ls0 ws0">C</div><div class="t m0 xab he ya2f ffd fs2 fc0 sc0 ls0 ws0">x</div><div class="t m0 x79 hb ya30 ffc fs7 fc0 sc0 ls0 ws0">t</div><div class="t m0 x9f h4 ya2f fff fs2 fc0 sc0 ls0 ws0">+<span class="_ _37"> </span><span class="ffd">b</span></div><div class="t m0 x63 hb ya31 ffc fs7 fc0 sc0 ls0 ws0">C</div><div class="t m0 x162 h4 ya2f fff fs2 fc0 sc0 ls0 ws0">)<span class="_ _6a"> </span><span class="ff3">(11.5)</span></div><div class="t m0 x3 hd ya32 ff5 fs8 fc0 sc0 ls0 ws0">11.2.5<span class="_ _36"> </span><span class="ff9">细胞状态更新</span></div><div class="t m0 x3 h6 ya33 ff1 fs2 fc0 sc0 ls0 ws0">现在我们该将旧细胞状态<span class="_ _d"> </span><span class="ff10">C</span></div><div class="t m0 x8 ha ya34 ffc fs7 fc0 sc0 ls0 ws0">t<span class="ffb">−<span class="ff12">1</span></span></div><div class="t m0 x93 h6 ya33 ff1 fs2 fc0 sc0 ls0 ws0">更新到新状态<span class="_ _d"> </span><span class="ff10">C</span></div><div class="t m0 x101 hb ya34 ffc fs7 fc0 sc0 ls0 ws0">t</div><div class="t m0 xaa h6 ya33 ff1 fs2 fc0 sc0 ls0 ws0">了。上面的步骤中已经决定了该怎么做，<span class="_ _12"></span>这一</div><div class="t m0 x3 h6 ya35 ff1 fs2 fc0 sc0 ls0 ws0">步我们只需要实际执行即可。</div><div class="t m0 x6e he ya36 ffd fs2 fc0 sc0 ls0 ws0">C</div><div class="t m0 xf3 hb ya37 ffc fs7 fc0 sc0 ls0 ws0">t</div><div class="t m0 x2f h4 ya36 fff fs2 fc0 sc0 ls0 ws0">=<span class="_ _32"> </span><span class="ffd">C</span></div><div class="t m0 xf4 ha ya37 ffc fs7 fc0 sc0 ls0 ws0">t<span class="ffb">−<span class="ff12">1</span></span></div><div class="t m0 x53 h4 ya36 ffe fs2 fc0 sc0 ls0 ws0">⊙<span class="_ _37"> </span><span class="ffd">f</span></div><div class="t m0 xaa hb ya37 ffc fs7 fc0 sc0 ls0 ws0">t</div><div class="t m0 xd4 h4 ya36 fff fs2 fc0 sc0 ls0 ws0">+<span class="_ _37"> </span><span class="ffd">i</span></div><div class="t m0 xe0 hb ya37 ffc fs7 fc0 sc0 ls0 ws0">t</div><div class="t m0 x66 h4 ya36 ffe fs2 fc0 sc0 ls0 ws0">⊙</div><div class="t m0 x61 h4 ya38 fff fs2 fc0 sc0 ls0 ws0">˜</div><div class="t m0 x79 he ya36 ffd fs2 fc0 sc0 ls0 ws0">C</div><div class="t m0 x178 hb ya37 ffc fs7 fc0 sc0 ls0 ws0">t</div><div class="t m0 x86 h4 ya36 ff3 fs2 fc0 sc0 ls0 ws0">(11.6)</div><div class="t m0 x3 h6 ya39 ffe fs2 fc0 sc0 ls0 ws0">⊙<span class="_ _d"> </span><span class="ff1">是矩阵的<span class="_ _e"> </span><span class="ff3">Hadamard<span class="_ _d"> </span></span>积<span class="_ _d"> </span><span class="ff3">(</span>两个矩阵相同位<span class="_ _23"></span>置元素的乘积<span class="ff3">)</span>。新状态即为旧状态乘以需要忘<span class="_ _23"></span>记的</span></div><div class="t m0 x3 h6 ya3a ff1 fs2 fc0 sc0 ls0 ws0">概率，加上新的候选值乘以需要更新的比率。</div><div class="t m0 x3 hd ya3b ff5 fs8 fc0 sc0 ls0 ws0">11.2.6<span class="_ _36"> </span><span class="ff9">输出门</span></div><div class="t m0 x3 h6 ya3c ff1 fs2 fc0 sc0 ls0 ws0">最后，<span class="_ _30"></span>我们需要决定最终的输出。<span class="_ _30"></span>输出将会基于目前的细胞状态，<span class="_ _30"></span>并且会加入一些过滤。<span class="_ _27"></span>首先我</div><div class="t m0 x3 h6 ya3d ff1 fs2 fc0 sc0 ls0 ws0">们建立一个<span class="_ _25"> </span><span class="ff3">Sigmoid<span class="_ _25"> </span></span>层的输出门<span class="_ _25"> </span><span class="ff3">(Output<span class="_ _25"> </span>Gate)</span>，<span class="_ _29"></span>来决定我们将输出元胞的哪些部分。<span class="_ _30"></span>然后我们</div><div class="t m0 x3 h6 ya3e ff1 fs2 fc0 sc0 ls0 ws0">将元胞状态通过<span class="_ _d"> </span><span class="ff3">tanh<span class="_ _d"> </span></span>之后（使得输<span class="_ _23"></span>出值在<span class="ff3">-1<span class="_ _25"> </span></span>到<span class="_ _e"> </span><span class="ff3">1<span class="_ _d"> </span></span>之间）<span class="_ _2f"></span>，与输出门相乘，这样我们只会输出我</div><div class="t m0 x3 h6 ya3f ff1 fs2 fc0 sc0 ls0 ws0">们想输出的部分。</div><div class="t m0 x11c he ya40 ffd fs2 fc0 sc0 ls0 ws0">o</div><div class="t m0 x10 hb ya41 ffc fs7 fc0 sc0 ls0 ws0">t</div><div class="t m0 x172 h4 ya40 fff fs2 fc0 sc0 ls0 ws0">=<span class="_ _32"> </span><span class="ffd">σ<span class="_ _38"> </span></span>(<span class="ffd">W</span></div><div class="t m0 x4 hb ya41 ffc fs7 fc0 sc0 ls0 ws0">o</div><div class="t m0 x122 he ya40 ffd fs2 fc0 sc0 ls0 ws0">h</div><div class="t m0 x75 ha ya41 ffc fs7 fc0 sc0 ls0 ws0">t<span class="ffb">−<span class="ff12">1</span></span></div><div class="t m0 x12a h4 ya40 fff fs2 fc0 sc0 ls0 ws0">+<span class="_ _37"> </span><span class="ffd">U</span></div><div class="t m0 x71 hb ya41 ffc fs7 fc0 sc0 ls0 ws0">o</div><div class="t m0 x39 he ya40 ffd fs2 fc0 sc0 ls0 ws0">x</div><div class="t m0 x124 hb ya41 ffc fs7 fc0 sc0 ls0 ws0">t</div><div class="t m0 x25 h4 ya40 fff fs2 fc0 sc0 ls0 ws0">+<span class="_ _37"> </span><span class="ffd">b</span></div><div class="t m0 x3a hb ya41 ffc fs7 fc0 sc0 ls0 ws0">o</div><div class="t m0 xb6 h4 ya40 fff fs2 fc0 sc0 ls0 ws0">)<span class="_ _6b"> </span><span class="ff3">(11.7)</span></div><div class="t m0 x157 he ya42 ffd fs2 fc0 sc0 ls0 ws0">h</div><div class="t m0 xe hb ya43 ffc fs7 fc0 sc0 ls0 ws0">t</div><div class="t m0 x80 h4 ya42 fff fs2 fc0 sc0 ls0 ws0">=<span class="_ _32"> </span><span class="ffd">o</span></div><div class="t m0 xc2 hb ya43 ffc fs7 fc0 sc0 ls0 ws0">t</div><div class="t m0 x123 h4 ya42 ffe fs2 fc0 sc0 ls0 ws0">⊙<span class="_ _37"> </span><span class="ff3">tanh</span></div><div class="t m0 xd2 hc ya44 ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x197 h4 ya45 fff fs2 fc0 sc0 ls0 ws0">˜</div><div class="t m0 xe0 he ya42 ffd fs2 fc0 sc0 ls0 ws0">C</div><div class="t m0 x44 hb ya43 ffc fs7 fc0 sc0 ls0 ws0">t</div><div class="t m0 x148 hc ya44 ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x86 h4 ya42 ff3 fs2 fc0 sc0 ls0 ws0">(11.8)</div><div class="t m0 x0 h9 ya46 ff5 fs6 fc0 sc0 ls0 ws0">11.3<span class="_ _24"> </span><span class="ff9">带窥孔的<span class="_ _18"> </span></span>LSTM</div><div class="t m0 x3 h6 ya47 ff1 fs2 fc0 sc0 ls0 ws0">本文前<span class="_ _23"></span>面所介绍<span class="_ _23"></span>的<span class="_ _e"> </span><span class="ff3">LSTM<span class="_ _e"> </span></span>是最普<span class="_ _23"></span>通的<span class="_ _e"> </span><span class="ff3">LSTM</span>，但并<span class="_ _23"></span>非所有的<span class="_ _1e"> </span><span class="ff3">LSTM<span class="_ _e"> </span></span>模型都<span class="_ _23"></span>与前面相<span class="_ _23"></span>同。事实</div><div class="t m0 x3 h6 ya48 ff1 fs2 fc0 sc0 ls0 ws0">上，似乎每一篇<span class="_ _25"> </span><span class="ff3">pap<span class="_ _23"></span>er<span class="_ _d"> </span></span>中所用到的<span class="_ _d"> </span><span class="ff3">LSTM<span class="_ _25"> </span></span>都是稍微不一样的版本。不同之处很微小，不过其中</div><div class="t m0 x3 h6 ya49 ff1 fs2 fc0 sc0 ls0 ws0">一些值得介绍。</div><div class="t m0 x3 h6 ya4a ff1 fs2 fc0 sc0 ls0 ws0">一个流行的<span class="_ _25"> </span><span class="ff3">LSTM<span class="_ _d"> </span></span>变种，<span class="_ _30"></span>由<span class="_ _d"> </span><span class="ff3">Gers<span class="_ _25"> </span>&amp;<span class="_ _d"> </span>Sc<span class="_ _12"></span>hmidh<span class="_ _12"></span>ub<span class="_ _23"></span>er (2000)<span class="_ _d"> </span><span class="ff1">提出，<span class="_ _27"></span>加入了<span class="_ _28"></span>“窥视孔连接<span class="_ _25"> </span><span class="ff3">(p<span class="_ _23"></span>eephole</span></span></span></div><div class="t m0 x3 h6 ya4b ff3 fs2 fc0 sc0 ls0 ws0">connection)<span class="ff1">”<span class="_ _26"></span>。也就是说我们让各种门可以观察到元胞状态。</span></div><div class="t m0 x28 h4d ya4c ff5 fs6 fc0 sc0 ls0 ws0">11.4<span class="_ _24"> </span>GR<span class="_ _28"></span>U</div><div class="t m0 x3 h6 ya4d ff1 fs2 fc0 sc0 ls0 ws0">另一个变化更大一些的<span class="_ _a"> </span><span class="ff3">LSTM<span class="_ _a"> </span></span>变种叫做<span class="_ _a"> </span><span class="ff3">Gated<span class="_ _37"> </span>Recurrent<span class="_ _a"> </span>Unit</span>，<span class="_ _3e"></span>或者<span class="_ _a"> </span><span class="ff3">GR<span class="_ _12"></span>U<span class="ff1">，<span class="_ _3e"></span>由<span class="_ _a"> </span><span class="ff3">Cho, et<span class="_ _a"> </span>al.<span class="_ _1e"> </span>(2014)</span></span></span></div><div class="t m0 x3 h6 ya4e ff1 fs2 fc0 sc0 ls0 ws0">提出。<span class="ff3">GR<span class="_ _12"></span>U<span class="_ _d"> </span><span class="ff1">将遗忘门<span class="_ _23"></span>和输入门合并成为单一的“更新门<span class="_ _e"> </span></span>(Up<span class="_ _23"></span>date<span class="_ _25"> </span>Gate)<span class="ff1">”<span class="_ _3e"></span>。<span class="ff3">GRU<span class="_ _25"> </span></span>同<span class="_ _23"></span>时也将元胞</span></span></div><div class="t m0 x3 h6 y955 ff1 fs2 fc0 sc0 ls0 ws0">状态<span class="_ _1e"> </span><span class="ff3">(Cell<span class="_ _e"> </span>State)<span class="_ _1e"> </span></span>和隐<span class="_ _23"></span>状态<span class="_ _1e"> </span><span class="ff3">(Hidden<span class="_ _e"> </span>State)<span class="_ _1e"> </span></span>合并，<span class="_ _23"></span>同时引<span class="_ _23"></span>入其他的<span class="_ _23"></span>一些变<span class="_ _23"></span>化。该模<span class="_ _23"></span>型比标准<span class="_ _23"></span>的</div><div class="t m0 x3 h6 y957 ff3 fs2 fc0 sc0 ls0 ws0">LSTM<span class="_ _d"> </span><span class="ff1">模型更加简化，同时现在也变得越来越流行。</span></div><div class="t m0 x3 h6 ya4f ff1 fs2 fc0 sc0 ls0 ws0">图中，<span class="ffd">r</span></div><div class="t m0 xb8 hb ya50 ffc fs7 fc0 sc0 ls0 ws0">t</div><div class="t m0 x145 h6 ya4f ff1 fs2 fc0 sc0 ls0 ws0">是<span class="_ _d"> </span><span class="ff3">GR<span class="_ _12"></span>U<span class="_ _d"> </span><span class="ff1">模型的重置门部分，用于控制前一时刻隐藏状态<span class="_ _d"> </span><span class="ffd">h</span></span></span></div><div class="t m0 xf7 ha ya50 ffc fs7 fc0 sc0 ls0 ws0">t<span class="ffb">−<span class="ff12">1</span></span></div><div class="t m0 xdf h6 ya4f ff1 fs2 fc0 sc0 ls0 ws0">对当前状态的影响。若</div><div class="t m0 x3 he ya51 ffd fs2 fc0 sc0 ls0 ws0">h</div><div class="t m0 x1be ha ya52 ffc fs7 fc0 sc0 ls0 ws0">t<span class="ffb">−<span class="ff12">1</span></span></div><div class="t m0 x174 h6 ya51 ff1 fs2 fc0 sc0 ls0 ws0">不重要，<span class="_ _29"></span>从语言模型角度看，<span class="_ _30"></span>即从当前开始表达新的意思，<span class="_ _29"></span>与上文无关，<span class="_ _30"></span>则重置门关闭，<span class="_ _30"></span>数</div><div class="t m0 x3 h6 y758 ff1 fs2 fc0 sc0 ls0 ws0">学表达式为：</div><div class="t m0 x11c he y20 ffd fs2 fc0 sc0 ls0 ws0">r</div><div class="t m0 x10 hb y2cd ffc fs7 fc0 sc0 ls0 ws0">t</div><div class="t m0 x172 h4 y20 fff fs2 fc0 sc0 ls0 ws0">=<span class="_ _32"> </span><span class="ffd">σ<span class="_ _38"> </span></span>(<span class="ffd">W</span></div><div class="t m0 x4 hb y2cd ffc fs7 fc0 sc0 ls0 ws0">r</div><div class="t m0 x122 he y20 ffd fs2 fc0 sc0 ls0 ws0">h</div><div class="t m0 x75 ha y2cd ffc fs7 fc0 sc0 ls0 ws0">t<span class="ffb">−<span class="ff12">1</span></span></div><div class="t m0 x12a h4 y20 fff fs2 fc0 sc0 ls0 ws0">+<span class="_ _37"> </span><span class="ffd">U</span></div><div class="t m0 x71 hb y2cd ffc fs7 fc0 sc0 ls0 ws0">r</div><div class="t m0 x39 he y20 ffd fs2 fc0 sc0 ls0 ws0">x</div><div class="t m0 x66 hb y2cd ffc fs7 fc0 sc0 ls0 ws0">t</div><div class="t m0 x25 h4 y20 fff fs2 fc0 sc0 ls0 ws0">+<span class="_ _37"> </span><span class="ffd">b</span></div><div class="t m0 x3a hb y2cd ffc fs7 fc0 sc0 ls0 ws0">r</div><div class="t m0 xb6 h4 y20 fff fs2 fc0 sc0 ls0 ws0">)<span class="_ _6b"> </span><span class="ff3">(11.9)</span></div><div class="t m0 x3 h4 y3 ff3 fs2 fc0 sc0 ls0 ws0">72</div></div><div class="pi" data-data='{"ctm":[1.500000,0.000000,0.000000,1.500000,0.000000,0.000000]}'></div></div>
<div id="pf4f" class="pf w0 h0" data-page-no="4f"><div class="pc pc4f w0 h0"><div class="t m0 x186 h29 y21 ff3 fs5 fc0 sc0 ls0 ws0">11.4<span class="_ _8"> </span>GR<span class="_ _12"></span>U</div><div class="t m0 x3 h6 y22 ff1 fs2 fc0 sc0 ls0 ws0">图中<span class="_ _e"> </span><span class="ffd">z</span></div><div class="t m0 xb9 hb y796 ffc fs7 fc0 sc0 ls0 ws0">t</div><div class="t m0 xf0 h6 y22 ff1 fs2 fc0 sc0 ls0 ws0">是<span class="_ _e"> </span><span class="ff3">GRU<span class="_ _d"> </span></span>模型<span class="_ _23"></span>的更新门<span class="_ _23"></span>部分，用于决<span class="_ _23"></span>定是否忽略<span class="_ _23"></span>当前输入<span class="_ _e"> </span><span class="ffd">x</span></div><div class="t m0 x135 hb y796 ffc fs7 fc0 sc0 ls0 ws0">t</div><div class="t m0 xf7 h6 y22 ff1 fs2 fc0 sc0 ls0 ws0">，类似<span class="_ _1e"> </span><span class="ff3">LSTM<span class="_ _e"> </span></span>中的输入<span class="_ _23"></span>门</div><div class="t m0 x3 he y17d ffd fs2 fc0 sc0 ls0 ws0">i</div><div class="t m0 x1b7 hb y488 ffc fs7 fc0 sc0 ls0 ws0">t</div><div class="t m0 x15c h6 y17d ff1 fs2 fc0 sc0 ls0 ws0">。从语言模型角度看，即判断当前词<span class="_ _d"> </span><span class="ffd">x</span></div><div class="t m0 x80 hb y488 ffc fs7 fc0 sc0 ls0 ws0">t</div><div class="t m0 xa9 h6 y17d ff1 fs2 fc0 sc0 ls0 ws0">对整体意思的表达是否重要，数学表达式为：</div><div class="t m0 x104 he ya53 ffd fs2 fc0 sc0 ls0 ws0">z</div><div class="t m0 x10 hb ya54 ffc fs7 fc0 sc0 ls0 ws0">t</div><div class="t m0 x172 h4 ya53 fff fs2 fc0 sc0 ls0 ws0">=<span class="_ _32"> </span><span class="ffd">σ<span class="_ _38"> </span></span>(<span class="ffd">W</span></div><div class="t m0 x4 hb ya54 ffc fs7 fc0 sc0 ls0 ws0">z</div><div class="t m0 x74 he ya53 ffd fs2 fc0 sc0 ls0 ws0">h</div><div class="t m0 x75 ha ya54 ffc fs7 fc0 sc0 ls0 ws0">t<span class="ffb">−<span class="ff12">1</span></span></div><div class="t m0 x12a h4 ya53 fff fs2 fc0 sc0 ls0 ws0">+<span class="_ _37"> </span><span class="ffd">U</span></div><div class="t m0 x71 hb ya54 ffc fs7 fc0 sc0 ls0 ws0">z</div><div class="t m0 x39 he ya53 ffd fs2 fc0 sc0 ls0 ws0">x</div><div class="t m0 x124 hb ya54 ffc fs7 fc0 sc0 ls0 ws0">t</div><div class="t m0 x25 h4 ya53 fff fs2 fc0 sc0 ls0 ws0">+<span class="_ _37"> </span><span class="ffd">b</span></div><div class="t m0 x3a hb ya54 ffc fs7 fc0 sc0 ls0 ws0">z</div><div class="t m0 xb6 h4 ya53 fff fs2 fc0 sc0 ls0 ws0">)<span class="_ _6c"> </span><span class="ff3">(11.10)</span></div><div class="t m0 x3 h6 y35c ff1 fs2 fc0 sc0 ls0 ws0">定义完<span class="_ _1e"> </span><span class="ff3">GR<span class="_ _12"></span>U<span class="_ _e"> </span><span class="ff1">的<span class="_ _23"></span>重置门和<span class="_ _23"></span>更新门之<span class="_ _23"></span>后，我们再<span class="_ _23"></span>来看<span class="_ _e"> </span></span>GRU<span class="_ _e"> </span><span class="ff1">的细胞<span class="_ _23"></span>更新。当<span class="_ _23"></span>更新门打<span class="_ _23"></span>开时，<span class="ffd">h</span></span></span></div><div class="t m0 x1bf hb ya55 ffc fs7 fc0 sc0 ls0 ws0">t</div><div class="t m0 xbc h6 y35c ff1 fs2 fc0 sc0 ls0 ws0">由</div><div class="t m0 x3 he y48c ffd fs2 fc0 sc0 ls0 ws0">h</div><div class="t m0 x1be ha ya56 ffc fs7 fc0 sc0 ls0 ws0">t<span class="ffb">−<span class="ff12">1</span></span></div><div class="t m0 x174 h6 y48c ff1 fs2 fc0 sc0 ls0 ws0">和<span class="_ _25"> </span><span class="ffd">x</span></div><div class="t m0 x145 hb ya56 ffc fs7 fc0 sc0 ls0 ws0">t</div><div class="t m0 x168 h6 y48c ff1 fs2 fc0 sc0 ls0 ws0">决定；<span class="_ _27"></span>当更新门被关闭时，<span class="_ _27"></span><span class="ffd">h</span></div><div class="t m0 x94 ha ya56 ffc fs7 fc0 sc0 ls0 ws0">t<span class="ffb">−<span class="ff12">1</span></span></div><div class="t m0 x1 h6 y48c ff1 fs2 fc0 sc0 ls0 ws0">将仅由<span class="_ _25"> </span><span class="ffd">h</span></div><div class="t m0 x9e ha ya56 ffc fs7 fc0 sc0 ls0 ws0">t<span class="ffb">−<span class="ff12">1</span></span></div><div class="t m0 x14f h6 y48c ff1 fs2 fc0 sc0 ls0 ws0">决定，<span class="_ _27"></span>帮助梯度反向传播，<span class="_ _27"></span>与<span class="_ _25"> </span><span class="ff3">LSTM<span class="_ _d"> </span></span>相</div><div class="t m0 x3 h6 y48d ff1 fs2 fc0 sc0 ls0 ws0">同，这种机制有效地缓解了梯度消失现象。数学表达式为：</div><div class="t m0 x31 h4 ya57 fff fs2 fc0 sc0 ls0 ws0">˜</div><div class="t m0 x31 he ya58 ffd fs2 fc0 sc0 ls0 ws0">h</div><div class="t m0 x93 hb ya59 ffc fs7 fc0 sc0 ls0 ws0">t</div><div class="t m0 x2 h4 ya58 fff fs2 fc0 sc0 ls0 ws0">=<span class="_ _32"> </span><span class="ff3">tanh<span class="_ _31"> </span></span>(<span class="ffd">W<span class="_ _33"> </span>r</span></div><div class="t m0 x100 hb ya59 ffc fs7 fc0 sc0 ls0 ws0">t</div><div class="t m0 x97 h4 ya58 ffe fs2 fc0 sc0 ls0 ws0">⊙<span class="_ _37"> </span><span class="ffd">h</span></div><div class="t m0 xaa ha ya59 ffc fs7 fc0 sc0 ls0 ws0">t<span class="ffb">−<span class="ff12">1</span></span></div><div class="t m0 x21 h4 ya58 fff fs2 fc0 sc0 ls0 ws0">+<span class="_ _37"> </span><span class="ffd">U<span class="_ _34"></span>x</span></div><div class="t m0 x11d hb ya59 ffc fs7 fc0 sc0 ls0 ws0">t</div><div class="t m0 x3a h4 ya58 fff fs2 fc0 sc0 ls0 ws0">+<span class="_ _37"> </span><span class="ffd">b</span></div><div class="t m0 xae hb ya5a ffc fs7 fc0 sc0 ls0 ws0">f</div><div class="t m0 x11e h4 ya58 fff fs2 fc0 sc0 ls0 ws0">)<span class="_ _6d"> </span><span class="ff3">(11.11)</span></div><div class="t m0 x4d he ya5b ffd fs2 fc0 sc0 ls0 ws0">h</div><div class="t m0 xff hb ya5c ffc fs7 fc0 sc0 ls0 ws0">t</div><div class="t m0 x73 h4 ya5b fff fs2 fc0 sc0 ls0 ws0">=<span class="_ _32"> </span>(1<span class="_ _37"> </span><span class="ffe">−<span class="_ _37"> </span><span class="ffd">z</span></span></div><div class="t m0 xc2 hb ya5c ffc fs7 fc0 sc0 ls0 ws0">t</div><div class="t m0 xd9 h4 ya5b fff fs2 fc0 sc0 ls0 ws0">)<span class="_ _37"> </span><span class="ffe">⊙<span class="_ _37"> </span><span class="ffd">h</span></span></div><div class="t m0 x126 ha ya5c ffc fs7 fc0 sc0 ls0 ws0">t<span class="ffb">−<span class="ff12">1</span></span></div><div class="t m0 x1a7 h4 ya5b fff fs2 fc0 sc0 ls0 ws0">+<span class="_ _37"> </span><span class="ffd">z</span></div><div class="t m0 x1e hb ya5c ffc fs7 fc0 sc0 ls0 ws0">t</div><div class="t m0 x61 h4 ya5b ffe fs2 fc0 sc0 ls0 ws0">⊙</div><div class="t m0 xa0 h4 ya5d fff fs2 fc0 sc0 ls0 ws0">˜</div><div class="t m0 xa0 he ya5b ffd fs2 fc0 sc0 ls0 ws0">h</div><div class="t m0 x140 hb ya5c ffc fs7 fc0 sc0 ls0 ws0">t</div><div class="t m0 x68 h4 ya5b ff3 fs2 fc0 sc0 ls0 ws0">(11.12)</div><div class="t m0 xbc h4 y3 ff3 fs2 fc0 sc0 ls0 ws0">73</div></div><div class="pi" data-data='{"ctm":[1.500000,0.000000,0.000000,1.500000,0.000000,0.000000]}'></div></div>
<div id="pf50" class="pf w0 h0" data-page-no="50"><div class="pc pc50 w0 h0"><div class="t m0 x3 h29 y21 ff3 fs5 fc0 sc0 ls0 ws0">11.4<span class="_ _8"> </span>GR<span class="_ _12"></span>U</div><div class="t m0 x3 h4 y3 ff3 fs2 fc0 sc0 ls0 ws0">74</div></div><div class="pi" data-data='{"ctm":[1.500000,0.000000,0.000000,1.500000,0.000000,0.000000]}'></div></div>
<div id="pf51" class="pf w0 h0" data-page-no="51"><div class="pc pc51 w0 h0"><img class="bi x3 ya5e w23 h71" alt="" src="bg51.png"/><div class="t m0 x50 h5 y4 ff4 fs3 fc0 sc0 ls0 ws0">第十二章 <span class="ff5">Seq2Seq</span></div><div class="t m0 xd7 h4d y66 ff5 fs6 fc0 sc0 ls0 ws0">12.1<span class="_ _24"> </span>Enco<span class="_ _23"></span>der-Deco<span class="_ _23"></span>der</div><div class="t m0 x3 h6 ya5f ff3 fs2 fc0 sc0 ls0 ws0">Kyungh<span class="_ _12"></span>yun Cho<span class="_ _25"> </span><span class="ff1">等人在<span class="_ _25"> </span></span>2014<span class="_ _25"> </span><span class="ff1">年<span class="_ _32"> </span></span>6<span class="_ _25"> </span><span class="ff1">月<span class="_ _25"> </span></span>3<span class="_ _25"> </span><span class="ff1">日将论文<span class="_ _29"></span>《<span class="ff3">Learning Phrase<span class="_ _25"> </span>Representations using<span class="_ _25"> </span>RNN</span></span></div><div class="t m0 x3 h6 ya60 ff3 fs2 fc0 sc0 ls0 ws0">Enco<span class="_ _23"></span>der<span class="_ _2d"></span><span class="ff1">–<span class="_ _2a"></span><span class="ff3">Deco<span class="_ _23"></span>der for<span class="_ _25"> </span>Statistical<span class="_ _25"> </span>Machine T<span class="_ _27"></span>ranslation<span class="ff1">》<span class="_ _30"></span>发布于<span class="_ _25"> </span><span class="ff3">Arxiv</span>，<span class="_ _29"></span>提出了<span class="_ _32"> </span><span class="ff3">Enco<span class="_ _23"></span>der<span class="_ _2a"></span><span class="ff1">–<span class="_ _2d"></span><span class="ff3">Deco<span class="_ _23"></span>der</span></span></span></span></span></span></div><div class="t m0 x3 h6 ya61 ff1 fs2 fc0 sc0 ls0 ws0">模型结构。论文提出的<span class="_ _d"> </span><span class="ff3">RNN<span class="_ _d"> </span>Enco<span class="_ _23"></span>der-Decoder<span class="_ _d"> </span></span>模型由两个<span class="_ _d"> </span><span class="ff3">RNN<span class="_ _d"> </span></span>组成：</div><div class="t m0 x3 h6 ya62 ff4 fs2 fc0 sc0 ls0 ws0">简要地回顾<span class="_ _e"> </span><span class="ff6">RNN<span class="_ _1e"> </span></span>的知识：</div><div class="t m0 x3 h6 ya63 ff3 fs2 fc0 sc0 ls0 ws0">RNN <span class="ff1">是一个包含隐藏状态<span class="_ _25"> </span><span class="ff10">h<span class="_ _25"> </span></span>和可选输出<span class="_ _32"> </span><span class="ff10">y<span class="_ _d"> </span></span>的神经网络，<span class="_ _2e"></span>它接受可变长序列<span class="_ _25"> </span><span class="ff10">x<span class="_ _32"> </span><span class="fff">=<span class="_ _32"> </span>(<span class="ffd">x</span></span></span></span></div><div class="t m0 x117 ha ya64 ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 x1b he ya63 ffd fs2 fc0 sc0 ls0 ws0">,<span class="_ _31"> </span>.<span class="_ _31"> </span>.<span class="_ _31"> </span>.<span class="_ _31"> </span>,<span class="_ _31"> </span>x</div><div class="t m0 x19d hb ya65 ffc fs7 fc0 sc0 ls0 ws0">T</div><div class="t m0 x1bf h6 ya63 fff fs2 fc0 sc0 ls0 ws0">)<span class="_ _32"> </span><span class="ff1">的</span></div><div class="t m0 x3 h6 ya66 ff1 fs2 fc0 sc0 ls0 ws0">输入。在每个时间步，隐藏状态<span class="_ _d"> </span><span class="ff10">h</span></div><div class="t m0 xff ha ya67 ffb fs7 fc0 sc0 ls0 ws0">⟨<span class="ffc">t</span>⟩</div><div class="t m0 x48 h6 ya66 ff1 fs2 fc0 sc0 ls0 ws0">按照如下公式更新：</div><div class="t m0 xd6 h3f ya68 ff15 fs2 fc0 sc0 ls0 ws0">h</div><div class="t m0 x16 ha ya69 ffb fs7 fc0 sc0 ls0 ws0">⟨<span class="ffc">t</span>⟩</div><div class="t m0 x24 h4 ya68 fff fs2 fc0 sc0 ls0 ws0">=<span class="_ _32"> </span><span class="ffd">f</span></div><div class="t m0 xc3 hc ya6a ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x98 h3f ya68 ff15 fs2 fc0 sc0 ls0 ws0">h</div><div class="t m0 x2b ha ya69 ffb fs7 fc0 sc0 ls0 ws0">⟨<span class="ffc">t</span>−<span class="ff12">1</span>⟩</div><div class="t m0 x71 he ya68 ffd fs2 fc0 sc0 ls0 ws0">,<span class="_ _31"> </span>x</div><div class="t m0 x124 hb ya6b ffc fs7 fc0 sc0 ls0 ws0">t</div><div class="t m0 x148 hc ya6a ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x3 h6 ya6c ff1 fs2 fc0 sc0 ls0 ws0">其中<span class="_ _25"> </span><span class="ffd">f<span class="_ _1e"> </span></span>是非线性激活函数。<span class="_ _30"></span><span class="ffd">f<span class="_ _1e"> </span><span class="ff1">可以像<span class="_ _25"> </span><span class="ff3">logistic</span>、<span class="_ _29"></span><span class="ff3">sigmoid<span class="_ _25"> </span>function<span class="_ _25"> </span><span class="ff1">一样简单，<span class="_ _29"></span>也可以像<span class="_ _25"> </span><span class="ff3">long short-</span></span></span></span></span></div><div class="t m0 x3 h6 ya6d ff3 fs2 fc0 sc0 ls0 ws0">term<span class="_ _d"> </span>memory<span class="ff1">（</span>LSTM<span class="ff1">）一样复杂。</span></div><div class="t m0 x3 h6 ya6e ff1 fs2 fc0 sc0 ls0 ws0">以输入序列的下一个字符作为预测目标来训练，<span class="_ _2e"></span><span class="ff3">RNN <span class="ff1">可以学习序列上的概率分布</span></span></div><div class="t m0 x116 h12 ya6f ff14 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 x188 h6 ya6e ff1 fs2 fc0 sc0 ls0 ws0">。<span class="_ _2e"></span>在这种情况</div><div class="t m0 x3 h6 ya70 ff1 fs2 fc0 sc0 ls0 ws0">下，<span class="_ _30"></span>每个时间步长<span class="_ _25"> </span><span class="ff3">t<span class="_ _d"> </span></span>的输出是条件分布<span class="_ _25"> </span><span class="ffd">p<span class="_ _31"> </span><span class="fff">(</span>x</span></div><div class="t m0 x1 hb ya71 ffc fs7 fc0 sc0 ls0 ws0">t</div><div class="t m0 xc2 h4 ya70 ffe fs2 fc0 sc0 ls0 ws0">|<span class="ffd">x</span></div><div class="t m0 x97 ha ya71 ffc fs7 fc0 sc0 ls0 ws0">t<span class="ffb">−<span class="ff12">1</span></span></div><div class="t m0 xc9 he ya70 ffd fs2 fc0 sc0 ls0 ws0">,<span class="_ _31"> </span>.<span class="_ _31"> </span>.<span class="_ _31"> </span>.<span class="_ _31"> </span>,<span class="_ _31"> </span>x</div><div class="t m0 x124 ha ya71 ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 x148 h6 ya70 fff fs2 fc0 sc0 ls0 ws0">)<span class="ff1">。<span class="_ _27"></span>例如，<span class="_ _30"></span>对于所有<span class="_ _25"> </span><span class="ffd">j<span class="_ _d"> </span><span class="fff">=<span class="_ _32"> </span>1</span>,<span class="_ _31"> </span><span class="ffe">·<span class="_ _31"></span>·<span class="_ _31"></span>·<span class="_ _d"> </span></span>,<span class="_ _31"> </span>K<span class="_ _51"></span></span>，<span class="_ _30"></span>可以</span></div><div class="t m0 x3 h6 ya72 ff1 fs2 fc0 sc0 ls0 ws0">使用<span class="_ _d"> </span><span class="ff3">softmax<span class="_ _d"> </span></span>激活函数输出多项式分布（<span class="ff3">1-K<span class="_ _d"> </span></span>编码）</div><div class="t m0 x8c h4 ya73 ffd fs2 fc0 sc0 ls0 ws0">p<span class="_ _31"> </span><span class="fff">(</span>x</div><div class="t m0 x58 hb ya74 ffc fs7 fc0 sc0 ls0 ws0">t,j</div><div class="t m0 x133 h4 ya73 fff fs2 fc0 sc0 ls0 ws0">=<span class="_ _32"> </span>1<span class="ffe">|<span class="ffd">x</span></span></div><div class="t m0 x111 ha ya74 ffc fs7 fc0 sc0 ls0 ws0">t<span class="ffb">−<span class="ff12">1</span></span></div><div class="t m0 x32 he ya73 ffd fs2 fc0 sc0 ls0 ws0">,<span class="_ _31"> </span>.<span class="_ _31"> </span>.<span class="_ _31"> </span>.<span class="_ _31"> </span>,<span class="_ _31"> </span>x</div><div class="t m0 x97 ha ya74 ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 xa h4 ya73 fff fs2 fc0 sc0 ls0 ws0">)<span class="_ _32"> </span>=</div><div class="t m0 x78 h4 ya75 ff3 fs2 fc0 sc0 ls0 ws0">exp</div><div class="t m0 x9f hc ya76 ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x1aa h3f ya75 ff15 fs2 fc0 sc0 ls0 ws0">w</div><div class="t m0 xac hb ya77 ffc fs7 fc0 sc0 ls0 ws0">j</div><div class="t m0 xad h3f ya75 ff15 fs2 fc0 sc0 ls0 ws0">h</div><div class="t m0 xe8 ha ya78 ffb fs7 fc0 sc0 ls0 ws0">⟨<span class="ffc">t</span>⟩</div><div class="t m0 x115 hc ya76 ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 xcf hc ya79 ff11 fs2 fc0 sc0 ls0 ws0">P</div><div class="t m0 x60 hb ya7a ffc fs7 fc0 sc0 ls0 ws0">K</div><div class="t m0 x60 hb ya7b ffc fs7 fc0 sc0 ls0 ws0">j</div><div class="t m0 x99 h1f ya7c ff17 fs9 fc0 sc0 ls0 ws0">′</div><div class="t m0 x37 ha ya7b ff12 fs7 fc0 sc0 ls0 ws0">=1</div><div class="t m0 x61 h4 ya7d ff3 fs2 fc0 sc0 ls0 ws0">exp</div><div class="t m0 xcb hc ya7e ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x7b h3f ya7d ff15 fs2 fc0 sc0 ls0 ws0">w</div><div class="t m0 x11e hb ya7f ffc fs7 fc0 sc0 ls0 ws0">j</div><div class="t m0 x7c h1f ya80 ff17 fs9 fc0 sc0 ls0 ws0">′</div><div class="t m0 x115 h3f ya7d ff15 fs2 fc0 sc0 ls0 ws0">h</div><div class="t m0 x15e ha ya81 ffb fs7 fc0 sc0 ls0 ws0">⟨<span class="ffc">t</span>⟩</div><div class="t m0 x6a hc ya7e ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x86 h4 ya73 ff3 fs2 fc0 sc0 ls0 ws0">(12.1)</div><div class="t m0 x3 h6 ya82 ff1 fs2 fc0 sc0 ls0 ws0">其中<span class="_ _d"> </span><span class="ff10">w</span></div><div class="t m0 xef hb ya83 ffc fs7 fc0 sc0 ls0 ws0">j</div><div class="t m0 x14c h6 ya82 ff1 fs2 fc0 sc0 ls0 ws0">是权重矩阵<span class="_ _d"> </span><span class="ff10">W<span class="_ _0"> </span></span>的行。通过组合这些概率，我们可以用如下公式计算序列<span class="_ _d"> </span><span class="ff10">x<span class="_ _d"> </span></span>的概率<span class="ff3">:</span></div><div class="t m0 x104 h4 ya84 ffd fs2 fc0 sc0 ls0 ws0">p<span class="fff">(<span class="ff15">x</span>)<span class="_ _32"> </span>=</span></div><div class="t m0 x33 hb ya85 ffc fs7 fc0 sc0 ls0 ws0">T</div><div class="t m0 x23 hc ya86 ff11 fs2 fc0 sc0 ls0 ws0">Y</div><div class="t m0 x23 ha ya87 ffc fs7 fc0 sc0 ls0 ws0">t<span class="ff12">=1</span></div><div class="t m0 xc2 h4 ya84 ffd fs2 fc0 sc0 ls0 ws0">p<span class="_ _31"> </span><span class="fff">(</span>x</div><div class="t m0 x13c hb ya88 ffc fs7 fc0 sc0 ls0 ws0">t</div><div class="t m0 x2b h4 ya84 ffe fs2 fc0 sc0 ls0 ws0">|<span class="ffd">x</span></div><div class="t m0 x128 ha ya88 ffc fs7 fc0 sc0 ls0 ws0">t<span class="ffb">−<span class="ff12">1</span></span></div><div class="t m0 x77 he ya84 ffd fs2 fc0 sc0 ls0 ws0">,<span class="_ _31"> </span>.<span class="_ _31"> </span>.<span class="_ _31"> </span>.<span class="_ _31"> </span>,<span class="_ _31"> </span>x</div><div class="t m0 x3a ha ya88 ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 xb6 h4 ya84 fff fs2 fc0 sc0 ls0 ws0">)<span class="_ _6e"> </span><span class="ff3">(12.2)</span></div><div class="t m0 x3 h6 ya89 ff1 fs2 fc0 sc0 ls0 ws0">从这个学习的分布中，通过在每个时间步长迭代采样符号来直接抽样新序列。</div><div class="t m0 x182 h35 ya8a ff22 fs9 fc0 sc0 ls0 ws0">1</div><div class="t m0 x17c h72 y20 ff1 fs1f fc0 sc0 ls0 ws0">此时，<span class="ff3f">RNN<span class="_ _32"> </span></span>的拟合目标就是这个概率分布。</div><div class="t m0 xc3 h4 y3 ff3 fs2 fc0 sc0 ls0 ws0">75</div><a class="l" href="#pf51" data-dest-detail='[81,"XYZ",87.01,53.48,null]'><div class="d m1" style="border-style:none;position:absolute;left:684.250500px;bottom:340.692000px;width:4.232000px;height:11.294000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.500000,0.000000,0.000000,1.500000,0.000000,0.000000]}'></div></div>
<div id="pf52" class="pf w0 h0" data-page-no="52"><div class="pc pc52 w0 h0"><img class="bi xdc ya8b w8 h73" alt="" src="bg52.png"/><div class="t m0 x3 h29 y21 ff3 fs5 fc0 sc0 ls0 ws0">12.2<span class="_ _8"> </span>SEQ2SEQ</div><div class="t m0 x3 h6 y22 ff6 fs2 fc0 sc0 ls0 ws0">RNN<span class="_ _e"> </span>Enco<span class="_ _23"></span>der-Deco<span class="_ _23"></span>der<span class="_ _e"> </span><span class="ff4">模型：</span></div><div class="t m0 x3 h6 y5c ff3 fs2 fc2 sc0 ls0 ws0">Enco<span class="_ _23"></span>der<span class="_ _d"> </span><span class="ff1">将输入序列<span class="_ _d"> </span><span class="ffd">X<span class="_ _35"> </span></span>编码为一<span class="_ _23"></span>个<span class="ff4">固定长度</span>的向量<span class="_ _d"> </span><span class="ff10">c</span>，</span>Deco<span class="_ _23"></span>der<span class="_ _d"> </span><span class="ff1">将输入的<span class="ff4">固定长<span class="_ _23"></span>度</span>向量<span class="_ _d"> </span><span class="ff10">c<span class="_ _d"> </span></span>解码</span></div><div class="t m0 x3 h6 y88 ff1 fs2 fc2 sc0 ls0 ws0">成输出<span class="_ _23"></span>序列<span class="_ _e"> </span><span class="ffd">Y<span class="_ _37"> </span></span>。<span class="fc0">从<span class="_ _23"></span>概率的角<span class="_ _23"></span>度来看，这<span class="_ _23"></span>种结构<span class="_ _23"></span>是一种通<span class="_ _23"></span>用方法，可<span class="_ _23"></span>学习一个<span class="_ _23"></span>可变长<span class="_ _23"></span>序列在另<span class="_ _23"></span>一</span></div><div class="t m0 x3 h6 y89 ff1 fs2 fc0 sc0 ls0 ws0">个可变长序列下的条件分布：<span class="_ _28"></span><span class="ffd">p<span class="_ _31"> </span><span class="fff">(</span>y</span></div><div class="t m0 x4d ha y652 ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 x4e he y89 ffd fs2 fc0 sc0 ls0 ws0">,<span class="_ _31"> </span>.<span class="_ _31"> </span>.<span class="_ _31"> </span>.<span class="_ _31"> </span>,<span class="_ _31"> </span>y</div><div class="t m0 x5b hb ya8c ffc fs7 fc0 sc0 ls0 ws0">T</div><div class="t m0 x33 h1f ya8d ff17 fs9 fc0 sc0 ls0 ws0">′</div><div class="t m0 x17 h4 y89 ffe fs2 fc0 sc0 ls0 ws0">|<span class="ffd">x</span></div><div class="t m0 x122 ha y652 ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 x123 he y89 ffd fs2 fc0 sc0 ls0 ws0">,<span class="_ _31"> </span>.<span class="_ _31"> </span>.<span class="_ _31"> </span>.<span class="_ _31"> </span>,<span class="_ _31"> </span>x</div><div class="t m0 x2a hb ya8e ffc fs7 fc0 sc0 ls0 ws0">T</div><div class="t m0 x21 h6 y89 fff fs2 fc0 sc0 ls0 ws0">)<span class="ff1">，<span class="_ _28"></span>值得注意的是代表了输入序列长度的<span class="_ _d"> </span><span class="ffd">T</span></span></div><div class="t m0 x3 h6 y35c ff1 fs2 fc0 sc0 ls0 ws0">和输出序列长度<span class="_ _d"> </span><span class="ffd">T</span></div><div class="t m0 xd5 ha ya8f ffb fs7 fc0 sc0 ls0 ws0">′</div><div class="t m0 x1b2 h6 y35c ff1 fs2 fc0 sc0 ls0 ws0">可以不一样。</div><div class="t m0 x3 h6 y8b ff1 fs2 fc0 sc0 ls0 ws0">编码器是一个<span class="_ _d"> </span><span class="ff3">RNN</span>，<span class="_ _23"></span>依次读取输入序列<span class="_ _d"> </span><span class="ff10">x<span class="_ _d"> </span></span>的每<span class="_ _23"></span>个字符。当它读取每个字符时，<span class="ff3">RNN<span class="_ _d"> </span></span>的隐<span class="_ _23"></span>层状</div><div class="t m0 x3 h6 ya90 ff1 fs2 fc0 sc0 ls0 ws0">态会根据公式（<span class="ff3">1</span>）改变。当读到序列的结尾（由<span class="_ _d"> </span><span class="ff3">end-of-sequence<span class="_ _d"> </span></span>符号标记）后，<span class="ff3">RNN<span class="_ _d"> </span></span>隐层状</div><div class="t m0 x3 h6 ya91 ff1 fs2 fc0 sc0 ls0 ws0">态<span class="_ _d"> </span><span class="ff10">c<span class="_ _d"> </span></span>包含了整个输入序列的信息。</div><div class="t m0 x3 h6 ya92 ff1 fs2 fc0 sc0 ls0 ws0">模型的解码器是另一个<span class="_ _25"> </span><span class="ff3">RNN</span>，<span class="_ _29"></span>通过给定隐藏状态<span class="_ _25"> </span><span class="ff10">h</span></div><div class="t m0 xcf ha ya93 ffb fs7 fc0 sc0 ls0 ws0">⟨<span class="ffc">t</span>⟩</div><div class="t m0 x39 h6 ya92 ff1 fs2 fc0 sc0 ls0 ws0">和下一个输出字符<span class="_ _25"> </span><span class="ffd">y</span></div><div class="t m0 xa5 hb ya94 ffc fs7 fc0 sc0 ls0 ws0">t</div><div class="t m0 x121 h6 ya92 ff1 fs2 fc0 sc0 ls0 ws0">，<span class="_ _29"></span>解码器被训练输出</div><div class="t m0 x3 h6 y490 ff1 fs2 fc0 sc0 ls0 ws0">序列。<span class="_ _12"></span>然而，<span class="_ _28"></span>与上述的<span class="_ _d"> </span><span class="ff3">RNN<span class="_ _d"> </span></span>不同，<span class="_ _28"></span><span class="ffd">y</span></div><div class="t m0 x48 hb ya95 ffc fs7 fc0 sc0 ls0 ws0">t</div><div class="t m0 x95 h6 y490 ff1 fs2 fc0 sc0 ls0 ws0">和<span class="_ _25"> </span><span class="ffd">h</span></div><div class="t m0 x1 hb ya95 ffc fs7 fc0 sc0 ls0 ws0">t</div><div class="t m0 x100 h6 y490 ff1 fs2 fc0 sc0 ls0 ws0">都受制于<span class="_ _25"> </span><span class="ffd">y</span></div><div class="t m0 x14f ha ya95 ffc fs7 fc0 sc0 ls0 ws0">t<span class="ff14">−<span class="ff12">1</span></span></div><div class="t m0 x62 h6 y490 ff1 fs2 fc0 sc0 ls0 ws0">和<span class="_ _25"> </span><span class="ff3">Enco<span class="_ _23"></span>der<span class="_ _d"> </span></span>隐藏状态<span class="_ _d"> </span><span class="ffd">c</span>。<span class="_ _28"></span>因此，在<span class="_ _25"> </span><span class="ff3">t</span></div><div class="t m0 x3 h6 y491 ff1 fs2 fc0 sc0 ls0 ws0">时刻解码器的隐藏状态是由下述公式计算：</div><div class="t m0 x172 h3f ya96 ff15 fs2 fc0 sc0 ls0 ws0">h</div><div class="t m0 x48 ha ya97 ffb fs7 fc0 sc0 ls0 ws0">⟨<span class="ffc">t</span>⟩</div><div class="t m0 x52 h4 ya96 fff fs2 fc0 sc0 ls0 ws0">=<span class="_ _32"> </span><span class="ffd">f</span></div><div class="t m0 x74 hc ya98 ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x123 h3f ya96 ff15 fs2 fc0 sc0 ls0 ws0">h</div><div class="t m0 x5e ha ya97 ffb fs7 fc0 sc0 ls0 ws0">⟨<span class="ffc">t</span>−<span class="ff12">1</span>⟩</div><div class="t m0 xf5 he ya96 ffd fs2 fc0 sc0 ls0 ws0">,<span class="_ _31"> </span>y</div><div class="t m0 x21 ha ya99 ffc fs7 fc0 sc0 ls0 ws0">t<span class="ffb">−<span class="ff12">1</span></span></div><div class="t m0 x148 he ya96 ffd fs2 fc0 sc0 ls0 ws0">,<span class="_ _31"> </span><span class="ff15">c</span></div><div class="t m0 x26 hc ya98 ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x86 h4 ya96 ff3 fs2 fc0 sc0 ls0 ws0">(12.3)</div><div class="t m0 x3 h6 ya9a ff1 fs2 fc0 sc0 ls0 ws0">类似的，下一个<span class="_ _d"> </span><span class="ff3">sym<span class="_ _12"></span>b<span class="_ _23"></span>ol<span class="_ _25"> </span><span class="ff1">的条件分布为：</span></span></div><div class="t m0 x3f h4 ya9b ffd fs2 fc0 sc0 ls0 ws0">P<span class="_ _25"> </span><span class="fff">(</span>y</div><div class="t m0 x17a hb ya9c ffc fs7 fc0 sc0 ls0 ws0">t</div><div class="t m0 x6d h4 ya9b ffe fs2 fc0 sc0 ls0 ws0">|<span class="ffd">y</span></div><div class="t m0 x4d ha ya9c ffc fs7 fc0 sc0 ls0 ws0">t<span class="ffb">−<span class="ff12">1</span></span></div><div class="t m0 x72 he ya9b ffd fs2 fc0 sc0 ls0 ws0">,<span class="_ _31"> </span>y</div><div class="t m0 x28 ha ya9c ffc fs7 fc0 sc0 ls0 ws0">t<span class="ffb">−<span class="ff12">2</span></span></div><div class="t m0 x9d he ya9b ffd fs2 fc0 sc0 ls0 ws0">,<span class="_ _31"> </span>.<span class="_ _31"> </span>.<span class="_ _31"> </span>.<span class="_ _31"> </span>,<span class="_ _31"> </span>y</div><div class="t m0 x81 ha ya9c ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 x2b h4 ya9b ffd fs2 fc0 sc0 ls0 ws0">,<span class="_ _31"> </span><span class="ff15">c<span class="fff">)<span class="_ _32"> </span>=<span class="_ _32"> </span></span></span>g</div><div class="t m0 xab hc ya9d ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x1c0 h3f ya9b ff15 fs2 fc0 sc0 ls0 ws0">h</div><div class="t m0 x11d ha ya9e ff12 fs7 fc0 sc0 ls0 ws0">(<span class="ffc">t</span>)</div><div class="t m0 xc4 he ya9b ffd fs2 fc0 sc0 ls0 ws0">,<span class="_ _31"> </span>y</div><div class="t m0 x7b ha ya9c ffc fs7 fc0 sc0 ls0 ws0">t<span class="ffb">−<span class="ff12">1</span></span></div><div class="t m0 x115 he ya9b ffd fs2 fc0 sc0 ls0 ws0">,<span class="_ _31"> </span><span class="ff15">c</span></div><div class="t m0 x125 hc ya9d ff11 fs2 fc0 sc0 ls0 ws0"></div><div class="t m0 x86 h4 ya9b ff3 fs2 fc0 sc0 ls0 ws0">(12.4)</div><div class="t m0 x3 h6 ya9f ffd fs2 fc0 sc0 ls0 ws0">f<span class="_ _35"> </span><span class="ff1">与<span class="_ _d"> </span></span>g<span class="_ _e"> </span><span class="ff1">为激活函数，</span>g<span class="_ _1e"> </span><span class="ff1">必须能生成有效的概率，比如利用<span class="_ _25"> </span><span class="ff3">softmax</span>。</span></div><div class="t m0 x73 h4d yaa0 ff5 fs6 fc0 sc0 ls0 ws0">12.2<span class="_ _24"> </span>Seq2Seq</div><div class="t m0 x3 h6 yaa1 ff1 fs2 fc0 sc0 ls0 ws0">正式<span class="_ _23"></span>提出<span class="_ _35"> </span><span class="ff3">Sequence<span class="_ _1e"> </span>to<span class="_ _35"> </span>Sequence<span class="_ _35"> </span></span>的文<span class="_ _23"></span>章是<span class="_ _23"></span>《<span class="ff3">Sequence<span class="_ _1e"> </span>to<span class="_ _35"> </span>Sequence<span class="_ _1e"> </span>Learning<span class="_ _35"> </span>with<span class="_ _35"> </span>Neural<span class="_ _1e"> </span>Net-</span></div><div class="t m0 x3 h6 yaa2 ff3 fs2 fc0 sc0 ls0 ws0">w<span class="_ _12"></span>orks<span class="ff1">》<span class="_ _3b"></span>。<span class="ff6">Sequence<span class="_ _1e"> </span>to<span class="_ _1e"> </span>Sequence<span class="_ _1e"> </span><span class="ff4">的<span class="_ _23"></span>意思是：输入一个<span class="_ _23"></span>序列，输出另一个<span class="_ _23"></span>序列。<span class="ff3">Seq2Seq<span class="_ _d"> </span></span></span></span>一词</span></div><div class="t m0 x3 h6 yaa3 ff1 fs2 fc0 sc0 ls0 ws0">带有<span class="_ _23"></span>歧义，<span class="_ _23"></span>在原<span class="_ _23"></span>论文<span class="_ _23"></span>中，<span class="ff3">Seq2Seq<span class="_ _1e"> </span></span>指代<span class="_ _23"></span>输入<span class="_ _23"></span>和输<span class="_ _23"></span>出都是<span class="_ _23"></span>序列<span class="_ _23"></span>的机<span class="_ _23"></span>器学<span class="_ _23"></span>习任<span class="_ _23"></span>务，但现<span class="_ _23"></span>在很<span class="_ _23"></span>多人<span class="_ _23"></span>都</div><div class="t m0 x3 h6 yaa4 ff1 fs2 fc0 sc0 ls0 ws0">将<span class="_ _e"> </span><span class="ff3">Seq2Seq<span class="_ _1e"> </span></span>视作<span class="_ _23"></span>一种模型，<span class="_ _23"></span>或者特<span class="_ _23"></span>指原文论<span class="_ _23"></span>中的模型。<span class="_ _23"></span>在我看<span class="_ _23"></span>来，<span class="ff3">Seq2Seq<span class="_ _e"> </span></span>更准<span class="_ _23"></span>确的含义<span class="_ _23"></span>是序</div><div class="t m0 x3 h6 yaa5 ff1 fs2 fc0 sc0 ls0 ws0">列学习<span class="_ _23"></span>任务，而不是<span class="_ _23"></span>作为模型的<span class="_ _23"></span>概念。即使<span class="_ _e"> </span><span class="ff3">Seq2Seq<span class="_ _1e"> </span></span>指代模型，<span class="_ _23"></span>也应该是<span class="_ _23"></span>一类模型（输<span class="_ _23"></span>入和输</div><div class="t m0 x3 h6 yaa6 ff1 fs2 fc0 sc0 ls0 ws0">出都<span class="_ _23"></span>是序列的<span class="_ _23"></span>模型）<span class="_ _55"></span>，而<span class="_ _23"></span>不是一<span class="_ _23"></span>种模型。之<span class="_ _23"></span>所以强调<span class="_ _1e"> </span><span class="ff3">Seq2Seq<span class="_ _e"> </span></span>的<span class="_ _23"></span>含义，是<span class="_ _23"></span>因为<span class="_ _e"> </span><span class="ff3">Seq2Seq<span class="_ _1e"> </span></span>往往和</div><div class="t m0 x3 h6 yaa7 ff3 fs2 fc0 sc0 ls0 ws0">Enco<span class="_ _23"></span>der-Decoder<span class="_ _25"> </span><span class="ff1">有关，<span class="_ _3a"></span>如果模糊<span class="_ _25"> </span><span class="ff3">Seq2Seq<span class="_ _25"> </span></span>的含义，<span class="_ _3a"></span><span class="ff3">Seq2Seq <span class="ff1">和<span class="_ _25"> </span></span>Enco<span class="_ _23"></span>der-Deco<span class="_ _23"></span>der <span class="ff1">两者同时出现</span></span></span></div><div class="t m0 x3 h6 yaa8 ff1 fs2 fc0 sc0 ls0 ws0">容易让人感到混乱。</div><div class="t m0 x3 h6 yaa9 ff1 fs2 fc0 sc0 ls0 ws0">这篇论文提出了如下图结构的模型（<span class="ff3">&lt;EOS&gt;<span class="_ _d"> </span></span>是句子结束的标识符）<span class="_ _26"></span>：</div><div class="t m0 x3 h6 yaaa ff1 fs2 fc0 sc0 ls0 ws0">实际<span class="_ _23"></span>上，这<span class="_ _23"></span>就是一<span class="_ _23"></span>个<span class="_ _1e"> </span><span class="ff3">Enco<span class="_ _23"></span>der-Decoder<span class="_ _35"> </span></span>结构<span class="_ _23"></span>的模<span class="_ _23"></span>型，但是<span class="_ _23"></span>它比<span class="_ _35"> </span><span class="ff3">RNN<span class="_ _1e"> </span>Enco<span class="_ _23"></span>der-Decoder<span class="_ _35"> </span></span>模型<span class="_ _23"></span>简</div><div class="t m0 x3 h6 yaab ff1 fs2 fc0 sc0 ls0 ws0">单一<span class="_ _23"></span>些。因<span class="_ _23"></span>为<span class="_ _e"> </span><span class="ff3">Deco<span class="_ _23"></span>der<span class="_ _1e"> </span></span>在<span class="_ _1e"> </span><span class="ffd">t<span class="_ _1e"> </span></span>时<span class="_ _23"></span>刻是<span class="_ _23"></span>由<span class="_ _e"> </span><span class="ffd">h</span></div><div class="t m0 x80 hb yaac ffc fs7 fc0 sc0 ls0 ws0">t</div><div class="t m0 x166 h6 yaab ff1 fs2 fc0 sc0 ls0 ws0">和<span class="_ _1e"> </span><span class="ffd">y</span></div><div class="t m0 xc3 ha yaac ffc fs7 fc0 sc0 ls0 ws0">t<span class="ff14">−<span class="ff12">1</span></span></div><div class="t m0 x128 h6 yaab ff1 fs2 fc0 sc0 ls0 ws0">计算<span class="_ _23"></span>出<span class="_ _1e"> </span><span class="ffd">y</span></div><div class="t m0 x62 hb yaac ffc fs7 fc0 sc0 ls0 ws0">t</div><div class="t m0 x127 h6 yaab ff1 fs2 fc0 sc0 ls0 ws0">，而<span class="_ _23"></span>没有<span class="_ _1e"> </span><span class="ffd">c</span>。<span class="_ _23"></span>论文中<span class="_ _23"></span>的<span class="_ _1e"> </span><span class="ff3">Enco<span class="_ _23"></span>der<span class="_ _e"> </span></span>和</div><div class="t m0 x3 h6 yaad ff3 fs2 fc0 sc0 ls0 ws0">Deco<span class="_ _23"></span>der<span class="_ _25"> </span><span class="ff1">都是用<span class="_ _d"> </span></span>4<span class="_ _d"> </span><span class="ff1">层<span class="_ _d"> </span></span>LSTM<span class="ff1">。</span></div><div class="t m0 x3 h6 yaae ff3 fs2 fc0 sc0 ls0 ws0">LSTM<span class="_ _37"> </span><span class="ff1">的目标是估计条件概率<span class="_ _37"> </span><span class="ffd">p<span class="_ _31"> </span><span class="fff">(</span>y</span></span></div><div class="t m0 x5a ha yaaf ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 x51 he yaae ffd fs2 fc0 sc0 ls0 ws0">,<span class="_ _31"> </span>.<span class="_ _31"> </span>.<span class="_ _31"> </span>.<span class="_ _31"> </span>,<span class="_ _31"> </span>y</div><div class="t m0 xc7 hb yab0 ffc fs7 fc0 sc0 ls0 ws0">T</div><div class="t m0 x17 h1f yab1 ff17 fs9 fc0 sc0 ls0 ws0">′</div><div class="t m0 x1 h4 yaae ffe fs2 fc0 sc0 ls0 ws0">|<span class="ffd">x</span></div><div class="t m0 x35 ha yaaf ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 x97 he yaae ffd fs2 fc0 sc0 ls0 ws0">,<span class="_ _31"> </span>.<span class="_ _31"> </span>.<span class="_ _31"> </span>.<span class="_ _31"> </span>,<span class="_ _31"> </span>x</div><div class="t m0 xd2 hb yab2 ffc fs7 fc0 sc0 ls0 ws0">T</div><div class="t m0 xe0 h6 yaae fff fs2 fc0 sc0 ls0 ws0">)<span class="_ _37"> </span><span class="ff1">，<span class="_ _56"></span>其中<span class="_ _37"> </span><span class="fff">(<span class="ffd">x</span></span></span></div><div class="t m0 x162 ha yaaf ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 x11e he yaae ffd fs2 fc0 sc0 ls0 ws0">,<span class="_ _31"> </span>.<span class="_ _31"> </span>.<span class="_ _31"> </span>.<span class="_ _31"> </span>,<span class="_ _31"> </span>x</div><div class="t m0 xa3 hb yab2 ffc fs7 fc0 sc0 ls0 ws0">T</div><div class="t m0 x156 h6 yaae fff fs2 fc0 sc0 ls0 ws0">)<span class="_ _37"> </span><span class="ff1">是输入序列，<span class="_ _39"></span><span class="ffd">y</span></span></div><div class="t m0 x67 ha yaaf ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 x1c1 he yaae ffd fs2 fc0 sc0 ls0 ws0">,<span class="_ _31"> </span>.<span class="_ _31"> </span>.<span class="_ _31"> </span>.<span class="_ _31"> </span>,<span class="_ _31"> </span>y</div><div class="t m0 x90 hb yab0 ffc fs7 fc0 sc0 ls0 ws0">T</div><div class="t m0 x1c2 h1f yab1 ff17 fs9 fc0 sc0 ls0 ws0">′</div><div class="t m0 x3 h6 yab3 ff1 fs2 fc0 sc0 ls0 ws0">是对应的输出序列。模型先获得<span class="_ _23"></span>输入序列<span class="_ _d"> </span><span class="fff">(<span class="ffd">x</span></span></div><div class="t m0 x122 ha yab4 ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 x123 he yab3 ffd fs2 fc0 sc0 ls0 ws0">,<span class="_ _31"> </span>.<span class="_ _31"> </span>.<span class="_ _31"> </span>.<span class="_ _31"> </span>,<span class="_ _31"> </span>x</div><div class="t m0 x2a hb yab5 ffc fs7 fc0 sc0 ls0 ws0">T</div><div class="t m0 x21 h6 yab3 fff fs2 fc0 sc0 ls0 ws0">)<span class="_ _d"> </span><span class="ff1">的固定维度的向量表<span class="_ _23"></span>示<span class="_ _25"> </span><span class="ffd">v<span class="_ _23"></span></span>，<span class="ffd">v<span class="_ _1e"> </span></span>是<span class="_ _d"> </span><span class="ff3">Enco<span class="_ _23"></span>der</span></span></div><div class="t m0 x3 h6 yab6 ff1 fs2 fc0 sc0 ls0 ws0">的最后一个隐藏状态，<span class="_ _28"></span>同时也是<span class="_ _25"> </span><span class="ff3">Deco<span class="_ _23"></span>der<span class="_ _d"> </span></span>的初始隐藏状态。<span class="_ _28"></span>然后模型通过标准的<span class="_ _d"> </span><span class="ff3">LSTM<span class="_ _25"> </span></span>计算公</div><div class="t m0 x3 h6 yab7 ff1 fs2 fc0 sc0 ls0 ws0">式计算出<span class="_ _d"> </span><span class="ffd">y</span></div><div class="t m0 x10a ha yab8 ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 x132 he yab7 ffd fs2 fc0 sc0 ls0 ws0">,<span class="_ _31"> </span>.<span class="_ _31"> </span>.<span class="_ _31"> </span>.<span class="_ _31"> </span>,<span class="_ _31"> </span>y</div><div class="t m0 x199 hb yab9 ffc fs7 fc0 sc0 ls0 ws0">T</div><div class="t m0 x55 h1f yaba ff17 fs9 fc0 sc0 ls0 ws0">′</div><div class="t m0 x56 h6 yab7 ff1 fs2 fc0 sc0 ls0 ws0">的条件概率：</div><div class="t m0 x10c h4 yabb ffd fs2 fc0 sc0 ls0 ws0">p<span class="_ _31"> </span><span class="fff">(</span>y</div><div class="t m0 x8d ha yabc ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 x38 he yabb ffd fs2 fc0 sc0 ls0 ws0">,<span class="_ _31"> </span>.<span class="_ _31"> </span>.<span class="_ _31"> </span>.<span class="_ _31"> </span>,<span class="_ _31"> </span>y</div><div class="t m0 x41 hb yabd ffc fs7 fc0 sc0 ls0 ws0">T</div><div class="t m0 x10 h1f yabe ff17 fs9 fc0 sc0 ls0 ws0">′</div><div class="t m0 x69 h4 yabb ffe fs2 fc0 sc0 ls0 ws0">|<span class="ffd">x</span></div><div class="t m0 xf3 ha yabc ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 x28 he yabb ffd fs2 fc0 sc0 ls0 ws0">,<span class="_ _31"> </span>.<span class="_ _31"> </span>.<span class="_ _31"> </span>.<span class="_ _31"> </span>,<span class="_ _31"> </span>x</div><div class="t m0 x100 hb yabf ffc fs7 fc0 sc0 ls0 ws0">T</div><div class="t m0 x97 h4 yabb fff fs2 fc0 sc0 ls0 ws0">)<span class="_ _32"> </span>=</div><div class="t m0 x128 hb yac0 ffc fs7 fc0 sc0 ls0 ws0">T</div><div class="t m0 x9e h1f yac1 ff17 fs9 fc0 sc0 ls0 ws0">′</div><div class="t m0 x5f hc yac2 ff11 fs2 fc0 sc0 ls0 ws0">Y</div><div class="t m0 x5f ha y216 ffc fs7 fc0 sc0 ls0 ws0">t<span class="ff12">=1</span></div><div class="t m0 x1a7 h4 yabb ffd fs2 fc0 sc0 ls0 ws0">p<span class="_ _31"> </span><span class="fff">(</span>y</div><div class="t m0 xc8 hb yabc ffc fs7 fc0 sc0 ls0 ws0">t</div><div class="t m0 x1f h4 yabb ffe fs2 fc0 sc0 ls0 ws0">|<span class="ffd">v<span class="_ _23"></span>,<span class="_ _33"> </span>y</span></div><div class="t m0 x140 ha yabc ff12 fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 xeb he yabb ffd fs2 fc0 sc0 ls0 ws0">,<span class="_ _31"> </span>.<span class="_ _31"> </span>.<span class="_ _31"> </span>.<span class="_ _31"> </span>,<span class="_ _31"> </span>y</div><div class="t m0 x14b ha yabc ffc fs7 fc0 sc0 ls0 ws0">t<span class="ffb">−<span class="ff12">1</span></span></div><div class="t m0 x11a h4 yabb fff fs2 fc0 sc0 ls0 ws0">)</div><div class="t m0 x3 h4 y3 ff3 fs2 fc0 sc0 ls0 ws0">76</div></div><div class="pi" data-data='{"ctm":[1.500000,0.000000,0.000000,1.500000,0.000000,0.000000]}'></div></div>
<div id="pf53" class="pf w0 h0" data-page-no="53"><div class="pc pc53 w0 h0"><div class="t m0 x11f h7 y21 ff3 fs5 fc0 sc0 ls0 ws0">12.3<span class="_ _8"> </span>A<span class="_ _27"></span>TTENTION<span class="_ _25"> </span><span class="ff7">机制</span></div><div class="t m0 x17a h9 y324 ff5 fs6 fc0 sc0 ls0 ws0">12.3<span class="_ _24"> </span>A<span class="_ _28"></span>tten<span class="_ _12"></span>tion<span class="_ _18"> </span><span class="ff9">机制</span></div><div class="t m0 x3 h6 yac3 ff3 fs2 fc0 sc0 ls0 ws0">A<span class="_ _12"></span>tten<span class="_ _12"></span>tion<span class="_ _25"> </span><span class="ff1">机制由视觉图像领域提出来，<span class="_ _3a"></span>在<span class="_ _25"> </span><span class="ff3">2014<span class="_ _25"> </span></span>年，<span class="_ _29"></span><span class="ff3">Bahdanau <span class="ff1">在<span class="_ _30"></span>《<span class="ff3">Neural<span class="_ _25"> </span>Machine T<span class="_ _27"></span>ranslation</span></span></span></span></div><div class="t m0 x3 h6 yac4 ff3 fs2 fc0 sc0 ls0 ws0">b<span class="_ _12"></span>y<span class="_ _25"> </span>Jointly Learning<span class="_ _d"> </span>to<span class="_ _25"> </span>Align<span class="_ _25"> </span>and<span class="_ _d"> </span>T<span class="_ _27"></span>ranslate<span class="ff1">》<span class="_ _27"></span>上将其应用到机器翻译任务上，<span class="_ _27"></span>这是第一个应用到</span></div><div class="t m0 x3 h6 yac5 ff3 fs2 fc0 sc0 ls0 ws0">NLP <span class="ff1">领域的论文。<span class="_ _2c"></span>之后，<span class="_ _2c"></span><span class="ff3">15<span class="ff1">、<span class="_ _2c"></span><span class="ff3">16<span class="ff1">、<span class="_ _2d"></span><span class="ff3">17 <span class="ff1">乃至今年，<span class="_ _2b"></span>都有各式各样的<span class="_ _a"> </span><span class="ff3">attention </span>机制结合深度学习网络</span></span></span></span></span></span></span></div><div class="t m0 x3 h6 yac6 ff1 fs2 fc0 sc0 ls0 ws0">模型被用于处理各种</div><div class="t m0 x19a h4 yac7 ff3 fs2 fc0 sc0 ls0 ws0">NLP</div><div class="t m0 x3f h6 yac6 ff1 fs2 fc0 sc0 ls0 ws0">的任务。<span class="_ _2d"></span>在</div><div class="t m0 x9c h4 yac7 ff3 fs2 fc0 sc0 ls0 ws0">2017</div><div class="t m0 x1 h6 yac6 ff1 fs2 fc0 sc0 ls0 ws0">年，</div><div class="t m0 xa h4 yac7 ff3 fs2 fc0 sc0 ls0 ws0">go<span class="_ _23"></span>ogle</div><div class="t m0 x39 h6 yac6 ff1 fs2 fc0 sc0 ls0 ws0">机器翻译团队发表的<span class="_ _2a"></span>《</div><div class="t m0 x173 h4 yac7 ff3 fs2 fc0 sc0 ls0 ws0">A<span class="_ _12"></span>tten<span class="_ _12"></span>tion is all<span class="_ _a"> </span>y<span class="_ _12"></span>ou</div><div class="t m0 x3 h6 yac8 ff3 fs2 fc0 sc0 ls0 ws0">need<span class="ff1">》中大<span class="_ _23"></span>量使用了<span class="_ _23"></span>自注意力机<span class="_ _23"></span>制（</span>self-atten<span class="_ _12"></span>tion<span class="ff1">）来学<span class="_ _23"></span>习文本表示，<span class="_ _23"></span>脱离传统<span class="_ _23"></span>的<span class="_ _e"> </span></span>RNN/CNN<span class="ff1">，</span></div><div class="t m0 x3 h6 yac9 ff1 fs2 fc0 sc0 ls0 ws0">同时也使用<span class="_ _23"></span>了新颖的<span class="_ _d"> </span><span class="ff3">multi-head<span class="_ _d"> </span></span>机制。<span class="_ _23"></span>自注意力机制也成<span class="_ _23"></span>为了大家近期研究<span class="_ _23"></span>的热点，可以应用</div><div class="t m0 x3 h6 yaca ff1 fs2 fc0 sc0 ls0 ws0">到各种<span class="_ _d"> </span><span class="ff3">NLP<span class="_ _d"> </span></span>任务上。</div><div class="t m0 x3 h6 yacb ff3 fs2 fc0 sc0 ls0 ws0">A<span class="_ _12"></span>tten<span class="_ _12"></span>tion<span class="_ _d"> </span><span class="ff1">机制经过长时间的发展，虽然不同论<span class="_ _23"></span>文里的实现方法可能各不一样，但是基本上都遵</span></div><div class="t m0 x3 h6 yacc ff1 fs2 fc0 sc0 ls0 ws0">循着同一个范式。其中包含三个成分<span class="ff3">:</span></div><div class="t m0 x3 h6 yacd ff3 fs2 fc0 sc0 ls0 ws0">Key(<span class="ff1">键</span>)<span class="_ _d"> </span><span class="ff1">与值相对应同时又用来与查询计算相似度作为<span class="_ _d"> </span></span>A<span class="_ _12"></span>tten<span class="_ _12"></span>tion<span class="_ _d"> </span><span class="ff1">选取的依据</span></div><div class="t m0 x3 h6 yace ff3 fs2 fc0 sc0 ls0 ws0">Query(<span class="ff1">查询</span>)<span class="_ _d"> </span><span class="ff1">一次执行<span class="_ _d"> </span></span>A<span class="_ _12"></span>tten<span class="_ _12"></span>tion<span class="_ _d"> </span><span class="ff1">时的查询</span></div><div class="t m0 x3 h6 yacf ff3 fs2 fc0 sc0 ls0 ws0">V<span class="_ _27"></span>alue(<span class="ff1">值</span>)<span class="_ _d"> </span><span class="ff1">被注意并选取的数据</span></div><div class="t m0 x3 h6 yad0 ff1 fs2 fc0 sc0 ls0 ws0">对应的公式为：</div><div class="t m0 x17f h4 yad1 ff3 fs2 fc0 sc0 ls0 ws0">A<span class="_ _12"></span>tten<span class="_ _12"></span>tion<span class="_ _d"> </span><span class="fff">(<span class="ffd">K,<span class="_ _31"> </span>Q,<span class="_ _31"> </span>V<span class="_ _37"> </span></span>)<span class="_ _32"> </span>=<span class="_ _32"> </span></span>softmax<span class="fff">(</span>Similarity<span class="fff">(<span class="ffd">K<span class="_ _23"></span>,<span class="_ _33"> </span>Q</span>))<span class="ffd">V<span class="_ _6f"> </span></span></span>(12.5)</div><div class="t m0 x3 h6 yad2 ff1 fs2 fc0 sc0 ls0 ws0">可以看出<span class="_ _d"> </span><span class="ff3">atten<span class="_ _12"></span>tion<span class="_ _d"> </span><span class="ff1">的计算分为三步：</span></span></div><div class="t m0 x3 h6 yad3 ff1 fs2 fc0 sc0 ls0 ws0">计算<span class="_ _d"> </span><span class="ff3">K</span>、<span class="ff3">Q<span class="_ _d"> </span></span>的相似矩阵</div><div class="t m0 x3 h6 yad4 ff1 fs2 fc0 sc0 ls0 ws0">对相似矩阵作归一化处理</div><div class="t m0 x3 h6 yad5 ff1 fs2 fc0 sc0 ls0 ws0">其中，相似矩阵的计算有很多种方式：</div><div class="t m0 xbc h4 y3 ff3 fs2 fc0 sc0 ls0 ws0">77</div></div><div class="pi" data-data='{"ctm":[1.500000,0.000000,0.000000,1.500000,0.000000,0.000000]}'></div></div>
</div>
<div class="loading-indicator">
<img alt="" src="pdf2htmlEX-64x64.png"/>
</div>
</body>
</html>
