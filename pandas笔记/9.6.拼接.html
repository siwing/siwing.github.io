
<!doctype html>
<html lang="zh" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      <link rel="shortcut icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1, mkdocs-material-6.1.4">
    
    
      
        <title>9.6.拼接 - Python笔记</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.358818c7.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.f0267088.min.css">
        
      
    
    
    
      
        
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
    
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
      
  
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#concat" class="md-skip">
          跳转至
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      

  

<header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href="../index.html" title="Python笔记" class="md-header-nav__button md-logo" aria-label="Python笔记">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      
        <div class="md-header-nav__ellipsis">
          <span class="md-header-nav__topic md-ellipsis">
            Python笔记
          </span>
          <span class="md-header-nav__topic md-ellipsis">
            
              9.6.拼接
            
          </span>
        </div>
      
    </div>
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="搜索" placeholder="搜索" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active">
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            正在初始化搜索引擎
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header-nav__source">
        
<a href="https://github.com/siwing/siwing.github.io/" title="前往 GitHub 仓库" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  

<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../index.html" title="Python笔记" class="md-nav__button md-logo" aria-label="Python笔记">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    Python笔记
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/siwing/siwing.github.io/" title="前往 GitHub 仓库" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../index.html" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      计算机基础
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="计算机基础" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        <span class="md-nav__icon md-icon"></span>
        计算机基础
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/1.1.CPU.html" class="md-nav__link">
      1.1.CPU
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/1.2.Memory.html" class="md-nav__link">
      1.2.Memory
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/1.3.%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5.html" class="md-nav__link">
      1.3.基本概念
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/1.4.%E7%BC%96%E8%AF%91%E5%9E%8B%E8%AF%AD%E8%A8%80%E5%92%8C%E8%A7%A3%E9%87%8A%E5%9E%8B%E8%AF%AD%E8%A8%80%E7%9A%84%E4%BC%98%E7%BC%BA%E7%82%B9%E5%AF%B9%E6%AF%94.html" class="md-nav__link">
      1.4.编译型语言 vs 解释型语言
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/1.5.%E5%AD%97%E7%AC%A6%E7%BC%96%E7%A0%81.html" class="md-nav__link">
      1.5.字符编码
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      Python基础
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Python基础" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        <span class="md-nav__icon md-icon"></span>
        Python基础
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../Python%E5%9F%BA%E7%A1%80/2.1.python%E5%9F%BA%E6%9C%AC%E8%AF%AD%E6%B3%95.html" class="md-nav__link">
      2.1.python基本语法
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Python%E5%9F%BA%E7%A1%80/2.2.%E8%AF%AD%E5%8F%A5.html" class="md-nav__link">
      2.2.语句
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Python%E5%9F%BA%E7%A1%80/2.3.String.html" class="md-nav__link">
      2.3.String
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Python%E5%9F%BA%E7%A1%80/2.4.List.html" class="md-nav__link">
      2.4.List
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Python%E5%9F%BA%E7%A1%80/2.5.Tuple.html" class="md-nav__link">
      2.5.Tuple
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Python%E5%9F%BA%E7%A1%80/2.6.Dict.html" class="md-nav__link">
      2.6.Dict
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Python%E5%9F%BA%E7%A1%80/2.7.%E7%AE%80%E6%B4%81%E7%9A%84Python.html" class="md-nav__link">
      2.7.简洁的Python
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Python%E5%9F%BA%E7%A1%80/2.8.%E8%B5%8B%E5%80%BC%E3%80%81immutable%E3%80%81%E6%B7%B1%E6%8B%B7%E8%B4%9D.html" class="md-nav__link">
      2.8.赋值、immutable、深拷贝
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Python%E5%9F%BA%E7%A1%80/2.9.%E5%87%BD%E6%95%B0.html" class="md-nav__link">
      2.9.函数
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Python%E5%9F%BA%E7%A1%80/2.10.%E5%86%85%E7%BD%AE%E5%87%BD%E6%95%B0.html" class="md-nav__link">
      2.10.内置函数
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Python%E5%9F%BA%E7%A1%80/2.11.%E7%AE%80%E6%B4%81%E7%9A%84Python.html" class="md-nav__link">
      2.11.简洁的Python
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Python%E5%9F%BA%E7%A1%80/3.1.%E5%BC%82%E5%B8%B8.html" class="md-nav__link">
      3.1.异常
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Python%E5%9F%BA%E7%A1%80/3.2.%E5%91%BD%E5%90%8D%E7%A9%BA%E9%97%B4%E5%92%8C%E4%BD%9C%E7%94%A8%E5%9F%9F.html" class="md-nav__link">
      3.2.命名空间和作用域
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Python%E5%9F%BA%E7%A1%80/3.3.%E9%97%AD%E5%8C%85.html" class="md-nav__link">
      3.3.闭包
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Python%E5%9F%BA%E7%A1%80/3.4.%E8%A3%85%E9%A5%B0%E5%99%A8.html" class="md-nav__link">
      3.4.装饰器
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Python%E5%9F%BA%E7%A1%80/4.1.%E7%B1%BB.html" class="md-nav__link">
      4.1.类
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Python%E5%9F%BA%E7%A1%80/4.2.%E5%A4%9A%E9%87%8D%E7%BB%A7%E6%89%BF%E5%92%8CMRO.html" class="md-nav__link">
      4.2.多重继承和MRO
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Python%E5%9F%BA%E7%A1%80/4.3.%E6%A8%A1%E5%9D%97.html" class="md-nav__link">
      4.3.模块
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Python%E5%9F%BA%E7%A1%80/4.4.%E9%AD%94%E6%9C%AF%E6%96%B9%E6%B3%95.html" class="md-nav__link">
      4.4.魔术方法
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      开发环境管理
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="开发环境管理" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        <span class="md-nav__icon md-icon"></span>
        开发环境管理
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E7%AE%A1%E7%90%86/5.1.conda%E7%AC%94%E8%AE%B0.html" class="md-nav__link">
      5.1.conda笔记
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E7%AE%A1%E7%90%86/5.2.pip%E7%AC%94%E8%AE%B0.html" class="md-nav__link">
      5.2.pip笔记
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E7%AE%A1%E7%90%86/5.3.pip%E5%AF%B9%E6%AF%94conda.html" class="md-nav__link">
      5.3.pip对比conda
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E7%AE%A1%E7%90%86/5.4.anaconda.html" class="md-nav__link">
      5.4.anaconda
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E7%AE%A1%E7%90%86/5.5.jupyter%E4%BD%BF%E7%94%A8%E7%AC%94%E8%AE%B0.html" class="md-nav__link">
      5.5.jupyter使用笔记
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      标准库
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="标准库" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        <span class="md-nav__icon md-icon"></span>
        标准库
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../%E6%A0%87%E5%87%86%E5%BA%93/6.1.string.html" class="md-nav__link">
      6.1.string
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../%E6%A0%87%E5%87%86%E5%BA%93/6.2.textwrap.html" class="md-nav__link">
      6.2.textwrap
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../%E6%A0%87%E5%87%86%E5%BA%93/6.3.time.html" class="md-nav__link">
      6.3.time
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../%E6%A0%87%E5%87%86%E5%BA%93/6.4.datetime.html" class="md-nav__link">
      6.4.datetime
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../%E6%A0%87%E5%87%86%E5%BA%93/6.5.calendar.html" class="md-nav__link">
      6.5.calendar
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../%E6%A0%87%E5%87%86%E5%BA%93/6.7.urllib.html" class="md-nav__link">
      6.7.urllib
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../%E6%A0%87%E5%87%86%E5%BA%93/6.8.requests.html" class="md-nav__link">
      6.8.requests
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../%E6%A0%87%E5%87%86%E5%BA%93/6.9.re.html" class="md-nav__link">
      6.9.re
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../%E6%A0%87%E5%87%86%E5%BA%93/6.10.os_path.html" class="md-nav__link">
      6.10.os.path
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../%E6%A0%87%E5%87%86%E5%BA%93/6.11.traceback.html" class="md-nav__link">
      6.11.traceback
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../%E6%A0%87%E5%87%86%E5%BA%93/6.12.enum.html" class="md-nav__link">
      6.12.enum
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../%E6%A0%87%E5%87%86%E5%BA%93/6.13.difflib%E2%80%94%E2%80%94%E5%AD%97%E7%AC%A6%E6%AF%94%E8%BE%83.html" class="md-nav__link">
      6.13.difflib——字符比较
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../%E6%A0%87%E5%87%86%E5%BA%93/6.14.logging.html" class="md-nav__link">
      6.14.logging
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../%E6%A0%87%E5%87%86%E5%BA%93/6.15.Compression%26Archiving.html" class="md-nav__link">
      6.15.Compression&Archiving
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../%E6%A0%87%E5%87%86%E5%BA%93/6.16.shutil.html" class="md-nav__link">
      6.16.shutil
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6">
    
    <label class="md-nav__link" for="nav-6">
      设计模式
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="设计模式" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        <span class="md-nav__icon md-icon"></span>
        设计模式
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/7.1.%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1%E5%9F%BA%E7%A1%80.html" class="md-nav__link">
      7.1.面向对象程序设计基础
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/7.2.%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E8%BD%AF%E4%BB%B6%E8%AE%BE%E8%AE%A1%E5%8E%9F%E5%88%99.html" class="md-nav__link">
      7.2.面向对象软件设计原则
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/7.3.%E5%88%9B%E5%BB%BA%E5%9E%8B%E6%A8%A1%E5%BC%8F.html" class="md-nav__link">
      7.3.创建型模式
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../设计模式/7.4.结构型模式.md" class="md-nav__link">
      7.4.结构型模式
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7">
    
    <label class="md-nav__link" for="nav-7">
      numpy笔记
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="numpy笔记" data-md-level="1">
      <label class="md-nav__title" for="nav-7">
        <span class="md-nav__icon md-icon"></span>
        numpy笔记
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../numpy%E7%AC%94%E8%AE%B0/8.1.%E5%88%9B%E5%BB%BA%E6%95%B0%E7%BB%84.html" class="md-nav__link">
      8.1.创建数组
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../numpy%E7%AC%94%E8%AE%B0/8.2.%E7%B4%A2%E5%BC%95.html" class="md-nav__link">
      8.2.索引
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../numpy%E7%AC%94%E8%AE%B0/8.3.%E5%86%85%E5%AD%98%E5%B8%83%E5%B1%80.html" class="md-nav__link">
      8.3.内存布局
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../numpy%E7%AC%94%E8%AE%B0/8.4.%E5%B9%BF%E6%92%AD.html" class="md-nav__link">
      8.4.广播
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../numpy%E7%AC%94%E8%AE%B0/8.5.%E5%B8%B8%E9%87%8F.html" class="md-nav__link">
      8.5.常量
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../numpy%E7%AC%94%E8%AE%B0/8.6.%E6%89%93%E5%8D%B0%E6%95%B0%E7%BB%84.html" class="md-nav__link">
      8.6.打印数组
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../numpy%E7%AC%94%E8%AE%B0/8.7.%E6%B7%BB%E5%8A%A0%E5%92%8C%E5%88%A0%E9%99%A4.html" class="md-nav__link">
      8.7.添加和删除
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../numpy%E7%AC%94%E8%AE%B0/8.8.%E5%BD%A2%E7%8A%B6%E6%93%8D%E7%BA%B5.html" class="md-nav__link">
      8.8.形状操纵
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../numpy%E7%AC%94%E8%AE%B0/8.9.ufunc%E5%87%BD%E6%95%B0.html" class="md-nav__link">
      8.9.ufunc函数
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../numpy%E7%AC%94%E8%AE%B0/8.10.%E5%87%BD%E6%95%B0%E5%BA%93.html" class="md-nav__link">
      8.10.函数库
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../numpy%E7%AC%94%E8%AE%B0/8.11.%E4%BF%9D%E5%AD%98%E5%92%8C%E5%8A%A0%E8%BD%BD.html" class="md-nav__link">
      8.11.保存和加载
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../numpy%E7%AC%94%E8%AE%B0/8.12.%E7%BB%93%E6%9E%84%E5%8C%96%E6%95%B0%E7%BB%84.html" class="md-nav__link">
      8.12.结构化数组
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../numpy%E7%AC%94%E8%AE%B0/8.13.%E6%95%B0%E6%8D%AE%E5%A4%84%E7%90%86.html" class="md-nav__link">
      8.13.数据处理
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-8" type="checkbox" id="nav-8" checked>
    
    <label class="md-nav__link" for="nav-8">
      pandas笔记
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="pandas笔记" data-md-level="1">
      <label class="md-nav__title" for="nav-8">
        <span class="md-nav__icon md-icon"></span>
        pandas笔记
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="9.1.Series.html" class="md-nav__link">
      9.1.Series
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="9.2.DataFrame.html" class="md-nav__link">
      9.2.DataFrame
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="9.3.%E7%B4%A2%E5%BC%95.html" class="md-nav__link">
      9.3.索引
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="9.4.%E7%B4%A2%E5%BC%95%E5%AF%B9%E8%B1%A1.html" class="md-nav__link">
      9.4.索引对象
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="9.5.%E7%B4%A2%E5%BC%95%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C.html" class="md-nav__link">
      9.5.索引的基本操作
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        9.6.拼接
        <span class="md-nav__icon md-icon"></span>
      </label>
    
    <a href="9.6.%E6%8B%BC%E6%8E%A5.html" class="md-nav__link md-nav__link--active">
      9.6.拼接
    </a>
    
      
<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#concat" class="md-nav__link">
    concat函数
  </a>
  
    <nav class="md-nav" aria-label="concat函数">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#join" class="md-nav__link">
    处理其他轴的逻辑：join参数
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#append" class="md-nav__link">
    使用append拼接
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ignore_index" class="md-nav__link">
    忽略串联轴上的索引：ignore_index
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seriesdataframe" class="md-nav__link">
    混合串联Series和DataFrame
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#key" class="md-nav__link">
    key参数
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dataframe" class="md-nav__link">
    行追加到 DataFrame
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    数据库形式的拼接
  </a>
  
    <nav class="md-nav" aria-label="数据库形式的拼接">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    合并方法简介（关系代数）
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#validate" class="md-nav__link">
    检查重复键：validate
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#indicator" class="md-nav__link">
    指示符：indicator
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    合并时数据类型的转换
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dataframejoin" class="md-nav__link">
    DataFrame.join()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#join_1" class="md-nav__link">
    按组合键列和索引拼接：join
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#join_2" class="md-nav__link">
    按单层索引和多层索引拼接：join
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#multiindexesjoin" class="md-nav__link">
    按MultiIndexes拼接：join
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    按照列和索引合并
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    值列重叠
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dataframes" class="md-nav__link">
    拼接多个DataFrames
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    按索引填补缺失值
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    合并时间序列
  </a>
  
    <nav class="md-nav" aria-label="合并时间序列">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_8" class="md-nav__link">
    合并有序数据
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#asof" class="md-nav__link">
    合并ASOF
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="9.7.%E5%8F%98%E6%8D%A2%E7%B4%A2%E5%BC%95.html" class="md-nav__link">
      9.7.变换索引
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="9.8.%E5%88%86%E7%BB%84%E4%B8%8E%E8%81%9A%E5%90%88.html" class="md-nav__link">
      9.8.分组与聚合
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="9.9.%E7%BB%98%E5%9B%BE.html" class="md-nav__link">
      9.9.绘图
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="9.11.%E6%95%B0%E6%8D%AE%E5%A4%84%E7%90%86.html" class="md-nav__link">
      9.11.数据处理
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-9" type="checkbox" id="nav-9">
    
    <label class="md-nav__link" for="nav-9">
      Matplotlib
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Matplotlib" data-md-level="1">
      <label class="md-nav__title" for="nav-9">
        <span class="md-nav__icon md-icon"></span>
        Matplotlib
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../Matplotlib/10.1.%E6%9E%B6%E6%9E%84.html" class="md-nav__link">
      10.1.架构
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-10" type="checkbox" id="nav-10">
    
    <label class="md-nav__link" for="nav-10">
      scikit-learn
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="scikit-learn" data-md-level="1">
      <label class="md-nav__title" for="nav-10">
        <span class="md-nav__icon md-icon"></span>
        scikit-learn
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../scikit-learn/11.1.%E6%95%B0%E6%8D%AE%E9%9B%86.html" class="md-nav__link">
      11.1.数据集
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../scikit-learn/11.2.%E8%AF%84%E4%BB%B7%E6%8C%87%E6%A0%87.html" class="md-nav__link">
      11.2.评价指标-分类
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../scikit-learn/11.5.%E6%8B%86%E5%88%86%E6%95%B0%E6%8D%AE.html" class="md-nav__link">
      11.5.拆分数据
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../scikit-learn/11.6.%E4%BA%A4%E5%8F%89%E9%AA%8C%E8%AF%81.html" class="md-nav__link">
      11.6.交叉验证
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../scikit-learn/11.7.%E8%B6%85%E5%8F%82%E6%95%B0%E5%AF%BB%E4%BC%98.html" class="md-nav__link">
      11.7.超参数寻优
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../scikit-learn/11.8.%E4%BF%9D%E5%AD%98%E6%A8%A1%E5%9E%8B.html" class="md-nav__link">
      11.8.保存模型
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../scikit-learn/11.9.%E7%89%B9%E5%BE%81%E5%A4%84%E7%90%86.html" class="md-nav__link">
      11.9.特征处理
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../scikit-learn/11.10.%E8%BD%AC%E6%8D%A2%E9%A2%84%E6%B5%8B%E7%9B%AE%E6%A0%87y.html" class="md-nav__link">
      11.10.转换预测目标y
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../scikit-learn/11.11.%E7%89%B9%E5%BE%81%E9%80%89%E6%8B%A9.html" class="md-nav__link">
      11.11.特征选择
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../scikit-learn/11.12.%E7%89%B9%E5%BE%81%E6%8F%90%E5%8F%96.html" class="md-nav__link">
      11.12.特征提取
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../scikit-learn/11.13.%E7%BC%BA%E5%A4%B1%E5%80%BC%E5%A4%84%E7%90%86.html" class="md-nav__link">
      11.13.缺失值处理
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../scikit-learn/11.14.%E7%BA%BF%E6%80%A7%E5%9B%9E%E5%BD%92.html" class="md-nav__link">
      11.14.线性回归
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../scikit-learn/11.15.%E5%86%B3%E7%AD%96%E6%A0%91.html" class="md-nav__link">
      11.15.决策树
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-11" type="checkbox" id="nav-11">
    
    <label class="md-nav__link" for="nav-11">
      tensorflow笔记
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="tensorflow笔记" data-md-level="1">
      <label class="md-nav__title" for="nav-11">
        <span class="md-nav__icon md-icon"></span>
        tensorflow笔记
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../tensorflow%E7%AC%94%E8%AE%B0/12.1.keras%E6%95%B0%E6%8D%AE%E9%9B%86.html" class="md-nav__link">
      12.1.keras数据集
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../tensorflow%E7%AC%94%E8%AE%B0/12.2.%E5%88%9B%E5%BB%BA%E5%BC%A0%E9%87%8F.html" class="md-nav__link">
      12.2.创建张量
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../tensorflow%E7%AC%94%E8%AE%B0/12.3.%E5%BC%A0%E9%87%8F%E8%BF%9B%E9%98%B6%E6%93%8D%E4%BD%9C.html" class="md-nav__link">
      12.3.张量进阶操作
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../tensorflow%E7%AC%94%E8%AE%B0/12.4.%E6%B1%82%E5%AF%BC.html" class="md-nav__link">
      12.4.求导
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../tensorflow%E7%AC%94%E8%AE%B0/12.5.%E5%8F%AF%E7%94%A8%E6%80%A7%E6%B5%8B%E8%AF%95.html" class="md-nav__link">
      12.5.可用性测试
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../tensorflow%E7%AC%94%E8%AE%B0/12.6.Perceptron.html" class="md-nav__link">
      12.6.Perceptron
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../tensorflow%E7%AC%94%E8%AE%B0/12.7.keras%E5%BF%AB%E9%80%9F%E5%BC%80%E5%A7%8B.html" class="md-nav__link">
      12.7.keras快速开始
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-12" type="checkbox" id="nav-12">
    
    <label class="md-nav__link" for="nav-12">
      爬虫
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="爬虫" data-md-level="1">
      <label class="md-nav__title" for="nav-12">
        <span class="md-nav__icon md-icon"></span>
        爬虫
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../%E7%88%AC%E8%99%AB/13.1.lxml.html" class="md-nav__link">
      13.1.lxml
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../%E7%88%AC%E8%99%AB/13.3.pyquery.html" class="md-nav__link">
      13.3.pyquery
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-13" type="checkbox" id="nav-13">
    
    <label class="md-nav__link" for="nav-13">
      gensim
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="gensim" data-md-level="1">
      <label class="md-nav__title" for="nav-13">
        <span class="md-nav__icon md-icon"></span>
        gensim
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../gensim/14.1.word2vec%20model.html" class="md-nav__link">
      14.1.word2vec model
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../gensim/14.2.word2vec%E5%8F%82%E6%95%B0.html" class="md-nav__link">
      14.2.word2vec参数
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-14" type="checkbox" id="nav-14">
    
    <label class="md-nav__link" for="nav-14">
      数据库
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="数据库" data-md-level="1">
      <label class="md-nav__title" for="nav-14">
        <span class="md-nav__icon md-icon"></span>
        数据库
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../%E6%95%B0%E6%8D%AE%E5%BA%93/15.1.DBAPI.html" class="md-nav__link">
      15.1.DBAPI
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../%E6%95%B0%E6%8D%AE%E5%BA%93/15.2.PostgreSQL.html" class="md-nav__link">
      15.2.PostgreSQL
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../%E6%95%B0%E6%8D%AE%E5%BA%93/15.3.MSSQL.html" class="md-nav__link">
      15.3.MSSQL
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../%E6%95%B0%E6%8D%AE%E5%BA%93/15.4.SQLAlchemy.html" class="md-nav__link">
      15.4.SQLAlchemy
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-15" type="checkbox" id="nav-15">
    
    <label class="md-nav__link" for="nav-15">
      文件操作
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="文件操作" data-md-level="1">
      <label class="md-nav__title" for="nav-15">
        <span class="md-nav__icon md-icon"></span>
        文件操作
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../%E6%96%87%E4%BB%B6%E6%93%8D%E4%BD%9C/16.2.PDF.html" class="md-nav__link">
      16.2.PDF
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../%E6%96%87%E4%BB%B6%E6%93%8D%E4%BD%9C/16.3.docx.html" class="md-nav__link">
      16.3.docx
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../%E6%96%87%E4%BB%B6%E6%93%8D%E4%BD%9C/16.4.OCR.html" class="md-nav__link">
      16.4.OCR
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-16" type="checkbox" id="nav-16">
    
    <label class="md-nav__link" for="nav-16">
      Docker
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Docker" data-md-level="1">
      <label class="md-nav__title" for="nav-16">
        <span class="md-nav__icon md-icon"></span>
        Docker
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../Docker/17.2.Dockerfile.html" class="md-nav__link">
      17.2.Dockerfile
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Docker/17.3.Image.html" class="md-nav__link">
      17.3.Image
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#concat" class="md-nav__link">
    concat函数
  </a>
  
    <nav class="md-nav" aria-label="concat函数">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#join" class="md-nav__link">
    处理其他轴的逻辑：join参数
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#append" class="md-nav__link">
    使用append拼接
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ignore_index" class="md-nav__link">
    忽略串联轴上的索引：ignore_index
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seriesdataframe" class="md-nav__link">
    混合串联Series和DataFrame
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#key" class="md-nav__link">
    key参数
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dataframe" class="md-nav__link">
    行追加到 DataFrame
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    数据库形式的拼接
  </a>
  
    <nav class="md-nav" aria-label="数据库形式的拼接">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    合并方法简介（关系代数）
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#validate" class="md-nav__link">
    检查重复键：validate
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#indicator" class="md-nav__link">
    指示符：indicator
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    合并时数据类型的转换
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dataframejoin" class="md-nav__link">
    DataFrame.join()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#join_1" class="md-nav__link">
    按组合键列和索引拼接：join
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#join_2" class="md-nav__link">
    按单层索引和多层索引拼接：join
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#multiindexesjoin" class="md-nav__link">
    按MultiIndexes拼接：join
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    按照列和索引合并
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    值列重叠
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dataframes" class="md-nav__link">
    拼接多个DataFrames
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    按索引填补缺失值
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    合并时间序列
  </a>
  
    <nav class="md-nav" aria-label="合并时间序列">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_8" class="md-nav__link">
    合并有序数据
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#asof" class="md-nav__link">
    合并ASOF
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/siwing/siwing.github.io/edit/master/docs/pandas笔记/9.6.拼接.md" title="编辑此页" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                  <h1>9.6.拼接</h1>
                
                <div class="codehilite"><pre><span></span><code><span class="kn">from</span> <span class="nn">toolkit.Help</span> <span class="kn">import</span> <span class="n">Help</span> <span class="k">as</span> <span class="n">H</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="err">Windows 10</span>
<span class="err">Python 3.7.3 @ MSC v.1915 64 bit (AMD64)</span>
<span class="err">Latest build date 2020.04.13</span>
<span class="err">pandas version:  1.0.1</span>
<span class="err">numpy version:  1.18.1</span>
</code></pre></div>


<p>Pandas有两种拼接DataFrame的函数，一种是<code>concat</code>函数，另一种是SQL风格的拼接函数，例如<code>merge</code>函数。<code>concat</code>函数只能按轴索引进行拼接，而<code>merge</code>函数则更加灵活，不仅可以根据列索引进行拼接，也可以按照指定的列进行拼接。但<code>merge</code>函数不能根据行标签进行拼接。</p>
<h2 id="concat"><code>concat</code>函数</h2>
<p>在深入研究<code>concat</code>函数的细节及其作用之前，这里有一个简单的示例：</p>
<div class="codehilite"><pre><span></span><code><span class="n">df1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;A&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;A0&#39;</span><span class="p">,</span> <span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="s1">&#39;A2&#39;</span><span class="p">,</span> <span class="s1">&#39;A3&#39;</span><span class="p">],</span>
                    <span class="s1">&#39;B&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;B0&#39;</span><span class="p">,</span> <span class="s1">&#39;B1&#39;</span><span class="p">,</span> <span class="s1">&#39;B2&#39;</span><span class="p">,</span> <span class="s1">&#39;B3&#39;</span><span class="p">],</span>
                    <span class="s1">&#39;C&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;C0&#39;</span><span class="p">,</span> <span class="s1">&#39;C1&#39;</span><span class="p">,</span> <span class="s1">&#39;C2&#39;</span><span class="p">,</span> <span class="s1">&#39;C3&#39;</span><span class="p">],</span>
                    <span class="s1">&#39;D&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;D0&#39;</span><span class="p">,</span> <span class="s1">&#39;D1&#39;</span><span class="p">,</span> <span class="s1">&#39;D2&#39;</span><span class="p">,</span> <span class="s1">&#39;D3&#39;</span><span class="p">]},</span>
                    <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>

<span class="n">df2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;A&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;A4&#39;</span><span class="p">,</span> <span class="s1">&#39;A5&#39;</span><span class="p">,</span> <span class="s1">&#39;A6&#39;</span><span class="p">,</span> <span class="s1">&#39;A7&#39;</span><span class="p">],</span>
                    <span class="s1">&#39;B&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;B4&#39;</span><span class="p">,</span> <span class="s1">&#39;B5&#39;</span><span class="p">,</span> <span class="s1">&#39;B6&#39;</span><span class="p">,</span> <span class="s1">&#39;B7&#39;</span><span class="p">],</span>
                    <span class="s1">&#39;C&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;C4&#39;</span><span class="p">,</span> <span class="s1">&#39;C5&#39;</span><span class="p">,</span> <span class="s1">&#39;C6&#39;</span><span class="p">,</span> <span class="s1">&#39;C7&#39;</span><span class="p">],</span>
                    <span class="s1">&#39;D&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;D4&#39;</span><span class="p">,</span> <span class="s1">&#39;D5&#39;</span><span class="p">,</span> <span class="s1">&#39;D6&#39;</span><span class="p">,</span> <span class="s1">&#39;D7&#39;</span><span class="p">]},</span>
                    <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">])</span>

<span class="n">df3</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;A&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;A8&#39;</span><span class="p">,</span> <span class="s1">&#39;A9&#39;</span><span class="p">,</span> <span class="s1">&#39;A10&#39;</span><span class="p">,</span> <span class="s1">&#39;A11&#39;</span><span class="p">],</span>
                    <span class="s1">&#39;B&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;B8&#39;</span><span class="p">,</span> <span class="s1">&#39;B9&#39;</span><span class="p">,</span> <span class="s1">&#39;B10&#39;</span><span class="p">,</span> <span class="s1">&#39;B11&#39;</span><span class="p">],</span>
                    <span class="s1">&#39;C&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;C8&#39;</span><span class="p">,</span> <span class="s1">&#39;C9&#39;</span><span class="p">,</span> <span class="s1">&#39;C10&#39;</span><span class="p">,</span> <span class="s1">&#39;C11&#39;</span><span class="p">],</span>
                    <span class="s1">&#39;D&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;D8&#39;</span><span class="p">,</span> <span class="s1">&#39;D9&#39;</span><span class="p">,</span> <span class="s1">&#39;D10&#39;</span><span class="p">,</span> <span class="s1">&#39;D11&#39;</span><span class="p">]},</span>
                    <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">])</span>

<span class="n">frames</span> <span class="o">=</span> <span class="p">[</span><span class="n">df1</span><span class="p">,</span> <span class="n">df2</span><span class="p">,</span> <span class="n">df3</span><span class="p">]</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">frames</span><span class="p">)</span>
</code></pre></div>


<p><img alt="../_images/merging_concat_basic.png" src="https://pandas.pydata.org/docs/_images/merging_concat_basic.png" /></p>
<p>与其在ndarrays上的同级函数一样<code>numpy.concatenate</code>，<code>pandas.concat</code> 获取同类类型对象的列表或字典，并将它们与“对其他轴的操作”的一些可配置处理进行连接：</p>
<div class="codehilite"><pre><span></span><code><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">objs</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">join</span><span class="o">=</span><span class="s1">&#39;outer&#39;</span><span class="p">,</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">keys</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
          <span class="n">levels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">verify_integrity</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div>


<ul>
<li><code>objs</code>：Series或DataFrame对象的序列或映射。如果传递了dict ，则除非传递了排序的键，否则将使用排序后的键作为keys参数，在这种情况下，将选择值（请参见下文）。除非它们都为None，否则所有None对象都将被静默删除，在这种情况下将引发ValueError。</li>
<li><code>axis</code> ：<code>{0,1,…}</code>，默认值为0。沿着该轴进行拼接。</li>
<li><code>join</code>：<code>{'inner','outer'}</code>，默认为<code>'outer'</code>。如何处理其他轴上的索引。<code>'outer'</code>为并集，<code>'inner'</code>为交集。</li>
<li><code>ignore_index</code>：布尔值，默认为False。如果为True，则用0, …, n-1代替串联轴的原索引。注意，拼接时仍会考虑其他轴上的索引值。</li>
<li><code>keys</code>：序列，默认为无。使用传递的键作为最外层级别来构造层次结构索引。如果通过了多个级别，则应包含元组。</li>
<li><code>levels</code>：序列列表，默认为无。用于构造MultiIndex的特定级别（唯一值）。否则，将从按键推断出它们。</li>
<li><code>names</code>：列表，默认为None。生成层次结构索引中的级别的名称。</li>
<li><code>verify_integrity</code>：布尔值，默认为False。检查新的串联轴是否包含重复项。相对于实际数据串联而言，这可能非常昂贵。</li>
<li><code>copy</code>：布尔值，默认为True。如果为False，在非必要的情况下不会复制数据。</li>
</ul>
<p>没有一个例子，讨论这些参数的作用没有多大意义。回顾一下上面的例子。假设我们想将特定的键与各个待拼接的DataFrame相关联。我们可以使用<code>keys</code>参数来做到这一点 ：</p>
<div class="codehilite"><pre><span></span><code><span class="n">result</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">frames</span><span class="p">,</span> <span class="n">keys</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">])</span>
</code></pre></div>


<p><img alt="../_images/merging_concat_keys.png" src="https://pandas.pydata.org/docs/_images/merging_concat_keys.png" /></p>
<p>返回对象的索引具有<a href="https://pandas.pydata.org/docs/user_guide/advanced.html#advanced-hierarchical">层次结构索引</a>。这意味着我们现在可以通过键选择每个块：</p>
<div class="codehilite"><pre><span></span><code><span class="n">result</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">]</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="err">    A   B   C   D</span>
<span class="err">4  A4  B4  C4  D4</span>
<span class="err">5  A5  B5  C5  D5</span>
<span class="err">6  A6  B6  C6  D6</span>
<span class="err">7  A7  B7  C7  D7</span>
</code></pre></div>


<p>意识到这个功能是非常有用的并不是一件容易的事，有关此功能的详细信息，参见下文。</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>值得注意的是<a href="https://pandas.pydata.org/docs/reference/api/pandas.concat.html#pandas.concat"><code>concat()</code></a>会完整复制数据（<code>append()</code>方法也是如此），不断重复使用此函数会严重影响性能。如果需要对多个数据集使用该操作，请使用列表推导式。</p>
</div>
<div class="codehilite"><pre><span></span><code><span class="n">frames</span> <span class="o">=</span> <span class="p">[</span><span class="n">process_your_file</span><span class="p">(</span><span class="n">f</span><span class="p">)</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">files</span><span class="p">]</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">frames</span><span class="p">)</span>
</code></pre></div>


<h3 id="join">处理其他轴的逻辑：join参数</h3>
<p>将多个DataFrame粘合在一起时，可以选择如何处理其他轴（而不是串联的轴）。这可以通过以下两种方式完成：</p>
<ol>
<li>把它们全部结合起来<code>join='outer'</code>。这是默认选项，这不会丢失信息。</li>
<li>只保留交集<code>join='inner'</code>。</li>
</ol>
<p>默认<code>join='outer'</code>：</p>
<div class="codehilite"><pre><span></span><code><span class="n">df4</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;B&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;B2&#39;</span><span class="p">,</span> <span class="s1">&#39;B3&#39;</span><span class="p">,</span> <span class="s1">&#39;B6&#39;</span><span class="p">,</span> <span class="s1">&#39;B7&#39;</span><span class="p">],</span>
                    <span class="s1">&#39;D&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;D2&#39;</span><span class="p">,</span> <span class="s1">&#39;D3&#39;</span><span class="p">,</span> <span class="s1">&#39;D6&#39;</span><span class="p">,</span> <span class="s1">&#39;D7&#39;</span><span class="p">],</span>
                    <span class="s1">&#39;F&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;F2&#39;</span><span class="p">,</span> <span class="s1">&#39;F3&#39;</span><span class="p">,</span> <span class="s1">&#39;F6&#39;</span><span class="p">,</span> <span class="s1">&#39;F7&#39;</span><span class="p">]},</span>
                    <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">6</span><span class="p">])</span>

<span class="n">result</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df1</span><span class="p">,</span> <span class="n">df4</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">sort</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">join</span><span class="o">=</span><span class="s2">&quot;outer&quot;</span><span class="p">)</span>
</code></pre></div>


<p><img alt="../_images/merging_concat_axis1.png" src="https://pandas.pydata.org/docs/_images/merging_concat_axis1.png" /></p>
<p>只保留交集<code>join='inner'</code>：</p>
<div class="codehilite"><pre><span></span><code><span class="n">result</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df1</span><span class="p">,</span> <span class="n">df4</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">join</span><span class="o">=</span><span class="s1">&#39;inner&#39;</span><span class="p">)</span>
</code></pre></div>


<p><img alt="../_images/merging_concat_axis1_inner.png" src="https://pandas.pydata.org/docs/_images/merging_concat_axis1_inner.png" /></p>
<p>如果只想用其中一个DataFrame的索引：</p>
<div class="codehilite"><pre><span></span><code><span class="n">result</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df1</span><span class="p">,</span> <span class="n">df4</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">reindex</span><span class="p">(</span><span class="n">df1</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
</code></pre></div>


<p>也可以在连接之前建立索引：</p>
<div class="codehilite"><pre><span></span><code><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df1</span><span class="p">,</span> <span class="n">df4</span><span class="o">.</span><span class="n">reindex</span><span class="p">(</span><span class="n">df1</span><span class="o">.</span><span class="n">index</span><span class="p">)],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="err">    A   B   C   D    B    D    F</span>
<span class="err">0  A0  B0  C0  D0  NaN  NaN  NaN</span>
<span class="err">1  A1  B1  C1  D1  NaN  NaN  NaN</span>
<span class="err">2  A2  B2  C2  D2   B2   D2   F2</span>
<span class="err">3  A3  B3  C3  D3   B3   D3   F3</span>
</code></pre></div>


<p><img alt="../_images/merging_concat_axis1_join_axes.png" src="https://pandas.pydata.org/docs/_images/merging_concat_axis1_join_axes.png" /></p>
<h3 id="append">使用<code>append</code>拼接</h3>
<p><a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.append.html#pandas.DataFrame.append"><code>append()</code></a>是Series和DataFrame的<strong>实例方法</strong>，它是<a href="https://pandas.pydata.org/docs/reference/api/pandas.concat.html#pandas.concat"><code>concat()</code></a>的一个快捷方式，但实际上，<code>append</code>比<code>concat</code>更早出现。<code>append</code>方法让Series和DataFrame沿着行（<code>axis=0</code>）拼接在一起：</p>
<div class="codehilite"><pre><span></span><code><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>            
       <span class="n">verify_integrity</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">sort</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</code></pre></div>


<p><img alt="../_images/merging_append1.png" src="https://pandas.pydata.org/docs/_images/merging_append1.png" /></p>
<p><code>append</code>不要求两个DataFrame的行索引或列索引交集为空：</p>
<div class="codehilite"><pre><span></span><code><span class="n">result</span> <span class="o">=</span> <span class="n">df1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df4</span><span class="p">,</span> <span class="n">sort</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div>


<p><img alt="../_images/merging_append2.png" src="https://pandas.pydata.org/docs/_images/merging_append2.png" /></p>
<p><code>append</code> 可以拼接多个对象：</p>
<div class="codehilite"><pre><span></span><code><span class="n">result</span> <span class="o">=</span> <span class="n">df1</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">df2</span><span class="p">,</span> <span class="n">df3</span><span class="p">])</span>
</code></pre></div>


<p><img alt="../_images/merging_append3.png" src="https://pandas.pydata.org/docs/_images/merging_append3.png" /></p>
<p>与list对象的<code>append()</code>方法不同，DataFrame对象的<code>append()</code>方法会返回副本，<strong>不会修改</strong> <code>df1</code>。</p>
<h3 id="ignore_index">忽略串联轴上的索引：ignore_index</h3>
<p>如果<code>DataFrame</code>的索引没有意义，可以使用<code>ignore_index</code>参数：</p>
<div class="codehilite"><pre><span></span><code><span class="n">result</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df1</span><span class="p">,</span> <span class="n">df4</span><span class="p">],</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sort</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div>


<p><img alt="../_images/merging_concat_ignore_index.png" src="https://pandas.pydata.org/docs/_images/merging_concat_ignore_index.png" /></p>
<p><a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.append.html#pandas.DataFrame.append"><code>DataFrame.append()</code></a>方法也有这个参数：</p>
<div class="codehilite"><pre><span></span><code><span class="n">result</span> <span class="o">=</span> <span class="n">df1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df4</span><span class="p">,</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sort</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div>


<p><img alt="../_images/merging_append_ignore_index.png" src="https://pandas.pydata.org/docs/_images/merging_append_ignore_index.png" /></p>
<h3 id="seriesdataframe">混合串联<code>Series</code>和<code>DataFrame</code></h3>
<p>可以拼接<code>Series</code>和<code>DataFrame</code>。该 <code>Series</code>会转化为<code>DataFrame</code>的一列，列名是<code>Series</code>的<code>name</code>。</p>
<div class="codehilite"><pre><span></span><code><span class="n">s1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="s1">&#39;X0&#39;</span><span class="p">,</span> <span class="s1">&#39;X1&#39;</span><span class="p">,</span> <span class="s1">&#39;X2&#39;</span><span class="p">,</span> <span class="s1">&#39;X3&#39;</span><span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;X&#39;</span><span class="p">)</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df1</span><span class="p">,</span> <span class="n">s1</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div>


<p><img alt="../_images/merging_concat_mixed_ndim.png" src="https://pandas.pydata.org/docs/_images/merging_concat_mixed_ndim.png" /></p>
<p>如果<code>Series</code>未命名，则将连续编号。</p>
<div class="codehilite"><pre><span></span><code><span class="n">s2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="s1">&#39;_0&#39;</span><span class="p">,</span> <span class="s1">&#39;_1&#39;</span><span class="p">,</span> <span class="s1">&#39;_2&#39;</span><span class="p">,</span> <span class="s1">&#39;_3&#39;</span><span class="p">])</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df1</span><span class="p">,</span> <span class="n">s2</span><span class="p">,</span> <span class="n">s2</span><span class="p">,</span> <span class="n">s2</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div>


<p><img alt="../_images/merging_concat_unnamed_series.png" src="https://pandas.pydata.org/docs/_images/merging_concat_unnamed_series.png" /></p>
<p>通过<code>ignore_index=True</code>删除原有索引标签。</p>
<div class="codehilite"><pre><span></span><code><span class="n">result</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df1</span><span class="p">,</span> <span class="n">s1</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div>


<p><img alt="../_images/merging_concat_series_ignore_index.png" src="https://pandas.pydata.org/docs/_images/merging_concat_series_ignore_index.png" /></p>
<h3 id="key"><code>key</code>参数</h3>
<p><code>keys</code>参数的一个相当普遍的用法是重新指定原DataFrame或Series的名字，可以作为拼接后的DataFrame的列索引：</p>
<div class="codehilite"><pre><span></span><code><span class="n">s3</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;foo&#39;</span><span class="p">)</span>
<span class="n">s4</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="n">s5</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>

<span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">s3</span><span class="p">,</span> <span class="n">s4</span><span class="p">,</span> <span class="n">s5</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="err">   foo  0  1</span>
<span class="err">0    0  0  0</span>
<span class="err">1    1  1  1</span>
<span class="err">2    2  2  4</span>
<span class="err">3    3  3  5</span>
</code></pre></div>


<p>通过<code>keys</code>参数，可以覆盖现有的列名。</p>
<div class="codehilite"><pre><span></span><code><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">s3</span><span class="p">,</span> <span class="n">s4</span><span class="p">,</span> <span class="n">s5</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">keys</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="s1">&#39;yellow&#39;</span><span class="p">])</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="err">   red  blue  yellow</span>
<span class="err">0    0     0       0</span>
<span class="err">1    1     1       1</span>
<span class="err">2    2     2       4</span>
<span class="err">3    3     3       5</span>
</code></pre></div>


<p>让我们考虑第一个示例的变体：</p>
<div class="codehilite"><pre><span></span><code><span class="n">result</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">frames</span><span class="p">,</span> <span class="n">keys</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">])</span>
</code></pre></div>


<p><img alt="../_images/merging_concat_group_keys2.png" src="https://pandas.pydata.org/docs/_images/merging_concat_group_keys2.png" /></p>
<p>还可以将需要拼接的DataFrame以dict形式传递给<code>concat</code>函数，在这种情况下，dict键将用作<code>keys</code>参数（除非指定了其他键）：</p>
<div class="codehilite"><pre><span></span><code><span class="n">pieces</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="n">df1</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="n">df2</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">:</span> <span class="n">df3</span><span class="p">}</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">pieces</span><span class="p">)</span>
</code></pre></div>


<p><img alt="../_images/merging_concat_dict.png" src="https://pandas.pydata.org/docs/_images/merging_concat_dict.png" /></p>
<div class="codehilite"><pre><span></span><code><span class="n">result</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">pieces</span><span class="p">,</span> <span class="n">keys</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;z&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">])</span>
</code></pre></div>


<p><img alt="../_images/merging_concat_dict_keys.png" src="https://pandas.pydata.org/docs/_images/merging_concat_dict_keys.png" /></p>
<p>创建的MultiIndex由传递的键和<code>DataFrame</code>行索引构造：</p>
<div class="codehilite"><pre><span></span><code><span class="n">result</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">levels</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="err">FrozenList([[&#39;z&#39;, &#39;y&#39;], [4, 5, 6, 7, 8, 9, 10, 11]])</span>
</code></pre></div>


<p>如果想指定其他级别（偶尔会这样），则可以使用以下<code>levels</code>参数：</p>
<div class="codehilite"><pre><span></span><code><span class="n">result</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">pieces</span><span class="p">,</span> <span class="n">keys</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">],</span>
                   <span class="n">levels</span><span class="o">=</span><span class="p">[[</span><span class="s1">&#39;z&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">]],</span>
                   <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;group_key&#39;</span><span class="p">])</span>
</code></pre></div>


<p><img alt="../_images/merging_concat_dict_keys_names.png" src="https://pandas.pydata.org/docs/_images/merging_concat_dict_keys_names.png" /></p>
<div class="codehilite"><pre><span></span><code><span class="n">result</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">levels</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="err">FrozenList([[&#39;z&#39;, &#39;y&#39;, &#39;x&#39;, &#39;w&#39;], [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,</span>
<span class="err">11]])</span>
</code></pre></div>


<h3 id="dataframe">行追加到 DataFrame</h3>
<p>尽管效率不是很高（因为必须创建一个新的对象），但是可以向<code>append</code>传递一个<code>Series</code>或dict来将一行附加到<code>DataFrame</code>：</p>
<div class="codehilite"><pre><span></span><code><span class="n">s2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="s1">&#39;X0&#39;</span><span class="p">,</span> <span class="s1">&#39;X1&#39;</span><span class="p">,</span> <span class="s1">&#39;X2&#39;</span><span class="p">,</span> <span class="s1">&#39;X3&#39;</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">])</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">df1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s2</span><span class="p">,</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div>


<p><img alt="../_images/merging_append_series_as_row.png" src="https://pandas.pydata.org/docs/_images/merging_append_series_as_row.png" /></p>
<p>还可以传递字典或系列的列表：</p>
<div class="codehilite"><pre><span></span><code><span class="n">dicts</span> <span class="o">=</span> <span class="p">[{</span><span class="s1">&#39;A&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;X&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">},</span>
         <span class="p">{</span><span class="s1">&#39;A&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">:</span> <span class="mi">8</span><span class="p">}]</span>

<span class="n">result</span> <span class="o">=</span> <span class="n">df1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dicts</span><span class="p">,</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sort</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div>


<p><img alt="../_images/merging_append_dits.png" src="https://pandas.pydata.org/docs/_images/merging_append_dits.png" /></p>
<h2 id="_1">数据库形式的拼接</h2>
<p>pandas具有全功能、高性能的内存连接操作，与SQL等关系数据库非常相似。这些方法的性能比其他开源实现（如R中的<code>base::merge.data.frame</code>）要好得多（在某些情况下甚至超过一个数量级）。原因是仔细的算法设计和DataFrame的数据的内部布局。</p>
<p>pandas提供函数<code>merge()</code>，作为DataFrame或Series对象之间所有标准数据库拼接操作的入口点：</p>
<div class="codehilite"><pre><span></span><code><span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;inner&#39;</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">left_on</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">right_on</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
         <span class="n">left_index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">right_index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">sort</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
         <span class="n">suffixes</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;_x&#39;</span><span class="p">,</span> <span class="s1">&#39;_y&#39;</span><span class="p">),</span> <span class="n">copy</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">indicator</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
         <span class="n">validate</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</code></pre></div>


<ul>
<li>
<p><code>left</code>：一个DataFrame或Series的对象。</p>
</li>
<li>
<p><code>right</code>：另一个DataFrame或Series的对象。</p>
</li>
<li>
<p><code>on</code>：一个<code>label</code>或者<code>label list</code>。它指定用作连接键的列的<code>label</code>。并且必须在两个<code>DataFrame</code>中这些<code>label</code>都存在。如果它为<code>None</code>，则默认使用两个<code>DataFrame</code>的列<code>label</code>的交集。你可以通过<code>left_on/right_on</code>分别指定两侧<code>DataFrame</code>对齐的连接键。</p>
</li>
<li>
<p><code>left_on</code>：一个<code>label</code>或者<code>label list</code>。指定左边<code>DataFrame</code>用作连接键的列，参考<code>on</code>。</p>
</li>
<li>
<p><code>right_on</code>：一个<code>label</code>或者<code>label list</code>。指定右边<code>DataFrame</code>用作连接键的列，参考<code>on</code>。</p>
</li>
<li>
<p><code>left_index</code>：一个布尔值。如果为<code>True</code>，则使用左边的<code>DataFrame</code>的行的<code>index value</code>来作为连接键来合并。</p>
</li>
<li>
<p><code>right_index</code>：一个布尔值。如果为<code>True</code>，则使用右边的<code>DataFrame</code>的行的<code>index value</code>来作为连接键来合并。</p>
</li>
<li>
<p><code>how</code>：其一<code>'left'</code>，<code>'right'</code>，<code>'outer'</code>，<code>'inner'</code>。默认为<code>inner</code>。有关每种方法的详细说明，请参见下文。</p>
</li>
<li>
<p><code>sort</code>：一个布尔值。如果为<code>True</code>，则在结果中，对合并采用的连接键进行排序。</p>
</li>
<li>
<p><code>suffixes</code>：一个二元序列。对于结果中同名的列，它会添加前缀来指示它们来自哪个<code>DataFrame</code>。</p>
</li>
<li>
<p><code>copy</code>：一个布尔值。如果为<code>True</code>，则拷贝基础数据。否则不拷贝数据。</p>
</li>
<li>
<p><code>indicator</code>：一个字符串或者布尔值。</p>
<ul>
<li>
<p>如果为<code>True</code>，则结果中多了一列称作<code>_merge</code>，该列给出了每一行来自于那个<code>DataFrame</code>。</p>
</li>
<li>
<p>如果为字符串，则结果中多了一列（该列名字由<code>indicator</code>字符串给出），该列给出了每一行来自于那个<code>DataFrame</code>。</p>
</li>
</ul>
</li>
<li>
<p><code>validate</code>：字符串，默认为无。如果指定，则检查合并是否为指定的类型。</p>
</li>
</ul>
<blockquote>
<ul>
<li>
<p>'one_to_one'或'1:1'：检查合并键在左右数据集中是否唯一。</p>
</li>
<li>
<p>'one_to_many'或'1:m'：检查合并键在左数据集中是否唯一。</p>
</li>
<li>
<p>'many_to_one'或'm:1'：检查合并键在正确的数据集中是否唯一。</p>
</li>
<li>
<p>'many_to_many'或'm:m'：允许，但不进行检查。</p>
</li>
</ul>
</blockquote>
<div class="admonition info">
<p class="admonition-title">新功能</p>
<p>0.23.0版本中添加了指定索引级别的<code>on</code>、<code>left_on</code>、<code>right_on</code>参数的支持。在0.24.0版中添加了对被命名的Series合并的支持。</p>
</div>
<p><code>merge</code>是pandas命名空间中的一个函数，它也可以作为DataFrame实例方法<a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.merge.html#pandas.DataFrame.merge"><code>merge()</code></a>使用，调用 <code>DataFrame.merge</code>时，<code>DataFrame</code>被视为拼接中的左侧对象。</p>
<p>相关<a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.join.html#pandas.DataFrame.join"><code>join()</code></a>方法在<code>merge</code>内部用于索引索引连接（默认情况下）和索引列连接。如果仅加入索引，则可能希望使用<code>DataFrame.join</code>来节省一些输入。</p>
<h3 id="_2">合并方法简介（关系代数）</h3>
<p>有经验的关系数据库（如SQL）用户将熟悉用于描述两个SQL类表结构（DataFrame对象）之间的连接操作的术语。有几个案例需要考虑，这些案例非常重要：</p>
<ul>
<li><strong>one-to-one</strong>联接：两个DataFrame对象的组合键都是唯一值。</li>
<li><strong>many-to-one</strong>联接：其中一个DataFrame对象的组合键是唯一值，另一个有重复值。</li>
<li><strong>many-to-many</strong>联接：两个DataFrame对象的组合键都有重复值。</li>
</ul>
<div class="admonition caution">
<p class="admonition-title">Caution</p>
<p>在列上连接列时（可能是多对多连接），传递的<code>DataFrame</code>对象上的所有索引<strong>都将被丢弃</strong>。</p>
</div>
<p>值得花些时间了解多对多连接案例的结果。<mark>在SQL/标准关系代数中，如果键组合在两个表中出现不止一次，则生成的表将具有关联数据的笛卡尔积。</mark> </p>
<p>下面是一个非常基本的例子，使用一个组合键，并且组合键的值都是唯一的：</p>
<div class="codehilite"><pre><span></span><code><span class="n">left</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;key&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;K0&#39;</span><span class="p">,</span> <span class="s1">&#39;K1&#39;</span><span class="p">,</span> <span class="s1">&#39;K2&#39;</span><span class="p">,</span> <span class="s1">&#39;K3&#39;</span><span class="p">],</span>
                       <span class="s1">&#39;A&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;A0&#39;</span><span class="p">,</span> <span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="s1">&#39;A2&#39;</span><span class="p">,</span> <span class="s1">&#39;A3&#39;</span><span class="p">],</span>
                       <span class="s1">&#39;B&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;B0&#39;</span><span class="p">,</span> <span class="s1">&#39;B1&#39;</span><span class="p">,</span> <span class="s1">&#39;B2&#39;</span><span class="p">,</span> <span class="s1">&#39;B3&#39;</span><span class="p">]})</span>

<span class="n">right</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;key&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;K0&#39;</span><span class="p">,</span> <span class="s1">&#39;K1&#39;</span><span class="p">,</span> <span class="s1">&#39;K2&#39;</span><span class="p">,</span> <span class="s1">&#39;K3&#39;</span><span class="p">],</span>
                        <span class="s1">&#39;C&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;C0&#39;</span><span class="p">,</span> <span class="s1">&#39;C1&#39;</span><span class="p">,</span> <span class="s1">&#39;C2&#39;</span><span class="p">,</span> <span class="s1">&#39;C3&#39;</span><span class="p">],</span>
                        <span class="s1">&#39;D&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;D0&#39;</span><span class="p">,</span> <span class="s1">&#39;D1&#39;</span><span class="p">,</span> <span class="s1">&#39;D2&#39;</span><span class="p">,</span> <span class="s1">&#39;D3&#39;</span><span class="p">]})</span>

<span class="n">result</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;key&#39;</span><span class="p">)</span>
</code></pre></div>


<p><img alt="../_images/merging_merge_on_key.png" src="https://pandas.pydata.org/docs/_images/merging_merge_on_key.png" /></p>
<p>多个组合键的示例（默认<code>how='inner'</code>）：</p>
<div class="codehilite"><pre><span></span><code><span class="n">left</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;key1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;K0&#39;</span><span class="p">,</span> <span class="s1">&#39;K0&#39;</span><span class="p">,</span> <span class="s1">&#39;K1&#39;</span><span class="p">,</span> <span class="s1">&#39;K2&#39;</span><span class="p">],</span>
                     <span class="s1">&#39;key2&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;K0&#39;</span><span class="p">,</span> <span class="s1">&#39;K1&#39;</span><span class="p">,</span> <span class="s1">&#39;K0&#39;</span><span class="p">,</span> <span class="s1">&#39;K1&#39;</span><span class="p">],</span>
                        <span class="s1">&#39;A&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;A0&#39;</span><span class="p">,</span> <span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="s1">&#39;A2&#39;</span><span class="p">,</span> <span class="s1">&#39;A3&#39;</span><span class="p">],</span>
                        <span class="s1">&#39;B&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;B0&#39;</span><span class="p">,</span> <span class="s1">&#39;B1&#39;</span><span class="p">,</span> <span class="s1">&#39;B2&#39;</span><span class="p">,</span> <span class="s1">&#39;B3&#39;</span><span class="p">]})</span>

<span class="n">right</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;key1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;K0&#39;</span><span class="p">,</span> <span class="s1">&#39;K1&#39;</span><span class="p">,</span> <span class="s1">&#39;K1&#39;</span><span class="p">,</span> <span class="s1">&#39;K2&#39;</span><span class="p">],</span>
                      <span class="s1">&#39;key2&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;K0&#39;</span><span class="p">,</span> <span class="s1">&#39;K0&#39;</span><span class="p">,</span> <span class="s1">&#39;K0&#39;</span><span class="p">,</span> <span class="s1">&#39;K0&#39;</span><span class="p">],</span>
                      <span class="s1">&#39;C&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;C0&#39;</span><span class="p">,</span> <span class="s1">&#39;C1&#39;</span><span class="p">,</span> <span class="s1">&#39;C2&#39;</span><span class="p">,</span> <span class="s1">&#39;C3&#39;</span><span class="p">],</span>
                      <span class="s1">&#39;D&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;D0&#39;</span><span class="p">,</span> <span class="s1">&#39;D1&#39;</span><span class="p">,</span> <span class="s1">&#39;D2&#39;</span><span class="p">,</span> <span class="s1">&#39;D3&#39;</span><span class="p">]})</span>

<span class="n">result</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;key1&#39;</span><span class="p">,</span> <span class="s1">&#39;key2&#39;</span><span class="p">])</span>
</code></pre></div>


<p><img alt="../_images/merging_merge_on_key_multiple.png" src="https://pandas.pydata.org/docs/_images/merging_merge_on_key_multiple.png" /></p>
<p>当左右两边的组合键不一致时，处理行为由<code>how</code>参数指定。以下是<code>how</code>选项及其SQL等效名称的摘要：</p>
<table>
<thead>
<tr>
<th align="left">合并方式</th>
<th align="left">SQL连接名称</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>left</code></td>
<td align="left"><code>LEFT OUTER JOIN</code></td>
<td align="left">仅保留left出现的组合键</td>
</tr>
<tr>
<td align="left"><code>right</code></td>
<td align="left"><code>RIGHT OUTER JOIN</code></td>
<td align="left">仅保留right出现的组合键</td>
</tr>
<tr>
<td align="left"><code>outer</code></td>
<td align="left"><code>FULL OUTER JOIN</code></td>
<td align="left">保留left和right组合键的并集</td>
</tr>
<tr>
<td align="left"><code>inner</code></td>
<td align="left"><code>INNER JOIN</code></td>
<td align="left">保留left和right组合键的交集</td>
</tr>
</tbody>
</table>
<div class="codehilite"><pre><span></span><code><span class="n">result</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;key1&#39;</span><span class="p">,</span> <span class="s1">&#39;key2&#39;</span><span class="p">])</span>
</code></pre></div>


<p><img alt="../_images/merging_merge_on_key_left.png" src="https://pandas.pydata.org/docs/_images/merging_merge_on_key_left.png" /></p>
<div class="codehilite"><pre><span></span><code><span class="n">result</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;key1&#39;</span><span class="p">,</span> <span class="s1">&#39;key2&#39;</span><span class="p">])</span>
</code></pre></div>


<p><img alt="../_images/merging_merge_on_key_right.png" src="https://pandas.pydata.org/docs/_images/merging_merge_on_key_right.png" /></p>
<div class="codehilite"><pre><span></span><code><span class="n">result</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;outer&#39;</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;key1&#39;</span><span class="p">,</span> <span class="s1">&#39;key2&#39;</span><span class="p">])</span>
</code></pre></div>


<p><img alt="../_images/merging_merge_on_key_outer.png" src="https://pandas.pydata.org/docs/_images/merging_merge_on_key_outer.png" /></p>
<div class="codehilite"><pre><span></span><code><span class="n">result</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;inner&#39;</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;key1&#39;</span><span class="p">,</span> <span class="s1">&#39;key2&#39;</span><span class="p">])</span>
</code></pre></div>


<p><img alt="../_images/merging_merge_on_key_inner.png" src="https://pandas.pydata.org/docs/_images/merging_merge_on_key_inner.png" /></p>
<p>这是组合键具有重复值的示例：</p>
<div class="codehilite"><pre><span></span><code><span class="n">left</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;A&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="s1">&#39;B&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]})</span>
<span class="n">right</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;A&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="s1">&#39;B&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]})</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;outer&#39;</span><span class="p">)</span>
</code></pre></div>


<p><img alt="../_images/merging_merge_on_key_dup.png" src="https://pandas.pydata.org/docs/_images/merging_merge_on_key_dup.png" /></p>
<div class="admonition caution">
<p class="admonition-title">Caution</p>
<p>在重复键上进行拼接，会导致返回的DataFrame的函数是原来两个DataFrame行数的乘积，这可能导致内存溢出。如果DataFrame很大，应该对重复键进行管理。</p>
</div>
<h3 id="validate">检查重复键：validate</h3>
<blockquote>
<p>这是 0.21.0版添加的功能。</p>
</blockquote>
<p>可以使用<code>validate</code>参数自动检查组合键中是否有意外的重复项。在合并操作之前检查键的唯一性，可以防止内存溢出。检查组合键的唯一性也是确保数据结构符合预期的一种好方法。</p>
<p>在以下示例中，right中的<code>B</code>存在重复的值。由于这不是<code>validate</code>参数中指定的一对一合并，因此将引发异常。</p>
<div class="codehilite"><pre><span></span><code><span class="n">left</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;A&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="s1">&#39;B&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]})</span>
<span class="n">right</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;A&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">],</span> <span class="s1">&#39;B&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]})</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;outer&#39;</span><span class="p">,</span> <span class="n">validate</span><span class="o">=</span><span class="s2">&quot;one_to_one&quot;</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;MergeError:&quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="n">MergeError</span><span class="o">:</span> <span class="n">Merge</span> <span class="n">keys</span> <span class="n">are</span> <span class="n">not</span> <span class="n">unique</span> <span class="k">in</span> <span class="n">right</span> <span class="n">dataset</span><span class="o">;</span> <span class="n">not</span> <span class="n">a</span> <span class="n">one</span><span class="o">-</span><span class="n">to</span><span class="o">-</span>
<span class="n">one</span> <span class="n">merge</span>
</code></pre></div>


<p>如果用户知道右边的重复项，<code>DataFrame</code>但要确保左边的DataFrame中没有重复项，则可以改用该<code>validate='one_to_many'</code>参数，这不会引发异常。</p>
<div class="codehilite"><pre><span></span><code><span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;outer&#39;</span><span class="p">,</span> <span class="n">validate</span><span class="o">=</span><span class="s2">&quot;one_to_many&quot;</span><span class="p">)</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="err">   A_x  B  A_y</span>
<span class="err">0    1  1  NaN</span>
<span class="err">1    2  2  4.0</span>
<span class="err">2    2  2  5.0</span>
<span class="err">3    2  2  6.0</span>
</code></pre></div>


<h3 id="indicator">指示符：indicator</h3>
<p><a href="https://pandas.pydata.org/docs/reference/api/pandas.merge.html#pandas.merge"><code>merge()</code></a>接受指示符参数<code>indicator</code>。如果<code>indicator=True</code>，则将一个名为<code>_merge</code>，dtype为Categorical的列添加到输出DataFrame的末尾：</p>
<table>
<thead>
<tr>
<th align="left">indicator</th>
<th align="left"><code>_merge</code>值</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">仅出现在<code>'left'</code>组合键</td>
<td align="left"><code>left_only</code></td>
</tr>
<tr>
<td align="left">仅出现在<code>'right'</code>组合键</td>
<td align="left"><code>right_only</code></td>
</tr>
<tr>
<td align="left">同时出现在<code>'left'</code>和<code>'right'</code>组合键</td>
<td align="left"><code>both</code></td>
</tr>
</tbody>
</table>
<div class="codehilite"><pre><span></span><code><span class="n">df1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;col1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;col_left&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">]})</span>
<span class="n">df2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;col1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="s1">&#39;col_right&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]})</span>
<span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df1</span><span class="p">,</span> <span class="n">df2</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;col1&#39;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;outer&#39;</span><span class="p">,</span> <span class="n">indicator</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="err">   col1 col_left  col_right      _merge</span>
<span class="err">0     0        a        NaN   left_only</span>
<span class="err">1     1        b        2.0        both</span>
<span class="err">2     2      NaN        2.0  right_only</span>
<span class="err">3     2      NaN        2.0  right_only</span>
</code></pre></div>


<p><code>indicator</code>参数还可以接受字符串参数，在这种情况下，指标函数将使用传递的字符串的值作为<strong>指标列</strong>的名称。</p>
<div class="codehilite"><pre><span></span><code><span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df1</span><span class="p">,</span> <span class="n">df2</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;col1&#39;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;outer&#39;</span><span class="p">,</span> <span class="n">indicator</span><span class="o">=</span><span class="s1">&#39;indicator_column&#39;</span><span class="p">)</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="err">   col1 col_left  col_right indicator_column</span>
<span class="err">0     0        a        NaN        left_only</span>
<span class="err">1     1        b        2.0             both</span>
<span class="err">2     2      NaN        2.0       right_only</span>
<span class="err">3     2      NaN        2.0       right_only</span>
</code></pre></div>


<h3 id="_3">合并时数据类型的转换</h3>
<p>合并将保留组合键的数据类型</p>
<div class="codehilite"><pre><span></span><code><span class="n">left</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;key&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;v1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">10</span><span class="p">]})</span>
<span class="nb">print</span><span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">right</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;key&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="s1">&#39;v1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">]})</span>
<span class="nb">print</span><span class="p">(</span><span class="n">right</span><span class="p">)</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code>   <span class="k">key</span>  <span class="n">v1</span>
<span class="mi">0</span>    <span class="mi">1</span>  <span class="mi">10</span>

   <span class="k">key</span>  <span class="n">v1</span>
<span class="mi">0</span>    <span class="mi">1</span>  <span class="mi">20</span>
<span class="mi">1</span>    <span class="mi">2</span>  <span class="mi">30</span>
</code></pre></div>


<p>我们可以保留组合键：</p>
<div class="codehilite"><pre><span></span><code><span class="nb">print</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;outer&#39;</span><span class="p">),</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;outer&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">dtypes</span><span class="p">)</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code>   <span class="k">key</span>  <span class="n">v1</span>
<span class="mi">0</span>    <span class="mi">1</span>  <span class="mi">10</span>
<span class="mi">1</span>    <span class="mi">1</span>  <span class="mi">20</span>
<span class="mi">2</span>    <span class="mi">2</span>  <span class="mi">30</span>

<span class="k">key</span>    <span class="n">int64</span>
<span class="n">v1</span>     <span class="n">int64</span>
<span class="n">dtype</span><span class="p">:</span> <span class="k">object</span>
</code></pre></div>


<p>如果缺少引入的值，则生成的dtype将被转换：</p>
<div class="codehilite"><pre><span></span><code><span class="nb">print</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;outer&#39;</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;key&#39;</span><span class="p">),</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;outer&#39;</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;key&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">dtypes</span><span class="p">)</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code>   <span class="k">key</span>  <span class="n">v1_x</span>  <span class="n">v1_y</span>
<span class="mi">0</span>    <span class="mi">1</span>  <span class="mi">10</span><span class="p">.</span><span class="mi">0</span>    <span class="mi">20</span>
<span class="mi">1</span>    <span class="mi">2</span>   <span class="n">NaN</span>    <span class="mi">30</span>

<span class="k">key</span>       <span class="n">int64</span>
<span class="n">v1_x</span>    <span class="n">float64</span>
<span class="n">v1_y</span>      <span class="n">int64</span>
<span class="n">dtype</span><span class="p">:</span> <span class="k">object</span>
</code></pre></div>


<p>合并将保留mergands的category类型。另请参阅关于<a href="https://pandas.pydata.org/docs/user_guide/categorical.html#categorical-merge">categoricals</a>的部分。</p>
<p>left：</p>
<div class="codehilite"><pre><span></span><code><span class="kn">from</span> <span class="nn">pandas.api.types</span> <span class="kn">import</span> <span class="n">CategoricalDtype</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">([</span><span class="s1">&#39;foo&#39;</span><span class="p">,</span> <span class="s1">&#39;bar&#39;</span><span class="p">],</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,)))</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">CategoricalDtype</span><span class="p">(</span><span class="n">categories</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;foo&#39;</span><span class="p">,</span> <span class="s1">&#39;bar&#39;</span><span class="p">]))</span>

<span class="n">left</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;X&#39;</span><span class="p">:</span> <span class="n">X</span><span class="p">,</span>
                     <span class="s1">&#39;Y&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">([</span><span class="s1">&#39;one&#39;</span><span class="p">,</span> <span class="s1">&#39;two&#39;</span><span class="p">,</span> <span class="s1">&#39;three&#39;</span><span class="p">],</span>
                                           <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,))})</span>

<span class="nb">print</span><span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">left</span><span class="o">.</span><span class="n">dtypes</span><span class="p">)</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code>     <span class="n">X</span>      <span class="n">Y</span>
<span class="mi">0</span>  <span class="n">bar</span>    <span class="n">one</span>
<span class="mi">1</span>  <span class="n">foo</span>  <span class="n">three</span>
<span class="mi">2</span>  <span class="n">bar</span>  <span class="n">three</span>
<span class="mi">3</span>  <span class="n">foo</span>    <span class="n">one</span>
<span class="mi">4</span>  <span class="n">bar</span>    <span class="n">one</span>
<span class="mi">5</span>  <span class="n">bar</span>  <span class="n">three</span>
<span class="mi">6</span>  <span class="n">bar</span>    <span class="n">one</span>
<span class="mi">7</span>  <span class="n">foo</span>  <span class="n">three</span>
<span class="mi">8</span>  <span class="n">bar</span>    <span class="n">two</span>
<span class="mi">9</span>  <span class="n">foo</span>  <span class="n">three</span>

<span class="n">X</span>    <span class="n">category</span>
<span class="n">Y</span>      <span class="k">object</span>
<span class="n">dtype</span><span class="p">:</span> <span class="k">object</span>
</code></pre></div>


<p>right：</p>
<div class="codehilite"><pre><span></span><code><span class="n">right</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;X&#39;</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="s1">&#39;foo&#39;</span><span class="p">,</span> <span class="s1">&#39;bar&#39;</span><span class="p">],</span>
                                     <span class="n">dtype</span><span class="o">=</span><span class="n">CategoricalDtype</span><span class="p">([</span><span class="s1">&#39;foo&#39;</span><span class="p">,</span> <span class="s1">&#39;bar&#39;</span><span class="p">])),</span>
                     <span class="s1">&#39;Z&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]})</span>

<span class="nb">print</span><span class="p">(</span><span class="n">right</span><span class="p">,</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">right</span><span class="o">.</span><span class="n">dtypes</span><span class="p">)</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code>     <span class="n">X</span>  <span class="n">Z</span>
<span class="mi">0</span>  <span class="n">foo</span>  <span class="mi">1</span>
<span class="mi">1</span>  <span class="n">bar</span>  <span class="mi">2</span>

<span class="n">X</span>    <span class="n">category</span>
<span class="n">Z</span>       <span class="n">int64</span>
<span class="n">dtype</span><span class="p">:</span> <span class="k">object</span>
</code></pre></div>


<p>合并结果：</p>
<div class="codehilite"><pre><span></span><code><span class="n">result</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;outer&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">dtypes</span><span class="p">)</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code>     <span class="n">X</span>      <span class="n">Y</span>  <span class="n">Z</span>
<span class="mi">0</span>  <span class="n">bar</span>    <span class="n">one</span>  <span class="mi">2</span>
<span class="mi">1</span>  <span class="n">bar</span>  <span class="n">three</span>  <span class="mi">2</span>
<span class="mi">2</span>  <span class="n">bar</span>    <span class="n">one</span>  <span class="mi">2</span>
<span class="mi">3</span>  <span class="n">bar</span>  <span class="n">three</span>  <span class="mi">2</span>
<span class="mi">4</span>  <span class="n">bar</span>    <span class="n">one</span>  <span class="mi">2</span>
<span class="mi">5</span>  <span class="n">bar</span>    <span class="n">two</span>  <span class="mi">2</span>
<span class="mi">6</span>  <span class="n">foo</span>  <span class="n">three</span>  <span class="mi">1</span>
<span class="mi">7</span>  <span class="n">foo</span>    <span class="n">one</span>  <span class="mi">1</span>
<span class="mi">8</span>  <span class="n">foo</span>  <span class="n">three</span>  <span class="mi">1</span>
<span class="mi">9</span>  <span class="n">foo</span>  <span class="n">three</span>  <span class="mi">1</span>

<span class="n">X</span>    <span class="n">category</span>
<span class="n">Y</span>      <span class="k">object</span>
<span class="n">Z</span>       <span class="n">int64</span>
<span class="n">dtype</span><span class="p">:</span> <span class="k">object</span>
</code></pre></div>


<div class="admonition note">
<p class="admonition-title">注意</p>
<p>category 类型必须<strong>完全相同</strong>，这意味着category对象有相同的类别和有序属性。否则，category类型将被转换成object类型。</p>
</div>
<div class="admonition note">
<p class="admonition-title">注意</p>
<p>与object数据类型合并相比，在相同的category数据类型上进行合并可以获得更好的性能。</p>
</div>
<h3 id="dataframejoin"><a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.join.html#pandas.DataFrame.join"><code>DataFrame.join()</code></a></h3>
<p>这是一个非常基本的示例：</p>
<div class="codehilite"><pre><span></span><code><span class="n">left</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;A&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;A0&#39;</span><span class="p">,</span> <span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="s1">&#39;A2&#39;</span><span class="p">],</span>
                     <span class="s1">&#39;B&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;B0&#39;</span><span class="p">,</span> <span class="s1">&#39;B1&#39;</span><span class="p">,</span> <span class="s1">&#39;B2&#39;</span><span class="p">]},</span>
                    <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;K0&#39;</span><span class="p">,</span> <span class="s1">&#39;K1&#39;</span><span class="p">,</span> <span class="s1">&#39;K2&#39;</span><span class="p">])</span>

<span class="n">right</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;C&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;C0&#39;</span><span class="p">,</span> <span class="s1">&#39;C2&#39;</span><span class="p">,</span> <span class="s1">&#39;C3&#39;</span><span class="p">],</span>
                      <span class="s1">&#39;D&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;D0&#39;</span><span class="p">,</span> <span class="s1">&#39;D2&#39;</span><span class="p">,</span> <span class="s1">&#39;D3&#39;</span><span class="p">]},</span>
                     <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;K0&#39;</span><span class="p">,</span> <span class="s1">&#39;K2&#39;</span><span class="p">,</span> <span class="s1">&#39;K3&#39;</span><span class="p">])</span>

<span class="n">result</span> <span class="o">=</span> <span class="n">left</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">right</span><span class="p">)</span>
</code></pre></div>


<p><img alt="../_images/merging_join.png" src="https://pandas.pydata.org/docs/_images/merging_join.png" /></p>
<div class="codehilite"><pre><span></span><code><span class="n">result</span> <span class="o">=</span> <span class="n">left</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">right</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;outer&#39;</span><span class="p">)</span>
</code></pre></div>


<p><img alt="../_images/merging_join_outer.png" src="https://pandas.pydata.org/docs/_images/merging_join_outer.png" /></p>
<p>与上述相同，但带有<code>how='inner'</code>：</p>
<div class="codehilite"><pre><span></span><code><span class="n">result</span> <span class="o">=</span> <span class="n">left</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">right</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;inner&#39;</span><span class="p">)</span>
</code></pre></div>


<p><img alt="../_images/merging_join_inner.png" src="https://pandas.pydata.org/docs/_images/merging_join_inner.png" /></p>
<p>此处的数据对齐在索引（行标签）上。使用<code>merge</code>指示其使用索引的附加参数可以实现相同的行为：</p>
<div class="codehilite"><pre><span></span><code><span class="n">result</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">left_index</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">right_index</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;outer&#39;</span><span class="p">)</span>
</code></pre></div>


<p><img alt="../_images/merging_merge_index_outer.png" src="https://pandas.pydata.org/docs/_images/merging_merge_index_outer.png" /></p>
<div class="codehilite"><pre><span></span><code><span class="n">result</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">left_index</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">right_index</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;inner&#39;</span><span class="p">)</span>
</code></pre></div>


<p><img alt="../_images/merging_merge_index_inner.png" src="https://pandas.pydata.org/docs/_images/merging_merge_index_inner.png" /></p>
<h3 id="join_1">按<strong>组合键列</strong>和<strong>索引</strong>拼接：join</h3>
<p><code>join()</code>接受一个可选的<code>on</code>参数，该参数可以是一个列或多个列名，它指定传递的DataFrame将在原DataFrame中的该列上对齐。即这两个函数调用完全等价：</p>
<div class="codehilite"><pre><span></span><code><span class="n">left</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">right</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="n">key_or_keys</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">left_on</span><span class="o">=</span><span class="n">key_or_keys</span><span class="p">,</span> <span class="n">right_index</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
      <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">sort</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div>


<p>显然，您可以选择任何一种更方便的形式。对于many-to-one拼接（其中一个DataFrame的索引是组合键），使用<code>join</code>可能会更方便。这是一个简单的示例：</p>
<div class="codehilite"><pre><span></span><code><span class="n">left</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;A&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;A0&#39;</span><span class="p">,</span> <span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="s1">&#39;A2&#39;</span><span class="p">,</span> <span class="s1">&#39;A3&#39;</span><span class="p">],</span>
                     <span class="s1">&#39;B&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;B0&#39;</span><span class="p">,</span> <span class="s1">&#39;B1&#39;</span><span class="p">,</span> <span class="s1">&#39;B2&#39;</span><span class="p">,</span> <span class="s1">&#39;B3&#39;</span><span class="p">],</span>
                   <span class="s1">&#39;key&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;K0&#39;</span><span class="p">,</span> <span class="s1">&#39;K1&#39;</span><span class="p">,</span> <span class="s1">&#39;K0&#39;</span><span class="p">,</span> <span class="s1">&#39;K1&#39;</span><span class="p">]})</span>

<span class="n">right</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;C&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;C0&#39;</span><span class="p">,</span> <span class="s1">&#39;C1&#39;</span><span class="p">],</span>
                      <span class="s1">&#39;D&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;D0&#39;</span><span class="p">,</span> <span class="s1">&#39;D1&#39;</span><span class="p">]},</span>
                      <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;K0&#39;</span><span class="p">,</span> <span class="s1">&#39;K1&#39;</span><span class="p">])</span>

<span class="n">result</span> <span class="o">=</span> <span class="n">left</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">right</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;key&#39;</span><span class="p">)</span>
</code></pre></div>


<p><img alt="../_images/merging_join_key_columns.png" src="https://pandas.pydata.org/docs/_images/merging_join_key_columns.png" /></p>
<div class="codehilite"><pre><span></span><code><span class="n">result</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">left_on</span><span class="o">=</span><span class="s1">&#39;key&#39;</span><span class="p">,</span> <span class="n">right_index</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                   <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">sort</span><span class="o">=</span><span class="kc">False</span><span class="p">);</span>
</code></pre></div>


<p><img alt="../_images/merging_merge_key_columns.png" src="https://pandas.pydata.org/docs/_images/merging_merge_key_columns.png" /></p>
<p>如果组合键有多个，传递的DataFrame必须具有<code>MultiIndex</code>：</p>
<div class="codehilite"><pre><span></span><code><span class="n">left</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;A&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;A0&#39;</span><span class="p">,</span> <span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="s1">&#39;A2&#39;</span><span class="p">,</span> <span class="s1">&#39;A3&#39;</span><span class="p">],</span>
                     <span class="s1">&#39;B&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;B0&#39;</span><span class="p">,</span> <span class="s1">&#39;B1&#39;</span><span class="p">,</span> <span class="s1">&#39;B2&#39;</span><span class="p">,</span> <span class="s1">&#39;B3&#39;</span><span class="p">],</span>
                  <span class="s1">&#39;key1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;K0&#39;</span><span class="p">,</span> <span class="s1">&#39;K0&#39;</span><span class="p">,</span> <span class="s1">&#39;K1&#39;</span><span class="p">,</span> <span class="s1">&#39;K2&#39;</span><span class="p">],</span>
                  <span class="s1">&#39;key2&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;K0&#39;</span><span class="p">,</span> <span class="s1">&#39;K1&#39;</span><span class="p">,</span> <span class="s1">&#39;K0&#39;</span><span class="p">,</span> <span class="s1">&#39;K1&#39;</span><span class="p">]})</span>

<span class="n">index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_tuples</span><span class="p">([(</span><span class="s1">&#39;K0&#39;</span><span class="p">,</span> <span class="s1">&#39;K0&#39;</span><span class="p">),</span> 
                                   <span class="p">(</span><span class="s1">&#39;K1&#39;</span><span class="p">,</span> <span class="s1">&#39;K0&#39;</span><span class="p">),</span>
                                   <span class="p">(</span><span class="s1">&#39;K2&#39;</span><span class="p">,</span> <span class="s1">&#39;K0&#39;</span><span class="p">),</span> 
                                   <span class="p">(</span><span class="s1">&#39;K2&#39;</span><span class="p">,</span> <span class="s1">&#39;K1&#39;</span><span class="p">)])</span>

<span class="n">right</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;C&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;C0&#39;</span><span class="p">,</span> <span class="s1">&#39;C1&#39;</span><span class="p">,</span> <span class="s1">&#39;C2&#39;</span><span class="p">,</span> <span class="s1">&#39;C3&#39;</span><span class="p">],</span>
                      <span class="s1">&#39;D&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;D0&#39;</span><span class="p">,</span> <span class="s1">&#39;D1&#39;</span><span class="p">,</span> <span class="s1">&#39;D2&#39;</span><span class="p">,</span> <span class="s1">&#39;D3&#39;</span><span class="p">]},</span>
                      <span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">)</span>
</code></pre></div>


<p>现在，可以通过传递两个组合键来进行拼接：</p>
<div class="codehilite"><pre><span></span><code><span class="n">result</span> <span class="o">=</span> <span class="n">left</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">right</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;key1&#39;</span><span class="p">,</span> <span class="s1">&#39;key2&#39;</span><span class="p">])</span>
</code></pre></div>


<p><img alt="../_images/merging_join_multikeys.png" src="https://pandas.pydata.org/docs/_images/merging_join_multikeys.png" /></p>
<p>默认的<code>DataFrame.join</code>是执行左联接（对于Excel用户，本质上是“ VLOOKUP”操作），该联接仅使用在调用DataFrame中找到的键。其他联接类型（例如内部联接）也可以轻松执行：</p>
<div class="codehilite"><pre><span></span><code><span class="n">result</span> <span class="o">=</span> <span class="n">left</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">right</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;key1&#39;</span><span class="p">,</span> <span class="s1">&#39;key2&#39;</span><span class="p">],</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;inner&#39;</span><span class="p">)</span>
</code></pre></div>


<p><img alt="../_images/merging_join_multikeys_inner.png" src="https://pandas.pydata.org/docs/_images/merging_join_multikeys_inner.png" /></p>
<p>如您所见，这将删除所有不匹配的行。</p>
<h3 id="join_2">按<strong>单层索引</strong>和<strong>多层索引</strong>拼接：join</h3>
<p>可以将单层索引DataFrame与多层索引DataFrame的<strong>一个级别</strong>连接起来。该级别将与单索引DataFrame的索引名称和多索引DataFrame的级别名称相匹配</p>
<div class="codehilite"><pre><span></span><code><span class="n">left</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;A&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;A0&#39;</span><span class="p">,</span> <span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="s1">&#39;A2&#39;</span><span class="p">],</span>
                     <span class="s1">&#39;B&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;B0&#39;</span><span class="p">,</span> <span class="s1">&#39;B1&#39;</span><span class="p">,</span> <span class="s1">&#39;B2&#39;</span><span class="p">]},</span>
              <span class="n">index</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">Index</span><span class="p">([</span><span class="s1">&#39;K0&#39;</span><span class="p">,</span> <span class="s1">&#39;K1&#39;</span><span class="p">,</span> <span class="s1">&#39;K2&#39;</span><span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;key&#39;</span><span class="p">))</span>

<span class="n">index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_tuples</span><span class="p">([(</span><span class="s1">&#39;K0&#39;</span><span class="p">,</span> <span class="s1">&#39;Y0&#39;</span><span class="p">),</span> 
                                   <span class="p">(</span><span class="s1">&#39;K1&#39;</span><span class="p">,</span> <span class="s1">&#39;Y1&#39;</span><span class="p">),</span> 
                                   <span class="p">(</span><span class="s1">&#39;K2&#39;</span><span class="p">,</span> <span class="s1">&#39;Y2&#39;</span><span class="p">),</span> 
                                   <span class="p">(</span><span class="s1">&#39;K2&#39;</span><span class="p">,</span> <span class="s1">&#39;Y3&#39;</span><span class="p">)],</span>
                                  <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;key&#39;</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">])</span>

<span class="n">right</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;C&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;C0&#39;</span><span class="p">,</span> <span class="s1">&#39;C1&#39;</span><span class="p">,</span> <span class="s1">&#39;C2&#39;</span><span class="p">,</span> <span class="s1">&#39;C3&#39;</span><span class="p">],</span>
                      <span class="s1">&#39;D&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;D0&#39;</span><span class="p">,</span> <span class="s1">&#39;D1&#39;</span><span class="p">,</span> <span class="s1">&#39;D2&#39;</span><span class="p">,</span> <span class="s1">&#39;D3&#39;</span><span class="p">]},</span>
                      <span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">)</span>

<span class="n">result</span> <span class="o">=</span> <span class="n">left</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">right</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;inner&#39;</span><span class="p">)</span>
</code></pre></div>


<p><img alt="../_images/merging_join_multiindex_inner.png" src="https://pandas.pydata.org/docs/_images/merging_join_multiindex_inner.png" /></p>
<p>下面的函数和上面的方法是等效的，但<code>pd.merge</code>的信息更详细，存储效率更高/更快。</p>
<div class="codehilite"><pre><span></span><code><span class="n">result</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">left</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(),</span> <span class="n">right</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(),</span>
       <span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;key&#39;</span><span class="p">],</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;inner&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">set_index</span><span class="p">([</span><span class="s1">&#39;key&#39;</span><span class="p">,</span><span class="s1">&#39;Y&#39;</span><span class="p">])</span>
</code></pre></div>


<p><img alt="../_images/merging_merge_multiindex_alternative.png" src="https://pandas.pydata.org/docs/_images/merging_merge_multiindex_alternative.png" /></p>
<h3 id="multiindexesjoin">按MultiIndexes拼接：join</h3>
<p>只要在连接中完全使用了右参数的索引，并且该参数是左参数中索引的子集，就可以用有限的方式来支持它，如下例所示：</p>
<div class="codehilite"><pre><span></span><code><span class="n">leftindex</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_product</span><span class="p">([</span><span class="nb">list</span><span class="p">(</span><span class="s1">&#39;abc&#39;</span><span class="p">),</span> <span class="nb">list</span><span class="p">(</span><span class="s1">&#39;xy&#39;</span><span class="p">),</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]],</span>
                                       <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;abc&#39;</span><span class="p">,</span> <span class="s1">&#39;xy&#39;</span><span class="p">,</span> <span class="s1">&#39;num&#39;</span><span class="p">])</span>

<span class="n">left</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;v1&#39;</span><span class="p">:</span> <span class="nb">range</span><span class="p">(</span><span class="mi">12</span><span class="p">)},</span> <span class="n">index</span><span class="o">=</span><span class="n">leftindex</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">rightindex</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_product</span><span class="p">([</span><span class="nb">list</span><span class="p">(</span><span class="s1">&#39;abc&#39;</span><span class="p">),</span> <span class="nb">list</span><span class="p">(</span><span class="s1">&#39;xy&#39;</span><span class="p">)],</span>
                                         <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;abc&#39;</span><span class="p">,</span> <span class="s1">&#39;xy&#39;</span><span class="p">])</span>

<span class="n">right</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;v2&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">100</span> <span class="o">*</span> <span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">)]},</span> <span class="n">index</span><span class="o">=</span><span class="n">rightindex</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">right</span><span class="p">,</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">left</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">right</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;abc&#39;</span><span class="p">,</span> <span class="s1">&#39;xy&#39;</span><span class="p">],</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;inner&#39;</span><span class="p">)</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code>            <span class="n">v1</span>
<span class="n">abc</span> <span class="n">xy</span> <span class="n">num</span>
<span class="n">a</span>   <span class="n">x</span>  <span class="mi">1</span>     <span class="mi">0</span>
       <span class="mi">2</span>     <span class="mi">1</span>
    <span class="n">y</span>  <span class="mi">1</span>     <span class="mi">2</span>
       <span class="mi">2</span>     <span class="mi">3</span>
<span class="n">b</span>   <span class="n">x</span>  <span class="mi">1</span>     <span class="mi">4</span>
       <span class="mi">2</span>     <span class="mi">5</span>
    <span class="n">y</span>  <span class="mi">1</span>     <span class="mi">6</span>
       <span class="mi">2</span>     <span class="mi">7</span>
<span class="k">c</span>   <span class="n">x</span>  <span class="mi">1</span>     <span class="mi">8</span>
       <span class="mi">2</span>     <span class="mi">9</span>
    <span class="n">y</span>  <span class="mi">1</span>    <span class="mi">10</span>
       <span class="mi">2</span>    <span class="mi">11</span>

         <span class="n">v2</span>
<span class="n">abc</span> <span class="n">xy</span>
<span class="n">a</span>   <span class="n">x</span>   <span class="mi">100</span>
    <span class="n">y</span>   <span class="mi">200</span>
<span class="n">b</span>   <span class="n">x</span>   <span class="mi">300</span>
    <span class="n">y</span>   <span class="mi">400</span>
<span class="k">c</span>   <span class="n">x</span>   <span class="mi">500</span>
    <span class="n">y</span>   <span class="mi">600</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="err">            v1   v2</span>
<span class="err">abc xy num</span>
<span class="err">a   x  1     0  100</span>
<span class="err">       2     1  100</span>
<span class="err">    y  1     2  200</span>
<span class="err">       2     3  200</span>
<span class="err">b   x  1     4  300</span>
<span class="err">       2     5  300</span>
<span class="err">    y  1     6  400</span>
<span class="err">       2     7  400</span>
<span class="err">c   x  1     8  500</span>
<span class="err">       2     9  500</span>
<span class="err">    y  1    10  600</span>
<span class="err">       2    11  600</span>
</code></pre></div>


<p>如果不满足该条件，则可以使用以下代码完成具有两个多索引的联接。</p>
<div class="codehilite"><pre><span></span><code><span class="n">leftindex</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_tuples</span><span class="p">([(</span><span class="s1">&#39;K0&#39;</span><span class="p">,</span> <span class="s1">&#39;X0&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;K0&#39;</span><span class="p">,</span> <span class="s1">&#39;X1&#39;</span><span class="p">),</span>
                                       <span class="p">(</span><span class="s1">&#39;K1&#39;</span><span class="p">,</span> <span class="s1">&#39;X2&#39;</span><span class="p">)],</span>
                                      <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;key&#39;</span><span class="p">,</span> <span class="s1">&#39;X&#39;</span><span class="p">])</span>

<span class="n">left</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;A&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;A0&#39;</span><span class="p">,</span> <span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="s1">&#39;A2&#39;</span><span class="p">],</span>
                     <span class="s1">&#39;B&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;B0&#39;</span><span class="p">,</span> <span class="s1">&#39;B1&#39;</span><span class="p">,</span> <span class="s1">&#39;B2&#39;</span><span class="p">]},</span>
                    <span class="n">index</span><span class="o">=</span><span class="n">leftindex</span><span class="p">)</span>

<span class="n">rightindex</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_tuples</span><span class="p">([(</span><span class="s1">&#39;K0&#39;</span><span class="p">,</span> <span class="s1">&#39;Y0&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;K1&#39;</span><span class="p">,</span> <span class="s1">&#39;Y1&#39;</span><span class="p">),</span>
                                        <span class="p">(</span><span class="s1">&#39;K2&#39;</span><span class="p">,</span> <span class="s1">&#39;Y2&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;K2&#39;</span><span class="p">,</span> <span class="s1">&#39;Y3&#39;</span><span class="p">)],</span>
                                       <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;key&#39;</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">])</span>

<span class="n">right</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;C&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;C0&#39;</span><span class="p">,</span> <span class="s1">&#39;C1&#39;</span><span class="p">,</span> <span class="s1">&#39;C2&#39;</span><span class="p">,</span> <span class="s1">&#39;C3&#39;</span><span class="p">],</span>
                      <span class="s1">&#39;D&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;D0&#39;</span><span class="p">,</span> <span class="s1">&#39;D1&#39;</span><span class="p">,</span> <span class="s1">&#39;D2&#39;</span><span class="p">,</span> <span class="s1">&#39;D3&#39;</span><span class="p">]},</span>
                     <span class="n">index</span><span class="o">=</span><span class="n">rightindex</span><span class="p">)</span>

<span class="n">result</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">left</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(),</span> <span class="n">right</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(),</span>
                  <span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;key&#39;</span><span class="p">],</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;inner&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">set_index</span><span class="p">([</span><span class="s1">&#39;key&#39;</span><span class="p">,</span> <span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">])</span>
</code></pre></div>


<p><img alt="../_images/merging_merge_two_multiindex.png" src="https://pandas.pydata.org/docs/_images/merging_merge_two_multiindex.png" /></p>
<h3 id="_4">按照列和索引合并</h3>
<blockquote>
<p>这是 0.23 版中添加的功能。</p>
</blockquote>
<p><code>on</code>、<code>left_on</code>和<code>right_on</code>参数可以引用列名或索引级名称。这允许在索引和列的组合上合并DataFrame实例，而不必重置索引：</p>
<div class="codehilite"><pre><span></span><code><span class="n">left_index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Index</span><span class="p">([</span><span class="s1">&#39;K0&#39;</span><span class="p">,</span> <span class="s1">&#39;K0&#39;</span><span class="p">,</span> <span class="s1">&#39;K1&#39;</span><span class="p">,</span> <span class="s1">&#39;K2&#39;</span><span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;key1&#39;</span><span class="p">)</span>

<span class="n">left</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;A&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;A0&#39;</span><span class="p">,</span> <span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="s1">&#39;A2&#39;</span><span class="p">,</span> <span class="s1">&#39;A3&#39;</span><span class="p">],</span>
                     <span class="s1">&#39;B&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;B0&#39;</span><span class="p">,</span> <span class="s1">&#39;B1&#39;</span><span class="p">,</span> <span class="s1">&#39;B2&#39;</span><span class="p">,</span> <span class="s1">&#39;B3&#39;</span><span class="p">],</span>
                  <span class="s1">&#39;key2&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;K0&#39;</span><span class="p">,</span> <span class="s1">&#39;K1&#39;</span><span class="p">,</span> <span class="s1">&#39;K0&#39;</span><span class="p">,</span> <span class="s1">&#39;K1&#39;</span><span class="p">]},</span>
                    <span class="n">index</span><span class="o">=</span><span class="n">left_index</span><span class="p">)</span>

<span class="n">right_index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Index</span><span class="p">([</span><span class="s1">&#39;K0&#39;</span><span class="p">,</span> <span class="s1">&#39;K1&#39;</span><span class="p">,</span> <span class="s1">&#39;K2&#39;</span><span class="p">,</span> <span class="s1">&#39;K2&#39;</span><span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;key1&#39;</span><span class="p">)</span>

<span class="n">right</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;C&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;C0&#39;</span><span class="p">,</span> <span class="s1">&#39;C1&#39;</span><span class="p">,</span> <span class="s1">&#39;C2&#39;</span><span class="p">,</span> <span class="s1">&#39;C3&#39;</span><span class="p">],</span>
                      <span class="s1">&#39;D&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;D0&#39;</span><span class="p">,</span> <span class="s1">&#39;D1&#39;</span><span class="p">,</span> <span class="s1">&#39;D2&#39;</span><span class="p">,</span> <span class="s1">&#39;D3&#39;</span><span class="p">],</span>
                   <span class="s1">&#39;key2&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;K0&#39;</span><span class="p">,</span> <span class="s1">&#39;K0&#39;</span><span class="p">,</span> <span class="s1">&#39;K0&#39;</span><span class="p">,</span> <span class="s1">&#39;K1&#39;</span><span class="p">]},</span>
                     <span class="n">index</span><span class="o">=</span><span class="n">right_index</span><span class="p">)</span>

<span class="n">result</span> <span class="o">=</span> <span class="n">left</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">right</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;key1&#39;</span><span class="p">,</span> <span class="s1">&#39;key2&#39;</span><span class="p">])</span>
</code></pre></div>


<p><img alt="../_images/merge_on_index_and_column.png" src="https://pandas.pydata.org/docs/_images/merge_on_index_and_column.png" /></p>
<h3 id="_5">值列重叠</h3>
<p><code>merge</code>函数的<code>suffixes</code>参数接受字符串列表的元组，以附加到输入DataFrame中重叠的列名以消除结果列的歧义：</p>
<div class="codehilite"><pre><span></span><code><span class="n">left</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;k&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;K0&#39;</span><span class="p">,</span> <span class="s1">&#39;K1&#39;</span><span class="p">,</span> <span class="s1">&#39;K2&#39;</span><span class="p">],</span> <span class="s1">&#39;v&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]})</span>
<span class="n">right</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;k&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;K0&#39;</span><span class="p">,</span> <span class="s1">&#39;K0&#39;</span><span class="p">,</span> <span class="s1">&#39;K3&#39;</span><span class="p">],</span> <span class="s1">&#39;v&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]})</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
</code></pre></div>


<p><img alt="../_images/merging_merge_overlapped.png" src="https://pandas.pydata.org/docs/_images/merging_merge_overlapped.png" /></p>
<div class="codehilite"><pre><span></span><code><span class="n">result</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">suffixes</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;_l&#39;</span><span class="p">,</span> <span class="s1">&#39;_r&#39;</span><span class="p">])</span>
</code></pre></div>


<p><img alt="../_images/merging_merge_overlapped_suffix.png" src="https://pandas.pydata.org/docs/_images/merging_merge_overlapped_suffix.png" /></p>
<p><a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.join.html#pandas.DataFrame.join"><code>DataFrame.join()</code></a>具有<code>lsuffix</code>和<code>rsuffix</code>行为类似的参数。</p>
<div class="codehilite"><pre><span></span><code><span class="n">left</span> <span class="o">=</span> <span class="n">left</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">right</span> <span class="o">=</span> <span class="n">right</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">left</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">right</span><span class="p">,</span> <span class="n">lsuffix</span><span class="o">=</span><span class="s1">&#39;_l&#39;</span><span class="p">,</span> <span class="n">rsuffix</span><span class="o">=</span><span class="s1">&#39;_r&#39;</span><span class="p">)</span>
</code></pre></div>


<p><img alt="../_images/merging_merge_overlapped_multi_suffix.png" src="https://pandas.pydata.org/docs/_images/merging_merge_overlapped_multi_suffix.png" /></p>
<h3 id="dataframes">拼接多个DataFrames</h3>
<p><code>DataFrames</code>也可以传递的列表或元组以<a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.join.html#pandas.DataFrame.join"><code>join()</code></a> 将它们连接到它们的索引上。</p>
<div class="codehilite"><pre><span></span><code><span class="n">right2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;v&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">]},</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;K1&#39;</span><span class="p">,</span> <span class="s1">&#39;K1&#39;</span><span class="p">,</span> <span class="s1">&#39;K2&#39;</span><span class="p">])</span>

<span class="n">result</span> <span class="o">=</span> <span class="n">left</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">right</span><span class="p">,</span> <span class="n">right2</span><span class="p">])</span>
</code></pre></div>


<p><img alt="../_images/merging_join_multi_df.png" src="https://pandas.pydata.org/docs/_images/merging_join_multi_df.png" /></p>
<h3 id="_6">按索引填补缺失值</h3>
<p>另一个相当常见的情况是有两个索引存在交集的对象，其中一个存在缺失值，想通过另一个对象填补缺失值。这是一个例子：</p>
<div class="codehilite"><pre><span></span><code><span class="n">df1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([[</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mf">3.</span><span class="p">,</span> <span class="mf">5.</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mf">4.6</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">],</span>
                   <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mf">7.</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">]])</span>

<span class="n">df2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([[</span><span class="o">-</span><span class="mf">42.6</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="o">-</span><span class="mf">8.2</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mf">5.</span><span class="p">,</span> <span class="mf">1.6</span><span class="p">,</span> <span class="mi">4</span><span class="p">]],</span>
                   <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
</code></pre></div>


<p><a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.combine_first.html#pandas.DataFrame.combine_first"><code>combine_first()</code></a>方法可以达到这个效果：</p>
<div class="codehilite"><pre><span></span><code><span class="n">result</span> <span class="o">=</span> <span class="n">df1</span><span class="o">.</span><span class="n">combine_first</span><span class="p">(</span><span class="n">df2</span><span class="p">)</span>
</code></pre></div>


<p><img alt="../_images/merging_combine_first.png" src="https://pandas.pydata.org/docs/_images/merging_combine_first.png" /></p>
<p>请注意，<code>combine_first</code>返回副本，而<a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.update.html#pandas.DataFrame.update"><code>update()</code></a>则会修改原对象：</p>
<div class="codehilite"><pre><span></span><code><span class="n">df1</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">df2</span><span class="p">)</span>
</code></pre></div>


<p><img alt="../_images/merging_update.png" src="https://pandas.pydata.org/docs/_images/merging_update.png" /></p>
<h2 id="_7">合并时间序列</h2>
<h3 id="_8">合并有序数据</h3>
<p><a href="https://pandas.pydata.org/docs/reference/api/pandas.merge_ordered.html#pandas.merge_ordered"><code>merge_ordered()</code></a>函数允许组合时间序列和其他有序数据。</p>
<div class="codehilite"><pre><span></span><code><span class="n">merge_ordered</span><span class="p">(</span>
    <span class="n">left</span><span class="p">,</span>
    <span class="n">right</span><span class="p">,</span>
    <span class="n">on</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">left_on</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">right_on</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">left_by</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">right_by</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">fill_method</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">suffixes</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;_x&quot;</span><span class="p">,</span> <span class="s2">&quot;_y&quot;</span><span class="p">),</span>
    <span class="n">how</span><span class="o">=</span><span class="s2">&quot;outer&quot;</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div>


<ul>
<li><code>left_by</code>: Group left DataFrame by group columns and merge piece by piece with right DataFrame</li>
</ul>
<div class="codehilite"><pre><span></span><code><span class="n">left</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;k&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;K0&#39;</span><span class="p">,</span> <span class="s1">&#39;K1&#39;</span><span class="p">,</span> <span class="s1">&#39;K1&#39;</span><span class="p">,</span> <span class="s1">&#39;K2&#39;</span><span class="p">],</span>
                    <span class="s1">&#39;lv&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
                     <span class="s1">&#39;s&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">]})</span>

<span class="n">right</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;k&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;K1&#39;</span><span class="p">,</span> <span class="s1">&#39;K2&#39;</span><span class="p">,</span> <span class="s1">&#39;K4&#39;</span><span class="p">],</span>
                     <span class="s1">&#39;rv&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]})</span>

<span class="nb">print</span><span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">right</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">merge_ordered</span><span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">fill_method</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">left_by</span><span class="o">=</span><span class="s1">&#39;s&#39;</span><span class="p">)</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code>    <span class="n">k</span>  <span class="n">lv</span>  <span class="n">s</span>
<span class="mi">0</span>  <span class="n">K0</span>   <span class="mi">1</span>  <span class="n">a</span>
<span class="mi">1</span>  <span class="n">K1</span>   <span class="mi">2</span>  <span class="n">b</span>
<span class="mi">2</span>  <span class="n">K1</span>   <span class="mi">3</span>  <span class="k">c</span>
<span class="mi">3</span>  <span class="n">K2</span>   <span class="mi">4</span>  <span class="n">d</span>

    <span class="n">k</span>  <span class="n">rv</span>
<span class="mi">0</span>  <span class="n">K1</span>   <span class="mi">1</span>
<span class="mi">1</span>  <span class="n">K2</span>   <span class="mi">2</span>
<span class="mi">2</span>  <span class="n">K4</span>   <span class="mi">3</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="err">     k   lv  s   rv</span>
<span class="err">0   K0  1.0  a  NaN</span>
<span class="err">1   K1  NaN  a  1.0</span>
<span class="err">2   K2  NaN  a  2.0</span>
<span class="err">3   K4  NaN  a  3.0</span>
<span class="err">4   K1  2.0  b  1.0</span>
<span class="err">5   K2  NaN  b  2.0</span>
<span class="err">6   K4  NaN  b  3.0</span>
<span class="err">7   K1  3.0  c  1.0</span>
<span class="err">8   K2  NaN  c  2.0</span>
<span class="err">9   K4  NaN  c  3.0</span>
<span class="err">10  K1  NaN  d  1.0</span>
<span class="err">11  K2  4.0  d  2.0</span>
<span class="err">12  K4  NaN  d  3.0</span>
</code></pre></div>


<p>它具有一个可选<code>fill_method</code>关键字来填充丢失的数据：</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># 前向填充：后面的缺失值用前面的数字填充</span>
<span class="n">pd</span><span class="o">.</span><span class="n">merge_ordered</span><span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">fill_method</span><span class="o">=</span><span class="s2">&quot;ffill&quot;</span><span class="p">,</span> <span class="n">left_by</span><span class="o">=</span><span class="s1">&#39;s&#39;</span><span class="p">)</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="err">     k   lv  s   rv</span>
<span class="err">0   K0  1.0  a  NaN</span>
<span class="err">1   K1  1.0  a  1.0</span>
<span class="err">2   K2  1.0  a  2.0</span>
<span class="err">3   K4  1.0  a  3.0</span>
<span class="err">4   K1  2.0  b  1.0</span>
<span class="err">5   K2  2.0  b  2.0</span>
<span class="err">6   K4  2.0  b  3.0</span>
<span class="err">7   K1  3.0  c  1.0</span>
<span class="err">8   K2  3.0  c  2.0</span>
<span class="err">9   K4  3.0  c  3.0</span>
<span class="err">10  K1  NaN  d  1.0</span>
<span class="err">11  K2  4.0  d  2.0</span>
<span class="err">12  K4  4.0  d  3.0</span>
</code></pre></div>


<h3 id="asof">合并ASOF</h3>
<p><a href="https://pandas.pydata.org/docs/reference/api/pandas.merge_asof.html#pandas.merge_asof"><code>merge_asof()</code></a>类似于有序左联接，只是我们匹配最近的键而不是相等的键。对于左数据框中的每一行，我们选择右数据框中的最后一行，该行的on键小于lefs键。两个数据帧都必须按键排序。</p>
<p>可选地，asof合并可以执行逐组合并。除了on键上最接近的匹配之外，它与by键的匹配相同</p>
<div class="codehilite"><pre><span></span><code><span class="n">merge_asof</span><span class="p">(</span>
    <span class="n">left</span><span class="p">,</span>
    <span class="n">right</span><span class="p">,</span>
    <span class="n">on</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">left_on</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">right_on</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">left_index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">right_index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">by</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">left_by</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">right_by</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">suffixes</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;_x&quot;</span><span class="p">,</span> <span class="s2">&quot;_y&quot;</span><span class="p">),</span>
    <span class="n">tolerance</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">allow_exact_matches</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">direction</span><span class="o">=</span><span class="s2">&quot;backward&quot;</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div>


<p>例如，我们可能有<code>trades</code>和<code>quotes</code>，我们想合并它们</p>
<div class="codehilite"><pre><span></span><code><span class="n">trades</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
     <span class="s1">&#39;time&#39;</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">([</span><span class="s1">&#39;20160525 13:30:00.023&#39;</span><span class="p">,</span>
                             <span class="s1">&#39;20160525 13:30:00.038&#39;</span><span class="p">,</span>
                             <span class="s1">&#39;20160525 13:30:00.048&#39;</span><span class="p">,</span>
                             <span class="s1">&#39;20160525 13:30:00.048&#39;</span><span class="p">,</span>
                             <span class="s1">&#39;20160525 13:30:00.048&#39;</span><span class="p">]),</span>
     <span class="s1">&#39;ticker&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;MSFT&#39;</span><span class="p">,</span> <span class="s1">&#39;MSFT&#39;</span><span class="p">,</span>
                <span class="s1">&#39;GOOG&#39;</span><span class="p">,</span> <span class="s1">&#39;GOOG&#39;</span><span class="p">,</span> <span class="s1">&#39;AAPL&#39;</span><span class="p">],</span>
     <span class="s1">&#39;price&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">51.95</span><span class="p">,</span> <span class="mf">51.95</span><span class="p">,</span>
               <span class="mf">720.77</span><span class="p">,</span> <span class="mf">720.92</span><span class="p">,</span> <span class="mf">98.00</span><span class="p">],</span>
     <span class="s1">&#39;quantity&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">75</span><span class="p">,</span> <span class="mi">155</span><span class="p">,</span>
                  <span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">]},</span>
     <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="s1">&#39;ticker&#39;</span><span class="p">,</span> <span class="s1">&#39;price&#39;</span><span class="p">,</span> <span class="s1">&#39;quantity&#39;</span><span class="p">])</span>


<span class="n">quotes</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
     <span class="s1">&#39;time&#39;</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">([</span><span class="s1">&#39;20160525 13:30:00.023&#39;</span><span class="p">,</span>
                             <span class="s1">&#39;20160525 13:30:00.023&#39;</span><span class="p">,</span>
                             <span class="s1">&#39;20160525 13:30:00.030&#39;</span><span class="p">,</span>
                             <span class="s1">&#39;20160525 13:30:00.041&#39;</span><span class="p">,</span>
                             <span class="s1">&#39;20160525 13:30:00.048&#39;</span><span class="p">,</span>
                             <span class="s1">&#39;20160525 13:30:00.049&#39;</span><span class="p">,</span>
                             <span class="s1">&#39;20160525 13:30:00.072&#39;</span><span class="p">,</span>
                             <span class="s1">&#39;20160525 13:30:00.075&#39;</span><span class="p">]),</span>
     <span class="s1">&#39;ticker&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;GOOG&#39;</span><span class="p">,</span> <span class="s1">&#39;MSFT&#39;</span><span class="p">,</span> <span class="s1">&#39;MSFT&#39;</span><span class="p">,</span>
                <span class="s1">&#39;MSFT&#39;</span><span class="p">,</span> <span class="s1">&#39;GOOG&#39;</span><span class="p">,</span> <span class="s1">&#39;AAPL&#39;</span><span class="p">,</span> <span class="s1">&#39;GOOG&#39;</span><span class="p">,</span>
                <span class="s1">&#39;MSFT&#39;</span><span class="p">],</span>
     <span class="s1">&#39;bid&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">720.50</span><span class="p">,</span> <span class="mf">51.95</span><span class="p">,</span> <span class="mf">51.97</span><span class="p">,</span> <span class="mf">51.99</span><span class="p">,</span>
             <span class="mf">720.50</span><span class="p">,</span> <span class="mf">97.99</span><span class="p">,</span> <span class="mf">720.50</span><span class="p">,</span> <span class="mf">52.01</span><span class="p">],</span>
     <span class="s1">&#39;ask&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">720.93</span><span class="p">,</span> <span class="mf">51.96</span><span class="p">,</span> <span class="mf">51.98</span><span class="p">,</span> <span class="mf">52.00</span><span class="p">,</span>
             <span class="mf">720.93</span><span class="p">,</span> <span class="mf">98.01</span><span class="p">,</span> <span class="mf">720.88</span><span class="p">,</span> <span class="mf">52.03</span><span class="p">]},</span>
     <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="s1">&#39;ticker&#39;</span><span class="p">,</span> <span class="s1">&#39;bid&#39;</span><span class="p">,</span> <span class="s1">&#39;ask&#39;</span><span class="p">])</span>

<span class="nb">print</span><span class="p">(</span><span class="n">trades</span><span class="p">,</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">quotes</span><span class="p">)</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code>                     <span class="n">time</span> <span class="n">ticker</span>   <span class="n">price</span>  <span class="n">quantity</span>
<span class="mi">0</span> <span class="mi">2016</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">25</span> <span class="mi">13</span><span class="p">:</span><span class="mi">30</span><span class="p">:</span><span class="mi">00</span><span class="p">.</span><span class="mi">023</span>   <span class="n">MSFT</span>   <span class="mi">51</span><span class="p">.</span><span class="mi">95</span>        <span class="mi">75</span>
<span class="mi">1</span> <span class="mi">2016</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">25</span> <span class="mi">13</span><span class="p">:</span><span class="mi">30</span><span class="p">:</span><span class="mi">00</span><span class="p">.</span><span class="mi">038</span>   <span class="n">MSFT</span>   <span class="mi">51</span><span class="p">.</span><span class="mi">95</span>       <span class="mi">155</span>
<span class="mi">2</span> <span class="mi">2016</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">25</span> <span class="mi">13</span><span class="p">:</span><span class="mi">30</span><span class="p">:</span><span class="mi">00</span><span class="p">.</span><span class="mi">048</span>   <span class="n">GOOG</span>  <span class="mi">720</span><span class="p">.</span><span class="mi">77</span>       <span class="mi">100</span>
<span class="mi">3</span> <span class="mi">2016</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">25</span> <span class="mi">13</span><span class="p">:</span><span class="mi">30</span><span class="p">:</span><span class="mi">00</span><span class="p">.</span><span class="mi">048</span>   <span class="n">GOOG</span>  <span class="mi">720</span><span class="p">.</span><span class="mi">92</span>       <span class="mi">100</span>
<span class="mi">4</span> <span class="mi">2016</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">25</span> <span class="mi">13</span><span class="p">:</span><span class="mi">30</span><span class="p">:</span><span class="mi">00</span><span class="p">.</span><span class="mi">048</span>   <span class="n">AAPL</span>   <span class="mi">98</span><span class="p">.</span><span class="mi">00</span>       <span class="mi">100</span>

                     <span class="n">time</span> <span class="n">ticker</span>     <span class="n">bid</span>     <span class="n">ask</span>
<span class="mi">0</span> <span class="mi">2016</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">25</span> <span class="mi">13</span><span class="p">:</span><span class="mi">30</span><span class="p">:</span><span class="mi">00</span><span class="p">.</span><span class="mi">023</span>   <span class="n">GOOG</span>  <span class="mi">720</span><span class="p">.</span><span class="mi">50</span>  <span class="mi">720</span><span class="p">.</span><span class="mi">93</span>
<span class="mi">1</span> <span class="mi">2016</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">25</span> <span class="mi">13</span><span class="p">:</span><span class="mi">30</span><span class="p">:</span><span class="mi">00</span><span class="p">.</span><span class="mi">023</span>   <span class="n">MSFT</span>   <span class="mi">51</span><span class="p">.</span><span class="mi">95</span>   <span class="mi">51</span><span class="p">.</span><span class="mi">96</span>
<span class="mi">2</span> <span class="mi">2016</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">25</span> <span class="mi">13</span><span class="p">:</span><span class="mi">30</span><span class="p">:</span><span class="mi">00</span><span class="p">.</span><span class="mi">030</span>   <span class="n">MSFT</span>   <span class="mi">51</span><span class="p">.</span><span class="mi">97</span>   <span class="mi">51</span><span class="p">.</span><span class="mi">98</span>
<span class="mi">3</span> <span class="mi">2016</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">25</span> <span class="mi">13</span><span class="p">:</span><span class="mi">30</span><span class="p">:</span><span class="mi">00</span><span class="p">.</span><span class="mi">041</span>   <span class="n">MSFT</span>   <span class="mi">51</span><span class="p">.</span><span class="mi">99</span>   <span class="mi">52</span><span class="p">.</span><span class="mi">00</span>
<span class="mi">4</span> <span class="mi">2016</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">25</span> <span class="mi">13</span><span class="p">:</span><span class="mi">30</span><span class="p">:</span><span class="mi">00</span><span class="p">.</span><span class="mi">048</span>   <span class="n">GOOG</span>  <span class="mi">720</span><span class="p">.</span><span class="mi">50</span>  <span class="mi">720</span><span class="p">.</span><span class="mi">93</span>
<span class="mi">5</span> <span class="mi">2016</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">25</span> <span class="mi">13</span><span class="p">:</span><span class="mi">30</span><span class="p">:</span><span class="mi">00</span><span class="p">.</span><span class="mi">049</span>   <span class="n">AAPL</span>   <span class="mi">97</span><span class="p">.</span><span class="mi">99</span>   <span class="mi">98</span><span class="p">.</span><span class="mi">01</span>
<span class="mi">6</span> <span class="mi">2016</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">25</span> <span class="mi">13</span><span class="p">:</span><span class="mi">30</span><span class="p">:</span><span class="mi">00</span><span class="p">.</span><span class="mi">072</span>   <span class="n">GOOG</span>  <span class="mi">720</span><span class="p">.</span><span class="mi">50</span>  <span class="mi">720</span><span class="p">.</span><span class="mi">88</span>
<span class="mi">7</span> <span class="mi">2016</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">25</span> <span class="mi">13</span><span class="p">:</span><span class="mi">30</span><span class="p">:</span><span class="mi">00</span><span class="p">.</span><span class="mi">075</span>   <span class="n">MSFT</span>   <span class="mi">52</span><span class="p">.</span><span class="mi">01</span>   <span class="mi">52</span><span class="p">.</span><span class="mi">03</span>
</code></pre></div>


<p>默认情况下，我们采用的是quotes。</p>
<div class="codehilite"><pre><span></span><code><span class="n">pd</span><span class="o">.</span><span class="n">merge_asof</span><span class="p">(</span><span class="n">trades</span><span class="p">,</span> <span class="n">quotes</span><span class="p">,</span>
               <span class="n">on</span><span class="o">=</span><span class="s1">&#39;time&#39;</span><span class="p">,</span>
               <span class="n">by</span><span class="o">=</span><span class="s1">&#39;ticker&#39;</span><span class="p">)</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="err">                     time ticker   price  quantity     bid     ask</span>
<span class="err">0 2016-05-25 13:30:00.023   MSFT   51.95        75   51.95   51.96</span>
<span class="err">1 2016-05-25 13:30:00.038   MSFT   51.95       155   51.97   51.98</span>
<span class="err">2 2016-05-25 13:30:00.048   GOOG  720.77       100  720.50  720.93</span>
<span class="err">3 2016-05-25 13:30:00.048   GOOG  720.92       100  720.50  720.93</span>
<span class="err">4 2016-05-25 13:30:00.048   AAPL   98.00       100     NaN     NaN</span>
</code></pre></div>


<p>我们只在quote 时间和trade 时间之间的2毫秒内合并：</p>
<div class="codehilite"><pre><span></span><code><span class="n">pd</span><span class="o">.</span><span class="n">merge_asof</span><span class="p">(</span><span class="n">trades</span><span class="p">,</span> <span class="n">quotes</span><span class="p">,</span>
               <span class="n">on</span><span class="o">=</span><span class="s1">&#39;time&#39;</span><span class="p">,</span>
               <span class="n">by</span><span class="o">=</span><span class="s1">&#39;ticker&#39;</span><span class="p">,</span>
               <span class="n">tolerance</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">Timedelta</span><span class="p">(</span><span class="s1">&#39;2ms&#39;</span><span class="p">))</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="err">                     time ticker   price  quantity     bid     ask</span>
<span class="err">0 2016-05-25 13:30:00.023   MSFT   51.95        75   51.95   51.96</span>
<span class="err">1 2016-05-25 13:30:00.038   MSFT   51.95       155     NaN     NaN</span>
<span class="err">2 2016-05-25 13:30:00.048   GOOG  720.77       100  720.50  720.93</span>
<span class="err">3 2016-05-25 13:30:00.048   GOOG  720.92       100  720.50  720.93</span>
<span class="err">4 2016-05-25 13:30:00.048   AAPL   98.00       100     NaN     NaN</span>
</code></pre></div>


<p>我们只在quote 时间和trade 时间之间的10毫秒内合并，并且不包括精确匹配。注意，尽管我们排除了（quotes的）完全匹配项，但以前的quotes确实会传播到那个时间点。</p>
<div class="codehilite"><pre><span></span><code><span class="n">pd</span><span class="o">.</span><span class="n">merge_asof</span><span class="p">(</span><span class="n">trades</span><span class="p">,</span> <span class="n">quotes</span><span class="p">,</span>
               <span class="n">on</span><span class="o">=</span><span class="s1">&#39;time&#39;</span><span class="p">,</span>
               <span class="n">by</span><span class="o">=</span><span class="s1">&#39;ticker&#39;</span><span class="p">,</span>
               <span class="n">tolerance</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">Timedelta</span><span class="p">(</span><span class="s1">&#39;10ms&#39;</span><span class="p">),</span>
               <span class="n">allow_exact_matches</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="err">                     time ticker   price  quantity    bid    ask</span>
<span class="err">0 2016-05-25 13:30:00.023   MSFT   51.95        75    NaN    NaN</span>
<span class="err">1 2016-05-25 13:30:00.038   MSFT   51.95       155  51.97  51.98</span>
<span class="err">2 2016-05-25 13:30:00.048   GOOG  720.77       100    NaN    NaN</span>
<span class="err">3 2016-05-25 13:30:00.048   GOOG  720.92       100    NaN    NaN</span>
<span class="err">4 2016-05-25 13:30:00.048   AAPL   98.00       100    NaN    NaN</span>
</code></pre></div>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid" aria-label="Footer">
        
          <a href="9.5.%E7%B4%A2%E5%BC%95%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C.html" class="md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
            </div>
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  上一页
                </span>
                9.5.索引的基本操作
              </div>
            </div>
          </a>
        
        
          <a href="9.7.%E5%8F%98%E6%8D%A2%E7%B4%A2%E5%BC%95.html" class="md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  下一页
                </span>
                9.7.变换索引
              </div>
            </div>
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/vendor.7e0ee788.min.js"></script>
      <script src="../assets/javascripts/bundle.b3a72adc.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "\u590d\u5236", "clipboard.copied": "\u5df2\u590d\u5236", "search.config.lang": "ja", "search.config.pipeline": "trimmer, stemmer", "search.config.separator": "[\\uff0c\\u3002]+", "search.placeholder": "\u641c\u7d22", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}</script>
      
      <script>
        app = initialize({
          base: "..",
          features: [],
          search: Object.assign({
            worker: "../assets/javascripts/worker/search.4ac00218.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
        <script src="../javascript/extra.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
      
    
  </body>
</html>